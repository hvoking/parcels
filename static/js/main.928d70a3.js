/*! For license information please see main.928d70a3.js.LICENSE.txt */
(()=>{var t={331:t=>{"use strict";t.exports=n,t.exports.default=n;var e=1e20;function n(t,e,n,i,r,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=i||.25,this.fontFamily=r||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var s=this.size=this.fontSize+2*this.buffer,a=s+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=s,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(s/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function i(t,e,n,i,o,s){for(var a=0;a<e;a++)r(t,a,e,n,i,o,s);for(var l=0;l<n;l++)r(t,l*e,1,e,i,o,s)}function r(t,n,i,r,o,s,a){var l,c,u,h;for(s[0]=0,a[0]=-e,a[1]=e,l=0;l<r;l++)o[l]=t[n+l*i];for(l=1,c=0,u=0;l<r;l++){do{h=s[c],u=(o[l]-o[h]+l*l-h*h)/(l-h)/2}while(u<=a[c]&&--c>-1);s[++c]=l,a[c]=u,a[c+1]=e}for(l=0,c=0;l<r;l++){for(;a[c+1]<l;)c++;h=s[c],t[n+l*i]=o[h]+(l-h)*(l-h)}}n.prototype._draw=function(t,n){var r,o,s,a,l,c,u,h,d,f=this.ctx.measureText(t),p=f.width,g=2*this.buffer;n&&this.useMetrics?(l=Math.floor(f.actualBoundingBoxAscent),h=this.buffer+Math.ceil(f.actualBoundingBoxAscent),c=this.buffer,u=this.buffer,r=(o=Math.min(this.size,Math.ceil(f.actualBoundingBoxRight-f.actualBoundingBoxLeft)))+g,s=(a=Math.min(this.size-c,Math.ceil(f.actualBoundingBoxAscent+f.actualBoundingBoxDescent)))+g,this.ctx.textBaseline="alphabetic"):(r=o=this.size,s=a=this.size,l=19*this.fontSize/24,c=u=0,h=this.middle,this.ctx.textBaseline="middle"),o&&a&&(this.ctx.clearRect(u,c,o,a),this.ctx.fillText(t,this.buffer,h),d=this.ctx.getImageData(u,c,o,a));var m=new Uint8ClampedArray(r*s);return function(t,n,i,r,o,s,a){s.fill(e,0,n*i),a.fill(0,0,n*i);for(var l=(n-r)/2,c=0;c<o;c++)for(var u=0;u<r;u++){var h=(c+l)*n+u+l,d=t.data[4*(c*r+u)+3]/255;if(1===d)s[h]=0,a[h]=e;else if(0===d)s[h]=e,a[h]=0;else{var f=Math.max(0,.5-d),p=Math.max(0,d-.5);s[h]=f*f,a[h]=p*p}}}(d,r,s,o,a,this.gridOuter,this.gridInner),i(this.gridOuter,r,s,this.f,this.v,this.z),i(this.gridInner,r,s,this.f,this.v,this.z),function(t,e,n,i,r,o,s){for(var a=0;a<e*n;a++){var l=Math.sqrt(i[a])-Math.sqrt(r[a]);t[a]=Math.round(255-255*(l/o+s))}}(m,r,s,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:m,metrics:{width:o,height:a,sdfWidth:r,sdfHeight:s,top:l,left:0,advance:p}}},n.prototype.draw=function(t){return this._draw(t,!1).data},n.prototype.drawWithMetrics=function(t){return this._draw(t,!0)}},89:t=>{"use strict";function e(t,e,i){i=i||2;var o,s,a,l,h,d,p,g=e&&e.length,m=g?e[0]*i:t.length,v=n(t,0,m,i,!0),y=[];if(!v||v.next===v.prev)return y;if(g&&(v=function(t,e,i,r){var o,s,a,l=[];for(o=0,s=e.length;o<s;o++)(a=n(t,e[o]*r,o<s-1?e[o+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),l.push(f(a));for(l.sort(c),o=0;o<l.length;o++)i=u(l[o],i);return i}(t,e,v,i)),t.length>80*i){o=a=t[0],s=l=t[1];for(var b=i;b<m;b+=i)(h=t[b])<o&&(o=h),(d=t[b+1])<s&&(s=d),h>a&&(a=h),d>l&&(l=d);p=0!==(p=Math.max(a-o,l-s))?32767/p:0}return r(v,y,i,o,s,p,0),y}function n(t,e,n,i,r){var o,s;if(r===C(t,e,n,i)>0)for(o=e;o<n;o+=i)s=S(o,t[o],t[o+1],s);else for(o=n-i;o>=e;o-=i)s=S(o,t[o],t[o+1],s);return s&&v(s,s.next)&&(P(s),s=s.next),s}function i(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!v(i,i.next)&&0!==m(i.prev,i,i.next))i=i.next;else{if(P(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function r(t,e,n,c,u,h,f){if(t){!f&&h&&function(t,e,n,i){var r=t;do{0===r.z&&(r.z=d(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,s,a,l,c=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,i=n,a=0,e=0;e<c&&(a++,i=i.nextZ);e++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,c*=2}while(s>1)}(r)}(t,c,u,h);for(var p,g,m=t;t.prev!==t.next;)if(p=t.prev,g=t.next,h?s(t,c,u,h):o(t))e.push(p.i/n|0),e.push(t.i/n|0),e.push(g.i/n|0),P(t),t=g.next,m=g.next;else if((t=g)===m){f?1===f?r(t=a(i(t),e,n),e,n,c,u,h,2):2===f&&l(t,e,n,c,u,h):r(i(t),e,n,c,u,h,1);break}}}function o(t){var e=t.prev,n=t,i=t.next;if(m(e,n,i)>=0)return!1;for(var r=e.x,o=n.x,s=i.x,a=e.y,l=n.y,c=i.y,u=r<o?r<s?r:s:o<s?o:s,h=a<l?a<c?a:c:l<c?l:c,d=r>o?r>s?r:s:o>s?o:s,f=a>l?a>c?a:c:l>c?l:c,g=i.next;g!==e;){if(g.x>=u&&g.x<=d&&g.y>=h&&g.y<=f&&p(r,a,o,l,s,c,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function s(t,e,n,i){var r=t.prev,o=t,s=t.next;if(m(r,o,s)>=0)return!1;for(var a=r.x,l=o.x,c=s.x,u=r.y,h=o.y,f=s.y,g=a<l?a<c?a:c:l<c?l:c,v=u<h?u<f?u:f:h<f?h:f,y=a>l?a>c?a:c:l>c?l:c,b=u>h?u>f?u:f:h>f?h:f,_=d(g,v,e,n,i),w=d(y,b,e,n,i),x=t.prevZ,S=t.nextZ;x&&x.z>=_&&S&&S.z<=w;){if(x.x>=g&&x.x<=y&&x.y>=v&&x.y<=b&&x!==r&&x!==s&&p(a,u,l,h,c,f,x.x,x.y)&&m(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,S.x>=g&&S.x<=y&&S.y>=v&&S.y<=b&&S!==r&&S!==s&&p(a,u,l,h,c,f,S.x,S.y)&&m(S.prev,S,S.next)>=0)return!1;S=S.nextZ}for(;x&&x.z>=_;){if(x.x>=g&&x.x<=y&&x.y>=v&&x.y<=b&&x!==r&&x!==s&&p(a,u,l,h,c,f,x.x,x.y)&&m(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;S&&S.z<=w;){if(S.x>=g&&S.x<=y&&S.y>=v&&S.y<=b&&S!==r&&S!==s&&p(a,u,l,h,c,f,S.x,S.y)&&m(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function a(t,e,n){var r=t;do{var o=r.prev,s=r.next.next;!v(o,s)&&y(o,r,r.next,s)&&w(o,s)&&w(s,o)&&(e.push(o.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),P(r),P(r.next),r=t=s),r=r.next}while(r!==t);return i(r)}function l(t,e,n,o,s,a){var l=t;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&g(l,c)){var u=x(l,c);return l=i(l,l.next),u=i(u,u.next),r(l,e,n,o,s,a,0),void r(u,e,n,o,s,a,0)}c=c.next}l=l.next}while(l!==t)}function c(t,e){return t.x-e.x}function u(t,e){var n=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s&&(s=a,n=i.x<i.next.x?i:i.next,a===r))return n}i=i.next}while(i!==e);if(!n)return null;var l,c=n,u=n.x,d=n.y,f=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&p(o<d?r:s,o,u,d,o<d?s:r,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(r-i.x),w(i,t)&&(l<f||l===f&&(i.x>n.x||i.x===n.x&&h(n,i)))&&(n=i,f=l)),i=i.next}while(i!==c);return n}(t,e);if(!n)return e;var r=x(n,t);return i(r,r.next),i(n,n.next)}function h(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function d(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function f(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function p(t,e,n,i,r,o,s,a){return(r-s)*(e-a)>=(t-s)*(o-a)&&(t-s)*(i-a)>=(n-s)*(e-a)&&(n-s)*(o-a)>=(r-s)*(i-a)}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&y(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(w(t,e)&&w(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!==n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||v(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function y(t,e,n,i){var r=_(m(t,e,n)),o=_(m(t,e,i)),s=_(m(n,i,t)),a=_(m(n,i,e));return r!==o&&s!==a||(!(0!==r||!b(t,n,e))||(!(0!==o||!b(t,i,e))||(!(0!==s||!b(n,t,i))||!(0!==a||!b(n,e,i)))))}function b(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function _(t){return t>0?1:t<0?-1:0}function w(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function x(t,e){var n=new E(t.i,t.x,t.y),i=new E(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function S(t,e,n,i){var r=new E(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function P(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function E(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function C(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,s=Math.abs(C(t,0,o,n));if(r)for(var a=0,l=e.length;a<l;a++){var c=e[a]*n,u=a<l-1?e[a+1]*n:t.length;s-=Math.abs(C(t,c,u,n))}var h=0;for(a=0;a<i.length;a+=3){var d=i[a]*n,f=i[a+1]*n,p=i[a+2]*n;h+=Math.abs((t[d]-t[p])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[p+1]-t[d+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},97:(t,e,n)=>{var i;!function(r,o,s,a){"use strict";var l,c=["","webkit","Moz","MS","ms","o"],u=o.createElement("div"),h="function",d=Math.round,f=Math.abs,p=Date.now;function g(t,e,n){return setTimeout(x(t,n),e)}function m(t,e,n){return!!Array.isArray(t)&&(v(t,n[e],n),!0)}function v(t,e,n){var i;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==a)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function y(t,e,n){var i="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=r.console&&(r.console.warn||r.console.log);return o&&o.call(r.console,i,n),t.apply(this,arguments)}}l="function"!==typeof Object.assign?function(t){if(t===a||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==a&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}return e}:Object.assign;var b=y((function(t,e,n){for(var i=Object.keys(e),r=0;r<i.length;)(!n||n&&t[i[r]]===a)&&(t[i[r]]=e[i[r]]),r++;return t}),"extend","Use `assign`."),_=y((function(t,e){return b(t,e,!0)}),"merge","Use `assign`.");function w(t,e,n){var i,r=e.prototype;(i=t.prototype=Object.create(r)).constructor=t,i._super=r,n&&l(i,n)}function x(t,e){return function(){return t.apply(e,arguments)}}function S(t,e){return typeof t==h?t.apply(e&&e[0]||a,e):t}function P(t,e){return t===a?e:t}function E(t,e,n){v(k(e),(function(e){t.addEventListener(e,n,!1)}))}function C(t,e,n){v(k(e),(function(e){t.removeEventListener(e,n,!1)}))}function T(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function A(t,e){return t.indexOf(e)>-1}function k(t){return t.trim().split(/\s+/g)}function M(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var i=0;i<t.length;){if(n&&t[i][n]==e||!n&&t[i]===e)return i;i++}return-1}function L(t){return Array.prototype.slice.call(t,0)}function O(t,e,n){for(var i=[],r=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];M(r,s)<0&&i.push(t[o]),r[o]=s,o++}return n&&(i=e?i.sort((function(t,n){return t[e]>n[e]})):i.sort()),i}function R(t,e){for(var n,i,r=e[0].toUpperCase()+e.slice(1),o=0;o<c.length;){if((i=(n=c[o])?n+r:e)in t)return i;o++}return a}var I=1;function j(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||r}var F="ontouchstart"in r,z=R(r,"PointerEvent")!==a,N=F&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),D="touch",B="mouse",U=25,V=1,W=2,H=4,G=8,X=1,q=2,Z=4,Y=8,K=16,Q=q|Z,$=Y|K,J=Q|$,tt=["x","y"],et=["clientX","clientY"];function nt(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){S(t.options.enable,[t])&&n.handler(e)},this.init()}function it(t,e,n){var i=n.pointers.length,r=n.changedPointers.length,o=e&V&&i-r===0,s=e&(H|G)&&i-r===0;n.isFirst=!!o,n.isFinal=!!s,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,i=e.pointers,r=i.length;n.firstInput||(n.firstInput=rt(e));r>1&&!n.firstMultiple?n.firstMultiple=rt(e):1===r&&(n.firstMultiple=!1);var o=n.firstInput,s=n.firstMultiple,l=s?s.center:o.center,c=e.center=ot(i);e.timeStamp=p(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=ct(l,c),e.distance=lt(l,c),function(t,e){var n=e.center,i=t.offsetDelta||{},r=t.prevDelta||{},o=t.prevInput||{};e.eventType!==V&&o.eventType!==H||(r=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},i=t.offsetDelta={x:n.x,y:n.y});e.deltaX=r.x+(n.x-i.x),e.deltaY=r.y+(n.y-i.y)}(n,e),e.offsetDirection=at(e.deltaX,e.deltaY);var u=st(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=u.x,e.overallVelocityY=u.y,e.overallVelocity=f(u.x)>f(u.y)?u.x:u.y,e.scale=s?(h=s.pointers,d=i,lt(d[0],d[1],et)/lt(h[0],h[1],et)):1,e.rotation=s?function(t,e){return ct(e[1],e[0],et)+ct(t[1],t[0],et)}(s.pointers,i):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,i,r,o,s=t.lastInterval||e,l=e.timeStamp-s.timeStamp;if(e.eventType!=G&&(l>U||s.velocity===a)){var c=e.deltaX-s.deltaX,u=e.deltaY-s.deltaY,h=st(l,c,u);i=h.x,r=h.y,n=f(h.x)>f(h.y)?h.x:h.y,o=at(c,u),t.lastInterval=e}else n=s.velocity,i=s.velocityX,r=s.velocityY,o=s.direction;e.velocity=n,e.velocityX=i,e.velocityY=r,e.direction=o}(n,e);var h,d;var g=t.element;T(e.srcEvent.target,g)&&(g=e.srcEvent.target);e.target=g}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function rt(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:d(t.pointers[n].clientX),clientY:d(t.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:e,center:ot(e),deltaX:t.deltaX,deltaY:t.deltaY}}function ot(t){var e=t.length;if(1===e)return{x:d(t[0].clientX),y:d(t[0].clientY)};for(var n=0,i=0,r=0;r<e;)n+=t[r].clientX,i+=t[r].clientY,r++;return{x:d(n/e),y:d(i/e)}}function st(t,e,n){return{x:e/t||0,y:n/t||0}}function at(t,e){return t===e?X:f(t)>=f(e)?t<0?q:Z:e<0?Y:K}function lt(t,e,n){n||(n=tt);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return Math.sqrt(i*i+r*r)}function ct(t,e,n){n||(n=tt);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return 180*Math.atan2(r,i)/Math.PI}nt.prototype={handler:function(){},init:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(j(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(j(this.element),this.evWin,this.domHandler)}};var ut={mousedown:V,mousemove:W,mouseup:H},ht="mousedown",dt="mousemove mouseup";function ft(){this.evEl=ht,this.evWin=dt,this.pressed=!1,nt.apply(this,arguments)}w(ft,nt,{handler:function(t){var e=ut[t.type];e&V&&0===t.button&&(this.pressed=!0),e&W&&1!==t.which&&(e=H),this.pressed&&(e&H&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:B,srcEvent:t}))}});var pt={pointerdown:V,pointermove:W,pointerup:H,pointercancel:G,pointerout:G},gt={2:D,3:"pen",4:B,5:"kinect"},mt="pointerdown",vt="pointermove pointerup pointercancel";function yt(){this.evEl=mt,this.evWin=vt,nt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(mt="MSPointerDown",vt="MSPointerMove MSPointerUp MSPointerCancel"),w(yt,nt,{handler:function(t){var e=this.store,n=!1,i=t.type.toLowerCase().replace("ms",""),r=pt[i],o=gt[t.pointerType]||t.pointerType,s=o==D,a=M(e,t.pointerId,"pointerId");r&V&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):r&(H|G)&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(a,1))}});var bt={touchstart:V,touchmove:W,touchend:H,touchcancel:G},_t="touchstart",wt="touchstart touchmove touchend touchcancel";function xt(){this.evTarget=_t,this.evWin=wt,this.started=!1,nt.apply(this,arguments)}function St(t,e){var n=L(t.touches),i=L(t.changedTouches);return e&(H|G)&&(n=O(n.concat(i),"identifier",!0)),[n,i]}w(xt,nt,{handler:function(t){var e=bt[t.type];if(e===V&&(this.started=!0),this.started){var n=St.call(this,t,e);e&(H|G)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:D,srcEvent:t})}}});var Pt={touchstart:V,touchmove:W,touchend:H,touchcancel:G},Et="touchstart touchmove touchend touchcancel";function Ct(){this.evTarget=Et,this.targetIds={},nt.apply(this,arguments)}function Tt(t,e){var n=L(t.touches),i=this.targetIds;if(e&(V|W)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,o,s=L(t.changedTouches),a=[],l=this.target;if(o=n.filter((function(t){return T(t.target,l)})),e===V)for(r=0;r<o.length;)i[o[r].identifier]=!0,r++;for(r=0;r<s.length;)i[s[r].identifier]&&a.push(s[r]),e&(H|G)&&delete i[s[r].identifier],r++;return a.length?[O(o.concat(a),"identifier",!0),a]:void 0}w(Ct,nt,{handler:function(t){var e=Pt[t.type],n=Tt.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:D,srcEvent:t})}});var At=2500,kt=25;function Mt(){nt.apply(this,arguments);var t=x(this.handler,this);this.touch=new Ct(this.manager,t),this.mouse=new ft(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function Lt(t,e){t&V?(this.primaryTouch=e.changedPointers[0].identifier,Ot.call(this,e)):t&(H|G)&&Ot.call(this,e)}function Ot(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout((function(){var t=i.indexOf(n);t>-1&&i.splice(t,1)}),At)}}function Rt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],o=Math.abs(e-r.x),s=Math.abs(n-r.y);if(o<=kt&&s<=kt)return!0}return!1}w(Mt,nt,{handler:function(t,e,n){var i=n.pointerType==D,r=n.pointerType==B;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)Lt.call(this,e,n);else if(r&&Rt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var It=R(u.style,"touchAction"),jt=It!==a,Ft="compute",zt="auto",Nt="manipulation",Dt="none",Bt="pan-x",Ut="pan-y",Vt=function(){if(!jt)return!1;var t={},e=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||r.CSS.supports("touch-action",n)})),t}();function Wt(t,e){this.manager=t,this.set(e)}Wt.prototype={set:function(t){t==Ft&&(t=this.compute()),jt&&this.manager.element.style&&Vt[t]&&(this.manager.element.style[It]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return v(this.manager.recognizers,(function(e){S(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(A(t,Dt))return Dt;var e=A(t,Bt),n=A(t,Ut);if(e&&n)return Dt;if(e||n)return e?Bt:Ut;if(A(t,Nt))return Nt;return zt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var i=this.actions,r=A(i,Dt)&&!Vt[Dt],o=A(i,Ut)&&!Vt[Ut],s=A(i,Bt)&&!Vt[Bt];if(r){var a=1===t.pointers.length,l=t.distance<2,c=t.deltaTime<250;if(a&&l&&c)return}if(!s||!o)return r||o&&n&Q||s&&n&$?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Ht=1,Gt=2,Xt=4,qt=8,Zt=qt,Yt=16,Kt=32;function Qt(t){this.options=l({},this.defaults,t||{}),this.id=I++,this.manager=null,this.options.enable=P(this.options.enable,!0),this.state=Ht,this.simultaneous={},this.requireFail=[]}function $t(t){return t&Yt?"cancel":t&qt?"end":t&Xt?"move":t&Gt?"start":""}function Jt(t){return t==K?"down":t==Y?"up":t==q?"left":t==Z?"right":""}function te(t,e){var n=e.manager;return n?n.get(t):t}function ee(){Qt.apply(this,arguments)}function ne(){ee.apply(this,arguments),this.pX=null,this.pY=null}function ie(){ee.apply(this,arguments)}function re(){Qt.apply(this,arguments),this._timer=null,this._input=null}function oe(){ee.apply(this,arguments)}function se(){ee.apply(this,arguments)}function ae(){Qt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function le(t,e){return(e=e||{}).recognizers=P(e.recognizers,le.defaults.preset),new ce(t,e)}Qt.prototype={defaults:{},set:function(t){return l(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(m(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=te(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return m(t,"dropRecognizeWith",this)||(t=te(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(m(t,"requireFailure",this))return this;var e=this.requireFail;return-1===M(e,t=te(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(m(t,"dropRequireFailure",this))return this;t=te(t,this);var e=M(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function i(n){e.manager.emit(n,t)}n<qt&&i(e.options.event+$t(n)),i(e.options.event),t.additionalEvent&&i(t.additionalEvent),n>=qt&&i(e.options.event+$t(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=Kt},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(Kt|Ht)))return!1;t++}return!0},recognize:function(t){var e=l({},t);if(!S(this.options.enable,[this,e]))return this.reset(),void(this.state=Kt);this.state&(Zt|Yt|Kt)&&(this.state=Ht),this.state=this.process(e),this.state&(Gt|Xt|qt|Yt)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},w(ee,Qt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,i=e&(Gt|Xt),r=this.attrTest(t);return i&&(n&G||!r)?e|Yt:i||r?n&H?e|qt:e&Gt?e|Xt:Gt:Kt}}),w(ne,ee,{defaults:{event:"pan",threshold:10,pointers:1,direction:J},getTouchAction:function(){var t=this.options.direction,e=[];return t&Q&&e.push(Ut),t&$&&e.push(Bt),e},directionTest:function(t){var e=this.options,n=!0,i=t.distance,r=t.direction,o=t.deltaX,s=t.deltaY;return r&e.direction||(e.direction&Q?(r=0===o?X:o<0?q:Z,n=o!=this.pX,i=Math.abs(t.deltaX)):(r=0===s?X:s<0?Y:K,n=s!=this.pY,i=Math.abs(t.deltaY))),t.direction=r,n&&i>e.threshold&&r&e.direction},attrTest:function(t){return ee.prototype.attrTest.call(this,t)&&(this.state&Gt||!(this.state&Gt)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Jt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),w(ie,ee,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Dt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&Gt)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),w(re,Qt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[zt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime>e.time;if(this._input=t,!i||!n||t.eventType&(H|G)&&!r)this.reset();else if(t.eventType&V)this.reset(),this._timer=g((function(){this.state=Zt,this.tryEmit()}),e.time,this);else if(t.eventType&H)return Zt;return Kt},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===Zt&&(t&&t.eventType&H?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),w(oe,ee,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Dt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&Gt)}}),w(se,ee,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Q|$,pointers:1},getTouchAction:function(){return ne.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(Q|$)?e=t.overallVelocity:n&Q?e=t.overallVelocityX:n&$&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&f(e)>this.options.velocity&&t.eventType&H},emit:function(t){var e=Jt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),w(ae,Qt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Nt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime<e.time;if(this.reset(),t.eventType&V&&0===this.count)return this.failTimeout();if(i&&r&&n){if(t.eventType!=H)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||lt(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=g((function(){this.state=Zt,this.tryEmit()}),e.interval,this),Gt):Zt}return Kt},failTimeout:function(){return this._timer=g((function(){this.state=Kt}),this.options.interval,this),Kt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Zt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),le.VERSION="2.0.7",le.defaults={domEvents:!1,touchAction:Ft,enable:!0,inputTarget:null,inputClass:null,preset:[[oe,{enable:!1}],[ie,{enable:!1},["rotate"]],[se,{direction:Q}],[ne,{direction:Q},["swipe"]],[ae],[ae,{event:"doubletap",taps:2},["tap"]],[re]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function ce(t,e){var n;this.options=l({},le.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(z?yt:N?Ct:F?Mt:ft))(n,it),this.touchAction=new Wt(this,this.options.touchAction),ue(this,!0),v(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function ue(t,e){var n,i=t.element;i.style&&(v(t.options.cssProps,(function(r,o){n=R(i.style,o),e?(t.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}ce.prototype={set:function(t){return l(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var i=this.recognizers,r=e.curRecognizer;(!r||r&&r.state&Zt)&&(r=e.curRecognizer=null);for(var o=0;o<i.length;)n=i[o],2===e.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(t),!r&&n.state&(Gt|Xt|qt)&&(r=e.curRecognizer=n),o++}},get:function(t){if(t instanceof Qt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(m(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(m(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=M(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==a&&e!==a){var n=this.handlers;return v(k(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==a){var n=this.handlers;return v(k(t),(function(t){e?n[t]&&n[t].splice(M(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](e),i++}},destroy:function(){this.element&&ue(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(le,{INPUT_START:V,INPUT_MOVE:W,INPUT_END:H,INPUT_CANCEL:G,STATE_POSSIBLE:Ht,STATE_BEGAN:Gt,STATE_CHANGED:Xt,STATE_ENDED:qt,STATE_RECOGNIZED:Zt,STATE_CANCELLED:Yt,STATE_FAILED:Kt,DIRECTION_NONE:X,DIRECTION_LEFT:q,DIRECTION_RIGHT:Z,DIRECTION_UP:Y,DIRECTION_DOWN:K,DIRECTION_HORIZONTAL:Q,DIRECTION_VERTICAL:$,DIRECTION_ALL:J,Manager:ce,Input:nt,TouchAction:Wt,TouchInput:Ct,MouseInput:ft,PointerEventInput:yt,TouchMouseInput:Mt,SingleTouchInput:xt,Recognizer:Qt,AttrRecognizer:ee,Tap:ae,Pan:ne,Swipe:se,Pinch:ie,Rotate:oe,Press:re,on:E,off:C,each:v,merge:_,extend:b,assign:l,inherit:w,bindFn:x,prefixed:R}),("undefined"!==typeof r?r:"undefined"!==typeof self?self:{}).Hammer=le,(i=function(){return le}.call(e,n,e,t))===a||(t.exports=i)}(window,document)},463:(t,e,n)=>{"use strict";var i=n(791),r=n(296);function o(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(t,e){c(t,e),c(t+"Capture",e)}function c(t,e){for(a[t]=e,t=0;t<e.length;t++)s.add(e[t])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(t,e,n,i,r,o,s){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){m[t]=new g(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];m[e]=new g(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){m[t]=new g(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){m[t]=new g(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){m[t]=new g(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){m[t]=new g(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){m[t]=new g(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){m[t]=new g(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){m[t]=new g(t,5,!1,t.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(t){return t[1].toUpperCase()}function b(t,e,n,i){var r=m.hasOwnProperty(e)?m[e]:null;(null!==r?0!==r.type:i||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,n,i){if(null===e||"undefined"===typeof e||function(t,e,n,i){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,r,i)&&(n=null),i||null===r?function(t){return!!h.call(p,t)||!h.call(f,t)&&(d.test(t)?p[t]=!0:(f[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=null===n?3!==r.type&&"":n:(e=r.attributeName,i=r.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(v,y);m[e]=new g(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(v,y);m[e]=new g(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(v,y);m[e]=new g(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){m[t]=new g(t,1,!1,t.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){m[t]=new g(t,1,!1,t.toLowerCase(),null,!0,!0)}));var _=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),x=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),T=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var I=Symbol.iterator;function j(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=I&&t[I]||t["@@iterator"])?t:null}var F,z=Object.assign;function N(t){if(void 0===F)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);F=e&&e[1]||""}return"\n"+F+t}var D=!1;function B(t,e){if(!t||D)return"";D=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var i=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){i=c}t.call(e.prototype)}else{try{throw Error()}catch(c){i=c}t()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),o=i.stack.split("\n"),s=r.length-1,a=o.length-1;1<=s&&0<=a&&r[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(r[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||r[s]!==o[a]){var l="\n"+r[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=s&&0<=a);break}}}finally{D=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?N(t):""}function U(t){switch(t.tag){case 5:return N(t.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return t=B(t.type,!1);case 11:return t=B(t.type.render,!1);case 1:return t=B(t.type,!0);default:return""}}function V(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case S:return"Fragment";case x:return"Portal";case E:return"Profiler";case P:return"StrictMode";case k:return"Suspense";case M:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case T:return(t.displayName||"Context")+".Consumer";case C:return(t._context.displayName||"Context")+".Provider";case A:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case L:return null!==(e=t.displayName||null)?e:V(t.type)||"Memo";case O:e=t._payload,t=t._init;try{return V(t(e))}catch(n){}}return null}function W(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(e);case 8:return e===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function H(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function G(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function X(t){t._valueTracker||(t._valueTracker=function(t){var e=G(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(t){i=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(t){i=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function q(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=G(t)?t.checked?"true":"false":t.value),(t=i)!==n&&(e.setValue(t),!0)}function Z(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function Y(t,e){var n=e.checked;return z({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function K(t,e){var n=null==e.defaultValue?"":e.defaultValue,i=null!=e.checked?e.checked:e.defaultChecked;n=H(null!=e.value?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function Q(t,e){null!=(e=e.checked)&&b(t,"checked",e,!1)}function $(t,e){Q(t,e);var n=H(e.value),i=e.type;if(null!=n)"number"===i?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===i||"reset"===i)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&tt(t,e.type,H(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function J(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!("submit"!==i&&"reset"!==i||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function tt(t,e,n){"number"===e&&Z(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var et=Array.isArray;function nt(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+H(n),e=null,r=0;r<t.length;r++){if(t[r].value===n)return t[r].selected=!0,void(i&&(t[r].defaultSelected=!0));null!==e||t[r].disabled||(e=t[r])}null!==e&&(e.selected=!0)}}function it(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(o(91));return z({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function rt(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(o(92));if(et(n)){if(1<n.length)throw Error(o(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:H(n)}}function ot(t,e){var n=H(e.value),i=H(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=i&&(t.defaultValue=""+i)}function st(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function at(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?at(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ct,ut,ht=(ut=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ct=ct||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ct.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,i){MSApp.execUnsafeLocalFunction((function(){return ut(t,e)}))}:ut);function dt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var ft={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pt=["Webkit","ms","Moz","O"];function gt(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||ft.hasOwnProperty(t)&&ft[t]?(""+e).trim():e+"px"}function mt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=gt(n,e[n],i);"float"===n&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}Object.keys(ft).forEach((function(t){pt.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ft[e]=ft[t]}))}));var vt=z({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yt(t,e){if(e){if(vt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(o(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(o(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(o(62))}}function bt(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _t=null;function wt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var xt=null,St=null,Pt=null;function Et(t){if(t=br(t)){if("function"!==typeof xt)throw Error(o(280));var e=t.stateNode;e&&(e=wr(e),xt(t.stateNode,t.type,e))}}function Ct(t){St?Pt?Pt.push(t):Pt=[t]:St=t}function Tt(){if(St){var t=St,e=Pt;if(Pt=St=null,Et(t),e)for(t=0;t<e.length;t++)Et(e[t])}}function At(t,e){return t(e)}function kt(){}var Mt=!1;function Lt(t,e,n){if(Mt)return t(e,n);Mt=!0;try{return At(t,e,n)}finally{Mt=!1,(null!==St||null!==Pt)&&(kt(),Tt())}}function Ot(t,e){var n=t.stateNode;if(null===n)return null;var i=wr(n);if(null===i)return null;n=i[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!i;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(o(231,e,typeof n));return n}var Rt=!1;if(u)try{var It={};Object.defineProperty(It,"passive",{get:function(){Rt=!0}}),window.addEventListener("test",It,It),window.removeEventListener("test",It,It)}catch(ut){Rt=!1}function jt(t,e,n,i,r,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Ft=!1,zt=null,Nt=!1,Dt=null,Bt={onError:function(t){Ft=!0,zt=t}};function Ut(t,e,n,i,r,o,s,a,l){Ft=!1,zt=null,jt.apply(Bt,arguments)}function Vt(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Wt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function Ht(t){if(Vt(t)!==t)throw Error(o(188))}function Gt(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Vt(t)))throw Error(o(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(i=r.return)){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return Ht(r),t;if(s===i)return Ht(r),e;s=s.sibling}throw Error(o(188))}if(n.return!==i.return)n=r,i=s;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,i=s;break}if(l===i){a=!0,i=r,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,i=r;break}if(l===i){a=!0,i=s,n=r;break}l=l.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==i)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?t:e}(t))?Xt(t):null}function Xt(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=Xt(t);if(null!==e)return e;t=t.sibling}return null}var qt=r.unstable_scheduleCallback,Zt=r.unstable_cancelCallback,Yt=r.unstable_shouldYield,Kt=r.unstable_requestPaint,Qt=r.unstable_now,$t=r.unstable_getCurrentPriorityLevel,Jt=r.unstable_ImmediatePriority,te=r.unstable_UserBlockingPriority,ee=r.unstable_NormalPriority,ne=r.unstable_LowPriority,ie=r.unstable_IdlePriority,re=null,oe=null;var se=Math.clz32?Math.clz32:function(t){return t>>>=0,0===t?32:31-(ae(t)/le|0)|0},ae=Math.log,le=Math.LN2;var ce=64,ue=4194304;function he(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function de(t,e){var n=t.pendingLanes;if(0===n)return 0;var i=0,r=t.suspendedLanes,o=t.pingedLanes,s=268435455&n;if(0!==s){var a=s&~r;0!==a?i=he(a):0!==(o&=s)&&(i=he(o))}else 0!==(s=n&~r)?i=he(s):0!==o&&(i=he(o));if(0===i)return 0;if(0!==e&&e!==i&&0===(e&r)&&((r=i&-i)>=(o=e&-e)||16===r&&0!==(4194240&o)))return e;if(0!==(4&i)&&(i|=16&n),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=i;0<e;)r=1<<(n=31-se(e)),i|=t[n],e&=~r;return i}function fe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function pe(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function ge(){var t=ce;return 0===(4194240&(ce<<=1))&&(ce=64),t}function me(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ve(t,e,n){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-se(e)]=n}function ye(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-se(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var be=0;function _e(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var we,xe,Se,Pe,Ee,Ce=!1,Te=[],Ae=null,ke=null,Me=null,Le=new Map,Oe=new Map,Re=[],Ie="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function je(t,e){switch(t){case"focusin":case"focusout":Ae=null;break;case"dragenter":case"dragleave":ke=null;break;case"mouseover":case"mouseout":Me=null;break;case"pointerover":case"pointerout":Le.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oe.delete(e.pointerId)}}function Fe(t,e,n,i,r,o){return null===t||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},null!==e&&(null!==(e=br(e))&&xe(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,null!==r&&-1===e.indexOf(r)&&e.push(r),t)}function ze(t){var e=yr(t.target);if(null!==e){var n=Vt(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Wt(n)))return t.blockedOn=e,void Ee(t.priority,(function(){Se(n)}))}else if(3===e&&n.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Ne(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ye(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=br(n))&&xe(e),t.blockedOn=n,!1;var i=new(n=t.nativeEvent).constructor(n.type,n);_t=i,n.target.dispatchEvent(i),_t=null,e.shift()}return!0}function De(t,e,n){Ne(t)&&n.delete(e)}function Be(){Ce=!1,null!==Ae&&Ne(Ae)&&(Ae=null),null!==ke&&Ne(ke)&&(ke=null),null!==Me&&Ne(Me)&&(Me=null),Le.forEach(De),Oe.forEach(De)}function Ue(t,e){t.blockedOn===e&&(t.blockedOn=null,Ce||(Ce=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Be)))}function Ve(t){function e(e){return Ue(e,t)}if(0<Te.length){Ue(Te[0],t);for(var n=1;n<Te.length;n++){var i=Te[n];i.blockedOn===t&&(i.blockedOn=null)}}for(null!==Ae&&Ue(Ae,t),null!==ke&&Ue(ke,t),null!==Me&&Ue(Me,t),Le.forEach(e),Oe.forEach(e),n=0;n<Re.length;n++)(i=Re[n]).blockedOn===t&&(i.blockedOn=null);for(;0<Re.length&&null===(n=Re[0]).blockedOn;)ze(n),null===n.blockedOn&&Re.shift()}var We=_.ReactCurrentBatchConfig,He=!0;function Ge(t,e,n,i){var r=be,o=We.transition;We.transition=null;try{be=1,qe(t,e,n,i)}finally{be=r,We.transition=o}}function Xe(t,e,n,i){var r=be,o=We.transition;We.transition=null;try{be=4,qe(t,e,n,i)}finally{be=r,We.transition=o}}function qe(t,e,n,i){if(He){var r=Ye(t,e,n,i);if(null===r)Hi(t,e,i,Ze,n),je(t,i);else if(function(t,e,n,i,r){switch(e){case"focusin":return Ae=Fe(Ae,t,e,n,i,r),!0;case"dragenter":return ke=Fe(ke,t,e,n,i,r),!0;case"mouseover":return Me=Fe(Me,t,e,n,i,r),!0;case"pointerover":var o=r.pointerId;return Le.set(o,Fe(Le.get(o)||null,t,e,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,Oe.set(o,Fe(Oe.get(o)||null,t,e,n,i,r)),!0}return!1}(r,t,e,n,i))i.stopPropagation();else if(je(t,i),4&e&&-1<Ie.indexOf(t)){for(;null!==r;){var o=br(r);if(null!==o&&we(o),null===(o=Ye(t,e,n,i))&&Hi(t,e,i,Ze,n),o===r)break;r=o}null!==r&&i.stopPropagation()}else Hi(t,e,i,null,n)}}var Ze=null;function Ye(t,e,n,i){if(Ze=null,null!==(t=yr(t=wt(i))))if(null===(e=Vt(t)))t=null;else if(13===(n=e.tag)){if(null!==(t=Wt(e)))return t;t=null}else if(3===n){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ze=t,null}function Ke(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($t()){case Jt:return 1;case te:return 4;case ee:case ne:return 16;case ie:return 536870912;default:return 16}default:return 16}}var Qe=null,$e=null,Je=null;function tn(){if(Je)return Je;var t,e,n=$e,i=n.length,r="value"in Qe?Qe.value:Qe.textContent,o=r.length;for(t=0;t<i&&n[t]===r[t];t++);var s=i-t;for(e=1;e<=s&&n[i-e]===r[o-e];e++);return Je=r.slice(t,1<e?1-e:void 0)}function en(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function nn(){return!0}function rn(){return!1}function on(t){function e(e,n,i,r,o){for(var s in this._reactName=e,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null,t)t.hasOwnProperty(s)&&(e=t[s],this[s]=e?e(r):r[s]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return z(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),e}var sn,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(cn),hn=z({},cn,{view:0,detail:0}),dn=on(hn),fn=z({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ln&&(ln&&"mousemove"===t.type?(sn=t.screenX-ln.screenX,an=t.screenY-ln.screenY):an=sn=0,ln=t),sn)},movementY:function(t){return"movementY"in t?t.movementY:an}}),pn=on(fn),gn=on(z({},fn,{dataTransfer:0})),mn=on(z({},hn,{relatedTarget:0})),vn=on(z({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=z({},cn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),bn=on(yn),_n=on(z({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Sn[t])&&!!e[t]}function En(){return Pn}var Cn=z({},hn,{key:function(t){if(t.key){var e=wn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=en(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?xn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(t){return"keypress"===t.type?en(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?en(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Tn=on(Cn),An=on(z({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),kn=on(z({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),Mn=on(z({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ln=z({},fn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),On=on(Ln),Rn=[9,13,27,32],In=u&&"CompositionEvent"in window,jn=null;u&&"documentMode"in document&&(jn=document.documentMode);var Fn=u&&"TextEvent"in window&&!jn,zn=u&&(!In||jn&&8<jn&&11>=jn),Nn=String.fromCharCode(32),Dn=!1;function Bn(t,e){switch(t){case"keyup":return-1!==Rn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Vn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Wn[t.type]:"textarea"===e}function Gn(t,e,n,i){Ct(i),0<(e=Xi(e,"onChange")).length&&(n=new un("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Xn=null,qn=null;function Zn(t){Ni(t,0)}function Yn(t){if(q(_r(t)))return t}function Kn(t,e){if("change"===t)return e}var Qn=!1;if(u){var $n;if(u){var Jn="oninput"in document;if(!Jn){var ti=document.createElement("div");ti.setAttribute("oninput","return;"),Jn="function"===typeof ti.oninput}$n=Jn}else $n=!1;Qn=$n&&(!document.documentMode||9<document.documentMode)}function ei(){Xn&&(Xn.detachEvent("onpropertychange",ni),qn=Xn=null)}function ni(t){if("value"===t.propertyName&&Yn(qn)){var e=[];Gn(e,qn,t,wt(t)),Lt(Zn,e)}}function ii(t,e,n){"focusin"===t?(ei(),qn=n,(Xn=e).attachEvent("onpropertychange",ni)):"focusout"===t&&ei()}function ri(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Yn(qn)}function oi(t,e){if("click"===t)return Yn(e)}function si(t,e){if("input"===t||"change"===t)return Yn(e)}var ai="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function li(t,e){if(ai(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!h.call(e,r)||!ai(t[r],e[r]))return!1}return!0}function ci(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ui(t,e){var n,i=ci(t);for(t=0;i;){if(3===i.nodeType){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=ci(i)}}function hi(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?hi(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function di(){for(var t=window,e=Z();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(i){n=!1}if(!n)break;e=Z((t=e.contentWindow).document)}return e}function fi(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function pi(t){var e=di(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&fi(n))if(e=i.start,void 0===(t=i.end)&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if((t=(e=n.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var r=n.textContent.length,o=Math.min(i.start,r);i=void 0===i.end?o:Math.min(i.end,r),!t.extend&&o>i&&(r=i,i=o,o=r),r=ui(n,o);var s=ui(n,i);r&&s&&(1!==t.rangeCount||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&((e=e.createRange()).setStart(r.node,r.offset),t.removeAllRanges(),o>i?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<e.length;n++)(t=e[n]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var gi=u&&"documentMode"in document&&11>=document.documentMode,mi=null,vi=null,yi=null,bi=!1;function _i(t,e,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;bi||null==mi||mi!==Z(i)||("selectionStart"in(i=mi)&&fi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&li(yi,i)||(yi=i,0<(i=Xi(vi,"onSelect")).length&&(e=new un("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=mi)))}function wi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var xi={animationend:wi("Animation","AnimationEnd"),animationiteration:wi("Animation","AnimationIteration"),animationstart:wi("Animation","AnimationStart"),transitionend:wi("Transition","TransitionEnd")},Si={},Pi={};function Ei(t){if(Si[t])return Si[t];if(!xi[t])return t;var e,n=xi[t];for(e in n)if(n.hasOwnProperty(e)&&e in Pi)return Si[t]=n[e];return t}u&&(Pi=document.createElement("div").style,"AnimationEvent"in window||(delete xi.animationend.animation,delete xi.animationiteration.animation,delete xi.animationstart.animation),"TransitionEvent"in window||delete xi.transitionend.transition);var Ci=Ei("animationend"),Ti=Ei("animationiteration"),Ai=Ei("animationstart"),ki=Ei("transitionend"),Mi=new Map,Li="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oi(t,e){Mi.set(t,e),l(e,[t])}for(var Ri=0;Ri<Li.length;Ri++){var Ii=Li[Ri];Oi(Ii.toLowerCase(),"on"+(Ii[0].toUpperCase()+Ii.slice(1)))}Oi(Ci,"onAnimationEnd"),Oi(Ti,"onAnimationIteration"),Oi(Ai,"onAnimationStart"),Oi("dblclick","onDoubleClick"),Oi("focusin","onFocus"),Oi("focusout","onBlur"),Oi(ki,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ji="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fi=new Set("cancel close invalid load scroll toggle".split(" ").concat(ji));function zi(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,i,r,s,a,l,c){if(Ut.apply(this,arguments),Ft){if(!Ft)throw Error(o(198));var u=zt;Ft=!1,zt=null,Nt||(Nt=!0,Dt=u)}}(i,e,void 0,t),t.currentTarget=null}function Ni(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;t:{var o=void 0;if(e)for(var s=i.length-1;0<=s;s--){var a=i[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&r.isPropagationStopped())break t;zi(r,a,c),o=l}else for(s=0;s<i.length;s++){if(l=(a=i[s]).instance,c=a.currentTarget,a=a.listener,l!==o&&r.isPropagationStopped())break t;zi(r,a,c),o=l}}}if(Nt)throw t=Dt,Nt=!1,Dt=null,t}function Di(t,e){var n=e[gr];void 0===n&&(n=e[gr]=new Set);var i=t+"__bubble";n.has(i)||(Wi(e,t,2,!1),n.add(i))}function Bi(t,e,n){var i=0;e&&(i|=4),Wi(n,t,i,e)}var Ui="_reactListening"+Math.random().toString(36).slice(2);function Vi(t){if(!t[Ui]){t[Ui]=!0,s.forEach((function(e){"selectionchange"!==e&&(Fi.has(e)||Bi(e,!1,t),Bi(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[Ui]||(e[Ui]=!0,Bi("selectionchange",!1,e))}}function Wi(t,e,n,i){switch(Ke(e)){case 1:var r=Ge;break;case 4:r=Xe;break;default:r=qe}n=r.bind(null,e,n,t),r=void 0,!Rt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(r=!0),i?void 0!==r?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):void 0!==r?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Hi(t,e,n,i,r){var o=i;if(0===(1&e)&&0===(2&e)&&null!==i)t:for(;;){if(null===i)return;var s=i.tag;if(3===s||4===s){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===s)for(s=i.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;s=s.return}for(;null!==a;){if(null===(s=yr(a)))return;if(5===(l=s.tag)||6===l){i=o=s;continue t}a=a.parentNode}}i=i.return}Lt((function(){var i=o,r=wt(n),s=[];t:{var a=Mi.get(t);if(void 0!==a){var l=un,c=t;switch(t){case"keypress":if(0===en(n))break t;case"keydown":case"keyup":l=Tn;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=kn;break;case Ci:case Ti:case Ai:l=vn;break;case ki:l=Mn;break;case"scroll":l=dn;break;case"wheel":l=On;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=An}var u=0!==(4&e),h=!u&&"scroll"===t,d=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=i;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==d&&(null!=(g=Ot(p,d))&&u.push(Gi(p,g,f)))),h)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,r),s.push({event:a,listeners:u}))}}if(0===(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(a="mouseover"===t||"pointerover"===t)||n===_t||!(c=n.relatedTarget||n.fromElement)||!yr(c)&&!c[pr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?yr(c):null)&&(c!==(h=Vt(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=pn,g="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==t&&"pointerover"!==t||(u=An,g="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?a:_r(l),f=null==c?a:_r(c),(a=new u(g,p+"leave",l,n,r)).target=h,a.relatedTarget=f,g=null,yr(r)===i&&((u=new u(d,p+"enter",c,n,r)).target=f,u.relatedTarget=h,g=u),h=g,l&&c)t:{for(d=c,p=0,f=u=l;f;f=qi(f))p++;for(f=0,g=d;g;g=qi(g))f++;for(;0<p-f;)u=qi(u),p--;for(;0<f-p;)d=qi(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break t;u=qi(u),d=qi(d)}u=null}else u=null;null!==l&&Zi(s,a,l,u,!1),null!==c&&null!==h&&Zi(s,h,c,u,!0)}if("select"===(l=(a=i?_r(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Kn;else if(Hn(a))if(Qn)m=si;else{m=ri;var v=ii}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=oi);switch(m&&(m=m(t,i))?Gn(s,m,n,r):(v&&v(t,a,i),"focusout"===t&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&tt(a,"number",a.value)),v=i?_r(i):window,t){case"focusin":(Hn(v)||"true"===v.contentEditable)&&(mi=v,vi=i,yi=null);break;case"focusout":yi=vi=mi=null;break;case"mousedown":bi=!0;break;case"contextmenu":case"mouseup":case"dragend":bi=!1,_i(s,n,r);break;case"selectionchange":if(gi)break;case"keydown":case"keyup":_i(s,n,r)}var y;if(In)t:{switch(t){case"compositionstart":var b="onCompositionStart";break t;case"compositionend":b="onCompositionEnd";break t;case"compositionupdate":b="onCompositionUpdate";break t}b=void 0}else Vn?Bn(t,n)&&(b="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(b="onCompositionStart");b&&(zn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Vn&&(y=tn()):($e="value"in(Qe=r)?Qe.value:Qe.textContent,Vn=!0)),0<(v=Xi(i,b)).length&&(b=new _n(b,t,null,n,r),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=Un(n))&&(b.data=y))),(y=Fn?function(t,e){switch(t){case"compositionend":return Un(e);case"keypress":return 32!==e.which?null:(Dn=!0,Nn);case"textInput":return(t=e.data)===Nn&&Dn?null:t;default:return null}}(t,n):function(t,e){if(Vn)return"compositionend"===t||!In&&Bn(t,e)?(t=tn(),Je=$e=Qe=null,Vn=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return zn&&"ko"!==e.locale?null:e.data}}(t,n))&&(0<(i=Xi(i,"onBeforeInput")).length&&(r=new _n("onBeforeInput","beforeinput",null,n,r),s.push({event:r,listeners:i}),r.data=y))}Ni(s,e)}))}function Gi(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Xi(t,e){for(var n=e+"Capture",i=[];null!==t;){var r=t,o=r.stateNode;5===r.tag&&null!==o&&(r=o,null!=(o=Ot(t,n))&&i.unshift(Gi(t,o,r)),null!=(o=Ot(t,e))&&i.push(Gi(t,o,r))),t=t.return}return i}function qi(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Zi(t,e,n,i,r){for(var o=e._reactName,s=[];null!==n&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=Ot(n,o))&&s.unshift(Gi(n,l,a)):r||null!=(l=Ot(n,o))&&s.push(Gi(n,l,a))),n=n.return}0!==s.length&&t.push({event:e,listeners:s})}var Yi=/\r\n?/g,Ki=/\u0000|\uFFFD/g;function Qi(t){return("string"===typeof t?t:""+t).replace(Yi,"\n").replace(Ki,"")}function $i(t,e,n){if(e=Qi(e),Qi(t)!==e&&n)throw Error(o(425))}function Ji(){}var tr=null,er=null;function nr(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,or="function"===typeof Promise?Promise:void 0,sr="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof or?function(t){return or.resolve(null).then(t).catch(ar)}:ir;function ar(t){setTimeout((function(){throw t}))}function lr(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return t.removeChild(r),void Ve(e);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Ve(e)}function cr(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function ur(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var hr=Math.random().toString(36).slice(2),dr="__reactFiber$"+hr,fr="__reactProps$"+hr,pr="__reactContainer$"+hr,gr="__reactEvents$"+hr,mr="__reactListeners$"+hr,vr="__reactHandles$"+hr;function yr(t){var e=t[dr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[pr]||n[dr]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=ur(t);null!==t;){if(n=t[dr])return n;t=ur(t)}return e}n=(t=n).parentNode}return null}function br(t){return!(t=t[dr]||t[pr])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function _r(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(o(33))}function wr(t){return t[fr]||null}var xr=[],Sr=-1;function Pr(t){return{current:t}}function Er(t){0>Sr||(t.current=xr[Sr],xr[Sr]=null,Sr--)}function Cr(t,e){Sr++,xr[Sr]=t.current,t.current=e}var Tr={},Ar=Pr(Tr),kr=Pr(!1),Mr=Tr;function Lr(t,e){var n=t.type.contextTypes;if(!n)return Tr;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in n)o[r]=e[r];return i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function Or(t){return null!==(t=t.childContextTypes)&&void 0!==t}function Rr(){Er(kr),Er(Ar)}function Ir(t,e,n){if(Ar.current!==Tr)throw Error(o(168));Cr(Ar,e),Cr(kr,n)}function jr(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in e))throw Error(o(108,W(t)||"Unknown",r));return z({},n,i)}function Fr(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Tr,Mr=Ar.current,Cr(Ar,t),Cr(kr,kr.current),!0}function zr(t,e,n){var i=t.stateNode;if(!i)throw Error(o(169));n?(t=jr(t,e,Mr),i.__reactInternalMemoizedMergedChildContext=t,Er(kr),Er(Ar),Cr(Ar,t)):Er(kr),Cr(kr,n)}var Nr=null,Dr=!1,Br=!1;function Ur(t){null===Nr?Nr=[t]:Nr.push(t)}function Vr(){if(!Br&&null!==Nr){Br=!0;var t=0,e=be;try{var n=Nr;for(be=1;t<n.length;t++){var i=n[t];do{i=i(!0)}while(null!==i)}Nr=null,Dr=!1}catch(r){throw null!==Nr&&(Nr=Nr.slice(t+1)),qt(Jt,Vr),r}finally{be=e,Br=!1}}return null}var Wr=[],Hr=0,Gr=null,Xr=0,qr=[],Zr=0,Yr=null,Kr=1,Qr="";function $r(t,e){Wr[Hr++]=Xr,Wr[Hr++]=Gr,Gr=t,Xr=e}function Jr(t,e,n){qr[Zr++]=Kr,qr[Zr++]=Qr,qr[Zr++]=Yr,Yr=t;var i=Kr;t=Qr;var r=32-se(i)-1;i&=~(1<<r),n+=1;var o=32-se(e)+r;if(30<o){var s=r-r%5;o=(i&(1<<s)-1).toString(32),i>>=s,r-=s,Kr=1<<32-se(e)+r|n<<r|i,Qr=o+t}else Kr=1<<o|n<<r|i,Qr=t}function to(t){null!==t.return&&($r(t,1),Jr(t,1,0))}function eo(t){for(;t===Gr;)Gr=Wr[--Hr],Wr[Hr]=null,Xr=Wr[--Hr],Wr[Hr]=null;for(;t===Yr;)Yr=qr[--Zr],qr[Zr]=null,Qr=qr[--Zr],qr[Zr]=null,Kr=qr[--Zr],qr[Zr]=null}var no=null,io=null,ro=!1,oo=null;function so(t,e){var n=Lc(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,null===(e=t.deletions)?(t.deletions=[n],t.flags|=16):e.push(n)}function ao(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,no=t,io=cr(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,no=t,io=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(n=null!==Yr?{id:Kr,overflow:Qr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},(n=Lc(18,null,null,0)).stateNode=e,n.return=t,t.child=n,no=t,io=null,!0);default:return!1}}function lo(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function co(t){if(ro){var e=io;if(e){var n=e;if(!ao(t,e)){if(lo(t))throw Error(o(418));e=cr(n.nextSibling);var i=no;e&&ao(t,e)?so(i,n):(t.flags=-4097&t.flags|2,ro=!1,no=t)}}else{if(lo(t))throw Error(o(418));t.flags=-4097&t.flags|2,ro=!1,no=t}}}function uo(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;no=t}function ho(t){if(t!==no)return!1;if(!ro)return uo(t),ro=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!nr(t.type,t.memoizedProps)),e&&(e=io)){if(lo(t))throw fo(),Error(o(418));for(;e;)so(t,e),e=cr(e.nextSibling)}if(uo(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(o(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){io=cr(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}io=null}}else io=no?cr(t.stateNode.nextSibling):null;return!0}function fo(){for(var t=io;t;)t=cr(t.nextSibling)}function po(){io=no=null,ro=!1}function go(t){null===oo?oo=[t]:oo.push(t)}var mo=_.ReactCurrentBatchConfig;function vo(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var i=n.stateNode}if(!i)throw Error(o(147,t));var r=i,s=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===s?e.ref:(e=function(t){var e=r.refs;null===t?delete e[s]:e[s]=t},e._stringRef=s,e)}if("string"!==typeof t)throw Error(o(284));if(!n._owner)throw Error(o(290,t))}return t}function yo(t,e){throw t=Object.prototype.toString.call(e),Error(o(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function bo(t){return(0,t._init)(t._payload)}function _o(t){function e(e,n){if(t){var i=e.deletions;null===i?(e.deletions=[n],e.flags|=16):i.push(n)}}function n(n,i){if(!t)return null;for(;null!==i;)e(n,i),i=i.sibling;return null}function i(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(t,e){return(t=Rc(t,e)).index=0,t.sibling=null,t}function s(e,n,i){return e.index=i,t?null!==(i=e.alternate)?(i=i.index)<n?(e.flags|=2,n):i:(e.flags|=2,n):(e.flags|=1048576,n)}function a(e){return t&&null===e.alternate&&(e.flags|=2),e}function l(t,e,n,i){return null===e||6!==e.tag?((e=zc(n,t.mode,i)).return=t,e):((e=r(e,n)).return=t,e)}function c(t,e,n,i){var o=n.type;return o===S?h(t,e,n.props.children,i,n.key):null!==e&&(e.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===O&&bo(o)===e.type)?((i=r(e,n.props)).ref=vo(t,e,n),i.return=t,i):((i=Ic(n.type,n.key,n.props,null,t.mode,i)).ref=vo(t,e,n),i.return=t,i)}function u(t,e,n,i){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Nc(n,t.mode,i)).return=t,e):((e=r(e,n.children||[])).return=t,e)}function h(t,e,n,i,o){return null===e||7!==e.tag?((e=jc(n,t.mode,i,o)).return=t,e):((e=r(e,n)).return=t,e)}function d(t,e,n){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=zc(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case w:return(n=Ic(e.type,e.key,e.props,null,t.mode,n)).ref=vo(t,null,e),n.return=t,n;case x:return(e=Nc(e,t.mode,n)).return=t,e;case O:return d(t,(0,e._init)(e._payload),n)}if(et(e)||j(e))return(e=jc(e,t.mode,n,null)).return=t,e;yo(t,e)}return null}function f(t,e,n,i){var r=null!==e?e.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(t,e,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===r?c(t,e,n,i):null;case x:return n.key===r?u(t,e,n,i):null;case O:return f(t,e,(r=n._init)(n._payload),i)}if(et(n)||j(n))return null!==r?null:h(t,e,n,i,null);yo(t,n)}return null}function p(t,e,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(e,t=t.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case w:return c(e,t=t.get(null===i.key?n:i.key)||null,i,r);case x:return u(e,t=t.get(null===i.key?n:i.key)||null,i,r);case O:return p(t,e,n,(0,i._init)(i._payload),r)}if(et(i)||j(i))return h(e,t=t.get(n)||null,i,r,null);yo(e,i)}return null}function g(r,o,a,l){for(var c=null,u=null,h=o,g=o=0,m=null;null!==h&&g<a.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var v=f(r,h,a[g],l);if(null===v){null===h&&(h=m);break}t&&h&&null===v.alternate&&e(r,h),o=s(v,o,g),null===u?c=v:u.sibling=v,u=v,h=m}if(g===a.length)return n(r,h),ro&&$r(r,g),c;if(null===h){for(;g<a.length;g++)null!==(h=d(r,a[g],l))&&(o=s(h,o,g),null===u?c=h:u.sibling=h,u=h);return ro&&$r(r,g),c}for(h=i(r,h);g<a.length;g++)null!==(m=p(h,r,g,a[g],l))&&(t&&null!==m.alternate&&h.delete(null===m.key?g:m.key),o=s(m,o,g),null===u?c=m:u.sibling=m,u=m);return t&&h.forEach((function(t){return e(r,t)})),ro&&$r(r,g),c}function m(r,a,l,c){var u=j(l);if("function"!==typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var h=u=null,g=a,m=a=0,v=null,y=l.next();null!==g&&!y.done;m++,y=l.next()){g.index>m?(v=g,g=null):v=g.sibling;var b=f(r,g,y.value,c);if(null===b){null===g&&(g=v);break}t&&g&&null===b.alternate&&e(r,g),a=s(b,a,m),null===h?u=b:h.sibling=b,h=b,g=v}if(y.done)return n(r,g),ro&&$r(r,m),u;if(null===g){for(;!y.done;m++,y=l.next())null!==(y=d(r,y.value,c))&&(a=s(y,a,m),null===h?u=y:h.sibling=y,h=y);return ro&&$r(r,m),u}for(g=i(r,g);!y.done;m++,y=l.next())null!==(y=p(g,r,m,y.value,c))&&(t&&null!==y.alternate&&g.delete(null===y.key?m:y.key),a=s(y,a,m),null===h?u=y:h.sibling=y,h=y);return t&&g.forEach((function(t){return e(r,t)})),ro&&$r(r,m),u}return function t(i,o,s,l){if("object"===typeof s&&null!==s&&s.type===S&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case w:t:{for(var c=s.key,u=o;null!==u;){if(u.key===c){if((c=s.type)===S){if(7===u.tag){n(i,u.sibling),(o=r(u,s.props.children)).return=i,i=o;break t}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===O&&bo(c)===u.type){n(i,u.sibling),(o=r(u,s.props)).ref=vo(i,u,s),o.return=i,i=o;break t}n(i,u);break}e(i,u),u=u.sibling}s.type===S?((o=jc(s.props.children,i.mode,l,s.key)).return=i,i=o):((l=Ic(s.type,s.key,s.props,null,i.mode,l)).ref=vo(i,o,s),l.return=i,i=l)}return a(i);case x:t:{for(u=s.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===s.containerInfo&&o.stateNode.implementation===s.implementation){n(i,o.sibling),(o=r(o,s.children||[])).return=i,i=o;break t}n(i,o);break}e(i,o),o=o.sibling}(o=Nc(s,i.mode,l)).return=i,i=o}return a(i);case O:return t(i,o,(u=s._init)(s._payload),l)}if(et(s))return g(i,o,s,l);if(j(s))return m(i,o,s,l);yo(i,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==o&&6===o.tag?(n(i,o.sibling),(o=r(o,s)).return=i,i=o):(n(i,o),(o=zc(s,i.mode,l)).return=i,i=o),a(i)):n(i,o)}}var wo=_o(!0),xo=_o(!1),So=Pr(null),Po=null,Eo=null,Co=null;function To(){Co=Eo=Po=null}function Ao(t){var e=So.current;Er(So),t._currentValue=e}function ko(t,e,n){for(;null!==t;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==i&&(i.childLanes|=e)):null!==i&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function Mo(t,e){Po=t,Co=Eo=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(ba=!0),t.firstContext=null)}function Lo(t){var e=t._currentValue;if(Co!==t)if(t={context:t,memoizedValue:e,next:null},null===Eo){if(null===Po)throw Error(o(308));Eo=t,Po.dependencies={lanes:0,firstContext:t}}else Eo=Eo.next=t;return e}var Oo=null;function Ro(t){null===Oo?Oo=[t]:Oo.push(t)}function Io(t,e,n,i){var r=e.interleaved;return null===r?(n.next=n,Ro(e)):(n.next=r.next,r.next=n),e.interleaved=n,jo(t,i)}function jo(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}var Fo=!1;function zo(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function No(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Do(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Bo(t,e,n){var i=t.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Al)){var r=i.pending;return null===r?e.next=e:(e.next=r.next,r.next=e),i.pending=e,jo(t,n)}return null===(r=i.interleaved)?(e.next=e,Ro(i)):(e.next=r.next,r.next=e),i.interleaved=e,jo(t,n)}function Uo(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&n))){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,ye(t,n)}}function Vo(t,e){var n=t.updateQueue,i=t.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?r=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?r=o=e:o=o.next=e}else r=o=e;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Wo(t,e,n,i){var r=t.updateQueue;Fo=!1;var o=r.firstBaseUpdate,s=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=t.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==o){var h=r.baseState;for(s=0,u=c=l=null,a=o;;){var d=a.lane,f=a.eventTime;if((i&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});t:{var p=t,g=a;switch(d=e,f=n,g.tag){case 1:if("function"===typeof(p=g.payload)){h=p.call(f,h,d);break t}h=p;break t;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=g.payload)?p.call(f,h,d):p)||void 0===d)break t;h=z({},h,d);break t;case 2:Fo=!0}}null!==a.callback&&0!==a.lane&&(t.flags|=64,null===(d=r.effects)?r.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,s|=d;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(d=a).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(e=r.shared.interleaved)){r=e;do{s|=r.lane,r=r.next}while(r!==e)}else null===o&&(r.shared.lanes=0);Fl|=s,t.lanes=s,t.memoizedState=h}}function Ho(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(o(191,r));r.call(i)}}}var Go={},Xo=Pr(Go),qo=Pr(Go),Zo=Pr(Go);function Yo(t){if(t===Go)throw Error(o(174));return t}function Ko(t,e){switch(Cr(Zo,e),Cr(qo,t),Cr(Xo,Go),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lt(null,"");break;default:e=lt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Er(Xo),Cr(Xo,e)}function Qo(){Er(Xo),Er(qo),Er(Zo)}function $o(t){Yo(Zo.current);var e=Yo(Xo.current),n=lt(e,t.type);e!==n&&(Cr(qo,t),Cr(Xo,n))}function Jo(t){qo.current===t&&(Er(Xo),Er(qo))}var ts=Pr(0);function es(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ns=[];function is(){for(var t=0;t<ns.length;t++)ns[t]._workInProgressVersionPrimary=null;ns.length=0}var rs=_.ReactCurrentDispatcher,os=_.ReactCurrentBatchConfig,ss=0,as=null,ls=null,cs=null,us=!1,hs=!1,ds=0,fs=0;function ps(){throw Error(o(321))}function gs(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ai(t[n],e[n]))return!1;return!0}function ms(t,e,n,i,r,s){if(ss=s,as=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,rs.current=null===t||null===t.memoizedState?Js:ta,t=n(i,r),hs){s=0;do{if(hs=!1,ds=0,25<=s)throw Error(o(301));s+=1,cs=ls=null,e.updateQueue=null,rs.current=ea,t=n(i,r)}while(hs)}if(rs.current=$s,e=null!==ls&&null!==ls.next,ss=0,cs=ls=as=null,us=!1,e)throw Error(o(300));return t}function vs(){var t=0!==ds;return ds=0,t}function ys(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===cs?as.memoizedState=cs=t:cs=cs.next=t,cs}function bs(){if(null===ls){var t=as.alternate;t=null!==t?t.memoizedState:null}else t=ls.next;var e=null===cs?as.memoizedState:cs.next;if(null!==e)cs=e,ls=t;else{if(null===t)throw Error(o(310));t={memoizedState:(ls=t).memoizedState,baseState:ls.baseState,baseQueue:ls.baseQueue,queue:ls.queue,next:null},null===cs?as.memoizedState=cs=t:cs=cs.next=t}return cs}function _s(t,e){return"function"===typeof e?e(t):e}function ws(t){var e=bs(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var i=ls,r=i.baseQueue,s=n.pending;if(null!==s){if(null!==r){var a=r.next;r.next=s.next,s.next=a}i.baseQueue=r=s,n.pending=null}if(null!==r){s=r.next,i=i.baseState;var l=a=null,c=null,u=s;do{var h=u.lane;if((ss&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:t(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=i):c=c.next=d,as.lanes|=h,Fl|=h}u=u.next}while(null!==u&&u!==s);null===c?a=i:c.next=l,ai(i,e.memoizedState)||(ba=!0),e.memoizedState=i,e.baseState=a,e.baseQueue=c,n.lastRenderedState=i}if(null!==(t=n.interleaved)){r=t;do{s=r.lane,as.lanes|=s,Fl|=s,r=r.next}while(r!==t)}else null===r&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function xs(t){var e=bs(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{s=t(s,a.action),a=a.next}while(a!==r);ai(s,e.memoizedState)||(ba=!0),e.memoizedState=s,null===e.baseQueue&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function Ss(){}function Ps(t,e){var n=as,i=bs(),r=e(),s=!ai(i.memoizedState,r);if(s&&(i.memoizedState=r,ba=!0),i=i.queue,Fs(Ts.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||null!==cs&&1&cs.memoizedState.tag){if(n.flags|=2048,Ls(9,Cs.bind(null,n,i,r,e),void 0,null),null===kl)throw Error(o(349));0!==(30&ss)||Es(n,e,r)}return r}function Es(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=as.updateQueue)?(e={lastEffect:null,stores:null},as.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function Cs(t,e,n,i){e.value=n,e.getSnapshot=i,As(e)&&ks(t)}function Ts(t,e,n){return n((function(){As(e)&&ks(t)}))}function As(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ai(t,n)}catch(i){return!0}}function ks(t){var e=jo(t,1);null!==e&&nc(e,t,1,-1)}function Ms(t){var e=ys();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_s,lastRenderedState:t},e.queue=t,t=t.dispatch=Zs.bind(null,as,t),[e.memoizedState,t]}function Ls(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},null===(e=as.updateQueue)?(e={lastEffect:null,stores:null},as.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function Os(){return bs().memoizedState}function Rs(t,e,n,i){var r=ys();as.flags|=t,r.memoizedState=Ls(1|e,n,void 0,void 0===i?null:i)}function Is(t,e,n,i){var r=bs();i=void 0===i?null:i;var o=void 0;if(null!==ls){var s=ls.memoizedState;if(o=s.destroy,null!==i&&gs(i,s.deps))return void(r.memoizedState=Ls(e,n,o,i))}as.flags|=t,r.memoizedState=Ls(1|e,n,o,i)}function js(t,e){return Rs(8390656,8,t,e)}function Fs(t,e){return Is(2048,8,t,e)}function zs(t,e){return Is(4,2,t,e)}function Ns(t,e){return Is(4,4,t,e)}function Ds(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Bs(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Is(4,4,Ds.bind(null,e,t),n)}function Us(){}function Vs(t,e){var n=bs();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&gs(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function Ws(t,e){var n=bs();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&gs(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function Hs(t,e,n){return 0===(21&ss)?(t.baseState&&(t.baseState=!1,ba=!0),t.memoizedState=n):(ai(n,e)||(n=ge(),as.lanes|=n,Fl|=n,t.baseState=!0),e)}function Gs(t,e){var n=be;be=0!==n&&4>n?n:4,t(!0);var i=os.transition;os.transition={};try{t(!1),e()}finally{be=n,os.transition=i}}function Xs(){return bs().memoizedState}function qs(t,e,n){var i=ec(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Ys(t))Ks(e,n);else if(null!==(n=Io(t,e,n,i))){nc(n,t,i,tc()),Qs(n,e,i)}}function Zs(t,e,n){var i=ec(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ys(t))Ks(e,r);else{var o=t.alternate;if(0===t.lanes&&(null===o||0===o.lanes)&&null!==(o=e.lastRenderedReducer))try{var s=e.lastRenderedState,a=o(s,n);if(r.hasEagerState=!0,r.eagerState=a,ai(a,s)){var l=e.interleaved;return null===l?(r.next=r,Ro(e)):(r.next=l.next,l.next=r),void(e.interleaved=r)}}catch(c){}null!==(n=Io(t,e,r,i))&&(nc(n,t,i,r=tc()),Qs(n,e,i))}}function Ys(t){var e=t.alternate;return t===as||null!==e&&e===as}function Ks(t,e){hs=us=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Qs(t,e,n){if(0!==(4194240&n)){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,ye(t,n)}}var $s={readContext:Lo,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useInsertionEffect:ps,useLayoutEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useMutableSource:ps,useSyncExternalStore:ps,useId:ps,unstable_isNewReconciler:!1},Js={readContext:Lo,useCallback:function(t,e){return ys().memoizedState=[t,void 0===e?null:e],t},useContext:Lo,useEffect:js,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Rs(4194308,4,Ds.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Rs(4194308,4,t,e)},useInsertionEffect:function(t,e){return Rs(4,2,t,e)},useMemo:function(t,e){var n=ys();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=ys();return e=void 0!==n?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=qs.bind(null,as,t),[i.memoizedState,t]},useRef:function(t){return t={current:t},ys().memoizedState=t},useState:Ms,useDebugValue:Us,useDeferredValue:function(t){return ys().memoizedState=t},useTransition:function(){var t=Ms(!1),e=t[0];return t=Gs.bind(null,t[1]),ys().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=as,r=ys();if(ro){if(void 0===n)throw Error(o(407));n=n()}else{if(n=e(),null===kl)throw Error(o(349));0!==(30&ss)||Es(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,js(Ts.bind(null,i,s,t),[t]),i.flags|=2048,Ls(9,Cs.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=ys(),e=kl.identifierPrefix;if(ro){var n=Qr;e=":"+e+"R"+(n=(Kr&~(1<<32-se(Kr)-1)).toString(32)+n),0<(n=ds++)&&(e+="H"+n.toString(32)),e+=":"}else e=":"+e+"r"+(n=fs++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ta={readContext:Lo,useCallback:Vs,useContext:Lo,useEffect:Fs,useImperativeHandle:Bs,useInsertionEffect:zs,useLayoutEffect:Ns,useMemo:Ws,useReducer:ws,useRef:Os,useState:function(){return ws(_s)},useDebugValue:Us,useDeferredValue:function(t){return Hs(bs(),ls.memoizedState,t)},useTransition:function(){return[ws(_s)[0],bs().memoizedState]},useMutableSource:Ss,useSyncExternalStore:Ps,useId:Xs,unstable_isNewReconciler:!1},ea={readContext:Lo,useCallback:Vs,useContext:Lo,useEffect:Fs,useImperativeHandle:Bs,useInsertionEffect:zs,useLayoutEffect:Ns,useMemo:Ws,useReducer:xs,useRef:Os,useState:function(){return xs(_s)},useDebugValue:Us,useDeferredValue:function(t){var e=bs();return null===ls?e.memoizedState=t:Hs(e,ls.memoizedState,t)},useTransition:function(){return[xs(_s)[0],bs().memoizedState]},useMutableSource:Ss,useSyncExternalStore:Ps,useId:Xs,unstable_isNewReconciler:!1};function na(t,e){if(t&&t.defaultProps){for(var n in e=z({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}function ia(t,e,n,i){n=null===(n=n(i,e=t.memoizedState))||void 0===n?e:z({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var ra={isMounted:function(t){return!!(t=t._reactInternals)&&Vt(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=tc(),r=ec(t),o=Do(i,r);o.payload=e,void 0!==n&&null!==n&&(o.callback=n),null!==(e=Bo(t,o,r))&&(nc(e,t,r,i),Uo(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=tc(),r=ec(t),o=Do(i,r);o.tag=1,o.payload=e,void 0!==n&&null!==n&&(o.callback=n),null!==(e=Bo(t,o,r))&&(nc(e,t,r,i),Uo(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=tc(),i=ec(t),r=Do(n,i);r.tag=2,void 0!==e&&null!==e&&(r.callback=e),null!==(e=Bo(t,r,i))&&(nc(e,t,i,n),Uo(e,t,i))}};function oa(t,e,n,i,r,o,s){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(i,o,s):!e.prototype||!e.prototype.isPureReactComponent||(!li(n,i)||!li(r,o))}function sa(t,e,n){var i=!1,r=Tr,o=e.contextType;return"object"===typeof o&&null!==o?o=Lo(o):(r=Or(e)?Mr:Ar.current,o=(i=null!==(i=e.contextTypes)&&void 0!==i)?Lr(t,r):Tr),e=new e(n,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=ra,t.stateNode=e,e._reactInternals=t,i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=o),e}function aa(t,e,n,i){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,i),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&ra.enqueueReplaceState(e,e.state,null)}function la(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},zo(t);var o=e.contextType;"object"===typeof o&&null!==o?r.context=Lo(o):(o=Or(e)?Mr:Ar.current,r.context=Lr(t,o)),r.state=t.memoizedState,"function"===typeof(o=e.getDerivedStateFromProps)&&(ia(t,e,o,n),r.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(e=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),e!==r.state&&ra.enqueueReplaceState(r,r.state,null),Wo(t,n,r,i),r.state=t.memoizedState),"function"===typeof r.componentDidMount&&(t.flags|=4194308)}function ca(t,e){try{var n="",i=e;do{n+=U(i),i=i.return}while(i);var r=n}catch(o){r="\nError generating stack: "+o.message+"\n"+o.stack}return{value:t,source:e,stack:r,digest:null}}function ua(t,e,n){return{value:t,source:null,stack:null!=n?n:null,digest:null!=e?e:null}}function ha(t,e){try{console.error(e.value)}catch(n){setTimeout((function(){throw n}))}}var da="function"===typeof WeakMap?WeakMap:Map;function fa(t,e,n){(n=Do(-1,n)).tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Hl||(Hl=!0,Gl=i),ha(0,e)},n}function pa(t,e,n){(n=Do(-1,n)).tag=3;var i=t.type.getDerivedStateFromError;if("function"===typeof i){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){ha(0,e)}}var o=t.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){ha(0,e),"function"!==typeof i&&(null===Xl?Xl=new Set([this]):Xl.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}function ga(t,e,n){var i=t.pingCache;if(null===i){i=t.pingCache=new da;var r=new Set;i.set(e,r)}else void 0===(r=i.get(e))&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=Ec.bind(null,t,e,n),e.then(t,t))}function ma(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function va(t,e,n,i,r){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((e=Do(-1,1)).tag=2,Bo(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=r,t)}var ya=_.ReactCurrentOwner,ba=!1;function _a(t,e,n,i){e.child=null===t?xo(e,null,n,i):wo(e,t.child,n,i)}function wa(t,e,n,i,r){n=n.render;var o=e.ref;return Mo(e,r),i=ms(t,e,n,i,o,r),n=vs(),null===t||ba?(ro&&n&&to(e),e.flags|=1,_a(t,e,i,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ha(t,e,r))}function xa(t,e,n,i,r){if(null===t){var o=n.type;return"function"!==typeof o||Oc(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Ic(n.type,null,i,e,e.mode,r)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=o,Sa(t,e,o,i,r))}if(o=t.child,0===(t.lanes&r)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:li)(s,i)&&t.ref===e.ref)return Ha(t,e,r)}return e.flags|=1,(t=Rc(o,i)).ref=e.ref,t.return=e,e.child=t}function Sa(t,e,n,i,r){if(null!==t){var o=t.memoizedProps;if(li(o,i)&&t.ref===e.ref){if(ba=!1,e.pendingProps=i=o,0===(t.lanes&r))return e.lanes=t.lanes,Ha(t,e,r);0!==(131072&t.flags)&&(ba=!0)}}return Ca(t,e,n,i,r)}function Pa(t,e,n){var i=e.pendingProps,r=i.children,o=null!==t?t.memoizedState:null;if("hidden"===i.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cr(Rl,Ol),Ol|=n;else{if(0===(1073741824&n))return t=null!==o?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Cr(Rl,Ol),Ol|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==o?o.baseLanes:n,Cr(Rl,Ol),Ol|=i}else null!==o?(i=o.baseLanes|n,e.memoizedState=null):i=n,Cr(Rl,Ol),Ol|=i;return _a(t,e,r,n),e.child}function Ea(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ca(t,e,n,i,r){var o=Or(n)?Mr:Ar.current;return o=Lr(e,o),Mo(e,r),n=ms(t,e,n,i,o,r),i=vs(),null===t||ba?(ro&&i&&to(e),e.flags|=1,_a(t,e,n,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ha(t,e,r))}function Ta(t,e,n,i,r){if(Or(n)){var o=!0;Fr(e)}else o=!1;if(Mo(e,r),null===e.stateNode)Wa(t,e),sa(e,n,i),la(e,n,i,r),i=!0;else if(null===t){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=Lo(c):c=Lr(e,c=Or(n)?Mr:Ar.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;h||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==i||l!==c)&&aa(e,s,i,c),Fo=!1;var d=e.memoizedState;s.state=d,Wo(e,i,s,r),l=e.memoizedState,a!==i||d!==l||kr.current||Fo?("function"===typeof u&&(ia(e,n,u,i),l=e.memoizedState),(a=Fo||oa(e,n,a,i,d,l,c))?(h||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(e.flags|=4194308)):("function"===typeof s.componentDidMount&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),s.props=i,s.state=l,s.context=c,i=a):("function"===typeof s.componentDidMount&&(e.flags|=4194308),i=!1)}else{s=e.stateNode,No(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:na(e.type,a),s.props=c,h=e.pendingProps,d=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=Lo(l):l=Lr(e,l=Or(n)?Mr:Ar.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==h||d!==l)&&aa(e,s,i,l),Fo=!1,d=e.memoizedState,s.state=d,Wo(e,i,s,r);var p=e.memoizedState;a!==h||d!==p||kr.current||Fo?("function"===typeof f&&(ia(e,n,f,i),p=e.memoizedState),(c=Fo||oa(e,n,c,i,d,p,l)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(i,p,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(i,p,l)),"function"===typeof s.componentDidUpdate&&(e.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof s.componentDidUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=p),s.props=i,s.state=p,s.context=l,i=c):("function"!==typeof s.componentDidUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),i=!1)}return Aa(t,e,n,i,o,r)}function Aa(t,e,n,i,r,o){Ea(t,e);var s=0!==(128&e.flags);if(!i&&!s)return r&&zr(e,n,!1),Ha(t,e,o);i=e.stateNode,ya.current=e;var a=s&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return e.flags|=1,null!==t&&s?(e.child=wo(e,t.child,null,o),e.child=wo(e,null,a,o)):_a(t,e,a,o),e.memoizedState=i.state,r&&zr(e,n,!0),e.child}function ka(t){var e=t.stateNode;e.pendingContext?Ir(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Ir(0,e.context,!1),Ko(t,e.containerInfo)}function Ma(t,e,n,i,r){return po(),go(r),e.flags|=256,_a(t,e,n,i),e.child}var La,Oa,Ra,Ia,ja={dehydrated:null,treeContext:null,retryLane:0};function Fa(t){return{baseLanes:t,cachePool:null,transitions:null}}function za(t,e,n){var i,r=e.pendingProps,s=ts.current,a=!1,l=0!==(128&e.flags);if((i=l)||(i=(null===t||null!==t.memoizedState)&&0!==(2&s)),i?(a=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(s|=1),Cr(ts,1&s),null===t)return co(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(l=r.children,t=r.fallback,a?(r=e.mode,a=e.child,l={mode:"hidden",children:l},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Fc(l,r,0,null),t=jc(t,r,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Fa(n),e.memoizedState=ja,t):Na(e,l));if(null!==(s=t.memoizedState)&&null!==(i=s.dehydrated))return function(t,e,n,i,r,s,a){if(n)return 256&e.flags?(e.flags&=-257,Da(t,e,a,i=ua(Error(o(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=Fc({mode:"visible",children:i.children},r,0,null),(s=jc(s,r,a,null)).flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,0!==(1&e.mode)&&wo(e,t.child,null,a),e.child.memoizedState=Fa(a),e.memoizedState=ja,s);if(0===(1&e.mode))return Da(t,e,a,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Da(t,e,a,i=ua(s=Error(o(419)),i,void 0))}if(l=0!==(a&t.childLanes),ba||l){if(null!==(i=kl)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|a))?0:r)&&r!==s.retryLane&&(s.retryLane=r,jo(t,r),nc(i,t,r,-1))}return gc(),Da(t,e,a,i=ua(Error(o(421))))}return"$?"===r.data?(e.flags|=128,e.child=t.child,e=Tc.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,io=cr(r.nextSibling),no=e,ro=!0,oo=null,null!==t&&(qr[Zr++]=Kr,qr[Zr++]=Qr,qr[Zr++]=Yr,Kr=t.id,Qr=t.overflow,Yr=e),e=Na(e,i.children),e.flags|=4096,e)}(t,e,l,r,i,s,n);if(a){a=r.fallback,l=e.mode,i=(s=t.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&e.child!==s?((r=e.child).childLanes=0,r.pendingProps=c,e.deletions=null):(r=Rc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==i?a=Rc(i,a):(a=jc(a,l,n,null)).flags|=2,a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,l=null===(l=t.child.memoizedState)?Fa(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=t.childLanes&~n,e.memoizedState=ja,r}return t=(a=t.child).sibling,r=Rc(a,{mode:"visible",children:r.children}),0===(1&e.mode)&&(r.lanes=n),r.return=e,r.sibling=null,null!==t&&(null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Na(t,e){return(e=Fc({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Da(t,e,n,i){return null!==i&&go(i),wo(e,t.child,null,n),(t=Na(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function Ba(t,e,n){t.lanes|=e;var i=t.alternate;null!==i&&(i.lanes|=e),ko(t.return,e,n)}function Ua(t,e,n,i,r){var o=t.memoizedState;null===o?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=r)}function Va(t,e,n){var i=e.pendingProps,r=i.revealOrder,o=i.tail;if(_a(t,e,i.children,n),0!==(2&(i=ts.current)))i=1&i|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Ba(t,n,e);else if(19===t.tag)Ba(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Cr(ts,i),0===(1&e.mode))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;null!==n;)null!==(t=n.alternate)&&null===es(t)&&(r=n),n=n.sibling;null===(n=r)?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Ua(e,!1,r,n,o);break;case"backwards":for(n=null,r=e.child,e.child=null;null!==r;){if(null!==(t=r.alternate)&&null===es(t)){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Ua(e,!0,n,null,o);break;case"together":Ua(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Wa(t,e){0===(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ha(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Fl|=e.lanes,0===(n&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(o(153));if(null!==e.child){for(n=Rc(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Rc(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function Ga(t,e){if(!ro)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?e||null===t.tail?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Xa(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=t,r=r.sibling;else for(r=t.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function qa(t,e,n){var i=e.pendingProps;switch(eo(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xa(e),null;case 1:case 17:return Or(e.type)&&Rr(),Xa(e),null;case 3:return i=e.stateNode,Qo(),Er(kr),Er(Ar),is(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==t&&null!==t.child||(ho(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==oo&&(sc(oo),oo=null))),Oa(t,e),Xa(e),null;case 5:Jo(e);var r=Yo(Zo.current);if(n=e.type,null!==t&&null!=e.stateNode)Ra(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(null===e.stateNode)throw Error(o(166));return Xa(e),null}if(t=Yo(Xo.current),ho(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[dr]=e,i[fr]=s,t=0!==(1&e.mode),n){case"dialog":Di("cancel",i),Di("close",i);break;case"iframe":case"object":case"embed":Di("load",i);break;case"video":case"audio":for(r=0;r<ji.length;r++)Di(ji[r],i);break;case"source":Di("error",i);break;case"img":case"image":case"link":Di("error",i),Di("load",i);break;case"details":Di("toggle",i);break;case"input":K(i,s),Di("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Di("invalid",i);break;case"textarea":rt(i,s),Di("invalid",i)}for(var l in yt(n,s),r=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==s.suppressHydrationWarning&&$i(i.textContent,c,t),r=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&$i(i.textContent,c,t),r=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Di("scroll",i)}switch(n){case"input":X(i),J(i,s,!0);break;case"textarea":X(i),st(i);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(i.onclick=Ji)}i=r,e.updateQueue=i,null!==i&&(e.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=at(n)),"http://www.w3.org/1999/xhtml"===t?"script"===n?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof i.is?t=l.createElement(n,{is:i.is}):(t=l.createElement(n),"select"===n&&(l=t,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):t=l.createElementNS(t,n),t[dr]=e,t[fr]=i,La(t,e,!1,!1),e.stateNode=t;t:{switch(l=bt(n,i),n){case"dialog":Di("cancel",t),Di("close",t),r=i;break;case"iframe":case"object":case"embed":Di("load",t),r=i;break;case"video":case"audio":for(r=0;r<ji.length;r++)Di(ji[r],t);r=i;break;case"source":Di("error",t),r=i;break;case"img":case"image":case"link":Di("error",t),Di("load",t),r=i;break;case"details":Di("toggle",t),r=i;break;case"input":K(t,i),r=Y(t,i),Di("invalid",t);break;case"option":default:r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=z({},i,{value:void 0}),Di("invalid",t);break;case"textarea":rt(t,i),r=it(t,i),Di("invalid",t)}for(s in yt(n,r),c=r)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?mt(t,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&ht(t,u):"children"===s?"string"===typeof u?("textarea"!==n||""!==u)&&dt(t,u):"number"===typeof u&&dt(t,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(a.hasOwnProperty(s)?null!=u&&"onScroll"===s&&Di("scroll",t):null!=u&&b(t,s,u,l))}switch(n){case"input":X(t),J(t,i,!1);break;case"textarea":X(t),st(t);break;case"option":null!=i.value&&t.setAttribute("value",""+H(i.value));break;case"select":t.multiple=!!i.multiple,null!=(s=i.value)?nt(t,!!i.multiple,s,!1):null!=i.defaultValue&&nt(t,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(t.onclick=Ji)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break t;case"img":i=!0;break t;default:i=!1}}i&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return Xa(e),null;case 6:if(t&&null!=e.stateNode)Ia(t,e,t.memoizedProps,i);else{if("string"!==typeof i&&null===e.stateNode)throw Error(o(166));if(n=Yo(Zo.current),Yo(Xo.current),ho(e)){if(i=e.stateNode,n=e.memoizedProps,i[dr]=e,(s=i.nodeValue!==n)&&null!==(t=no))switch(t.tag){case 3:$i(i.nodeValue,n,0!==(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&$i(i.nodeValue,n,0!==(1&t.mode))}s&&(e.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[dr]=e,e.stateNode=i}return Xa(e),null;case 13:if(Er(ts),i=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(ro&&null!==io&&0!==(1&e.mode)&&0===(128&e.flags))fo(),po(),e.flags|=98560,s=!1;else if(s=ho(e),null!==i&&null!==i.dehydrated){if(null===t){if(!s)throw Error(o(318));if(!(s=null!==(s=e.memoizedState)?s.dehydrated:null))throw Error(o(317));s[dr]=e}else po(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;Xa(e),s=!1}else null!==oo&&(sc(oo),oo=null),s=!0;if(!s)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=n,e):((i=null!==i)!==(null!==t&&null!==t.memoizedState)&&i&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&ts.current)?0===Il&&(Il=3):gc())),null!==e.updateQueue&&(e.flags|=4),Xa(e),null);case 4:return Qo(),Oa(t,e),null===t&&Vi(e.stateNode.containerInfo),Xa(e),null;case 10:return Ao(e.type._context),Xa(e),null;case 19:if(Er(ts),null===(s=e.memoizedState))return Xa(e),null;if(i=0!==(128&e.flags),null===(l=s.rendering))if(i)Ga(s,!1);else{if(0!==Il||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(l=es(t))){for(e.flags|=128,Ga(s,!1),null!==(i=l.updateQueue)&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;null!==n;)t=i,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,t=l.dependencies,s.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Cr(ts,1&ts.current|2),e.child}t=t.sibling}null!==s.tail&&Qt()>Vl&&(e.flags|=128,i=!0,Ga(s,!1),e.lanes=4194304)}else{if(!i)if(null!==(t=es(l))){if(e.flags|=128,i=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),Ga(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ro)return Xa(e),null}else 2*Qt()-s.renderingStartTime>Vl&&1073741824!==n&&(e.flags|=128,i=!0,Ga(s,!1),e.lanes=4194304);s.isBackwards?(l.sibling=e.child,e.child=l):(null!==(n=s.last)?n.sibling=l:e.child=l,s.last=l)}return null!==s.tail?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Qt(),e.sibling=null,n=ts.current,Cr(ts,i?1&n|2:1&n),e):(Xa(e),null);case 22:case 23:return hc(),i=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==i&&(e.flags|=8192),i&&0!==(1&e.mode)?0!==(1073741824&Ol)&&(Xa(e),6&e.subtreeFlags&&(e.flags|=8192)):Xa(e),null;case 24:case 25:return null}throw Error(o(156,e.tag))}function Za(t,e){switch(eo(e),e.tag){case 1:return Or(e.type)&&Rr(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return Qo(),Er(kr),Er(Ar),is(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return Jo(e),null;case 13:if(Er(ts),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(o(340));po()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Er(ts),null;case 4:return Qo(),null;case 10:return Ao(e.type._context),null;case 22:case 23:return hc(),null;default:return null}}La=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Oa=function(){},Ra=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Yo(Xo.current);var o,s=null;switch(n){case"input":r=Y(t,r),i=Y(t,i),s=[];break;case"select":r=z({},r,{value:void 0}),i=z({},i,{value:void 0}),s=[];break;case"textarea":r=it(t,r),i=it(t,i),s=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(t.onclick=Ji)}for(u in yt(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Di("scroll",t),s||l===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}},Ia=function(t,e,n,i){n!==i&&(e.flags|=4)};var Ya=!1,Ka=!1,Qa="function"===typeof WeakSet?WeakSet:Set,$a=null;function Ja(t,e){var n=t.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Pc(t,e,i)}else n.current=null}function tl(t,e,n){try{n()}catch(i){Pc(t,e,i)}}var el=!1;function nl(t,e,n){var i=e.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&t)===t){var o=r.destroy;r.destroy=void 0,void 0!==o&&tl(e,n,o)}r=r.next}while(r!==i)}}function il(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function rl(t){var e=t.ref;if(null!==e){var n=t.stateNode;t.tag,t=n,"function"===typeof e?e(t):e.current=t}}function ol(t){var e=t.alternate;null!==e&&(t.alternate=null,ol(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[dr],delete e[fr],delete e[gr],delete e[mr],delete e[vr])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function sl(t){return 5===t.tag||3===t.tag||4===t.tag}function al(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||sl(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function ll(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=Ji));else if(4!==i&&null!==(t=t.child))for(ll(t,e,n),t=t.sibling;null!==t;)ll(t,e,n),t=t.sibling}function cl(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==i&&null!==(t=t.child))for(cl(t,e,n),t=t.sibling;null!==t;)cl(t,e,n),t=t.sibling}var ul=null,hl=!1;function dl(t,e,n){for(n=n.child;null!==n;)fl(t,e,n),n=n.sibling}function fl(t,e,n){if(oe&&"function"===typeof oe.onCommitFiberUnmount)try{oe.onCommitFiberUnmount(re,n)}catch(a){}switch(n.tag){case 5:Ka||Ja(n,e);case 6:var i=ul,r=hl;ul=null,dl(t,e,n),hl=r,null!==(ul=i)&&(hl?(t=ul,n=n.stateNode,8===t.nodeType?t.parentNode.removeChild(n):t.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(t=ul,n=n.stateNode,8===t.nodeType?lr(t.parentNode,n):1===t.nodeType&&lr(t,n),Ve(t)):lr(ul,n.stateNode));break;case 4:i=ul,r=hl,ul=n.stateNode.containerInfo,hl=!0,dl(t,e,n),ul=i,hl=r;break;case 0:case 11:case 14:case 15:if(!Ka&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var o=r,s=o.destroy;o=o.tag,void 0!==s&&(0!==(2&o)||0!==(4&o))&&tl(n,e,s),r=r.next}while(r!==i)}dl(t,e,n);break;case 1:if(!Ka&&(Ja(n,e),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Pc(n,e,a)}dl(t,e,n);break;case 21:dl(t,e,n);break;case 22:1&n.mode?(Ka=(i=Ka)||null!==n.memoizedState,dl(t,e,n),Ka=i):dl(t,e,n);break;default:dl(t,e,n)}}function pl(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Qa),e.forEach((function(e){var i=Ac.bind(null,t,e);n.has(e)||(n.add(e),e.then(i,i))}))}}function gl(t,e){var n=e.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,a=e,l=a;t:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break t;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break t}l=l.return}if(null===ul)throw Error(o(160));fl(s,a,r),ul=null,hl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(u){Pc(r,e,u)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)ml(e,t),e=e.sibling}function ml(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(gl(e,t),vl(t),4&i){try{nl(3,t,t.return),il(3,t)}catch(m){Pc(t,t.return,m)}try{nl(5,t,t.return)}catch(m){Pc(t,t.return,m)}}break;case 1:gl(e,t),vl(t),512&i&&null!==n&&Ja(n,n.return);break;case 5:if(gl(e,t),vl(t),512&i&&null!==n&&Ja(n,n.return),32&t.flags){var r=t.stateNode;try{dt(r,"")}catch(m){Pc(t,t.return,m)}}if(4&i&&null!=(r=t.stateNode)){var s=t.memoizedProps,a=null!==n?n.memoizedProps:s,l=t.type,c=t.updateQueue;if(t.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&Q(r,s),bt(l,a);var u=bt(l,s);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];"style"===h?mt(r,d):"dangerouslySetInnerHTML"===h?ht(r,d):"children"===h?dt(r,d):b(r,h,d,u)}switch(l){case"input":$(r,s);break;case"textarea":ot(r,s);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var p=s.value;null!=p?nt(r,!!s.multiple,p,!1):f!==!!s.multiple&&(null!=s.defaultValue?nt(r,!!s.multiple,s.defaultValue,!0):nt(r,!!s.multiple,s.multiple?[]:"",!1))}r[fr]=s}catch(m){Pc(t,t.return,m)}}break;case 6:if(gl(e,t),vl(t),4&i){if(null===t.stateNode)throw Error(o(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(m){Pc(t,t.return,m)}}break;case 3:if(gl(e,t),vl(t),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Ve(e.containerInfo)}catch(m){Pc(t,t.return,m)}break;case 4:default:gl(e,t),vl(t);break;case 13:gl(e,t),vl(t),8192&(r=t.child).flags&&(s=null!==r.memoizedState,r.stateNode.isHidden=s,!s||null!==r.alternate&&null!==r.alternate.memoizedState||(Ul=Qt())),4&i&&pl(t);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&t.mode?(Ka=(u=Ka)||h,gl(e,t),Ka=u):gl(e,t),vl(t),8192&i){if(u=null!==t.memoizedState,(t.stateNode.isHidden=u)&&!h&&0!==(1&t.mode))for($a=t,h=t.child;null!==h;){for(d=$a=h;null!==$a;){switch(p=(f=$a).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Ja(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){i=f,n=f.return;try{e=i,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(m){Pc(i,n,m)}}break;case 5:Ja(f,f.return);break;case 22:if(null!==f.memoizedState){wl(d);continue}}null!==p?(p.return=f,$a=p):wl(d)}h=h.sibling}t:for(h=null,d=t;;){if(5===d.tag){if(null===h){h=d;try{r=d.stateNode,u?"function"===typeof(s=r.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=d.stateNode,a=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=gt("display",a))}catch(m){Pc(t,t.return,m)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){Pc(t,t.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===t)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===t)break t;for(;null===d.sibling;){if(null===d.return||d.return===t)break t;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gl(e,t),vl(t),4&i&&pl(t);case 21:}}function vl(t){var e=t.flags;if(2&e){try{t:{for(var n=t.return;null!==n;){if(sl(n)){var i=n;break t}n=n.return}throw Error(o(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(dt(r,""),i.flags&=-33),cl(t,al(t),r);break;case 3:case 4:var s=i.stateNode.containerInfo;ll(t,al(t),s);break;default:throw Error(o(161))}}catch(a){Pc(t,t.return,a)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function yl(t,e,n){$a=t,bl(t,e,n)}function bl(t,e,n){for(var i=0!==(1&t.mode);null!==$a;){var r=$a,o=r.child;if(22===r.tag&&i){var s=null!==r.memoizedState||Ya;if(!s){var a=r.alternate,l=null!==a&&null!==a.memoizedState||Ka;a=Ya;var c=Ka;if(Ya=s,(Ka=l)&&!c)for($a=r;null!==$a;)l=(s=$a).child,22===s.tag&&null!==s.memoizedState?xl(r):null!==l?(l.return=s,$a=l):xl(r);for(;null!==o;)$a=o,bl(o,e,n),o=o.sibling;$a=r,Ya=a,Ka=c}_l(t)}else 0!==(8772&r.subtreeFlags)&&null!==o?(o.return=r,$a=o):_l(t)}}function _l(t){for(;null!==$a;){var e=$a;if(0!==(8772&e.flags)){var n=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:Ka||il(5,e);break;case 1:var i=e.stateNode;if(4&e.flags&&!Ka)if(null===n)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:na(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;null!==s&&Ho(e,s,i);break;case 3:var a=e.updateQueue;if(null!==a){if(n=null,null!==e.child)switch(e.child.tag){case 5:case 1:n=e.child.stateNode}Ho(e,a,n)}break;case 5:var l=e.stateNode;if(null===n&&4&e.flags){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var u=e.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Ve(d)}}}break;default:throw Error(o(163))}Ka||512&e.flags&&rl(e)}catch(f){Pc(e,e.return,f)}}if(e===t){$a=null;break}if(null!==(n=e.sibling)){n.return=e.return,$a=n;break}$a=e.return}}function wl(t){for(;null!==$a;){var e=$a;if(e===t){$a=null;break}var n=e.sibling;if(null!==n){n.return=e.return,$a=n;break}$a=e.return}}function xl(t){for(;null!==$a;){var e=$a;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{il(4,e)}catch(l){Pc(e,n,l)}break;case 1:var i=e.stateNode;if("function"===typeof i.componentDidMount){var r=e.return;try{i.componentDidMount()}catch(l){Pc(e,r,l)}}var o=e.return;try{rl(e)}catch(l){Pc(e,o,l)}break;case 5:var s=e.return;try{rl(e)}catch(l){Pc(e,s,l)}}}catch(l){Pc(e,e.return,l)}if(e===t){$a=null;break}var a=e.sibling;if(null!==a){a.return=e.return,$a=a;break}$a=e.return}}var Sl,Pl=Math.ceil,El=_.ReactCurrentDispatcher,Cl=_.ReactCurrentOwner,Tl=_.ReactCurrentBatchConfig,Al=0,kl=null,Ml=null,Ll=0,Ol=0,Rl=Pr(0),Il=0,jl=null,Fl=0,zl=0,Nl=0,Dl=null,Bl=null,Ul=0,Vl=1/0,Wl=null,Hl=!1,Gl=null,Xl=null,ql=!1,Zl=null,Yl=0,Kl=0,Ql=null,$l=-1,Jl=0;function tc(){return 0!==(6&Al)?Qt():-1!==$l?$l:$l=Qt()}function ec(t){return 0===(1&t.mode)?1:0!==(2&Al)&&0!==Ll?Ll&-Ll:null!==mo.transition?(0===Jl&&(Jl=ge()),Jl):0!==(t=be)?t:t=void 0===(t=window.event)?16:Ke(t.type)}function nc(t,e,n,i){if(50<Kl)throw Kl=0,Ql=null,Error(o(185));ve(t,n,i),0!==(2&Al)&&t===kl||(t===kl&&(0===(2&Al)&&(zl|=n),4===Il&&ac(t,Ll)),ic(t,i),1===n&&0===Al&&0===(1&e.mode)&&(Vl=Qt()+500,Dr&&Vr()))}function ic(t,e){var n=t.callbackNode;!function(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-se(o),a=1<<s,l=r[s];-1===l?0!==(a&n)&&0===(a&i)||(r[s]=fe(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}(t,e);var i=de(t,t===kl?Ll:0);if(0===i)null!==n&&Zt(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(null!=n&&Zt(n),1===e)0===t.tag?function(t){Dr=!0,Ur(t)}(lc.bind(null,t)):Ur(lc.bind(null,t)),sr((function(){0===(6&Al)&&Vr()})),n=null;else{switch(_e(i)){case 1:n=Jt;break;case 4:n=te;break;case 16:default:n=ee;break;case 536870912:n=ie}n=kc(n,rc.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function rc(t,e){if($l=-1,Jl=0,0!==(6&Al))throw Error(o(327));var n=t.callbackNode;if(xc()&&t.callbackNode!==n)return null;var i=de(t,t===kl?Ll:0);if(0===i)return null;if(0!==(30&i)||0!==(i&t.expiredLanes)||e)e=mc(t,i);else{e=i;var r=Al;Al|=2;var s=pc();for(kl===t&&Ll===e||(Wl=null,Vl=Qt()+500,dc(t,e));;)try{yc();break}catch(l){fc(t,l)}To(),El.current=s,Al=r,null!==Ml?e=0:(kl=null,Ll=0,e=Il)}if(0!==e){if(2===e&&(0!==(r=pe(t))&&(i=r,e=oc(t,r))),1===e)throw n=jl,dc(t,0),ac(t,i),ic(t,Qt()),n;if(6===e)ac(t,i);else{if(r=t.current.alternate,0===(30&i)&&!function(t){for(var e=t;;){if(16384&e.flags){var n=e.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],o=r.getSnapshot;r=r.value;try{if(!ai(o(),r))return!1}catch(a){return!1}}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(r)&&(2===(e=mc(t,i))&&(0!==(s=pe(t))&&(i=s,e=oc(t,s))),1===e))throw n=jl,dc(t,0),ac(t,i),ic(t,Qt()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(o(345));case 2:case 5:wc(t,Bl,Wl);break;case 3:if(ac(t,i),(130023424&i)===i&&10<(e=Ul+500-Qt())){if(0!==de(t,0))break;if(((r=t.suspendedLanes)&i)!==i){tc(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=ir(wc.bind(null,t,Bl,Wl),e);break}wc(t,Bl,Wl);break;case 4:if(ac(t,i),(4194240&i)===i)break;for(e=t.eventTimes,r=-1;0<i;){var a=31-se(i);s=1<<a,(a=e[a])>r&&(r=a),i&=~s}if(i=r,10<(i=(120>(i=Qt()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Pl(i/1960))-i)){t.timeoutHandle=ir(wc.bind(null,t,Bl,Wl),i);break}wc(t,Bl,Wl);break;default:throw Error(o(329))}}}return ic(t,Qt()),t.callbackNode===n?rc.bind(null,t):null}function oc(t,e){var n=Dl;return t.current.memoizedState.isDehydrated&&(dc(t,e).flags|=256),2!==(t=mc(t,e))&&(e=Bl,Bl=n,null!==e&&sc(e)),t}function sc(t){null===Bl?Bl=t:Bl.push.apply(Bl,t)}function ac(t,e){for(e&=~Nl,e&=~zl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-se(e),i=1<<n;t[n]=-1,e&=~i}}function lc(t){if(0!==(6&Al))throw Error(o(327));xc();var e=de(t,0);if(0===(1&e))return ic(t,Qt()),null;var n=mc(t,e);if(0!==t.tag&&2===n){var i=pe(t);0!==i&&(e=i,n=oc(t,i))}if(1===n)throw n=jl,dc(t,0),ac(t,e),ic(t,Qt()),n;if(6===n)throw Error(o(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,wc(t,Bl,Wl),ic(t,Qt()),null}function cc(t,e){var n=Al;Al|=1;try{return t(e)}finally{0===(Al=n)&&(Vl=Qt()+500,Dr&&Vr())}}function uc(t){null!==Zl&&0===Zl.tag&&0===(6&Al)&&xc();var e=Al;Al|=1;var n=Tl.transition,i=be;try{if(Tl.transition=null,be=1,t)return t()}finally{be=i,Tl.transition=n,0===(6&(Al=e))&&Vr()}}function hc(){Ol=Rl.current,Er(Rl)}function dc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,rr(n)),null!==Ml)for(n=Ml.return;null!==n;){var i=n;switch(eo(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Rr();break;case 3:Qo(),Er(kr),Er(Ar),is();break;case 5:Jo(i);break;case 4:Qo();break;case 13:case 19:Er(ts);break;case 10:Ao(i.type._context);break;case 22:case 23:hc()}n=n.return}if(kl=t,Ml=t=Rc(t.current,null),Ll=Ol=e,Il=0,jl=null,Nl=zl=Fl=0,Bl=Dl=null,null!==Oo){for(e=0;e<Oo.length;e++)if(null!==(i=(n=Oo[e]).interleaved)){n.interleaved=null;var r=i.next,o=n.pending;if(null!==o){var s=o.next;o.next=r,i.next=s}n.pending=i}Oo=null}return t}function fc(t,e){for(;;){var n=Ml;try{if(To(),rs.current=$s,us){for(var i=as.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}us=!1}if(ss=0,cs=ls=as=null,hs=!1,ds=0,Cl.current=null,null===n||null===n.return){Il=1,jl=e,Ml=null;break}t:{var s=t,a=n.return,l=n,c=e;if(e=Ll,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ma(a);if(null!==p){p.flags&=-257,va(p,a,l,0,e),1&p.mode&&ga(s,u,e),c=u;var g=(e=p).updateQueue;if(null===g){var m=new Set;m.add(c),e.updateQueue=m}else g.add(c);break t}if(0===(1&e)){ga(s,u,e),gc();break t}c=Error(o(426))}else if(ro&&1&l.mode){var v=ma(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),va(v,a,l,0,e),go(ca(c,l));break t}}s=c=ca(c,l),4!==Il&&(Il=2),null===Dl?Dl=[s]:Dl.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e,Vo(s,fa(0,c,e));break t;case 1:l=c;var y=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Xl||!Xl.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e,Vo(s,pa(s,l,e));break t}}s=s.return}while(null!==s)}_c(n)}catch(_){e=_,Ml===n&&null!==n&&(Ml=n=n.return);continue}break}}function pc(){var t=El.current;return El.current=$s,null===t?$s:t}function gc(){0!==Il&&3!==Il&&2!==Il||(Il=4),null===kl||0===(268435455&Fl)&&0===(268435455&zl)||ac(kl,Ll)}function mc(t,e){var n=Al;Al|=2;var i=pc();for(kl===t&&Ll===e||(Wl=null,dc(t,e));;)try{vc();break}catch(r){fc(t,r)}if(To(),Al=n,El.current=i,null!==Ml)throw Error(o(261));return kl=null,Ll=0,Il}function vc(){for(;null!==Ml;)bc(Ml)}function yc(){for(;null!==Ml&&!Yt();)bc(Ml)}function bc(t){var e=Sl(t.alternate,t,Ol);t.memoizedProps=t.pendingProps,null===e?_c(t):Ml=e,Cl.current=null}function _c(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(n=qa(n,e,Ol)))return void(Ml=n)}else{if(null!==(n=Za(n,e)))return n.flags&=32767,void(Ml=n);if(null===t)return Il=6,void(Ml=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(Ml=e);Ml=e=t}while(null!==e);0===Il&&(Il=5)}function wc(t,e,n){var i=be,r=Tl.transition;try{Tl.transition=null,be=1,function(t,e,n,i){do{xc()}while(null!==Zl);if(0!==(6&Al))throw Error(o(327));n=t.finishedWork;var r=t.finishedLanes;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(o(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-se(n),o=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~o}}(t,s),t===kl&&(Ml=kl=null,Ll=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||ql||(ql=!0,kc(ee,(function(){return xc(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Tl.transition,Tl.transition=null;var a=be;be=1;var l=Al;Al|=4,Cl.current=null,function(t,e){if(tr=He,fi(t=di())){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{var i=(n=(n=t.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch(w){n=null;break t}var a=0,l=-1,c=-1,u=0,h=0,d=t,f=null;e:for(;;){for(var p;d!==n||0!==r&&3!==d.nodeType||(l=a+r),d!==s||0!==i&&3!==d.nodeType||(c=a+i),3===d.nodeType&&(a+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===t)break e;if(f===n&&++u===r&&(l=a),f===s&&++h===i&&(c=a),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(er={focusedElem:t,selectionRange:n},He=!1,$a=e;null!==$a;)if(t=(e=$a).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,$a=t;else for(;null!==$a;){e=$a;try{var g=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=e.stateNode,b=y.getSnapshotBeforeUpdate(e.elementType===e.type?m:na(e.type,m),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var _=e.stateNode.containerInfo;1===_.nodeType?_.textContent="":9===_.nodeType&&_.documentElement&&_.removeChild(_.documentElement);break;default:throw Error(o(163))}}catch(w){Pc(e,e.return,w)}if(null!==(t=e.sibling)){t.return=e.return,$a=t;break}$a=e.return}g=el,el=!1}(t,n),ml(n,t),pi(er),He=!!tr,er=tr=null,t.current=n,yl(n,t,r),Kt(),Al=l,be=a,Tl.transition=s}else t.current=n;if(ql&&(ql=!1,Zl=t,Yl=r),s=t.pendingLanes,0===s&&(Xl=null),function(t){if(oe&&"function"===typeof oe.onCommitFiberRoot)try{oe.onCommitFiberRoot(re,t,void 0,128===(128&t.current.flags))}catch(e){}}(n.stateNode),ic(t,Qt()),null!==e)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Hl)throw Hl=!1,t=Gl,Gl=null,t;0!==(1&Yl)&&0!==t.tag&&xc(),s=t.pendingLanes,0!==(1&s)?t===Ql?Kl++:(Kl=0,Ql=t):Kl=0,Vr()}(t,e,n,i)}finally{Tl.transition=r,be=i}return null}function xc(){if(null!==Zl){var t=_e(Yl),e=Tl.transition,n=be;try{if(Tl.transition=null,be=16>t?16:t,null===Zl)var i=!1;else{if(t=Zl,Zl=null,Yl=0,0!==(6&Al))throw Error(o(331));var r=Al;for(Al|=4,$a=t.current;null!==$a;){var s=$a,a=s.child;if(0!==(16&$a.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for($a=u;null!==$a;){var h=$a;switch(h.tag){case 0:case 11:case 15:nl(8,h,s)}var d=h.child;if(null!==d)d.return=h,$a=d;else for(;null!==$a;){var f=(h=$a).sibling,p=h.return;if(ol(h),h===u){$a=null;break}if(null!==f){f.return=p,$a=f;break}$a=p}}}var g=s.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}$a=s}}if(0!==(2064&s.subtreeFlags)&&null!==a)a.return=s,$a=a;else t:for(;null!==$a;){if(0!==(2048&(s=$a).flags))switch(s.tag){case 0:case 11:case 15:nl(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,$a=y;break t}$a=s.return}}var b=t.current;for($a=b;null!==$a;){var _=(a=$a).child;if(0!==(2064&a.subtreeFlags)&&null!==_)_.return=a,$a=_;else t:for(a=b;null!==$a;){if(0!==(2048&(l=$a).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(x){Pc(l,l.return,x)}if(l===a){$a=null;break t}var w=l.sibling;if(null!==w){w.return=l.return,$a=w;break t}$a=l.return}}if(Al=r,Vr(),oe&&"function"===typeof oe.onPostCommitFiberRoot)try{oe.onPostCommitFiberRoot(re,t)}catch(x){}i=!0}return i}finally{be=n,Tl.transition=e}}return!1}function Sc(t,e,n){t=Bo(t,e=fa(0,e=ca(n,e),1),1),e=tc(),null!==t&&(ve(t,1,e),ic(t,e))}function Pc(t,e,n){if(3===t.tag)Sc(t,t,n);else for(;null!==e;){if(3===e.tag){Sc(e,t,n);break}if(1===e.tag){var i=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Xl||!Xl.has(i))){e=Bo(e,t=pa(e,t=ca(n,t),1),1),t=tc(),null!==e&&(ve(e,1,t),ic(e,t));break}}e=e.return}}function Ec(t,e,n){var i=t.pingCache;null!==i&&i.delete(e),e=tc(),t.pingedLanes|=t.suspendedLanes&n,kl===t&&(Ll&n)===n&&(4===Il||3===Il&&(130023424&Ll)===Ll&&500>Qt()-Ul?dc(t,0):Nl|=n),ic(t,e)}function Cc(t,e){0===e&&(0===(1&t.mode)?e=1:(e=ue,0===(130023424&(ue<<=1))&&(ue=4194304)));var n=tc();null!==(t=jo(t,e))&&(ve(t,e,n),ic(t,n))}function Tc(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),Cc(t,n)}function Ac(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(o(314))}null!==i&&i.delete(e),Cc(t,n)}function kc(t,e){return qt(t,e)}function Mc(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lc(t,e,n,i){return new Mc(t,e,n,i)}function Oc(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Rc(t,e){var n=t.alternate;return null===n?((n=Lc(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ic(t,e,n,i,r,s){var a=2;if(i=t,"function"===typeof t)Oc(t)&&(a=1);else if("string"===typeof t)a=5;else t:switch(t){case S:return jc(n.children,r,s,e);case P:a=8,r|=8;break;case E:return(t=Lc(12,n,e,2|r)).elementType=E,t.lanes=s,t;case k:return(t=Lc(13,n,e,r)).elementType=k,t.lanes=s,t;case M:return(t=Lc(19,n,e,r)).elementType=M,t.lanes=s,t;case R:return Fc(n,r,s,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case C:a=10;break t;case T:a=9;break t;case A:a=11;break t;case L:a=14;break t;case O:a=16,i=null;break t}throw Error(o(130,null==t?t:typeof t,""))}return(e=Lc(a,n,e,r)).elementType=t,e.type=i,e.lanes=s,e}function jc(t,e,n,i){return(t=Lc(7,t,i,e)).lanes=n,t}function Fc(t,e,n,i){return(t=Lc(22,t,i,e)).elementType=R,t.lanes=n,t.stateNode={isHidden:!1},t}function zc(t,e,n){return(t=Lc(6,t,null,e)).lanes=n,t}function Nc(t,e,n){return(e=Lc(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Dc(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=me(0),this.expirationTimes=me(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=me(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Bc(t,e,n,i,r,o,s,a,l){return t=new Dc(t,e,n,a,l),1===e?(e=1,!0===o&&(e|=8)):e=0,o=Lc(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},zo(o),t}function Uc(t){if(!t)return Tr;t:{if(Vt(t=t._reactInternals)!==t||1!==t.tag)throw Error(o(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Or(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(o(171))}if(1===t.tag){var n=t.type;if(Or(n))return jr(t,n,e)}return e}function Vc(t,e,n,i,r,o,s,a,l){return(t=Bc(n,i,!0,t,0,o,0,a,l)).context=Uc(null),n=t.current,(o=Do(i=tc(),r=ec(n))).callback=void 0!==e&&null!==e?e:null,Bo(n,o,r),t.current.lanes=r,ve(t,r,i),ic(t,i),t}function Wc(t,e,n,i){var r=e.current,o=tc(),s=ec(r);return n=Uc(n),null===e.context?e.context=n:e.pendingContext=n,(e=Do(o,s)).payload={element:t},null!==(i=void 0===i?null:i)&&(e.callback=i),null!==(t=Bo(r,e,s))&&(nc(t,r,s,o),Uo(t,r,s)),s}function Hc(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Gc(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function Xc(t,e){Gc(t,e),(t=t.alternate)&&Gc(t,e)}Sl=function(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps||kr.current)ba=!0;else{if(0===(t.lanes&n)&&0===(128&e.flags))return ba=!1,function(t,e,n){switch(e.tag){case 3:ka(e),po();break;case 5:$o(e);break;case 1:Or(e.type)&&Fr(e);break;case 4:Ko(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Cr(So,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=e.memoizedState))return null!==i.dehydrated?(Cr(ts,1&ts.current),e.flags|=128,null):0!==(n&e.child.childLanes)?za(t,e,n):(Cr(ts,1&ts.current),null!==(t=Ha(t,e,n))?t.sibling:null);Cr(ts,1&ts.current);break;case 19:if(i=0!==(n&e.childLanes),0!==(128&t.flags)){if(i)return Va(t,e,n);e.flags|=128}if(null!==(r=e.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Cr(ts,ts.current),i)break;return null;case 22:case 23:return e.lanes=0,Pa(t,e,n)}return Ha(t,e,n)}(t,e,n);ba=0!==(131072&t.flags)}else ba=!1,ro&&0!==(1048576&e.flags)&&Jr(e,Xr,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Wa(t,e),t=e.pendingProps;var r=Lr(e,Ar.current);Mo(e,n),r=ms(null,e,i,t,r,n);var s=vs();return e.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Or(i)?(s=!0,Fr(e)):s=!1,e.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,zo(e),r.updater=ra,e.stateNode=r,r._reactInternals=e,la(e,i,t,n),e=Aa(null,e,i,!0,s,n)):(e.tag=0,ro&&s&&to(e),_a(null,e,r,n),e=e.child),e;case 16:i=e.elementType;t:{switch(Wa(t,e),t=e.pendingProps,i=(r=i._init)(i._payload),e.type=i,r=e.tag=function(t){if("function"===typeof t)return Oc(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===A)return 11;if(t===L)return 14}return 2}(i),t=na(i,t),r){case 0:e=Ca(null,e,i,t,n);break t;case 1:e=Ta(null,e,i,t,n);break t;case 11:e=wa(null,e,i,t,n);break t;case 14:e=xa(null,e,i,na(i.type,t),n);break t}throw Error(o(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,Ca(t,e,i,r=e.elementType===i?r:na(i,r),n);case 1:return i=e.type,r=e.pendingProps,Ta(t,e,i,r=e.elementType===i?r:na(i,r),n);case 3:t:{if(ka(e),null===t)throw Error(o(387));i=e.pendingProps,r=(s=e.memoizedState).element,No(t,e),Wo(e,i,null,n);var a=e.memoizedState;if(i=a.element,s.isDehydrated){if(s={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,256&e.flags){e=Ma(t,e,i,n,r=ca(Error(o(423)),e));break t}if(i!==r){e=Ma(t,e,i,n,r=ca(Error(o(424)),e));break t}for(io=cr(e.stateNode.containerInfo.firstChild),no=e,ro=!0,oo=null,n=xo(e,null,i,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(po(),i===r){e=Ha(t,e,n);break t}_a(t,e,i,n)}e=e.child}return e;case 5:return $o(e),null===t&&co(e),i=e.type,r=e.pendingProps,s=null!==t?t.memoizedProps:null,a=r.children,nr(i,r)?a=null:null!==s&&nr(i,s)&&(e.flags|=32),Ea(t,e),_a(t,e,a,n),e.child;case 6:return null===t&&co(e),null;case 13:return za(t,e,n);case 4:return Ko(e,e.stateNode.containerInfo),i=e.pendingProps,null===t?e.child=wo(e,null,i,n):_a(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,wa(t,e,i,r=e.elementType===i?r:na(i,r),n);case 7:return _a(t,e,e.pendingProps,n),e.child;case 8:case 12:return _a(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,a=r.value,Cr(So,i._currentValue),i._currentValue=a,null!==s)if(ai(s.value,a)){if(s.children===r.children&&!kr.current){e=Ha(t,e,n);break t}}else for(null!==(s=e.child)&&(s.return=e);null!==s;){var l=s.dependencies;if(null!==l){a=s.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===s.tag){(c=Do(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),ko(s.return,n,e),l.lanes|=n;break}c=c.next}}else if(10===s.tag)a=s.type===e.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(o(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),ko(a,n,e),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===e){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}_a(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Mo(e,n),i=i(r=Lo(r)),e.flags|=1,_a(t,e,i,n),e.child;case 14:return r=na(i=e.type,e.pendingProps),xa(t,e,i,r=na(i.type,r),n);case 15:return Sa(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:na(i,r),Wa(t,e),e.tag=1,Or(i)?(t=!0,Fr(e)):t=!1,Mo(e,n),sa(e,i,r),la(e,i,r,n),Aa(null,e,i,!0,t,n);case 19:return Va(t,e,n);case 22:return Pa(t,e,n)}throw Error(o(156,e.tag))};var qc="function"===typeof reportError?reportError:function(t){console.error(t)};function Zc(t){this._internalRoot=t}function Yc(t){this._internalRoot=t}function Kc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Qc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function $c(){}function Jc(t,e,n,i,r){var o=n._reactRootContainer;if(o){var s=o;if("function"===typeof r){var a=r;r=function(){var t=Hc(s);a.call(t)}}Wc(e,s,t,r)}else s=function(t,e,n,i,r){if(r){if("function"===typeof i){var o=i;i=function(){var t=Hc(s);o.call(t)}}var s=Vc(e,i,t,0,null,!1,0,"",$c);return t._reactRootContainer=s,t[pr]=s.current,Vi(8===t.nodeType?t.parentNode:t),uc(),s}for(;r=t.lastChild;)t.removeChild(r);if("function"===typeof i){var a=i;i=function(){var t=Hc(l);a.call(t)}}var l=Bc(t,0,!1,null,0,!1,0,"",$c);return t._reactRootContainer=l,t[pr]=l.current,Vi(8===t.nodeType?t.parentNode:t),uc((function(){Wc(e,l,n,i)})),l}(n,e,t,r,i);return Hc(s)}Yc.prototype.render=Zc.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(o(409));Wc(t,e,null,null)},Yc.prototype.unmount=Zc.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;uc((function(){Wc(null,t,null,null)})),e[pr]=null}},Yc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Pe();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Re.length&&0!==e&&e<Re[n].priority;n++);Re.splice(n,0,t),0===n&&ze(t)}},we=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=he(e.pendingLanes);0!==n&&(ye(e,1|n),ic(e,Qt()),0===(6&Al)&&(Vl=Qt()+500,Vr()))}break;case 13:uc((function(){var e=jo(t,1);if(null!==e){var n=tc();nc(e,t,1,n)}})),Xc(t,1)}},xe=function(t){if(13===t.tag){var e=jo(t,134217728);if(null!==e)nc(e,t,134217728,tc());Xc(t,134217728)}},Se=function(t){if(13===t.tag){var e=ec(t),n=jo(t,e);if(null!==n)nc(n,t,e,tc());Xc(t,e)}},Pe=function(){return be},Ee=function(t,e){var n=be;try{return be=t,e()}finally{be=n}},xt=function(t,e,n){switch(e){case"input":if($(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=wr(i);if(!r)throw Error(o(90));q(i),$(i,r)}}}break;case"textarea":ot(t,n);break;case"select":null!=(e=n.value)&&nt(t,!!n.multiple,e,!1)}},At=cc,kt=uc;var tu={usingClientEntryPoint:!1,Events:[br,_r,wr,Ct,Tt,cc]},eu={findFiberByHostInstance:yr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Gt(t))?null:t.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{re=iu.inject(nu),oe=iu}catch(ut){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,e.createPortal=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(e))throw Error(o(200));return function(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==i?null:""+i,children:t,containerInfo:e,implementation:n}}(t,e,null,n)},e.createRoot=function(t,e){if(!Kc(t))throw Error(o(299));var n=!1,i="",r=qc;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(n=!0),void 0!==e.identifierPrefix&&(i=e.identifierPrefix),void 0!==e.onRecoverableError&&(r=e.onRecoverableError)),e=Bc(t,1,!1,null,0,n,0,i,r),t[pr]=e.current,Vi(8===t.nodeType?t.parentNode:t),new Zc(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(o(188));throw t=Object.keys(t).join(","),Error(o(268,t))}return t=null===(t=Gt(e))?null:t.stateNode},e.flushSync=function(t){return uc(t)},e.hydrate=function(t,e,n){if(!Qc(e))throw Error(o(200));return Jc(null,t,e,!0,n)},e.hydrateRoot=function(t,e,n){if(!Kc(t))throw Error(o(405));var i=null!=n&&n.hydratedSources||null,r=!1,s="",a=qc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),e=Vc(e,null,t,1,null!=n?n:null,r,0,s,a),t[pr]=e.current,Vi(t),i)for(t=0;t<i.length;t++)r=(r=(n=i[t])._getVersion)(n._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new Yc(e)},e.render=function(t,e,n){if(!Qc(e))throw Error(o(200));return Jc(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!Qc(t))throw Error(o(40));return!!t._reactRootContainer&&(uc((function(){Jc(null,null,t,!1,(function(){t._reactRootContainer=null,t[pr]=null}))})),!0)},e.unstable_batchedUpdates=cc,e.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!Qc(n))throw Error(o(200));if(null==t||void 0===t._reactInternals)throw Error(o(38));return Jc(t,e,n,!1,i)},e.version="18.3.1-next-f1338f8080-20240426"},250:(t,e,n)=>{"use strict";var i=n(164);e.s=i.createRoot,i.hydrateRoot},164:(t,e,n)=>{"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(463)},374:(t,e,n)=>{"use strict";var i=n(791),r=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(t,e,n){var i,o={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==e.key&&(c=""+e.key),void 0!==e.ref&&(u=e.ref),e)s.call(e,i)&&!l.hasOwnProperty(i)&&(o[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps)void 0===o[i]&&(o[i]=e[i]);return{$$typeof:r,type:t,key:c,ref:u,props:o,_owner:a.current}}e.Fragment=o,e.jsx=c,e.jsxs=c},117:(t,e)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||p}function y(){}function b(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},v.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},y.prototype=v.prototype;var _=b.prototype=new y;_.constructor=b,g(_,v.prototype),_.isPureReactComponent=!0;var w=Array.isArray,x=Object.prototype.hasOwnProperty,S={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function E(t,e,i){var r,o={},s=null,a=null;if(null!=e)for(r in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(s=""+e.key),e)x.call(e,r)&&!P.hasOwnProperty(r)&&(o[r]=e[r]);var l=arguments.length-2;if(1===l)o.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps)void 0===o[r]&&(o[r]=l[r]);return{$$typeof:n,type:t,key:s,ref:a,props:o,_owner:S.current}}function C(t){return"object"===typeof t&&null!==t&&t.$$typeof===n}var T=/\/+/g;function A(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function k(t,e,r,o,s){var a=typeof t;"undefined"!==a&&"boolean"!==a||(t=null);var l=!1;if(null===t)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case n:case i:l=!0}}if(l)return s=s(l=t),t=""===o?"."+A(l,0):o,w(s)?(r="",null!=t&&(r=t.replace(T,"$&/")+"/"),k(s,e,r,"",(function(t){return t}))):null!=s&&(C(s)&&(s=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(T,"$&/")+"/")+t)),e.push(s)),1;if(l=0,o=""===o?".":o+":",w(t))for(var c=0;c<t.length;c++){var u=o+A(a=t[c],c);l+=k(a,e,r,u,s)}else if(u=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t),"function"===typeof u)for(t=u.call(t),c=0;!(a=t.next()).done;)l+=k(a=a.value,e,r,u=o+A(a,c++),s);else if("object"===a)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function M(t,e,n){if(null==t)return t;var i=[],r=0;return k(t,i,"","",(function(t){return e.call(n,t,r++)})),i}function L(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var O={current:null},R={transition:null},I={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:R,ReactCurrentOwner:S};function j(){throw Error("act(...) is not supported in production builds of React.")}e.Children={map:M,forEach:function(t,e,n){M(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return M(t,(function(){e++})),e},toArray:function(t){return M(t,(function(t){return t}))||[]},only:function(t){if(!C(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=v,e.Fragment=r,e.Profiler=s,e.PureComponent=b,e.StrictMode=o,e.Suspense=u,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,e.act=j,e.cloneElement=function(t,e,i){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=g({},t.props),o=t.key,s=t.ref,a=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,a=S.current),void 0!==e.key&&(o=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)x.call(e,c)&&!P.hasOwnProperty(c)&&(r[c]=void 0===e[c]&&void 0!==l?l[c]:e[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:n,type:t.type,key:o,ref:s,props:r,_owner:a}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:t},t.Consumer=t},e.createElement=E,e.createFactory=function(t){var e=E.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:c,render:t}},e.isValidElement=C,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:L}},e.memo=function(t,e){return{$$typeof:h,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=R.transition;R.transition={};try{t()}finally{R.transition=e}},e.unstable_act=j,e.useCallback=function(t,e){return O.current.useCallback(t,e)},e.useContext=function(t){return O.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return O.current.useDeferredValue(t)},e.useEffect=function(t,e){return O.current.useEffect(t,e)},e.useId=function(){return O.current.useId()},e.useImperativeHandle=function(t,e,n){return O.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return O.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return O.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return O.current.useMemo(t,e)},e.useReducer=function(t,e,n){return O.current.useReducer(t,e,n)},e.useRef=function(t){return O.current.useRef(t)},e.useState=function(t){return O.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return O.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return O.current.useTransition()},e.version="18.3.1"},791:(t,e,n)=>{"use strict";t.exports=n(117)},184:(t,e,n)=>{"use strict";t.exports=n(374)},813:(t,e)=>{"use strict";function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var i=n-1>>>1,r=t[i];if(!(0<o(r,e)))break t;t[i]=e,t[n]=r,n=i}}function i(t){return 0===t.length?null:t[0]}function r(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var i=0,r=t.length,s=r>>>1;i<s;){var a=2*(i+1)-1,l=t[a],c=a+1,u=t[c];if(0>o(l,n))c<r&&0>o(u,l)?(t[i]=u,t[c]=n,i=c):(t[i]=l,t[a]=n,i=a);else{if(!(c<r&&0>o(u,n)))break t;t[i]=u,t[c]=n,i=c}}}return e}function o(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,g=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function _(t){for(var e=i(u);null!==e;){if(null===e.callback)r(u);else{if(!(e.startTime<=t))break;r(u),e.sortIndex=e.expirationTime,n(c,e)}e=i(u)}}function w(t){if(m=!1,_(t),!g)if(null!==i(c))g=!0,R(x);else{var e=i(u);null!==e&&I(w,e.startTime-t)}}function x(t,n){g=!1,m&&(m=!1,y(C),C=-1),p=!0;var o=f;try{for(_(n),d=i(c);null!==d&&(!(d.expirationTime>n)||t&&!k());){var s=d.callback;if("function"===typeof s){d.callback=null,f=d.priorityLevel;var a=s(d.expirationTime<=n);n=e.unstable_now(),"function"===typeof a?d.callback=a:d===i(c)&&r(c),_(n)}else r(c);d=i(c)}if(null!==d)var l=!0;else{var h=i(u);null!==h&&I(w,h.startTime-n),l=!1}return l}finally{d=null,f=o,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,P=!1,E=null,C=-1,T=5,A=-1;function k(){return!(e.unstable_now()-A<T)}function M(){if(null!==E){var t=e.unstable_now();A=t;var n=!0;try{n=E(!0,t)}finally{n?S():(P=!1,E=null)}}else P=!1}if("function"===typeof b)S=function(){b(M)};else if("undefined"!==typeof MessageChannel){var L=new MessageChannel,O=L.port2;L.port1.onmessage=M,S=function(){O.postMessage(null)}}else S=function(){v(M,0)};function R(t){E=t,P||(P=!0,S())}function I(t,n){C=v((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,R(x))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return i(c)},e.unstable_next=function(t){switch(f){case 1:case 2:case 3:var e=3;break;default:e=f}var n=f;f=e;try{return t()}finally{f=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=f;f=t;try{return e()}finally{f=n}},e.unstable_scheduleCallback=function(t,r,o){var s=e.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,t){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return t={id:h++,callback:r,priorityLevel:t,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(t.sortIndex=o,n(u,t),null===i(c)&&t===i(u)&&(m?(y(C),C=-1):m=!0,I(w,o-s))):(t.sortIndex=a,n(c,t),g||p||(g=!0,R(x))),t},e.unstable_shouldYield=k,e.unstable_wrapCallback=function(t){var e=f;return function(){var n=f;f=e;try{return t.apply(this,arguments)}finally{f=n}}}},296:(t,e,n)=>{"use strict";t.exports=n(813)}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,n),o.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},(()=>{var t,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__;n.t=function(i,r){if(1&r&&(i=this(i)),8&r)return i;if("object"===typeof i&&i){if(4&r&&i.__esModule)return i;if(16&r&&"function"===typeof i.then)return i}var o=Object.create(null);n.r(o);var s={};t=t||[null,e({}),e([]),e(e)];for(var a=2&r&&i;"object"==typeof a&&!~t.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach((t=>s[t]=()=>i[t]));return s.default=()=>i,n.d(o,s),o}})(),n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.f={},n.e=t=>Promise.all(Object.keys(n.f).reduce(((e,i)=>(n.f[i](t,e),e)),[])),n.u=t=>"static/js/"+t+".308ca486.chunk.js",n.miniCssF=t=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={},e="parcels:";n.l=(i,r,o,s)=>{if(t[i])t[i].push(r);else{var a,l;if(void 0!==o)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==e+o){a=h;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",e+o),a.src=i),t[i]=[r];var d=(e,n)=>{a.onerror=a.onload=null,clearTimeout(f);var r=t[i];if(delete t[i],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((t=>t(n))),e)return e(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.p="/parcels/",(()=>{var t={179:0};n.f.j=(e,i)=>{var r=n.o(t,e)?t[e]:void 0;if(0!==r)if(r)i.push(r[2]);else{var o=new Promise(((n,i)=>r=t[e]=[n,i]));i.push(r[2]=o);var s=n.p+n.u(e),a=new Error;n.l(s,(i=>{if(n.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var o=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;a.message="Loading chunk "+e+" failed.\n("+o+": "+s+")",a.name="ChunkLoadError",a.type=o,a.request=s,r[1](a)}}),"chunk-"+e,e)}};var e=(e,i)=>{var r,o,s=i[0],a=i[1],l=i[2],c=0;if(s.some((e=>0!==t[e]))){for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(l)l(n)}for(e&&e(i);c<s.length;c++)o=s[c],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0},i=self.webpackChunkparcels=self.webpackChunkparcels||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})(),(()=>{"use strict";var t=n(791),e=n(250),i=n(184);const r=()=>(0,i.jsx)("div",{className:"title-wrapper-style",children:(0,i.jsxs)("div",{children:["Filter by parcel area ",(0,i.jsx)("span",{style:{fontSize:"0.8em"},children:"m\xb2"})]})});r.displayName="Title";const o=(0,t.createContext)(null),s=()=>(0,t.useContext)(o),a=e=>{let{children:n}=e;const[r,s]=(0,t.useState)(null),[a,l]=(0,t.useState)(null),c={top:10,bottom:0,left:0,right:0},u=r-c.right-c.left,h=a-c.top-c.bottom;return(0,i.jsx)(o.Provider,{value:{margin:c,width:r,height:a,setWidth:s,setHeight:l,innerWidth:u,innerHeight:h},children:n})};o.displayName="BarsSizesContext";const l=e=>{let{children:n}=e;const{margin:r,width:o,height:a,setWidth:l,setHeight:c}=s(),u=(0,t.useCallback)((t=>{if(t){const e=t.getBoundingClientRect().width,n=t.getBoundingClientRect().height;l(e),c(n)}}),[]);return 0===o?(0,i.jsx)(i.Fragment,{}):(0,i.jsx)("div",{ref:u,style:{width:"100%",height:"100%"},children:o&&(0,i.jsx)("svg",{viewBox:"0 0 ".concat(o," ").concat(a),preserveAspectRatio:"none",children:(0,i.jsx)("g",{transform:"translate(".concat(r.left,", ").concat(r.top,")"),children:t.Children.map(n,((e,n)=>(0,t.cloneElement)(e,{width:"100%"})))})})})};l.displayName="SVGWrapper";const c={latitude:-26.905141661134657,longitude:-49.08110549040376,bearing:-34,pitch:60,zoom:15.5},u=(0,t.createContext)(null),h=()=>(0,t.useContext)(u),d=e=>{let{children:n}=e;const[r,o]=(0,t.useState)("mapbox://styles/hvoking/clrwzn1jo015q01nl53664m2c"),[s,a]=(0,t.useState)("blumenau"),[l,h]=(0,t.useState)(37),[d,f]=(0,t.useState)(41351),[p,g]=(0,t.useState)(41351),[m,v]=(0,t.useState)(c),[y,b]=(0,t.useState)({latitude:m.latitude,longitude:m.longitude}),[_,w]=(0,t.useState)({latitude:m.latitude,longitude:m.longitude});(0,t.useEffect)((()=>{v({...m,...y})}),[y]);const x=(0,t.useRef)();return(0,t.useEffect)((()=>{var t;null===(t=x.current)||void 0===t||t.flyTo({center:[m.longitude,m.latitude],zoom:m.zoom,duration:3e3,essential:!0}),w({longitude:m.longitude,latitude:m.latitude})}),[m]),(0,i.jsx)(u.Provider,{value:{mapRef:x,basemap:r,setBasemap:o,viewport:m,setViewport:v,cityName:s,setCityName:a,parcelId:d,setParcelId:f,cityId:l,setCityId:h,marker:_,setMarker:w,placeCoordinates:y,setPlaceCoordinates:b,placeId:p,setPlaceId:g},children:n})};u.displayName="GeoContext";const f=(0,t.createContext)(null),p=()=>(0,t.useContext)(f),g=e=>{let{children:n}=e;const{marker:r}=h(),[o,s]=(0,t.useState)(1),[a,l]=(0,t.useState)(1),c=((t,e,n)=>{n||(n=64);const i=r.latitude,o=r.longitude,s=e,a=s/(111.32*Math.cos(i*Math.PI/180)),l=s/110.574;let c,u,h;const d=[];for(let r=0;r<n;r++)c=r/n*(2*Math.PI),u=a*Math.cos(c),h=l*Math.sin(c),d.push([o+u,i+h]);return d.push(d[0]),{type:"Polygon",coordinates:[d]}})((r.longitude,r.latitude),a,64);return(0,i.jsx)(f.Provider,{value:{circleGeometry:c,circleRadius:a,setCircleRadius:l,radiusPosition:o,setRadiusPosition:s,maxBound:2,minBound:.5},children:n})};f.displayName="CircleContext";const m=(0,t.createContext)(null),v=()=>(0,t.useContext)(m),y=e=>{let{children:n}=e;const{cityName:r,placeCoordinates:o}=h(),{circleGeometry:s}=p(),[a,l]=(0,t.useState)(null);return(0,t.useEffect)((()=>{s&&(async()=>{const t=await fetch("".concat("http://localhost:8000","/polygon_api"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({polygon:JSON.stringify(s),longitude:JSON.stringify(o.longitude),latitude:JSON.stringify(o.latitude),schema:"limites",table:"municipios_br"})}),e=await t.json();l(e[0])})()}),[s]),(0,i.jsx)(m.Provider,{value:{polygonData:a},children:n})};m.displayName="PolygonApiContext";const b=(0,t.createContext)(null),_=()=>(0,t.useContext)(b),w=e=>{let{children:n}=e;const{polygonData:r}=v(),[o,s]=(0,t.useState)(null);return(0,t.useEffect)((()=>{r&&(async()=>{const t="\n\t    \t".concat("http://localhost:8000","/\n\t    \tparcels_api\n\t    ").replace(/\s/g,""),e=await fetch(t),n=await e.json();s(n[0][0])})()}),[r]),(0,i.jsx)(b.Provider,{value:{parcelsData:o},children:n})};function x(t,e){let n;if(void 0===e)for(const i of t)null!=i&&(n<i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function S(t,e){let n;if(void 0===e)for(const i of t)null!=i&&(n>i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}function P(){}function E(t){return null==t?P:function(){return this.querySelector(t)}}function C(){return[]}function T(t){return null==t?C:function(){return this.querySelectorAll(t)}}function A(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}function k(t){return function(){return this.matches(t)}}function M(t){return function(e){return e.matches(t)}}b.displayName="ParcelsApiContext";var L=Array.prototype.find;function O(){return this.firstElementChild}var R=Array.prototype.filter;function I(){return Array.from(this.children)}function j(t){return new Array(t.length)}function F(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function z(t,e,n,i,r,o){for(var s,a=0,l=e.length,c=o.length;a<c;++a)(s=e[a])?(s.__data__=o[a],i[a]=s):n[a]=new F(t,o[a]);for(;a<l;++a)(s=e[a])&&(r[a]=s)}function N(t,e,n,i,r,o,s){var a,l,c,u=new Map,h=e.length,d=o.length,f=new Array(h);for(a=0;a<h;++a)(l=e[a])&&(f[a]=c=s.call(l,l.__data__,a,e)+"",u.has(c)?r[a]=l:u.set(c,l));for(a=0;a<d;++a)c=s.call(t,o[a],a,o)+"",(l=u.get(c))?(i[a]=l,l.__data__=o[a],u.delete(c)):n[a]=new F(t,o[a]);for(a=0;a<h;++a)(l=e[a])&&u.get(f[a])===l&&(r[a]=l)}function D(t){return t.__data__}function B(t){return"object"===typeof t&&"length"in t?t:Array.from(t)}function U(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}F.prototype={constructor:F,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var V="http://www.w3.org/1999/xhtml";const W={svg:"http://www.w3.org/2000/svg",xhtml:V,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function H(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),W.hasOwnProperty(e)?{space:W[e],local:t}:t}function G(t){return function(){this.removeAttribute(t)}}function X(t){return function(){this.removeAttributeNS(t.space,t.local)}}function q(t,e){return function(){this.setAttribute(t,e)}}function Z(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Y(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function K(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Q(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function $(t){return function(){this.style.removeProperty(t)}}function J(t,e,n){return function(){this.style.setProperty(t,e,n)}}function tt(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function et(t,e){return t.style.getPropertyValue(e)||Q(t).getComputedStyle(t,null).getPropertyValue(e)}function nt(t){return function(){delete this[t]}}function it(t,e){return function(){this[t]=e}}function rt(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function ot(t){return t.trim().split(/^|\s+/)}function st(t){return t.classList||new at(t)}function at(t){this._node=t,this._names=ot(t.getAttribute("class")||"")}function lt(t,e){for(var n=st(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function ct(t,e){for(var n=st(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function ut(t){return function(){lt(this,t)}}function ht(t){return function(){ct(this,t)}}function dt(t,e){return function(){(e.apply(this,arguments)?lt:ct)(this,t)}}function ft(){this.textContent=""}function pt(t){return function(){this.textContent=t}}function gt(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function mt(){this.innerHTML=""}function vt(t){return function(){this.innerHTML=t}}function yt(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function bt(){this.nextSibling&&this.parentNode.appendChild(this)}function _t(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function wt(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===V&&e.documentElement.namespaceURI===V?e.createElement(t):e.createElementNS(n,t)}}function xt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function St(t){var e=H(t);return(e.local?xt:wt)(e)}function Pt(){return null}function Et(){var t=this.parentNode;t&&t.removeChild(this)}function Ct(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Tt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function At(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,o=e.length;i<o;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?e.length=r:delete this.__on}}}function kt(t,e,n){return function(){var i,r=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var s=0,a=r.length;s<a;++s)if((i=r[s]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),void(i.value=e);this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Mt(t,e,n){var i=Q(t),r=i.CustomEvent;"function"===typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Lt(t,e){return function(){return Mt(this,t,e)}}function Ot(t,e){return function(){return Mt(this,t,e.apply(this,arguments))}}at.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Rt=[null];function It(t,e){this._groups=t,this._parents=e}function jt(){return new It([[document.documentElement]],Rt)}It.prototype=jt.prototype={constructor:It,select:function(t){"function"!==typeof t&&(t=E(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,s,a=e[r],l=a.length,c=i[r]=new Array(l),u=0;u<l;++u)(o=a[u])&&(s=t.call(o,o.__data__,u,a))&&("__data__"in o&&(s.__data__=o.__data__),c[u]=s);return new It(i,this._parents)},selectAll:function(t){t="function"===typeof t?A(t):T(t);for(var e=this._groups,n=e.length,i=[],r=[],o=0;o<n;++o)for(var s,a=e[o],l=a.length,c=0;c<l;++c)(s=a[c])&&(i.push(t.call(s,s.__data__,c,a)),r.push(s));return new It(i,r)},selectChild:function(t){return this.select(null==t?O:function(t){return function(){return L.call(this.children,t)}}("function"===typeof t?t:M(t)))},selectChildren:function(t){return this.selectAll(null==t?I:function(t){return function(){return R.call(this.children,t)}}("function"===typeof t?t:M(t)))},filter:function(t){"function"!==typeof t&&(t=k(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,s=e[r],a=s.length,l=i[r]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new It(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,D);var n,i=e?N:z,r=this._parents,o=this._groups;"function"!==typeof t&&(n=t,t=function(){return n});for(var s=o.length,a=new Array(s),l=new Array(s),c=new Array(s),u=0;u<s;++u){var h=r[u],d=o[u],f=d.length,p=B(t.call(h,h&&h.__data__,u,r)),g=p.length,m=l[u]=new Array(g),v=a[u]=new Array(g);i(h,d,m,v,c[u]=new Array(f),p,e);for(var y,b,_=0,w=0;_<g;++_)if(y=m[_]){for(_>=w&&(w=_+1);!(b=v[w])&&++w<g;);y._next=b||null}}return(a=new It(a,r))._enter=l,a._exit=c,a},enter:function(){return new It(this._enter||this._groups.map(j),this._parents)},exit:function(){return new It(this._exit||this._groups.map(j),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,o=this.exit();return"function"===typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(r=e(r))&&(r=r.selection()),null==n?o.remove():n(o),i&&r?i.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,o=i.length,s=Math.min(r,o),a=new Array(r),l=0;l<s;++l)for(var c,u=n[l],h=i[l],d=u.length,f=a[l]=new Array(d),p=0;p<d;++p)(c=u[p]||h[p])&&(f[p]=c);for(;l<r;++l)a[l]=n[l];return new It(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],o=r.length-1,s=r[o];--o>=0;)(i=r[o])&&(s&&4^i.compareDocumentPosition(s)&&s.parentNode.insertBefore(i,s),s=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=U);for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var s,a=n[o],l=a.length,c=r[o]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(e)}return new It(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var s=i[r];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,o=e[n],s=0,a=o.length;s<a;++s)(r=o[s])&&t.call(r,r.__data__,s,o);return this},attr:function(t,e){var n=H(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?X:G:"function"===typeof e?n.local?K:Y:n.local?Z:q)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?$:"function"===typeof e?tt:J)(t,e,null==n?"":n)):et(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?nt:"function"===typeof e?rt:it)(t,e)):this.node()[t]},classed:function(t,e){var n=ot(t+"");if(arguments.length<2){for(var i=st(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"===typeof e?dt:e?ut:ht)(n,e))},text:function(t){return arguments.length?this.each(null==t?ft:("function"===typeof t?gt:pt)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?mt:("function"===typeof t?yt:vt)(t)):this.node().innerHTML},raise:function(){return this.each(bt)},lower:function(){return this.each(_t)},append:function(t){var e="function"===typeof t?t:St(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"===typeof t?t:St(t),i=null==e?Pt:"function"===typeof e?e:E(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(Et)},clone:function(t){return this.select(t?Tt:Ct)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,o=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?kt:At,i=0;i<s;++i)this.each(a(o[i],e,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(i=0,l=a[c];i<s;++i)if((r=o[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"===typeof e?Ot:Lt)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,r=t[e],o=0,s=r.length;o<s;++o)(i=r[o])&&(yield i)}};const Ft=jt;var zt={value:()=>{}};function Nt(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new Dt(i)}function Dt(t){this._=t}function Bt(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function Ut(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=zt,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}Dt.prototype=Nt.prototype={constructor:Dt,on:function(t,e){var n,i,r=this._,o=(i=r,(t+"").trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!i.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),s=-1,a=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!==typeof e)throw new Error("invalid callback: "+e);for(;++s<a;)if(n=(t=o[s]).type)r[n]=Ut(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Ut(r[n],t.name,null);return this}for(;++s<a;)if((n=(t=o[s]).type)&&(n=Bt(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Dt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(i=this._[t]).length;o<n;++o)i[o].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};const Vt=Nt;var Wt,Ht,Gt=0,Xt=0,qt=0,Zt=1e3,Yt=0,Kt=0,Qt=0,$t="object"===typeof performance&&performance.now?performance:Date,Jt="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function te(){return Kt||(Jt(ee),Kt=$t.now()+Qt)}function ee(){Kt=0}function ne(){this._call=this._time=this._next=null}function ie(t,e,n){var i=new ne;return i.restart(t,e,n),i}function re(){Kt=(Yt=$t.now())+Qt,Gt=Xt=0;try{!function(){te(),++Gt;for(var t,e=Wt;e;)(t=Kt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Gt}()}finally{Gt=0,function(){var t,e,n=Wt,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Wt=e);Ht=t,se(i)}(),Kt=0}}function oe(){var t=$t.now(),e=t-Yt;e>Zt&&(Qt-=e,Yt=t)}function se(t){Gt||(Xt&&(Xt=clearTimeout(Xt)),t-Kt>24?(t<1/0&&(Xt=setTimeout(re,t-$t.now()-Qt)),qt&&(qt=clearInterval(qt))):(qt||(Yt=$t.now(),qt=setInterval(oe,Zt)),Gt=1,Jt(re)))}function ae(t,e,n){var i=new ne;return e=null==e?0:+e,i.restart((n=>{i.stop(),t(n+e)}),e,n),i}ne.prototype=ie.prototype={constructor:ne,restart:function(t,e,n){if("function"!==typeof t)throw new TypeError("callback is not a function");n=(null==n?te():+n)+(null==e?0:+e),this._next||Ht===this||(Ht?Ht._next=this:Wt=this,Ht=this),this._call=t,this._time=n,se()},stop:function(){this._call&&(this._call=null,this._time=1/0,se())}};var le=Vt("start","end","cancel","interrupt"),ce=[],ue=0,he=1,de=2,fe=3,pe=4,ge=5,me=6;function ve(t,e,n,i,r,o){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function o(t){n.state=he,n.timer.restart(s,n.delay,n.time),n.delay<=t&&s(t-n.delay)}function s(o){var c,u,h,d;if(n.state!==he)return l();for(c in r)if((d=r[c]).name===n.name){if(d.state===fe)return ae(s);d.state===pe?(d.state=me,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=me,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(ae((function(){n.state===fe&&(n.state=pe,n.timer.restart(a,n.delay,n.time),a(o))})),n.state=de,n.on.call("start",t,t.__data__,n.index,n.group),n.state===de){for(n.state=fe,i=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++u]=d);i.length=u+1}}function a(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=ge,1),o=-1,s=i.length;++o<s;)i[o].call(t,r);n.state===ge&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var i in n.state=me,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=ie(o,0,n.time)}(t,n,{name:e,index:i,group:r,on:le,tween:ce,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:ue})}function ye(t,e){var n=_e(t,e);if(n.state>ue)throw new Error("too late; already scheduled");return n}function be(t,e){var n=_e(t,e);if(n.state>fe)throw new Error("too late; already running");return n}function _e(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function we(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var xe,Se=180/Math.PI,Pe={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ee(t,e,n,i,r,o){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),t*i<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*Se,skewX:Math.atan(l)*Se,scaleX:s,scaleY:a}}function Ce(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],l=[];return o=t(o),s=t(s),function(t,i,r,o,s,a){if(t!==r||i!==o){var l=s.push("translate(",null,e,null,n);a.push({i:l-4,x:we(t,r)},{i:l-2,x:we(i,o)})}else(r||o)&&s.push("translate("+r+e+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(r(n)+"rotate(",null,i)-2,x:we(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}(o.rotate,s.rotate,a,l),function(t,e,n,o){t!==e?o.push({i:n.push(r(n)+"skewX(",null,i)-2,x:we(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}(o.skewX,s.skewX,a,l),function(t,e,n,i,o,s){if(t!==n||e!==i){var a=o.push(r(o)+"scale(",null,",",null,")");s.push({i:a-4,x:we(t,n)},{i:a-2,x:we(e,i)})}else 1===n&&1===i||o.push(r(o)+"scale("+n+","+i+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(t){for(var e,n=-1,i=l.length;++n<i;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var Te=Ce((function(t){const e=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Pe:Ee(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),Ae=Ce((function(t){return null==t?Pe:(xe||(xe=document.createElementNS("http://www.w3.org/2000/svg","g")),xe.setAttribute("transform",t),(t=xe.transform.baseVal.consolidate())?Ee((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Pe)}),", ",")",")");function ke(t,e){var n,i;return function(){var r=be(this,t),o=r.tween;if(o!==n)for(var s=0,a=(i=n=o).length;s<a;++s)if(i[s].name===e){(i=i.slice()).splice(s,1);break}r.tween=i}}function Me(t,e,n){var i,r;if("function"!==typeof n)throw new Error;return function(){var o=be(this,t),s=o.tween;if(s!==i){r=(i=s).slice();for(var a={name:e,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=a;break}l===c&&r.push(a)}o.tween=r}}function Le(t,e,n){var i=t._id;return t.each((function(){var t=be(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return _e(t,i).value[e]}}function Oe(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Re(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Ie(){}var je=.7,Fe=1/je,ze="\\s*([+-]?\\d+)\\s*",Ne="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",De="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Be=/^#([0-9a-f]{3,8})$/,Ue=new RegExp("^rgb\\(".concat(ze,",").concat(ze,",").concat(ze,"\\)$")),Ve=new RegExp("^rgb\\(".concat(De,",").concat(De,",").concat(De,"\\)$")),We=new RegExp("^rgba\\(".concat(ze,",").concat(ze,",").concat(ze,",").concat(Ne,"\\)$")),He=new RegExp("^rgba\\(".concat(De,",").concat(De,",").concat(De,",").concat(Ne,"\\)$")),Ge=new RegExp("^hsl\\(".concat(Ne,",").concat(De,",").concat(De,"\\)$")),Xe=new RegExp("^hsla\\(".concat(Ne,",").concat(De,",").concat(De,",").concat(Ne,"\\)$")),qe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ze(){return this.rgb().formatHex()}function Ye(){return this.rgb().formatRgb()}function Ke(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Be.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Qe(e):3===n?new tn(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?$e(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?$e(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Ue.exec(t))?new tn(e[1],e[2],e[3],1):(e=Ve.exec(t))?new tn(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=We.exec(t))?$e(e[1],e[2],e[3],e[4]):(e=He.exec(t))?$e(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ge.exec(t))?an(e[1],e[2]/100,e[3]/100,1):(e=Xe.exec(t))?an(e[1],e[2]/100,e[3]/100,e[4]):qe.hasOwnProperty(t)?Qe(qe[t]):"transparent"===t?new tn(NaN,NaN,NaN,0):null}function Qe(t){return new tn(t>>16&255,t>>8&255,255&t,1)}function $e(t,e,n,i){return i<=0&&(t=e=n=NaN),new tn(t,e,n,i)}function Je(t,e,n,i){return 1===arguments.length?((r=t)instanceof Ie||(r=Ke(r)),r?new tn((r=r.rgb()).r,r.g,r.b,r.opacity):new tn):new tn(t,e,n,null==i?1:i);var r}function tn(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function en(){return"#".concat(sn(this.r)).concat(sn(this.g)).concat(sn(this.b))}function nn(){const t=rn(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(on(this.r),", ").concat(on(this.g),", ").concat(on(this.b)).concat(1===t?")":", ".concat(t,")"))}function rn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function on(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function sn(t){return((t=on(t))<16?"0":"")+t.toString(16)}function an(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new cn(t,e,n,i)}function ln(t){if(t instanceof cn)return new cn(t.h,t.s,t.l,t.opacity);if(t instanceof Ie||(t=Ke(t)),!t)return new cn;if(t instanceof cn)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),s=NaN,a=o-r,l=(o+r)/2;return a?(s=e===o?(n-i)/a+6*(n<i):n===o?(i-e)/a+2:(e-n)/a+4,a/=l<.5?o+r:2-o-r,s*=60):a=l>0&&l<1?0:s,new cn(s,a,l,t.opacity)}function cn(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function un(t){return(t=(t||0)%360)<0?t+360:t}function hn(t){return Math.max(0,Math.min(1,t||0))}function dn(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function fn(t,e,n,i,r){var o=t*t,s=o*t;return((1-3*t+3*o-s)*e+(4-6*o+3*s)*n+(1+3*t+3*o-3*s)*i+s*r)/6}Oe(Ie,Ke,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Ze,formatHex:Ze,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return ln(this).formatHsl()},formatRgb:Ye,toString:Ye}),Oe(tn,Je,Re(Ie,{brighter(t){return t=null==t?Fe:Math.pow(Fe,t),new tn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?je:Math.pow(je,t),new tn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new tn(on(this.r),on(this.g),on(this.b),rn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:en,formatHex:en,formatHex8:function(){return"#".concat(sn(this.r)).concat(sn(this.g)).concat(sn(this.b)).concat(sn(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:nn,toString:nn})),Oe(cn,(function(t,e,n,i){return 1===arguments.length?ln(t):new cn(t,e,n,null==i?1:i)}),Re(Ie,{brighter(t){return t=null==t?Fe:Math.pow(Fe,t),new cn(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?je:Math.pow(je,t),new cn(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new tn(dn(t>=240?t-240:t+120,r,i),dn(t,r,i),dn(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new cn(un(this.h),hn(this.s),hn(this.l),rn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=rn(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(un(this.h),", ").concat(100*hn(this.s),"%, ").concat(100*hn(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));const pn=t=>()=>t;function gn(t,e){return function(n){return t+n*e}}function mn(t){return 1===(t=+t)?vn:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):pn(isNaN(e)?n:e)}}function vn(t,e){var n=e-t;return n?gn(t,n):pn(isNaN(t)?e:t)}const yn=function t(e){var n=mn(e);function i(t,e){var i=n((t=Je(t)).r,(e=Je(e)).r),r=n(t.g,e.g),o=n(t.b,e.b),s=vn(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=o(e),t.opacity=s(e),t+""}}return i.gamma=t,i}(1);function bn(t){return function(e){var n,i,r=e.length,o=new Array(r),s=new Array(r),a=new Array(r);for(n=0;n<r;++n)i=Je(e[n]),o[n]=i.r||0,s[n]=i.g||0,a[n]=i.b||0;return o=t(o),s=t(s),a=t(a),i.opacity=1,function(t){return i.r=o(t),i.g=s(t),i.b=a(t),i+""}}}bn((function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],o=t[i+1],s=i>0?t[i-1]:2*r-o,a=i<e-1?t[i+2]:2*o-r;return fn((n-i/e)*e,s,r,o,a)}})),bn((function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],o=t[i%e],s=t[(i+1)%e],a=t[(i+2)%e];return fn((n-i/e)*e,r,o,s,a)}}));var _n=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,wn=new RegExp(_n.source,"g");function xn(t,e){var n,i,r,o=_n.lastIndex=wn.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(n=_n.exec(t))&&(i=wn.exec(e));)(r=i.index)>o&&(r=e.slice(o,r),a[s]?a[s]+=r:a[++s]=r),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,l.push({i:s,x:we(n,i)})),o=wn.lastIndex;return o<e.length&&(r=e.slice(o),a[s]?a[s]+=r:a[++s]=r),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)a[(n=l[i]).i]=n.x(t);return a.join("")})}function Sn(t,e){var n;return("number"===typeof e?we:e instanceof Ke?yn:(n=Ke(e))?(e=n,yn):xn)(t,e)}function Pn(t){return function(){this.removeAttribute(t)}}function En(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Cn(t,e,n){var i,r,o=n+"";return function(){var s=this.getAttribute(t);return s===o?null:s===i?r:r=e(i=s,n)}}function Tn(t,e,n){var i,r,o=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===i?r:r=e(i=s,n)}}function An(t,e,n){var i,r,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(t))===(a=l+"")?null:s===i&&a===r?o:(r=a,o=e(i=s,l));this.removeAttribute(t)}}function kn(t,e,n){var i,r,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:s===i&&a===r?o:(r=a,o=e(i=s,l));this.removeAttributeNS(t.space,t.local)}}function Mn(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,r)),n}return r._value=e,r}function Ln(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,r)),n}return r._value=e,r}function On(t,e){return function(){ye(this,t).delay=+e.apply(this,arguments)}}function Rn(t,e){return e=+e,function(){ye(this,t).delay=e}}function In(t,e){return function(){be(this,t).duration=+e.apply(this,arguments)}}function jn(t,e){return e=+e,function(){be(this,t).duration=e}}var Fn=Ft.prototype.constructor;function zn(t){return function(){this.style.removeProperty(t)}}var Nn=0;function Dn(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function Bn(){return++Nn}var Un=Ft.prototype;Dn.prototype=function(t){return Ft().transition(t)}.prototype={constructor:Dn,select:function(t){var e=this._name,n=this._id;"function"!==typeof t&&(t=E(t));for(var i=this._groups,r=i.length,o=new Array(r),s=0;s<r;++s)for(var a,l,c=i[s],u=c.length,h=o[s]=new Array(u),d=0;d<u;++d)(a=c[d])&&(l=t.call(a,a.__data__,d,c))&&("__data__"in a&&(l.__data__=a.__data__),h[d]=l,ve(h[d],e,n,d,h,_e(a,n)));return new Dn(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!==typeof t&&(t=T(t));for(var i=this._groups,r=i.length,o=[],s=[],a=0;a<r;++a)for(var l,c=i[a],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var d,f=t.call(l,l.__data__,h,c),p=_e(l,n),g=0,m=f.length;g<m;++g)(d=f[g])&&ve(d,e,n,g,f,p);o.push(f),s.push(l)}return new Dn(o,s,e,n)},selectChild:Un.selectChild,selectChildren:Un.selectChildren,filter:function(t){"function"!==typeof t&&(t=k(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,s=e[r],a=s.length,l=i[r]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new Dn(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),s=new Array(i),a=0;a<o;++a)for(var l,c=e[a],u=n[a],h=c.length,d=s[a]=new Array(h),f=0;f<h;++f)(l=c[f]||u[f])&&(d[f]=l);for(;a<i;++a)s[a]=e[a];return new Dn(s,this._parents,this._name,this._id)},selection:function(){return new Fn(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Bn(),i=this._groups,r=i.length,o=0;o<r;++o)for(var s,a=i[o],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=_e(s,e);ve(s,t,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Dn(i,this._parents,t,n)},call:Un.call,nodes:Un.nodes,node:Un.node,size:Un.size,empty:Un.empty,each:Un.each,on:function(t,e){var n=this._id;return arguments.length<2?_e(this.node(),n).on.on(t):this.each(function(t,e,n){var i,r,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?ye:be;return function(){var s=o(this,t),a=s.on;a!==i&&(r=(i=a).copy()).on(e,n),s.on=r}}(n,t,e))},attr:function(t,e){var n=H(t),i="transform"===n?Ae:Sn;return this.attrTween(t,"function"===typeof e?(n.local?kn:An)(n,i,Le(this,"attr."+t,e)):null==e?(n.local?En:Pn)(n):(n.local?Tn:Cn)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!==typeof e)throw new Error;var i=H(t);return this.tween(n,(i.local?Mn:Ln)(i,e))},style:function(t,e,n){var i="transform"===(t+="")?Te:Sn;return null==e?this.styleTween(t,function(t,e){var n,i,r;return function(){var o=et(this,t),s=(this.style.removeProperty(t),et(this,t));return o===s?null:o===n&&s===i?r:r=e(n=o,i=s)}}(t,i)).on("end.style."+t,zn(t)):"function"===typeof e?this.styleTween(t,function(t,e,n){var i,r,o;return function(){var s=et(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=et(this,t)),s===l?null:s===i&&l===r?o:(r=l,o=e(i=s,a))}}(t,i,Le(this,"style."+t,e))).each(function(t,e){var n,i,r,o,s="style."+e,a="end."+s;return function(){var l=be(this,t),c=l.on,u=null==l.value[s]?o||(o=zn(e)):void 0;c===n&&r===u||(i=(n=c).copy()).on(a,r=u),l.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,r,o=n+"";return function(){var s=et(this,t);return s===o?null:s===i?r:r=e(i=s,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!==typeof e)throw new Error;return this.tween(i,function(t,e,n){var i,r;function o(){var o=e.apply(this,arguments);return o!==r&&(i=(r=o)&&function(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}(t,o,n)),i}return o._value=e,o}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"===typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Le(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!==typeof t)throw new Error;return this.tween(e,function(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&function(t){return function(e){this.textContent=t.call(this,e)}}(i)),e}return i._value=t,i}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=_e(this.node(),n).tween,o=0,s=r.length;o<s;++o)if((i=r[o]).name===t)return i.value;return null}return this.each((null==e?ke:Me)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"===typeof t?On:Rn)(e,t)):_e(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"===typeof t?In:jn)(e,t)):_e(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!==typeof e)throw new Error;return function(){be(this,t).ease=e}}(e,t)):_e(this.node(),e).ease},easeVarying:function(t){if("function"!==typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!==typeof n)throw new Error;be(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise((function(o,s){var a={value:s},l={value:function(){0===--r&&o()}};n.each((function(){var n=be(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e})),0===r&&o()}))},[Symbol.iterator]:Un[Symbol.iterator]};var Vn={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Wn(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error("transition ".concat(e," not found"));return n}Ft.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,i,r,o=t.__transition,s=!0;if(o){for(r in e=null==e?null:e+"",o)(n=o[r]).name===e?(i=n.state>de&&n.state<ge,n.state=me,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[r]):s=!1;s&&delete t.__transition}}(this,t)}))},Ft.prototype.transition=function(t){var e,n;t instanceof Dn?(e=t._id,t=t._name):(e=Bn(),(n=Vn).time=te(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var s,a=i[o],l=a.length,c=0;c<l;++c)(s=a[c])&&ve(s,t,e,c,a,n||Wn(s,e));return new Dn(i,this._parents,t,e)};const{abs:Hn,max:Gn,min:Xn}=Math;function qn(t){return[+t[0],+t[1]]}function Zn(t){return[qn(t[0]),qn(t[1])]}["w","e"].map(Yn),["n","s"].map(Yn),["n","w","e","s","nw","ne","sw","se"].map(Yn);function Yn(t){return{type:t}}function Kn(t){return"string"===typeof t?new It([[document.querySelector(t)]],[document.documentElement]):new It([[t]],Rt)}function Qn(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,[(i=i.matrixTransform(e.getScreenCTM().inverse())).x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}const $n={passive:!1},Jn={capture:!0,passive:!1};function ti(t){t.stopImmediatePropagation()}function ei(t){t.preventDefault(),t.stopImmediatePropagation()}const ni=t=>()=>t;function ii(t,e){let{sourceEvent:n,subject:i,target:r,identifier:o,active:s,x:a,y:l,dx:c,dy:u,dispatch:h}=e;Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:i,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:h}})}function ri(t){return!t.ctrlKey&&!t.button}function oi(){return this.parentNode}function si(t,e){return null==e?{x:t.x,y:t.y}:e}function ai(){return navigator.maxTouchPoints||"ontouchstart"in this}function li(){var t,e,n,i,r=ri,o=oi,s=si,a=ai,l={},c=Vt("start","drag","end"),u=0,h=0;function d(t){t.on("mousedown.drag",f).filter(a).on("touchstart.drag",m).on("touchmove.drag",v,$n).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(s,a){if(!i&&r.call(this,s,a)){var l=b(this,o.call(this,s,a),s,a,"mouse");l&&(Kn(s.view).on("mousemove.drag",p,Jn).on("mouseup.drag",g,Jn),function(t){var e=t.document.documentElement,n=Kn(t).on("dragstart.drag",ei,Jn);"onselectstart"in e?n.on("selectstart.drag",ei,Jn):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}(s.view),ti(s),n=!1,t=s.clientX,e=s.clientY,l("start",s))}}function p(i){if(ei(i),!n){var r=i.clientX-t,o=i.clientY-e;n=r*r+o*o>h}l.mouse("drag",i)}function g(t){Kn(t.view).on("mousemove.drag mouseup.drag",null),function(t,e){var n=t.document.documentElement,i=Kn(t).on("dragstart.drag",null);e&&(i.on("click.drag",ei,Jn),setTimeout((function(){i.on("click.drag",null)}),0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(t.view,n),ei(t),l.mouse("end",t)}function m(t,e){if(r.call(this,t,e)){var n,i,s=t.changedTouches,a=o.call(this,t,e),l=s.length;for(n=0;n<l;++n)(i=b(this,a,t,e,s[n].identifier,s[n]))&&(ti(t),i("start",t,s[n]))}}function v(t){var e,n,i=t.changedTouches,r=i.length;for(e=0;e<r;++e)(n=l[i[e].identifier])&&(ei(t),n("drag",t,i[e]))}function y(t){var e,n,r=t.changedTouches,o=r.length;for(i&&clearTimeout(i),i=setTimeout((function(){i=null}),500),e=0;e<o;++e)(n=l[r[e].identifier])&&(ti(t),n("end",t,r[e]))}function b(t,e,n,i,r,o){var a,h,f,p=c.copy(),g=Qn(o||n,e);if(null!=(f=s.call(t,new ii("beforestart",{sourceEvent:n,target:d,identifier:r,active:u,x:g[0],y:g[1],dx:0,dy:0,dispatch:p}),i)))return a=f.x-g[0]||0,h=f.y-g[1]||0,function n(o,s,c){var m,v=g;switch(o){case"start":l[r]=n,m=u++;break;case"end":delete l[r],--u;case"drag":g=Qn(c||s,e),m=u}p.call(o,t,new ii(o,{sourceEvent:s,subject:f,target:d,identifier:r,active:m,x:g[0]+a,y:g[1]+h,dx:g[0]-v[0],dy:g[1]-v[1],dispatch:p}),i)}}return d.filter=function(t){return arguments.length?(r="function"===typeof t?t:ni(!!t),d):r},d.container=function(t){return arguments.length?(o="function"===typeof t?t:ni(t),d):o},d.subject=function(t){return arguments.length?(s="function"===typeof t?t:ni(t),d):s},d.touchable=function(t){return arguments.length?(a="function"===typeof t?t:ni(!!t),d):a},d.on=function(){var t=c.on.apply(c,arguments);return t===c?d:t},d.clickDistance=function(t){return arguments.length?(h=(t=+t)*t,d):Math.sqrt(h)},d}ii.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};const ci=Math.sqrt(50),ui=Math.sqrt(10),hi=Math.sqrt(2);function di(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),o=i/Math.pow(10,r),s=o>=ci?10:o>=ui?5:o>=hi?2:1;let a,l,c;return r<0?(c=Math.pow(10,-r)/s,a=Math.round(t*c),l=Math.round(e*c),a/c<t&&++a,l/c>e&&--l,c=-c):(c=Math.pow(10,r)*s,a=Math.round(t/c),l=Math.round(e/c),a*c<t&&++a,l*c>e&&--l),l<a&&.5<=n&&n<2?di(t,e,2*n):[a,l,c]}function fi(t,e,n){return di(t=+t,e=+e,n=+n)[2]}function pi(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function gi(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function mi(t){let e,n,i;function r(t,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(r<o){if(0!==e(i,i))return o;do{const e=r+o>>>1;n(t[e],i)<0?r=e+1:o=e}while(r<o)}return r}return 2!==t.length?(e=pi,n=(e,n)=>pi(t(e),n),i=(e,n)=>t(e)-n):(e=t===pi||t===gi?t:vi,n=t,i=t),{left:r,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=r(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return o>n&&i(t[o-1],e)>-i(t[o],e)?o-1:o},right:function(t,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(r<o){if(0!==e(i,i))return o;do{const e=r+o>>>1;n(t[e],i)<=0?r=e+1:o=e}while(r<o)}return r}}}function vi(){return 0}const yi=mi(pi),bi=yi.right,_i=(yi.left,mi((function(t){return null===t?NaN:+t})).center,bi);function wi(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,o=new Array(r),s=new Array(i);for(n=0;n<r;++n)o[n]=Ei(t[n],e[n]);for(;n<i;++n)s[n]=e[n];return function(t){for(n=0;n<r;++n)s[n]=o[n](t);return s}}function xi(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function Si(t,e){var n,i={},r={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?i[n]=Ei(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}function Pi(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(o){for(n=0;n<i;++n)r[n]=t[n]*(1-o)+e[n]*o;return r}}function Ei(t,e){var n,i,r=typeof e;return null==e||"boolean"===r?pn(e):("number"===r?we:"string"===r?(n=Ke(e))?(e=n,yn):xn:e instanceof Ke?yn:e instanceof Date?xi:(i=e,!ArrayBuffer.isView(i)||i instanceof DataView?Array.isArray(e)?wi:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?Si:we:Pi))(t,e)}function Ci(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Ti(t){return+t}var Ai=[0,1];function ki(t){return t}function Mi(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Li(t,e,n){var i=t[0],r=t[1],o=e[0],s=e[1];return r<i?(i=Mi(r,i),o=n(s,o)):(i=Mi(i,r),o=n(o,s)),function(t){return o(i(t))}}function Oi(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),o=new Array(i),s=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<i;)r[s]=Mi(t[s],t[s+1]),o[s]=n(e[s],e[s+1]);return function(e){var n=_i(t,e,1,i)-1;return o[n](r[n](e))}}function Ri(){var t,e,n,i,r,o,s=Ai,a=Ai,l=Ei,c=ki;function u(){var t=Math.min(s.length,a.length);return c!==ki&&(c=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(s[0],s[t-1])),i=t>2?Oi:Li,r=o=null,h}function h(e){return null==e||isNaN(e=+e)?n:(r||(r=i(s.map(t),a,l)))(t(c(e)))}return h.invert=function(n){return c(e((o||(o=i(a,s.map(t),we)))(n)))},h.domain=function(t){return arguments.length?(s=Array.from(t,Ti),u()):s.slice()},h.range=function(t){return arguments.length?(a=Array.from(t),u()):a.slice()},h.rangeRound=function(t){return a=Array.from(t),l=Ci,u()},h.clamp=function(t){return arguments.length?(c=!!t||ki,u()):c!==ki},h.interpolate=function(t){return arguments.length?(l=t,u()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,i){return t=n,e=i,u()}}function Ii(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}var ji,Fi=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function zi(t){if(!(e=Fi.exec(t)))throw new Error("invalid format: "+t);var e;return new Ni({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Ni(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Di(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function Bi(t){return(t=Di(Math.abs(t)))?t[1]:NaN}function Ui(t,e){var n=Di(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}zi.prototype=Ni.prototype,Ni.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Vi={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Ui(100*t,e),r:Ui,s:function(t,e){var n=Di(t,e);if(!n)return t+"";var i=n[0],r=n[1],o=r-(ji=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,s=i.length;return o===s?i:o>s?i+new Array(o-s+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+Di(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Wi(t){return t}var Hi,Gi,Xi,qi=Array.prototype.map,Zi=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Yi(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?Wi:(e=qi.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,o=[],s=0,a=e[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),o.push(t.substring(r-=a,r+a)),!((l+=a+1)>i));)a=e[s=(s+1)%e.length];return o.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?Wi:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(qi.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"\u2212":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=zi(t)).fill,n=t.align,h=t.sign,d=t.symbol,f=t.zero,p=t.width,g=t.comma,m=t.precision,v=t.trim,y=t.type;"n"===y?(g=!0,y="g"):Vi[y]||(void 0===m&&(m=12),v=!0,y="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var b="$"===d?r:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",_="$"===d?o:/[%p]/.test(y)?l:"",w=Vi[y],x=/[defgprs%]/.test(y);function S(t){var r,o,l,d=b,S=_;if("c"===y)S=w(t)+S,t="";else{var P=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:w(Math.abs(t),m),v&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),P&&0===+t&&"+"!==h&&(P=!1),d=(P?"("===h?h:c:"-"===h||"("===h?"":h)+d,S=("s"===y?Zi[8+ji/3]:"")+S+(P&&"("===h?")":""),x)for(r=-1,o=t.length;++r<o;)if(48>(l=t.charCodeAt(r))||l>57){S=(46===l?s+t.slice(r+1):t.slice(r))+S,t=t.slice(0,r);break}}g&&!f&&(t=i(t,1/0));var E=d.length+t.length+S.length,C=E<p?new Array(p-E+1).join(e):"";switch(g&&f&&(t=i(C+t,C.length?p-S.length:1/0),C=""),n){case"<":t=d+t+S+C;break;case"=":t=d+C+t+S;break;case"^":t=C.slice(0,E=C.length>>1)+d+t+S+C.slice(E);break;default:t=C+d+t+S}return a(t)}return m=void 0===m?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),S.toString=function(){return t+""},S}return{format:h,formatPrefix:function(t,e){var n=h(((t=zi(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(Bi(e)/3))),r=Math.pow(10,-i),o=Zi[8+i/3];return function(t){return n(r*t)+o}}}}function Ki(t,e,n,i){var r,o=function(t,e,n){n=+n;const i=(e=+e)<(t=+t),r=i?fi(e,t,n):fi(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}(t,e,n);switch((i=zi(null==i?",f":i)).type){case"s":var s=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Bi(e)/3)))-Bi(Math.abs(t)))}(o,s))||(i.precision=r),Xi(i,s);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Bi(e)-Bi(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=function(t){return Math.max(0,-Bi(Math.abs(t)))}(o))||(i.precision=r-2*("%"===i.type))}return Gi(i)}function Qi(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){if(!((n=+n)>0))return[];if((t=+t)===(e=+e))return[t];const i=e<t,[r,o,s]=i?di(e,t,n):di(t,e,n);if(!(o>=r))return[];const a=o-r+1,l=new Array(a);if(i)if(s<0)for(let c=0;c<a;++c)l[c]=(o-c)/-s;else for(let c=0;c<a;++c)l[c]=(o-c)*s;else if(s<0)for(let c=0;c<a;++c)l[c]=(r+c)/-s;else for(let c=0;c<a;++c)l[c]=(r+c)*s;return l}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return Ki(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,r,o=e(),s=0,a=o.length-1,l=o[s],c=o[a],u=10;for(c<l&&(r=l,l=c,c=r,r=s,s=a,a=r);u-- >0;){if((r=fi(l,c,n))===i)return o[s]=l,o[a]=c,e(o);if(r>0)l=Math.floor(l/r)*r,c=Math.ceil(c/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,c=Math.floor(c*r)/r}i=r}return t},t}function $i(){var t=Ri()(ki,ki);return t.copy=function(){return function(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}(t,$i())},Ii.apply(t,arguments),Qi(t)}function Ji(t,e,n){this.k=t,this.x=e,this.y=n}Hi=Yi({thousands:",",grouping:[3],currency:["$",""]}),Gi=Hi.format,Xi=Hi.formatPrefix,Ji.prototype={constructor:Ji,scale:function(t){return 1===t?this:new Ji(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Ji(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new Ji(1,0,0);Ji.prototype;const tr=t=>{let{xScale:e,minBound:n,maxBound:r,innerWidth:o,innerHeight:s}=t;const{parcelsData:a}=_();if(!a)return(0,i.jsx)(i.Fragment,{});const l=((t,e,n,i)=>{let r={},o=e;for(;o<=n;){const e=o-i,n=t.filter((t=>e<t.area&&t.area<o)),s=n.length,a=n.filter((t=>0===t.constructed_area)).length;r[o]={totalLength:s,freeLength:a,constructedLength:s-a},o+=i}return r})(a.filter((t=>t.area<r)),n,r,50),c=Object.values(l).map((t=>t.totalLength)),u=S(c),h=x(c),d=$i().domain([u,h]).range([0,s]),f=o/c.length;return(0,i.jsxs)(i.Fragment,{children:[Object.keys(l).slice(0,-1).map((t=>{const n=l[t].freeLength;return(0,i.jsx)("rect",{x:e(t)+1,y:s-d(n),width:f-2,height:d(n),fill:"rgba(126, 126, 132, 0.6)"},t)})),Object.keys(l).slice(0,-1).map((t=>{const n=l[t].freeLength,r=l[t].constructedLength;return(0,i.jsx)("rect",{x:e(t)+1,y:s-d(r)-d(n),width:f-2,height:d(r),fill:"rgba(126, 126, 132, 0.6)"},t)}))]})};tr.displayName="Bars";const er=t=>{let{xScale:e,innerHeight:n,leftPosition:r,rightPosition:o,activeForeground:s}=t;return(0,i.jsx)("rect",{x:e(r),width:e(o)-e(r),height:n,fill:s?"rgba(126, 126, 132, 0.2)":"none"})};er.displayName="Foreground";const nr=e=>{let{xScale:n,minBound:r,maxBound:o,innerWidth:s,innerHeight:a,leftPosition:l,setLeftPosition:c,rightPosition:u,setRightPosition:h,setActiveForeground:d}=e;const f=(0,t.useRef)(null),p=t=>{const e=n.invert(t.x),i=Math.abs(u-e),s=Math.abs(l-e);f.current=i<s?"right":"left";const a=e<r?r:e>u?u:e,d=e>o?o:e<l?l:e;"left"===f.current?c(+a):h(+d)},g=t=>{const e=n.invert(t.x),i=e<r?r:e>u?u:e,s=e>o?o:e<l?l:e;"left"===f.current?c(+i):h(+s)},m=(0,t.useCallback)((t=>{const e=li().on("start",p).on("drag",g);Kn(t).call(e)}),[u,l]);return(0,i.jsx)("rect",{ref:m,width:s,height:a,fill:"transparent",onMouseOver:()=>{d(!0)},onMouseLeave:()=>{d(!1)}})};nr.displayName="Wrapper";const ir=(0,t.createContext)(null),rr=()=>(0,t.useContext)(ir),or=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(100),[s,a]=(0,t.useState)(1200),[l,c]=(0,t.useState)(100),[u,h]=(0,t.useState)(1200),[d,f]=(0,t.useState)(1200);return(0,t.useEffect)((()=>{d<u&&h(d),d<l&&c(d)}),[d]),(0,t.useEffect)((()=>{a(u)}),[u]),(0,t.useEffect)((()=>{o(l)}),[l]),(0,i.jsx)(ir.Provider,{value:{parcelAreaFrom:r,setParcelAreaFrom:o,parcelAreaTo:s,setParcelAreaTo:a,leftPosition:l,setLeftPosition:c,rightPosition:u,setRightPosition:h,minBound:100,maxBound:d,setMaxBound:f},children:n})};ir.displayName="ParcelDimensionsContext";const sr=t=>{let{activeForeground:e,setActiveForeground:n}=t;const{innerWidth:r,innerHeight:o}=s(),{minBound:a,maxBound:c,leftPosition:u,setLeftPosition:h,rightPosition:d,setRightPosition:f}=rr(),p=$i().domain([a,c]).range([20,r-20]);return(0,i.jsx)("div",{style:{overflow:"hidden"},children:(0,i.jsxs)(l,{children:[(0,i.jsx)(tr,{xScale:p,minBound:a,maxBound:c,innerWidth:r,innerHeight:o}),(0,i.jsx)(er,{xScale:p,innerHeight:o,leftPosition:u,rightPosition:d,activeForeground:e}),(0,i.jsx)(nr,{xScale:p,innerWidth:r,innerHeight:o,leftPosition:u,rightPosition:d,setLeftPosition:h,setRightPosition:f,minBound:a,maxBound:c,setActiveForeground:n})]})})};sr.displayName="Graphics";const ar=(0,t.createContext)(null),lr=()=>(0,t.useContext)(ar),cr=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(null),[s,a]=(0,t.useState)(null),l={top:0,bottom:10,left:0,right:0},c=r-l.right-l.left,u=s-l.top-l.bottom;return(0,i.jsx)(ar.Provider,{value:{margin:l,width:r,height:s,setWidth:o,setHeight:a,innerWidth:c,innerHeight:u},children:n})};ar.displayName="ParcelSliderSizesContext";const ur=e=>{let{children:n}=e;const{margin:r,width:o,height:s,setWidth:a,setHeight:l}=lr(),c=(0,t.useCallback)((t=>{t&&(a(t.getBoundingClientRect().width),l(t.getBoundingClientRect().height))}),[]);return(0,i.jsx)("div",{ref:c,style:{width:"100%",height:"100%"},children:o&&(0,i.jsx)("svg",{viewBox:"0 0 ".concat(o," ").concat(s),preserveAspectRatio:"none",children:(0,i.jsx)("g",{transform:"translate(".concat(r.left,", ").concat(r.top,")"),children:t.Children.map(n,((e,n)=>(0,t.cloneElement)(e,{width:"100%"})))})})})};ur.displayName="SVGWrapper";const hr=t=>{let{xScale:e,circleRadius:n,currentPosition:r}=t;const o=r>99999?25:r>9999?22:r>999?17:14;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("polygon",{points:"\n\t\t\t\t\t".concat(e(r)," ").concat(2*n,", \n\t\t\t\t\t").concat(e(r)-6," ").concat(3*n,", \n\t\t\t\t\t").concat(e(r)+6," ").concat(3*n,"\n\t\t\t\t"),fill:"rgba(126, 126, 132, 1)"}),(0,i.jsx)("rect",{x:e(r)-o,y:3*n,rx:2,ry:2,width:2*o,height:3*n,fill:"rgba(23, 23, 32, 1)",strokeWidth:2,stroke:"rgba(126, 126, 132, 1)"}),(0,i.jsx)("text",{x:e(r),y:5*n,fill:"rgba(255, 255, 255, 1)",textAnchor:"middle",fontSize:"0.8em",children:Math.round(r)})]})};hr.displayName="Legend";const dr=t=>{let{xScale:e,minBound:n,maxBound:r,circleRadius:o}=t;return(0,i.jsx)("rect",{x:e(n),y:o/2,rx:o/2,ry:o/2,width:e(r)-e(n),height:o,fill:"rgba(126, 126, 132, 0.4)",stroke:"rgba(126, 126, 132, 0.4)",strokeWidth:"1px"})};dr.displayName="Background";const fr=t=>{let{xScale:e,leftPosition:n,rightPosition:r,circleRadius:o,activeForeground:s}=t;return(0,i.jsx)("rect",{x:e(n),y:o/2,rx:o/2,ry:o/2,width:e(r)-e(n),height:o,fill:s?"rgba(255, 255, 255, 0.5)":"rgba(255, 255, 255, 0.3)"})};fr.displayName="Foreground";const pr=t=>{let{activeForeground:e,cx:n,cy:r,r:o}=t;return(0,i.jsx)("circle",{cx:n,cy:o,r:e?o:o-1,fill:"rgba(255, 255, 255, 1)",strokeWidth:0})};pr.displayName="Handler";const gr=e=>{let{xScale:n,minBound:r,maxBound:o,innerWidth:s,innerHeight:a,leftPosition:l,setLeftPosition:c,rightPosition:u,setRightPosition:h,setActiveForeground:d}=e;const f=(0,t.useRef)(null),p=t=>{const e=n.invert(t.x),i=Math.abs(u-e),s=Math.abs(l-e);f.current=i<s?"right":"left";const a=e<r?r:e>u?u:e,d=e>o?o:e<l?l:e;"left"===f.current?c(+a):h(+d)},g=t=>{const e=n.invert(t.x),i=e<r?r:e>u?u:e,s=e>o?o:e<l?l:e;"left"===f.current?c(+i):h(+s)},m=(0,t.useCallback)((t=>{const e=li().on("start",p).on("drag",g);Kn(t).call(e)}),[u,l]);return(0,i.jsx)("rect",{ref:m,width:s,height:a,fill:"transparent",onMouseOver:()=>{d(!0)},onMouseLeave:()=>{d(!1)}})};gr.displayName="Wrapper";const mr=t=>{let{activeForeground:e,setActiveForeground:n}=t;const{innerWidth:r,innerHeight:o}=lr(),{minBound:s,maxBound:a,leftPosition:l,setLeftPosition:c,rightPosition:u,setRightPosition:h}=rr(),d=o/6,f=$i().domain([s,a]).range([20,r-20]);return(0,i.jsxs)(ur,{children:[(0,i.jsx)(hr,{xScale:f,circleRadius:d,currentPosition:l}),(0,i.jsx)(hr,{xScale:f,circleRadius:d,currentPosition:u}),(0,i.jsx)(dr,{xScale:f,minBound:s,maxBound:a,circleRadius:d}),(0,i.jsx)(fr,{xScale:f,leftPosition:l,rightPosition:u,circleRadius:d,activeForeground:e}),(0,i.jsx)(pr,{activeForeground:e,cx:f(l),cy:d,r:d}),(0,i.jsx)(pr,{activeForeground:e,cx:f(u),cy:d,r:d}),(0,i.jsx)(gr,{xScale:f,innerWidth:r,innerHeight:o,leftPosition:l,rightPosition:u,setLeftPosition:c,setRightPosition:h,minBound:s,maxBound:a,setActiveForeground:n})]})};mr.displayName="Slider";const vr=()=>{const[e,n]=(0,t.useState)(!1);return(0,i.jsxs)("div",{className:"area-filter-wrapper",children:[(0,i.jsx)(r,{}),(0,i.jsxs)("div",{className:"area-filter",children:[(0,i.jsx)(sr,{activeForeground:e,setActiveForeground:n}),(0,i.jsx)("div",{style:{transform:"translateY(-8px)"},children:(0,i.jsx)(mr,{activeForeground:e,setActiveForeground:n})})]})]})};vr.displayName="Area";const yr=(0,t.createContext)(null),br=()=>(0,t.useContext)(yr),_r=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(null),[s,a]=(0,t.useState)(null),l={top:5,bottom:0,left:0,right:0},c=r-l.right-l.left,u=s-l.top-l.bottom;return(0,i.jsx)(yr.Provider,{value:{margin:l,width:r,height:s,setWidth:o,setHeight:a,innerWidth:c,innerHeight:u},children:n})};yr.displayName="CircleSizesContext";const wr=e=>{let{children:n}=e;const{width:r,height:o,setWidth:s,setHeight:a,margin:l}=br(),c=(0,t.useCallback)((t=>{t&&(s(t.getBoundingClientRect().width),a(t.getBoundingClientRect().height))}),[]);return(0,i.jsx)("div",{ref:c,style:{width:"100%",height:"100%"},children:r&&(0,i.jsx)("svg",{fill:"none",viewBox:"0 0 ".concat(r," ").concat(o),preserveAspectRatio:"none",children:(0,i.jsx)("g",{transform:"translate(".concat(l.left,", ").concat(l.top,")"),children:t.Children.map(n,((e,n)=>(0,t.cloneElement)(e,{width:"100%"})))})})})};wr.displayName="SVGWrapper";const xr=()=>(0,i.jsx)("div",{className:"title-wrapper-style",children:(0,i.jsx)("div",{children:"Catchment area"})});xr.displayName="Title";const Sr=(0,t.createContext)(null),Pr=()=>(0,t.useContext)(Sr),Er=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(null),[s,a]=(0,t.useState)(null),l={top:0,bottom:10,left:0,right:0},c=r-l.right-l.left,u=s-l.top-l.bottom;return(0,i.jsx)(Sr.Provider,{value:{margin:l,width:r,height:s,setWidth:o,setHeight:a,innerWidth:c,innerHeight:u},children:n})};Sr.displayName="RadiusSizesContext";const Cr=e=>{let{children:n}=e;const{margin:r,width:o,height:s,setWidth:a,setHeight:l}=Pr(),c=(0,t.useCallback)((t=>{t&&(a(t.getBoundingClientRect().width),l(t.getBoundingClientRect().height))}),[]);return(0,i.jsx)("div",{ref:c,style:{width:"100%",height:"100%"},children:o&&(0,i.jsx)("svg",{viewBox:"0 0 ".concat(o," ").concat(s),preserveAspectRatio:"none",children:(0,i.jsx)("g",{transform:"translate(".concat(r.left,", ").concat(r.top,")"),children:t.Children.map(n,((e,n)=>(0,t.cloneElement)(e,{width:"100%"})))})})})};Cr.displayName="SVGWrapper";const Tr=t=>{let{xScale:e,minBound:n,maxBound:r,circleRadius:o}=t;return(0,i.jsx)("rect",{x:e(n),y:o/2,rx:o/2,ry:o/2,width:e(r)-e(n),height:o,fill:"rgba(126, 126, 132, 0.4)"})};Tr.displayName="Background";const Ar=t=>{let{activeForeground:e,xScale:n,minBound:r,radiusPosition:o,circleRadius:s}=t;return(0,i.jsx)("rect",{x:n(r),y:s/2,rx:s/2,ry:s/2,width:n(o)-n(r),height:s,fill:e?"rgba(255, 255, 255, 0.5)":"rgba(255, 255, 255, 0.3)"})};Ar.displayName="Foreground";const kr=t=>{let{cx:e,cy:n,r:r}=t;return(0,i.jsx)("circle",{cx:e,cy:r,r:r-1,fill:"rgba(255, 255, 255, 1)",strokeWidth:0})};kr.displayName="Handler";const Mr=t=>{let{xScale:e,circleRadius:n,currentPosition:r}=t;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("polygon",{points:"\n\t\t\t\t\t".concat(e(r)," ").concat(2*n,", \n\t\t\t\t\t").concat(e(r)-6," ").concat(3*n,", \n\t\t\t\t\t").concat(e(r)+6," ").concat(3*n,"\n\t\t\t\t"),fill:"rgba(126, 126, 132, 1)"}),(0,i.jsx)("rect",{x:e(r)-16,y:3*n,rx:2,ry:2,width:32,height:3*n,fill:"rgba(23, 23, 32, 1)",strokeWidth:2,stroke:"rgba(126, 126, 132, 1)"}),(0,i.jsx)("text",{x:e(r),y:5*n,fill:"rgba(255, 255, 255, 1)",textAnchor:"middle",fontSize:"0.8em",children:Math.round(100*r*10)/10})]})};Mr.displayName="Legend";const Lr=e=>{let{xScale:n,minBound:r,maxBound:o,innerWidth:s,innerHeight:a,radiusPosition:l,setRadiusPosition:c,setCircleRadius:u,setActiveForeground:h}=e;const d=t=>{const e=n.invert(t.x);c(+(e<r?r:e>o?o:e))},f=t=>{const e=n.invert(t.x);c(+(e<r?r:e>o?o:e))},p=t=>{const e=n.invert(t.x);u(+(e<r?r:e>o?o:e))},g=(0,t.useCallback)((t=>{const e=li().on("start",d).on("drag",f).on("end",p);Kn(t).call(e)}),[l]);return(0,i.jsx)("rect",{ref:g,width:s,height:a,fill:"transparent",onMouseOver:()=>{h(!0)},onMouseLeave:()=>{h(!1)}})};Lr.displayName="Wrapper";const Or=()=>{const[e,n]=(0,t.useState)(!1),{innerWidth:r,innerHeight:o}=Pr(),{radiusPosition:s,setRadiusPosition:a,setCircleRadius:l,minBound:c,maxBound:u}=p(),h=o/6,d=$i().domain([c,u]).range([20,r-20]);return(0,i.jsxs)(Cr,{children:[(0,i.jsx)(Tr,{xScale:d,minBound:c,maxBound:u,circleRadius:h}),(0,i.jsx)(Ar,{xScale:d,minBound:c,radiusPosition:s,circleRadius:h,activeForeground:e}),(0,i.jsx)(kr,{activeForeground:e,cx:d(s),cy:h,r:h}),(0,i.jsx)(Mr,{xScale:d,circleRadius:h,currentPosition:s}),(0,i.jsx)(Lr,{xScale:d,innerWidth:r,innerHeight:o,setRadiusPosition:a,setCircleRadius:l,minBound:c,maxBound:u,setActiveForeground:n})]})};Or.displayName="Slider";const Rr=(0,t.createContext)(null),Ir=()=>(0,t.useContext)(Rr),jr=e=>{let{children:n}=e;const[r,o]=(0,t.useState)("rgba(255, 255, 255, 1)"),[s,a]=(0,t.useState)(.3),[l,c]=(0,t.useState)("rgba(255, 255, 255, 0.2)");return(0,i.jsx)(Rr.Provider,{value:{linesColor:r,setLinesColor:o,linesWidth:s,setLinesWidth:a,fillColor:l,setFillColor:c},children:n})};Rr.displayName="StyleSheetContext";const Fr=t=>{let{polygonArea:e,polygon:n}=t;const{innerWidth:r,innerHeight:o}=br(),{maxBound:s,radiusPosition:a}=p(),{fillColor:l}=Ir(),c=S([r/2,o/2]),u=$i().domain([1,2*s*1e3]).range([1,2*c]);return(0,i.jsxs)("div",{className:"catchment-wrapper",children:[(0,i.jsx)(xr,{}),(0,i.jsxs)("div",{className:"circle-wrapper",children:[(0,i.jsx)(wr,{children:(0,i.jsx)("circle",{cx:r/2,cy:o/2,r:u(1e3*a),fill:l})}),(0,i.jsxs)("div",{className:"distance-info",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[(Math.round(100*a*10)/10).toFixed(1),(0,i.jsx)("span",{style:{fontSize:"0.8em"},children:" km"})]}),(0,i.jsx)("div",{className:"subtitle-style",children:"radius"})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[Math.round(100*a*12),(0,i.jsx)("span",{style:{fontSize:"0.8em"},children:" min"})]}),(0,i.jsx)("div",{className:"subtitle-style",children:"walk time"})]})]})]}),(0,i.jsx)(Or,{})]})};Fr.displayName="Catchment";const zr=()=>(0,i.jsx)("div",{className:"title-wrapper-style",children:(0,i.jsxs)("div",{children:["Filter by built area ",(0,i.jsx)("span",{style:{fontSize:"0.8em"},children:"m\xb2"})]})});zr.displayName="Title";const Nr=e=>{let{children:n}=e;const{margin:r,width:o,height:a,setWidth:l,setHeight:c}=s(),u=(0,t.useCallback)((t=>{if(t){const e=t.getBoundingClientRect().width,n=t.getBoundingClientRect().height;l(e),c(n)}}),[]);return 0===o?(0,i.jsx)(i.Fragment,{}):(0,i.jsx)("div",{ref:u,style:{width:"100%",height:"100%"},children:o&&(0,i.jsx)("svg",{viewBox:"0 0 ".concat(o," ").concat(a),preserveAspectRatio:"none",children:(0,i.jsx)("g",{transform:"translate(".concat(r.left,", ").concat(r.top,")"),children:t.Children.map(n,((e,n)=>(0,t.cloneElement)(e,{width:"100%"})))})})})};Nr.displayName="SVGWrapper";const Dr=t=>{let{xScale:e,minBound:n,maxBound:r,innerWidth:o,innerHeight:s}=t;const{parcelsData:a}=_();if(!a)return(0,i.jsx)(i.Fragment,{});const l=((t,e,n,i)=>{let r={},o=e;for(;o<=n;){const e=t.filter((t=>t<o&&t>o-i)).length;r[o]=e,o+=i}return r})(a.map((t=>t.constructed_area<r&&t.constructed_area)),n,r,30),c=Object.values(l),u=S(c),h=x(c),d=o/c.length,f=$i().domain([h,u]).range([10,s]);return(0,i.jsx)(i.Fragment,{children:Object.keys(l).slice(0,-1).map(((t,n)=>(0,i.jsx)("rect",{x:e(t)+1,y:f(l[t]),width:d-2,height:s-f(l[t]),fill:"rgba(126, 126, 132, 0.6)"},n)))})};Dr.displayName="Bars";const Br=t=>{let{xScale:e,innerHeight:n,leftPosition:r,rightPosition:o,activeForeground:s}=t;return(0,i.jsx)("rect",{x:e(r),width:e(o)-e(r),height:n,fill:s?"rgba(126, 126, 132, 0.2)":"none"})};Br.displayName="Foreground";const Ur=e=>{let{xScale:n,minBound:r,maxBound:o,innerWidth:s,innerHeight:a,leftPosition:l,setLeftPosition:c,rightPosition:u,setRightPosition:h,setActiveForeground:d}=e;const f=(0,t.useRef)(null),p=t=>{const e=n.invert(t.x),i=Math.abs(u-e),s=Math.abs(l-e);f.current=i<s?"right":"left";const a=e<r?r:e>u?u:e,d=e>o?o:e<l?l:e;"left"===f.current?c(+a):h(+d)},g=t=>{const e=n.invert(t.x),i=e<r?r:e>u?u:e,s=e>o?o:e<l?l:e;"left"===f.current?c(+i):h(+s)},m=(0,t.useCallback)((t=>{const e=li().on("start",p).on("drag",g);Kn(t).call(e)}),[u,l]);return(0,i.jsx)("rect",{ref:m,width:s,height:a,fill:"transparent",onMouseOver:()=>{d(!0)},onMouseLeave:()=>{d(!1)}})};Ur.displayName="Wrapper";const Vr=(0,t.createContext)(null),Wr=()=>(0,t.useContext)(Vr),Hr=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(0),[s,a]=(0,t.useState)(600),[l,c]=(0,t.useState)(0),[u,h]=(0,t.useState)(600),[d,f]=(0,t.useState)(600);return(0,t.useEffect)((()=>{d<u&&h(d),d<l&&c(d)}),[d]),(0,t.useEffect)((()=>{a(u)}),[u]),(0,t.useEffect)((()=>{o(l)}),[l]),(0,i.jsx)(Vr.Provider,{value:{builtAreaFrom:r,setBuiltAreaFrom:o,builtAreaTo:s,setBuiltAreaTo:a,leftPosition:l,setLeftPosition:c,rightPosition:u,setRightPosition:h,minBound:0,maxBound:d,setMaxBound:f},children:n})};Vr.displayName="BuiltDimensionsContext";const Gr=t=>{let{activeForeground:e,setActiveForeground:n}=t;const{innerWidth:r,innerHeight:o}=s(),{minBound:a,maxBound:l,leftPosition:c,setLeftPosition:u,rightPosition:h,setRightPosition:d}=Wr(),f=$i().domain([a,l]).range([20,r-20]);return(0,i.jsx)("div",{style:{overflow:"hidden"},children:(0,i.jsxs)(Nr,{children:[(0,i.jsx)(Dr,{xScale:f,minBound:a,maxBound:l,innerWidth:r,innerHeight:o}),(0,i.jsx)(Br,{xScale:f,innerHeight:o,leftPosition:c,rightPosition:h,activeForeground:e}),(0,i.jsx)(Ur,{xScale:f,innerWidth:r,innerHeight:o,leftPosition:c,rightPosition:h,setLeftPosition:u,setRightPosition:d,minBound:a,maxBound:l,setActiveForeground:n})]})})};Gr.displayName="Graphics";const Xr=(0,t.createContext)(null),qr=()=>(0,t.useContext)(Xr),Zr=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(null),[s,a]=(0,t.useState)(null),l={top:0,bottom:10,left:0,right:0},c=r-l.right-l.left,u=s-l.top-l.bottom;return(0,i.jsx)(Xr.Provider,{value:{margin:l,width:r,height:s,setWidth:o,setHeight:a,innerWidth:c,innerHeight:u},children:n})};Xr.displayName="ConstructionSliderSizesContext";const Yr=e=>{let{children:n}=e;const{margin:r,width:o,height:s,setWidth:a,setHeight:l}=qr(),c=(0,t.useCallback)((t=>{t&&(a(t.getBoundingClientRect().width),l(t.getBoundingClientRect().height))}),[]);return(0,i.jsx)("div",{ref:c,style:{width:"100%",height:"100%"},children:o&&(0,i.jsx)("svg",{viewBox:"0 0 ".concat(o," ").concat(s),preserveAspectRatio:"none",children:(0,i.jsx)("g",{transform:"translate(".concat(r.left,", ").concat(r.top,")"),children:t.Children.map(n,((e,n)=>(0,t.cloneElement)(e,{width:"100%"})))})})})};Yr.displayName="SVGWrapper";const Kr=t=>{let{xScale:e,circleRadius:n,currentPosition:r}=t;const o=r>99999?25:r>9999?22:r>999?17:14;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("polygon",{points:"\n\t\t\t\t".concat(e(r)," ").concat(2*n,", \n\t\t\t\t").concat(e(r)-6," ").concat(3*n,", \n\t\t\t\t").concat(e(r)+6," ").concat(3*n,"\n\t\t\t"),fill:"rgba(126, 126, 132, 1)"}),(0,i.jsx)("rect",{x:e(r)-o,y:3*n,rx:2,ry:2,width:2*o,height:3*n,fill:"rgba(23, 23, 32, 1)",strokeWidth:2,stroke:"rgba(126, 126, 132, 1)"}),(0,i.jsx)("text",{x:e(r),y:5*n,fill:"rgba(255, 255, 255, 1)",textAnchor:"middle",fontSize:"0.8em",children:Math.round(r)})]})};Kr.displayName="Legend";const Qr=t=>{let{xScale:e,minBound:n,maxBound:r,circleRadius:o}=t;return(0,i.jsx)("rect",{x:e(n),y:o/2,rx:o/2,ry:o/2,width:e(r)-e(n),height:o,fill:"rgba(126, 126, 132, 0.4)",stroke:"rgba(126, 126, 132, 0.4)",strokeWidth:"1px"})};Qr.displayName="Background";const $r=t=>{let{xScale:e,leftPosition:n,rightPosition:r,circleRadius:o,activeForeground:s}=t;return(0,i.jsx)("rect",{x:e(n),y:o/2,rx:o/2,ry:o/2,width:e(r)-e(n),height:o,fill:s?"rgba(255, 255, 255, 0.5)":"rgba(255, 255, 255, 0.3)"})};$r.displayName="Foreground";const Jr=t=>{let{activeForeground:e,cx:n,cy:r,r:o}=t;return(0,i.jsx)("circle",{cx:n,cy:o,r:e?o:o-1,fill:"rgba(255, 255, 255, 1)",strokeWidth:0})};Jr.displayName="Handler";const to=e=>{let{xScale:n,minBound:r,maxBound:o,innerWidth:s,innerHeight:a,leftPosition:l,setLeftPosition:c,rightPosition:u,setRightPosition:h,setActiveForeground:d}=e;const f=(0,t.useRef)(null),p=t=>{const e=n.invert(t.x),i=Math.abs(u-e),s=Math.abs(l-e);f.current=i<s?"right":"left";const a=e<r?r:e>u?u:e,d=e>o?o:e<l?l:e;"left"===f.current?c(+a):h(+d)},g=t=>{const e=n.invert(t.x),i=e<r?r:e>u?u:e,s=e>o?o:e<l?l:e;"left"===f.current?c(+i):h(+s)},m=(0,t.useCallback)((t=>{const e=li().on("start",p).on("drag",g);Kn(t).call(e)}),[u,l]);return(0,i.jsx)("rect",{ref:m,width:s,height:a,fill:"transparent",onMouseOver:()=>{d(!0)},onMouseLeave:()=>{d(!1)}})};to.displayName="Wrapper";const eo=t=>{let{activeForeground:e,setActiveForeground:n}=t;const{innerWidth:r,innerHeight:o}=qr(),{minBound:s,maxBound:a,leftPosition:l,setLeftPosition:c,rightPosition:u,setRightPosition:h}=Wr(),d=o/6,f=$i().domain([s,a]).range([20,r-20]);return(0,i.jsxs)(Yr,{children:[(0,i.jsx)(Kr,{xScale:f,circleRadius:d,currentPosition:l}),(0,i.jsx)(Kr,{xScale:f,circleRadius:d,currentPosition:u}),(0,i.jsx)(Qr,{xScale:f,minBound:s,maxBound:a,circleRadius:d}),(0,i.jsx)($r,{xScale:f,leftPosition:l,rightPosition:u,circleRadius:d,activeForeground:e}),(0,i.jsx)(Jr,{activeForeground:e,cx:f(l),cy:d,r:d}),(0,i.jsx)(Jr,{activeForeground:e,cx:f(u),cy:d,r:d}),(0,i.jsx)(to,{xScale:f,innerWidth:r,innerHeight:o,leftPosition:l,rightPosition:u,setLeftPosition:c,setRightPosition:h,minBound:s,maxBound:a,setActiveForeground:n})]})};eo.displayName="Slider";const no=()=>{const[e,n]=(0,t.useState)(!1);return(0,i.jsxs)("div",{className:"built-filter-wrapper",children:[(0,i.jsx)(zr,{}),(0,i.jsxs)("div",{className:"built-filter",children:[(0,i.jsx)(Gr,{activeForeground:e,setActiveForeground:n}),(0,i.jsx)("div",{style:{transform:"translateY(-8px)"},children:(0,i.jsx)(eo,{activeForeground:e,setActiveForeground:n})})]})]})};no.displayName="Built";const io=(0,t.createContext)(null),ro=()=>(0,t.useContext)(io),oo=e=>{let{children:n}=e;const{parcelId:r}=h(),[o,s]=(0,t.useState)(null);return(0,t.useEffect)((()=>{(async()=>{const t="\n        ".concat("http://localhost:8000","/\n        zone_api\n        ?parcel_id=").concat(r,"\n      ").replace(/\s/g,""),e=await fetch(t),n=await e.json();s(n)})()}),[r]),(0,i.jsx)(io.Provider,{value:{zoneData:o},children:n})};io.displayName="ZoneApiContext";const so=()=>{const{zoneData:t}=ro();if(!t)return(0,i.jsx)(i.Fragment,{});const e=t.zone,n=t.height,r=t.occupancy_rate,o=t.far;return(0,i.jsxs)("div",{className:"zone-wrapper",children:[(0,i.jsx)("div",{className:"title-wrapper-style",children:"Parcel regulations"}),(0,i.jsxs)("div",{className:"zone",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"zone-title",children:e}),(0,i.jsx)("div",{className:"subtitle-style",children:"zone"})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"zone-title",children:[n||"Free",(0,i.jsx)("span",{style:{fontSize:"0.8em"},children:n?"m":""})]}),(0,i.jsx)("div",{className:"subtitle-style",children:"height"})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"zone-title",children:[100*r,(0,i.jsx)("span",{style:{fontSize:"0.8em"},children:"%"})]}),(0,i.jsx)("div",{className:"subtitle-style",children:"o.r."})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"zone-title",children:o}),(0,i.jsx)("div",{className:"subtitle-style",children:"f.a.r."})]})]})]})};so.displayName="Zone";const ao=()=>(0,i.jsx)("div",{className:"left-wrapper",children:(0,i.jsxs)("div",{className:"left-items-wrapper",children:[(0,i.jsx)(Fr,{}),(0,i.jsx)(so,{}),(0,i.jsx)(vr,{}),(0,i.jsx)(no,{})]})});ao.displayName="Left";const lo=t.createContext(null);function co(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!co(t[n],e[n]))return!1;return!0}if(Array.isArray(e))return!1;if("object"===typeof t&&"object"===typeof e){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const r of n){if(!e.hasOwnProperty(r))return!1;if(!co(t[r],e[r]))return!1}return!0}return!1}function uo(t,e){if(!t.getProjection)return;const n=t.getProjection();co(n,e.getProjection())||e.setProjection(n)}function ho(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function fo(t,e){const n=e.viewState||e;let i=!1;if("longitude"in n&&"latitude"in n){const e=t.center;t.center=new e.constructor(n.longitude,n.latitude),i=i||e!==t.center}if("zoom"in n){const e=t.zoom;t.zoom=n.zoom,i=i||e!==t.zoom}if("bearing"in n){const e=t.bearing;t.bearing=n.bearing,i=i||e!==t.bearing}if("pitch"in n){const e=t.pitch;t.pitch=n.pitch,i=i||e!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(i=!0,t.padding=n.padding),i}const po=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function go(t){if(!t)return null;if("string"===typeof t)return t;if("toJS"in t&&(t=t.toJS()),!t.layers)return t;const e={};for(const i of t.layers)e[i.id]=i;const n=t.layers.map((t=>{let n=null;"interactive"in t&&(n=Object.assign({},t),delete n.interactive);const i=e[t.ref];if(i){n=n||Object.assign({},t),delete n.ref;for(const t of po)t in i&&(n[t]=i[t])}return n||t}));return{...t,layers:n}}const mo={version:8,sources:{},layers:[]},vo={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},yo={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},bo={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},_o=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],wo=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class xo{constructor(t,e,n){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=t=>{const e=this.props[bo[t.type]];e?e(t):"error"===t.type&&console.error(t.error)},this._onPointerEvent=t=>{"mousemove"!==t.type&&"mouseout"!==t.type||this._updateHover(t);const e=this.props[vo[t.type]];e&&(this.props.interactiveLayerIds&&"mouseover"!==t.type&&"mouseout"!==t.type&&(t.features=this._hoveredFeatures||this._queryRenderedFeatures(t.point)),e(t),delete t.features)},this._onCameraEvent=t=>{if(!this._internalUpdate){const e=this.props[yo[t.type]];e&&e(t)}t.type in this._deferredEvents&&(this._deferredEvents[t.type]=!1)},this._MapClass=t,this.props=e,this._initialize(n)}get map(){return this._map}get transform(){return this._renderTransform}setProps(t){const e=this.props;this.props=t;const n=this._updateSettings(t,e);n&&this._createShadowTransform(this._map);const i=this._updateSize(t),r=this._updateViewState(t,!0);this._updateStyle(t,e),this._updateStyleComponents(t,e),this._updateHandlers(t,e),(n||i||r&&!this._map.isMoving())&&this.redraw()}static reuse(t,e){const n=xo.savedMaps.pop();if(!n)return null;const i=n.map,r=i.getContainer();for(e.className=r.className;r.childNodes.length>0;)e.appendChild(r.childNodes[0]);i._container=e;const o=i._resizeObserver;o&&(o.disconnect(),o.observe(e)),n.setProps({...t,styleDiffing:!1}),i.resize();const{initialViewState:s}=t;return s&&(s.bounds?i.fitBounds(s.bounds,{...s.fitBoundsOptions,duration:0}):n._updateViewState(s,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",(()=>i.fire("load"))),i._update(),n}_initialize(t){const{props:e}=this,{mapStyle:n=mo}=e,i={...e,...e.initialViewState,accessToken:e.mapboxAccessToken||So()||null,container:t,style:go(n)},r=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[r.longitude||0,r.latitude||0],zoom:r.zoom||0,pitch:r.pitch||0,bearing:r.bearing||0}),e.gl){const t=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=t,e.gl)}const o=new this._MapClass(i);r.padding&&o.setPadding(r.padding),e.cursor&&(o.getCanvas().style.cursor=e.cursor),this._createShadowTransform(o);const s=o._render;o._render=t=>{this._inRender=!0,s.call(o,t),this._inRender=!1};const a=o._renderTaskQueue.run;o._renderTaskQueue.run=t=>{a.call(o._renderTaskQueue,t),this._onBeforeRepaint()},o.on("render",(()=>this._onAfterRepaint()));const l=o.fire;o.fire=this._fireEvent.bind(this,l),o.on("resize",(()=>{this._renderTransform.resize(o.transform.width,o.transform.height)})),o.on("styledata",(()=>{this._updateStyleComponents(this.props,{}),uo(o.transform,this._renderTransform)})),o.on("sourcedata",(()=>this._updateStyleComponents(this.props,{})));for(const c in vo)o.on(c,this._onPointerEvent);for(const c in yo)o.on(c,this._onCameraEvent);for(const c in bo)o.on(c,this._onEvent);this._map=o}recycle(){const t=this.map.getContainer().querySelector("[mapboxgl-children]");null===t||void 0===t||t.remove(),xo.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;!this._inRender&&t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_createShadowTransform(t){const e=function(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}(t.transform);t.painter.transform=e,this._renderTransform=e}_updateSize(t){const{viewState:e}=t;if(e){const t=this._map;if(e.width!==t.transform.width||e.height!==t.transform.height)return t.resize(),!0}return!1}_updateViewState(t,e){if(this._internalUpdate)return!1;const n=this._map,i=this._renderTransform,{zoom:r,pitch:o,bearing:s}=i,a=n.isMoving();a&&(i.cameraElevationReference="sea");const l=fo(i,{...ho(n.transform),...t});if(a&&(i.cameraElevationReference="ground"),l&&e){const t=this._deferredEvents;t.move=!0,t.zoom||(t.zoom=r!==i.zoom),t.rotate||(t.rotate=s!==i.bearing),t.pitch||(t.pitch=o!==i.pitch)}return a||fo(n.transform,t),l}_updateSettings(t,e){const n=this._map;let i=!1;for(const r of _o)if(r in t&&!co(t[r],e[r])){i=!0;const e=n["set".concat(r[0].toUpperCase()).concat(r.slice(1))];null===e||void 0===e||e.call(n,t[r])}return i}_updateStyle(t,e){if(t.cursor!==e.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==e.mapStyle){const{mapStyle:e=mo,styleDiffing:n=!0}=t,i={diff:n};return"localIdeographFontFamily"in t&&(i.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(go(e),i),!0}return!1}_updateStyleComponents(t,e){const n=this._map;let i=!1;return n.isStyleLoaded()&&("light"in t&&n.setLight&&!co(t.light,e.light)&&(i=!0,n.setLight(t.light)),"fog"in t&&n.setFog&&!co(t.fog,e.fog)&&(i=!0,n.setFog(t.fog)),"terrain"in t&&n.setTerrain&&!co(t.terrain,e.terrain)&&(t.terrain&&!n.getSource(t.terrain.source)||(i=!0,n.setTerrain(t.terrain)))),i}_updateHandlers(t,e){var n,i;const r=this._map;let o=!1;for(const s of wo){const a=null===(n=t[s])||void 0===n||n;co(a,null===(i=e[s])||void 0===i||i)||(o=!0,a?r[s].enable(a):r[s].disable())}return o}_queryRenderedFeatures(t){const e=this._map,n=e.transform,{interactiveLayerIds:i=[]}=this.props;try{return e.transform=this._renderTransform,e.queryRenderedFeatures(t,{layers:i.filter(e.getLayer.bind(e))})}catch(r){return[]}finally{e.transform=n}}_updateHover(t){var e;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const n=t.type,i=(null===(e=this._hoveredFeatures)||void 0===e?void 0:e.length)>0,r=this._queryRenderedFeatures(t.point),o=r.length>0;!o&&i&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=r,o&&!i&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=n}else this._hoveredFeatures=null}_fireEvent(t,e,n){const i=this._map,r=i.transform,o="string"===typeof e?e:e.type;return"move"===o&&this._updateViewState(this.props,!1),o in yo&&("object"===typeof e&&(e.viewState=ho(r)),this._map.isMoving())?(i.transform=this._renderTransform,t.call(i,e,n),i.transform=r,i):(t.call(i,e,n),i)}_onBeforeRepaint(){const t=this._map;this._internalUpdate=!0;for(const n in this._deferredEvents)this._deferredEvents[n]&&t.fire(n);this._internalUpdate=!1;const e=this._map.transform;t.transform=this._renderTransform,this._onAfterRepaint=()=>{uo(this._renderTransform,e),t.transform=e}}}function So(){let t=null;if("undefined"!==typeof location){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{NODE_ENV:"production",PUBLIC_URL:"/parcels",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"http://localhost:8000",REACT_APP_MAPBOX_TOKEN:"pk.eyJ1IjoiaHZva2luZyIsImEiOiJja3F4YWMyNHMwODkxMm5vNzcxNWJrZXUzIn0.QCH37vNtXL1p2CfPYiVdgg"}.MapboxAccessToken}catch(e){}try{t=t||{NODE_ENV:"production",PUBLIC_URL:"/parcels",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"http://localhost:8000",REACT_APP_MAPBOX_TOKEN:"pk.eyJ1IjoiaHZva2luZyIsImEiOiJja3F4YWMyNHMwODkxMm5vNzcxNWJrZXUzIn0.QCH37vNtXL1p2CfPYiVdgg"}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch(n){}return t}xo.savedMaps=[];const Po=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Eo(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:n=>{const i=e.transform;e.transform=t.transform;const r=e.project(n);return e.transform=i,r},unproject:n=>{const i=e.transform;e.transform=t.transform;const r=e.unproject(n);return e.transform=i,r},queryTerrainElevation:(n,i)=>{const r=e.transform;e.transform=t.transform;const o=e.queryTerrainElevation(n,i);return e.transform=r,o},queryRenderedFeatures:(n,i)=>{const r=e.transform;e.transform=t.transform;const o=e.queryRenderedFeatures(n,i);return e.transform=r,o}};for(const i of function(t){const e=new Set;let n=t;for(;n;){for(const i of Object.getOwnPropertyNames(n))"_"!==i[0]&&"function"===typeof t[i]&&"fire"!==i&&"setEventedParent"!==i&&e.add(i);n=Object.getPrototypeOf(n)}return Array.from(e)}(e))i in n||Po.includes(i)||(n[i]=e[i].bind(e));return n}const Co="undefined"!==typeof document?t.useLayoutEffect:t.useEffect,To=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];const Ao=t.createContext(null);function ko(e,n,i){const r=(0,t.useContext)(lo),[o,s]=(0,t.useState)(null),a=(0,t.useRef)(),{current:l}=(0,t.useRef)({mapLib:null,map:null});(0,t.useEffect)((()=>{const t=e.mapLib;let n,o=!0;return Promise.resolve(t||i).then((t=>{if(!o)return;if(!t)throw new Error("Invalid mapLib");const i="Map"in t?t:t.default;if(!i.Map)throw new Error("Invalid mapLib");if(function(t,e){for(const i of To)i in e&&(t[i]=e[i]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&"unavailable"===t.getRTLTextPluginStatus()&&t.setRTLTextPlugin(n,(t=>{t&&console.error(t)}),!0)}(i,e),i.supported&&!i.supported(e))throw new Error("Map is not supported by this browser");e.reuseMaps&&(n=xo.reuse(e,a.current)),n||(n=new xo(i.Map,e,a.current)),l.map=Eo(n),l.mapLib=i,s(n),null===r||void 0===r||r.onMapMount(l.map,e.id)})).catch((t=>{const{onError:n}=e;n?n({type:"error",target:null,originalEvent:null,error:t}):console.error(t)})),()=>{o=!1,n&&(null===r||void 0===r||r.onMapUnmount(e.id),e.reuseMaps?n.recycle():n.destroy())}}),[]),Co((()=>{o&&o.setProps(e)})),(0,t.useImperativeHandle)(n,(()=>l.map),[o]);const c=(0,t.useMemo)((()=>({position:"relative",width:"100%",height:"100%",...e.style})),[e.style]);return t.createElement("div",{id:e.id,ref:a,style:c},o&&t.createElement(Ao.Provider,{value:l},t.createElement("div",{"mapboxgl-children":"",style:{height:"100%"}},e.children)))}var Mo=n(164);const Lo=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Oo(t,e){if(!t||!e)return;const n=t.style;for(const i in e){const t=e[i];Number.isFinite(t)&&!Lo.test(i)?n[i]="".concat(t,"px"):n[i]=t}}const Ro=(0,t.memo)((0,t.forwardRef)((function(e,n){const{map:i,mapLib:r}=(0,t.useContext)(Ao),o=(0,t.useRef)({props:e});o.current.props=e;const s=(0,t.useMemo)((()=>{let n=!1;t.Children.forEach(e.children,(t=>{t&&(n=!0)}));const i={...e,element:n?document.createElement("div"):null},a=new r.Marker(i);return a.setLngLat([e.longitude,e.latitude]),a.getElement().addEventListener("click",(t=>{var e,n;null===(n=(e=o.current.props).onClick)||void 0===n||n.call(e,{type:"click",target:a,originalEvent:t})})),a.on("dragstart",(t=>{var e,n;const i=t;i.lngLat=s.getLngLat(),null===(n=(e=o.current.props).onDragStart)||void 0===n||n.call(e,i)})),a.on("drag",(t=>{var e,n;const i=t;i.lngLat=s.getLngLat(),null===(n=(e=o.current.props).onDrag)||void 0===n||n.call(e,i)})),a.on("dragend",(t=>{var e,n;const i=t;i.lngLat=s.getLngLat(),null===(n=(e=o.current.props).onDragEnd)||void 0===n||n.call(e,i)})),a}),[]);(0,t.useEffect)((()=>(s.addTo(i.getMap()),()=>{s.remove()})),[]);const{longitude:a,latitude:l,offset:c,style:u,draggable:h=!1,popup:d=null,rotation:f=0,rotationAlignment:p="auto",pitchAlignment:g="auto"}=e;return(0,t.useEffect)((()=>{Oo(s.getElement(),u)}),[u]),(0,t.useImperativeHandle)(n,(()=>s),[]),s.getLngLat().lng===a&&s.getLngLat().lat===l||s.setLngLat([a,l]),c&&!function(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,i=Array.isArray(t)?t[1]:t?t.y:0,r=Array.isArray(e)?e[0]:e?e.x:0,o=Array.isArray(e)?e[1]:e?e.y:0;return n===r&&i===o}(s.getOffset(),c)&&s.setOffset(c),s.isDraggable()!==h&&s.setDraggable(h),s.getRotation()!==f&&s.setRotation(f),s.getRotationAlignment()!==p&&s.setRotationAlignment(p),s.getPitchAlignment()!==g&&s.setPitchAlignment(g),s.getPopup()!==d&&s.setPopup(d),(0,Mo.createPortal)(e.children,s.getElement())})));function Io(t){return new Set(t?t.trim().split(/\s+/):[])}(0,t.memo)((0,t.forwardRef)((function(e,n){const{map:i,mapLib:r}=(0,t.useContext)(Ao),o=(0,t.useMemo)((()=>document.createElement("div")),[]),s=(0,t.useRef)({props:e});s.current.props=e;const a=(0,t.useMemo)((()=>{const t={...e},n=new r.Popup(t);return n.setLngLat([e.longitude,e.latitude]),n.once("open",(t=>{var e,n;null===(n=(e=s.current.props).onOpen)||void 0===n||n.call(e,t)})),n}),[]);if((0,t.useEffect)((()=>{const t=t=>{var e,n;null===(n=(e=s.current.props).onClose)||void 0===n||n.call(e,t)};return a.on("close",t),a.setDOMContent(o).addTo(i.getMap()),()=>{a.off("close",t),a.isOpen()&&a.remove()}}),[]),(0,t.useEffect)((()=>{Oo(a.getElement(),e.style)}),[e.style]),(0,t.useImperativeHandle)(n,(()=>a),[]),a.isOpen()&&(a.getLngLat().lng===e.longitude&&a.getLngLat().lat===e.latitude||a.setLngLat([e.longitude,e.latitude]),e.offset&&!co(a.options.offset,e.offset)&&a.setOffset(e.offset),a.options.anchor===e.anchor&&a.options.maxWidth===e.maxWidth||(a.options.anchor=e.anchor,a.setMaxWidth(e.maxWidth)),a.options.className!==e.className)){const t=Io(a.options.className),n=Io(e.className);for(const e of t)n.has(e)||a.removeClassName(e);for(const e of n)t.has(e)||a.addClassName(e);a.options.className=e.className}return(0,Mo.createPortal)(e.children,o)})));const jo=function(e,n,i,r){const o=(0,t.useContext)(Ao),s=(0,t.useMemo)((()=>e(o)),[]);return(0,t.useEffect)((()=>{const t=r||i||n,e="function"===typeof n&&"function"===typeof i?n:null,a="function"===typeof i?i:"function"===typeof n?n:null,{map:l}=o;return l.hasControl(s)||(l.addControl(s,null===t||void 0===t?void 0:t.position),e&&e(o)),()=>{a&&a(o),l.hasControl(s)&&l.removeControl(s)}}),[]),s};(0,t.memo)((function(e){const n=jo((t=>{let{mapLib:n}=t;return new n.AttributionControl(e)}),{position:e.position});return(0,t.useEffect)((()=>{Oo(n._container,e.style)}),[e.style]),null}));(0,t.memo)((function(e){const n=jo((t=>{let{mapLib:n}=t;return new n.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)})}),{position:e.position});return(0,t.useEffect)((()=>{Oo(n._controlContainer,e.style)}),[e.style]),null}));(0,t.memo)((0,t.forwardRef)((function(e,n){const i=(0,t.useRef)({props:e}),r=jo((t=>{let{mapLib:n}=t;const r=new n.GeolocateControl(e),o=r._setupUI;return r._setupUI=t=>{r._container.hasChildNodes()||o(t)},r.on("geolocate",(t=>{var e,n;null===(n=(e=i.current.props).onGeolocate)||void 0===n||n.call(e,t)})),r.on("error",(t=>{var e,n;null===(n=(e=i.current.props).onError)||void 0===n||n.call(e,t)})),r.on("outofmaxbounds",(t=>{var e,n;null===(n=(e=i.current.props).onOutOfMaxBounds)||void 0===n||n.call(e,t)})),r.on("trackuserlocationstart",(t=>{var e,n;null===(n=(e=i.current.props).onTrackUserLocationStart)||void 0===n||n.call(e,t)})),r.on("trackuserlocationend",(t=>{var e,n;null===(n=(e=i.current.props).onTrackUserLocationEnd)||void 0===n||n.call(e,t)})),r}),{position:e.position});return i.current.props=e,(0,t.useImperativeHandle)(n,(()=>r),[]),(0,t.useEffect)((()=>{Oo(r._container,e.style)}),[e.style]),null})));const Fo=(0,t.memo)((function(e){const n=jo((t=>{let{mapLib:n}=t;return new n.NavigationControl(e)}),{position:e.position});return(0,t.useEffect)((()=>{Oo(n._container,e.style)}),[e.style]),null}));(0,t.memo)((function(e){const n=jo((t=>{let{mapLib:n}=t;return new n.ScaleControl(e)}),{position:e.position}),i=(0,t.useRef)(e),r=i.current;i.current=e;const{style:o}=e;return void 0!==e.maxWidth&&e.maxWidth!==r.maxWidth&&(n.options.maxWidth=e.maxWidth),void 0!==e.unit&&e.unit!==r.unit&&n.setUnit(e.unit),(0,t.useEffect)((()=>{Oo(n._container,o)}),[o]),null}));function zo(t,e){if(!t)throw new Error(e)}let No=0;const Do=function(e){const n=(0,t.useContext)(Ao).map.getMap(),i=(0,t.useRef)(e),[,r]=(0,t.useState)(0),o=(0,t.useMemo)((()=>e.id||"jsx-layer-".concat(No++)),[]);if((0,t.useEffect)((()=>{if(n){const t=()=>r((t=>t+1));return n.on("styledata",t),t(),()=>{n.off("styledata",t),n.style&&n.style._loaded&&n.getLayer(o)&&n.removeLayer(o)}}}),[n]),n&&n.style&&n.getLayer(o))try{!function(t,e,n,i){if(zo(n.id===i.id,"layer id changed"),zo(n.type===i.type,"layer type changed"),"custom"===n.type||"custom"===i.type)return;const{layout:r={},paint:o={},filter:s,minzoom:a,maxzoom:l,beforeId:c}=n;if(c!==i.beforeId&&t.moveLayer(e,c),r!==i.layout){const n=i.layout||{};for(const i in r)co(r[i],n[i])||t.setLayoutProperty(e,i,r[i]);for(const i in n)r.hasOwnProperty(i)||t.setLayoutProperty(e,i,void 0)}if(o!==i.paint){const n=i.paint||{};for(const i in o)co(o[i],n[i])||t.setPaintProperty(e,i,o[i]);for(const i in n)o.hasOwnProperty(i)||t.setPaintProperty(e,i,void 0)}co(s,i.filter)||t.setFilter(e,s),a===i.minzoom&&l===i.maxzoom||t.setLayerZoomRange(e,a,l)}(n,o,e,i.current)}catch(s){console.warn(s)}else!function(t,e,n){if(t.style&&t.style._loaded&&(!("source"in n)||t.getSource(n.source))){const i={...n,id:e};delete i.beforeId,t.addLayer(i,n.beforeId)}}(n,o,e);return i.current=e,null};let Bo=0;const Uo=function(e){const n=(0,t.useContext)(Ao).map.getMap(),i=(0,t.useRef)(e),[,r]=(0,t.useState)(0),o=(0,t.useMemo)((()=>e.id||"jsx-source-".concat(Bo++)),[]);(0,t.useEffect)((()=>{if(n){const t=()=>setTimeout((()=>r((t=>t+1))),0);return n.on("styledata",t),t(),()=>{var e;if(n.off("styledata",t),n.style&&n.style._loaded&&n.getSource(o)){const t=null===(e=n.getStyle())||void 0===e?void 0:e.layers;if(t)for(const e of t)e.source===o&&n.removeLayer(e.id);n.removeSource(o)}}}}),[n]);let s=n&&n.style&&n.getSource(o);return s?function(t,e,n){zo(e.id===n.id,"source id changed"),zo(e.type===n.type,"source type changed");let i="",r=0;for(const s in e)"children"===s||"id"===s||co(n[s],e[s])||(i=s,r++);if(!r)return;const o=e.type;if("geojson"===o)t.setData(e.data);else if("image"===o)t.updateImage({url:e.url,coordinates:e.coordinates});else if("setCoordinates"in t&&1===r&&"coordinates"===i)t.setCoordinates(e.coordinates);else if("setUrl"in t)switch(i){case"url":t.setUrl(e.url);break;case"tiles":t.setTiles(e.tiles)}else console.warn("Unable to update <Source> prop: ".concat(i))}(s,e,i.current):s=function(t,e,n){if(t.style&&t.style._loaded){const i={...n};return delete i.id,delete i.children,t.addSource(e,i),t.getSource(e)}return null}(n,o,e),i.current=e,s&&t.Children.map(e.children,(e=>e&&(0,t.cloneElement)(e,{source:o})))||null};const Vo=n.e(483).then(n.t.bind(n,483,23)),Wo=t.forwardRef((function(t,e){return ko(t,e,Vo)})),Ho=Ro,Go=Fo,Xo=Do,qo=Uo,Zo=()=>{const{marker:e,setMarker:n,setPlaceCoordinates:r}=h(),o=(0,t.useCallback)((t=>{const e=t.lngLat.lat,i=t.lngLat.lng;n({longitude:i,latitude:e})}),[]),s=(0,t.useCallback)((t=>{const e=t.lngLat.lat,n=t.lngLat.lng;r({longitude:n,latitude:e})}),[]);return(0,i.jsx)(Ho,{longitude:e.longitude,latitude:e.latitude,anchor:"bottom",draggable:!0,onDrag:o,onDragEnd:s,children:(0,i.jsx)("img",{style:{width:"25px"},src:"/parcels/static/components/maps/marker.svg",alt:"marker"})})};Zo.displayName="Pin";const Yo=t=>{let{setViewport:e,viewport:n,placeCoordinates:r}=t;return(0,i.jsx)("img",{className:"recenter-image",src:"/parcels/static/components/maps/reCenter.svg",alt:"reCenter",onClick:()=>{e({...n,placeCoordinates:r})}})};Yo.displayName="ReCenter";const Ko=()=>{const{viewport:t,setViewport:e,placeCoordinates:n}=h();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Go,{}),(0,i.jsx)(Yo,{viewport:t,setViewport:e,placeCoordinates:n})]})};Ko.displayName="Controllers";const Qo=(0,t.createContext)(null),$o=()=>(0,t.useContext)(Qo),Jo=e=>{let{children:n}=e;const[r,o]=(0,t.useState)({}),[s,a]=(0,t.useState)(null),[l,c]=(0,t.useState)(null),[u,h]=(0,t.useState)(null);return(0,t.useEffect)((()=>{s&&(async()=>{const t="\n\t    \t".concat("http://localhost:8000","/\n\t    \treverse_api\n\t    \t?language=pt_BR\n\t    ").replace(/\s/g,""),e=await fetch(t),n=(await e.json()).formatted_address,i=n.split(",").slice(0,3).join(",")+","+n.split(",").slice(-1);h(i)})()}),[s]),(0,i.jsx)(Qo.Provider,{value:{parcelsProperties:r,setParcelsProperties:o,setParcelLatitude:c,setParcelLongitude:a,currentAddress:u},children:n})};Qo.displayName="GoogleReverseApiContext";const ts=()=>{const{currentAddress:t}=$o();return(0,i.jsxs)("div",{className:"location-wrapper",children:[(0,i.jsx)("img",{style:{width:"10px"},src:"/parcels/static/components/maps/marker.svg",alt:"pin-location"}),(0,i.jsx)("div",{children:t})]})},es=()=>{const{basemap:t,setBasemap:e}=h();return(0,i.jsx)("div",{className:"basemaps-wrapper",children:(0,i.jsx)("img",{className:"basemaps-image",src:"/parcels/static/components/maps/globe.svg",alt:"globe",onClick:()=>{e("mapbox://styles/hvoking/clrwzn1jo015q01nl53664m2c"===t?"mapbox://styles/mapbox/satellite-v9":"mapbox://styles/hvoking/clrwzn1jo015q01nl53664m2c")}})})};es.displayName="BasemapsSelectors";const ns=t=>{let{children:e}=t;return(0,i.jsxs)("div",{className:"map-wrapper",children:[e,(0,i.jsx)(es,{}),(0,i.jsx)(ts,{})]})};ns.displayName="Wrapper";const is=(0,t.createContext)(null),rs=e=>{let{children:n}=e;const[r,o]=(0,t.useState)([]),[s,a]=(0,t.useState)("parcels");return(0,t.useEffect)((()=>{(async()=>{const t="\n\t\t    \t".concat("http://localhost:8000","/\n\t\t    \tstyle/\n\t\t    \t").concat(s,"\n\t\t    ").replace(/\s/g,""),e=await fetch(t),n=await e.json();o(n)})()}),[s]),(0,i.jsx)(is.Provider,{value:{styleData:r,styleName:s,setStyleName:a},children:n})};is.displayName="StylesContext";const os=()=>{const{styleData:e,styleName:n}=(0,t.useContext)(is),r="".concat("http://localhost:8000","/tiles?schema_name=layers&style_name=").concat(n,"&z={z}&x={x}&y={y}"),o=e.map(((t,e)=>(0,i.jsx)(Xo,{...t},e)));return(0,i.jsx)(qo,{id:"raster-style",type:"vector",tiles:[r],children:o})};os.displayName="Tiles";const ss=()=>{const{marker:e,setMarker:n,mapRef:r}=h(),[o,s]=(0,t.useState)("down"),[a,l]=(0,t.useState)(0);(0,t.useEffect)((()=>{const t=t=>{let i=.004,{latitude:r,longitude:o}=e;const a=()=>l((t=>(t+1)%4));switch(t.key){case"ArrowUp":case"W":case"w":n({latitude:r+i,longitude:o}),s("up"),a();break;case"ArrowDown":case"S":case"s":n({latitude:r-i,longitude:o}),s("down"),a();break;case"ArrowLeft":case"A":case"a":n({latitude:r,longitude:o-i}),s("left"),a();break;case"ArrowRight":case"D":case"d":n({latitude:r,longitude:o+i}),s("right"),a()}};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}}),[e]),(0,t.useEffect)((()=>{var t;null===(t=r.current)||void 0===t||t.flyTo({center:[e.longitude,e.latitude],essential:!0,duration:300})}),[e]);return(0,i.jsx)(Ho,{latitude:e.latitude,longitude:e.longitude,anchor:"center",children:(0,i.jsx)("div",{style:{width:"64px",height:"64px",backgroundImage:"url(".concat("/parcels/static/sprite/sprite-boy.png",")"),backgroundPosition:(()=>{let t=-64*a,e=0;switch(o){case"down":e=0;break;case"left":e=-64;break;case"right":e=-128;break;case"up":e=-192}return"".concat(t,"px ").concat(e,"px")})()}})})};ss.displayName="Avatar";var as=6371008.8;Math.PI;function ls(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function cs(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!us(t[0])||!us(t[1]))throw new Error("coordinates must contain numbers");return ls({type:"Point",coordinates:t},e,n)}function us(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function hs(t,e,n){if(null!==t)for(var i,r,o,s,a,l,c,u,h=0,d=0,f=t.type,p="FeatureCollection"===f,g="Feature"===f,m=p?t.features.length:1,v=0;v<m;v++){a=(u=!!(c=p?t.features[v].geometry:g?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var y=0;y<a;y++){var b=0,_=0;if(null!==(s=u?c.geometries[y]:c)){l=s.coordinates;var w=s.type;switch(h=!n||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(l,d,v,b,_))return!1;d++,b++;break;case"LineString":case"MultiPoint":for(i=0;i<l.length;i++){if(!1===e(l[i],d,v,b,_))return!1;d++,"MultiPoint"===w&&b++}"LineString"===w&&b++;break;case"Polygon":case"MultiLineString":for(i=0;i<l.length;i++){for(r=0;r<l[i].length-h;r++){if(!1===e(l[i][r],d,v,b,_))return!1;d++}"MultiLineString"===w&&b++,"Polygon"===w&&_++}"Polygon"===w&&b++;break;case"MultiPolygon":for(i=0;i<l.length;i++){for(_=0,r=0;r<l[i].length;r++){for(o=0;o<l[i][r].length-h;o++){if(!1===e(l[i][r][o],d,v,b,_))return!1;d++}_++}b++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(!1===hs(s.geometries[i],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function ds(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=0,i=0,r=0;return hs(t,(function(t){n+=t[0],i+=t[1],r++}),!0),cs([n/r,i/r],e.properties)}const fs=function(t,e){for(var n=0,i=0,r=0,o=0,s=0,a=0,l=0,c=0,u=null,h=null,d=t[0],f=t[1],p=e.length;n<p;n++){i=0;var g=e[n].length-1,m=e[n];if((u=m[0])[0]!==m[g][0]&&u[1]!==m[g][1])throw new Error("First and last coordinates in a ring must be the same");for(s=u[0]-d,a=u[1]-f;i<g;i++)if(c=(h=m[i+1])[1]-f,a<0&&c<0||a>0&&c>0)a=c,s=(u=h)[0]-d;else{if(l=h[0]-t[0],c>0&&a<=0){if((o=s*c-l*a)>0)r+=1;else if(0===o)return 0}else if(a>0&&c<=0){if((o=s*c-l*a)<0)r+=1;else if(0===o)return 0}else if(0===c&&a<0){if(0===(o=s*c-l*a))return 0}else if(0===a&&c<0){if(0===(o=s*c-l*a))return 0}else if(0===a&&0===c){if(l<=0&&s>=0)return 0;if(s<=0&&l>=0)return 0}u=h,a=c,s=l}}return r%2!==0};function ps(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");const i=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return[...t.geometry.coordinates];if("Point"===t.type)return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}(t),r="Feature"===(o=e).type?o.geometry:o;var o;const s=r.type,a=e.bbox;let l=r.coordinates;if(a&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(i,a))return!1;"Polygon"===s&&(l=[l]);let c=!1;for(var u=0;u<l.length;++u){const t=fs(i,l[u]);if(0===t)return!n.ignoreBoundary;t&&(c=!0)}return c}const gs=(0,t.createContext)(null),ms=e=>{let{children:n}=e;const{mapRef:r}=h(),{circleGeometry:o}=p(),[s,a]=(0,t.useState)([]),[l,c]=(0,t.useState)(!1);(0,t.useEffect)((()=>{const t=r.current;if(!t)return;const e=t=>t.tile&&c((t=>!t));return t.on("data",e),()=>{t.off("data",e)}}),[r.current]),(0,t.useEffect)((()=>{const t=r.current;t&&a(t.queryRenderedFeatures())}),[l,r.current]);const u=(0,t.useMemo)((()=>s.filter((t=>{if("raster-style"===t.source){return ps(ds(t.geometry),o)}}))),[s,o]);return(0,i.jsx)(gs.Provider,{value:{maskProperties:u},children:n})};gs.displayName="MaskContext";const vs=()=>{const{maskProperties:e}=(0,t.useContext)(gs);if(!e)return(0,i.jsx)(i.Fragment,{});const n={type:"FeatureCollection",features:e.filter((t=>Object.keys(t.layer.paint).includes("fill-color"))).map((t=>{const e=(t=>{const{r:e,g:n,b:i,a:r}=t;return"rgba(".concat(255*e,", ").concat(255*n,", ").concat(255*i,", ").concat(r,")")})(t.layer.paint["fill-color"]);return{type:"Feature",geometry:t.geometry,properties:{...t.properties,"fill-color":e}}}))};return(0,i.jsx)(qo,{id:"polygon-data",type:"geojson",data:n,children:(0,i.jsx)(Xo,{id:"extruded-polygons",type:"fill-extrusion",paint:{"fill-extrusion-color":["get","fill-color"],"fill-extrusion-height":["*",["get","indice_fin"],1e3],"fill-extrusion-base":0,"fill-extrusion-opacity":.9}})})};vs.displayName="Mask";const ys=(0,t.createContext)(null),bs=()=>(0,t.useContext)(ys),_s=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(!1),[s,a]=(0,t.useState)(!1),[l,c]=(0,t.useState)(!0),[u,h]=(0,t.useState)(!1);return(0,i.jsx)(ys.Provider,{value:{activeCurves:r,setActiveCurves:o,activeDrain:s,setActiveDrain:a,activeLots:l,setActiveLots:c,activePdf:u,setActivePdf:h},children:n})};function ws(t){return ws="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ws(t)}function xs(t){var e=function(t,e){if("object"!=ws(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=ws(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ws(e)?e:e+""}function Ss(t,e,n){return(e=xs(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ps(t){if("undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof process&&"object"===typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Es(){return!("object"===typeof process&&"[object process]"===String(process)&&!process.browser)||Ps()}ys.displayName="VisibilityContext";const Cs="undefined"!==typeof __VERSION__?__VERSION__:"untranspiled source";Es();class Ts{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";Ss(this,"storage",void 0),Ss(this,"id",void 0),Ss(this,"config",void 0),this.storage=function(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(e){return null}}(n),this.id=t,this.config=e,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function As(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const o=t.width*n,s=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(r,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let ks;function Ms(t){return"string"===typeof t?ks[t.toUpperCase()]||ks.WHITE:t}function Ls(t,e){if(!t)throw new Error(e||"Assertion failed")}!function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(ks||(ks={}));const Os={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof n.g&&n.g,document:"undefined"!==typeof document&&document,process:"object"===typeof process&&process},Rs=(globalThis,Os.window||Os.self||Os.global),Is=Os.process||{};console;function js(){let t;var e,n;if(Es&&"performance"in Rs)t=null===Rs||void 0===Rs||null===(e=Rs.performance)||void 0===e||null===(n=e.now)||void 0===n?void 0:n.call(e);else if("hrtime"in Is){var i;const e=null===Is||void 0===Is||null===(i=Is.hrtime)||void 0===i?void 0:i.call(Is);t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}const Fs={debug:Es&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},zs={enabled:!0,level:0};function Ns(){}const Ds={},Bs={once:!0};class Us{constructor(){let{id:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};Ss(this,"id",void 0),Ss(this,"VERSION",Cs),Ss(this,"_startTs",js()),Ss(this,"_deltaTs",js()),Ss(this,"_storage",void 0),Ss(this,"userData",{}),Ss(this,"LOG_THROTTLE_TIMEOUT",0),this.id=t,this.userData={},this._storage=new Ts("__probe-".concat(this.id,"__"),zs),this.timeStamp("".concat(this.id," started")),function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n);for(const r of i)"function"===typeof t[r]&&(e.find((t=>r===t))||(t[r]=t[r].bind(t)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((js()-this._startTs).toPrecision(10))}getDelta(){return Number((js()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.setConfiguration({enabled:t}),this}setLevel(t){return this._storage.setConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,e){this._storage.setConfiguration({[t]:e})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,e){Ls(t,e)}warn(t){return this._getLogFunction(0,t,Fs.warn,arguments,Bs)}error(t){return this._getLogFunction(0,t,Fs.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,Fs.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,Fs.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return this._getLogFunction(t,e,Fs.debug||Fs.info,arguments,Bs)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||Ns,n&&[n],{tag:Hs(e)}):Ns}image(t){let{logLevel:e,priority:n,image:i,message:r="",scale:o=1}=t;return this._shouldLog(e||n)?Es?function(t){let{image:e,message:n="",scale:i=1}=t;if("string"===typeof e){const t=new Image;return t.onload=()=>{const e=As(t,n,i);console.log(...e)},t.src=e,Ns}const r=e.nodeName||"";if("img"===r.toLowerCase())return console.log(...As(e,n,i)),Ns;if("canvas"===r.toLowerCase()){const t=new Image;return t.onload=()=>console.log(...As(t,n,i)),t.src=e.toDataURL(),Ns}return Ns}({image:i,message:r,scale:o}):function(t){let{image:e,message:n="",scale:i=1}=t;return console.warn("removed"),Ns}({image:i,message:r,scale:o}):Ns}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||Ns)}group(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const i=Ws({logLevel:t,message:e,opts:n}),{collapsed:r}=n;return i.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||Ns)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=Vs(t)}_getLogFunction(t,e,n,i,r){if(this._shouldLog(t)){r=Ws({logLevel:t,message:e,args:i,opts:r}),Ls(n=n||r.method),r.total=this.getTotal(),r.delta=this.getDelta(),this._deltaTs=js();const o=r.tag||r.message;if(r.once){if(Ds[o])return Ns;Ds[o]=js()}return e=function(t,e,n){if("string"===typeof e){const i=n.time?function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}(function(t){let e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s"),e}(n.total)):"";e=function(t,e,n){return Es||"string"!==typeof t||(e&&(e=Ms(e),t="\x1b[".concat(e,"m").concat(t,"\x1b[39m")),n&&(e=Ms(n),t="\x1b[".concat(n+10,"m").concat(t,"\x1b[49m"))),t}(e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),n.color,n.background)}return e}(this.id,r.message,r),n.bind(console,e,...r.args)}return Ns}}function Vs(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Ls(Number.isFinite(e)&&e>=0),e}function Ws(t){const{logLevel:e,message:n}=t;t.logLevel=Vs(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":void 0!==n&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e)}"function"===typeof t.message&&(t.message=t.message());const r=typeof t.message;return Ls("string"===r||"object"===r),Object.assign(t,{args:i},t.opts)}function Hs(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}Ss(Us,"VERSION",Cs);const Gs=new Us({id:"deck"}),Xs={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Xs,"IDENTITY",{get:()=>(Gs.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const qs={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Zs={common:0,meters:1,pixels:2},Ys={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},Ks="draw",Qs="mask",$s=new Us({id:"luma.gl"});function Js(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const ta="Invalid WebGLRenderingContext",ea="Requires WebGL2";function na(t){return"undefined"!==typeof WebGLRenderingContext&&t instanceof WebGLRenderingContext||("undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&Number.isFinite(t._version)))}function ia(t){return"undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}function ra(t){return Js(na(t),ta),t}function oa(t){return Js(ia(t),ea),t}const sa={};function aa(t,e){var n;sa[t]=!0,void 0!==e&&(n=e,globalThis.console&&globalThis.console.error&&globalThis.console.error(n))}const la=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const e=new t.VertexAttrib(n);this.attribs[i]=e}this.maxAttrib=0};(la.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const ca=function(t){const e=this;this.gl=t,function(t){const e=t.getError;t.getError=function(){let n;do{n=e.apply(t),0!==n&&(sa[n]=!0)}while(0!==n);for(n in sa)if(sa[n])return delete sa[n],parseInt(n,10);return 0}}(t);const n=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(t){return t===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(t){const i=e.currentVertexArrayObject;i.maxAttrib=Math.max(i.maxAttrib,t);return i.attribs[t].enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(t){const i=e.currentVertexArrayObject;i.maxAttrib=Math.max(i.maxAttrib,t);return i.attribs[t].enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(t,i){switch(t){case 34962:e.currentArrayBuffer=i;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=i}return n.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(t,i){const r=e.currentVertexArrayObject.attribs[t];switch(i){case 34975:return r.buffer;case 34338:return r.enabled;case 34339:return r.size;case 34340:return r.stride;case 34341:return r.type;case 34922:return r.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(t,i,r,o,s,a){const l=e.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,t);const c=l.attribs[t];return c.buffer=e.currentArrayBuffer,c.size=i,c.type=r,c.normalized=o,c.stride=s,c.offset=a,c.recache(),n.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",(()=>{var t;t="OESVertexArrayObject emulation library context restored",globalThis.console&&globalThis.console.log&&globalThis.console.log(t),e.reset_()}),!0),this.reset_()};ca.prototype.VERTEX_ARRAY_BINDING_OES=34229,ca.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let e=0;e<this.vertexArrayObjects.length;++e)this.vertexArrayObjects.isAlive=!1;const t=this.gl;this.maxVertexAttribs=t.getParameter(34921),this.defaultVertexArrayObject=new la(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},ca.prototype.createVertexArrayOES=function(){const t=new la(this);return this.vertexArrayObjects.push(t),t},ca.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},ca.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof la&&t.hasBeenBound&&t.ext===this)},ca.prototype.bindVertexArrayOES=function(t){const e=this.gl;if(t&&!t.isAlive)return void aa(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const n=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const r=this.currentVertexArrayObject;if(i===r)return;i&&r.elementArrayBuffer===i.elementArrayBuffer||n.bindBuffer.call(e,34963,r.elementArrayBuffer);let o=this.currentArrayBuffer;const s=Math.max(i?i.maxAttrib:0,r.maxAttrib);for(let a=0;a<=s;a++){const t=r.attribs[a],s=i?i.attribs[a]:null;if(i&&t.enabled===s.enabled||(t.enabled?n.enableVertexAttribArray.call(e,a):n.disableVertexAttribArray.call(e,a)),t.enabled){let r=!1;i&&t.buffer===s.buffer||(o!==t.buffer&&(n.bindBuffer.call(e,34962,t.buffer),o=t.buffer),r=!0),(r||t.cached!==s.cached)&&n.vertexAttribPointer.call(e,a,t.size,t.type,t.normalized,t.stride,t.offset)}}this.currentArrayBuffer!==o&&n.bindBuffer.call(e,34962,this.currentArrayBuffer)};const ua="OES_element_index",ha="WEBGL_draw_buffers",da="WEBGL_debug_renderer_info",fa=t=>ia(t)?void 0:0,pa={3074:t=>ia(t)?void 0:36064,35723:t=>ia(t)?void 0:4352,35977:fa,32937:fa,36795:(t,e)=>{const n=ia(t)?t.getExtension("EXT_disjoint_timer_query_webgl2"):t.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},37445:(t,e)=>{const n=t.getExtension(da);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},37446:(t,e)=>{const n=t.getExtension(da);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},34047:(t,e)=>{const n=t.luma.extensions.EXT_texture_filter_anisotropic;return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:fa,35071:fa,37447:fa,36063:(t,e)=>{if(!ia(t)){const n=t.getExtension(ha);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:fa,35374:fa,35377:fa,34852:t=>{if(!ia(t)){const e=t.getExtension(ha);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(ua)?2147483647:65535,33001:t=>t.getExtension(ua)?16777216:65535,33e3:t=>16777216,37157:fa,35373:fa,35657:fa,36183:fa,37137:fa,34045:fa,35978:fa,35979:fa,35968:fa,35376:fa,35375:fa,35659:fa,37154:fa,35371:fa,35658:fa,35076:fa,35077:fa,35380:fa};const ga="ANGLE_instanced_arrays";const ma={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{Js(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[ga]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Js(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Js(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{Js(!1)},deleteQuery:()=>{Js(!1)},beginQuery:()=>{Js(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},va={readBuffer:(t,e,n)=>{ia(t)&&e(n)},getVertexAttrib:(t,e,n,i)=>{const{webgl2:r,ext:o}=function(t,e){return{webgl2:ia(t),ext:t.getExtension(e)}}(t,ga);let s;switch(i){case 35069:s=!!r&&void 0;break;case 35070:s=r||o?void 0:0}return void 0!==s?s:e(n,i)},getProgramParameter:(t,e,n,i)=>{if(!ia(t))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(n,i)},getInternalformatParameter:(t,e,n,i,r)=>ia(t)||32937!==r?t.getInternalformatParameter(n,i,r):new Int32Array([0]),getTexParameter(t,e,n,i){if(34046===i){const{extensions:e}=t.luma,n=e.EXT_texture_filter_anisotropic;i=n&&n.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(n,i)},getParameter:function(t,e,n){const i=pa[n],r="function"===typeof i?i(t,e,n):i;return void 0!==r?r:e(n)},hint:(t,e,n,i)=>e(n,i)};function ya(t,e){let{extension:n,target:i,target2:r}=e;const o=ma[n];Js(o);const{meta:s={}}=o,{suffix:a=""}=s,l=t.getExtension(n);for(const c of Object.keys(o)){const e="".concat(c).concat(a);let n=null;"meta"===c||"function"===typeof t[c]||(l&&"function"===typeof l[e]?n=function(){return l[e](...arguments)}:"function"===typeof o[c]&&(n=o[c].bind(i))),n&&(i[c]=n,r[c]=n)}}globalThis.polyfillContext=function(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(!function(t){if("function"===typeof t.createVertexArray)return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};const n=t.getExtension;t.getExtension=function(e){return n.call(this,e)||("OES_vertex_array_object"!==e?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new ca(this)),this.__OESVertexArrayObject))}}(t),function(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}(t),function(t,e){for(const n of Object.getOwnPropertyNames(e))"overrides"!==n&&ya(t,{extension:n,target:t.luma,target2:t})}(t,ma),function(t,e){let{target:n,target2:i}=e;Object.keys(va).forEach((e=>{if("function"===typeof va[e]){const r=t[e]?t[e].bind(t):()=>{},o=va[e].bind(null,t,r);n[e]=o,i[e]=o}}))}(t,{target:e,target2:t}),e.polyfilled=!0),t};const ba={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},_a=(t,e,n)=>e?t.enable(n):t.disable(n),wa=(t,e,n)=>t.hint(n,e),xa=(t,e,n)=>t.pixelStorei(n,e);function Sa(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const Pa={3042:_a,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:_a,2885:(t,e)=>t.cullFace(e),2929:_a,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:_a,35723:wa,36006:(t,e)=>{const n=ia(t)?36009:36160;return t.bindFramebuffer(n,e)},2886:(t,e)=>t.frontFace(e),33170:wa,2849:(t,e)=>t.lineWidth(e),32823:_a,32824:"polygonOffset",10752:"polygonOffset",35977:_a,32938:"sampleCoverage",32939:"sampleCoverage",3089:_a,3088:(t,e)=>t.scissor(...e),2960:_a,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:xa,3317:xa,37440:xa,37441:xa,37443:xa,3330:xa,3332:xa,3331:xa,36010:(t,e)=>t.bindFramebuffer(36008,e),3314:xa,32878:xa,3316:xa,3315:xa,32877:xa,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Sa(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Sa(e)&&2===e.length?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Sa(e)?e:[e,e];const[n,i]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,i)},stencilFunc:(t,e)=>{e=Sa(e)&&3===e.length?[...e,...e]:e;const[n,i,r,o,s,a]=e;t.stencilFuncSeparate(1028,n,i,r),t.stencilFuncSeparate(1029,o,s,a)},stencilOp:(t,e)=>{e=Sa(e)&&3===e.length?[...e,...e]:e;const[n,i,r,o,s,a]=e;t.stencilOpSeparate(1028,n,i,r),t.stencilOpSeparate(1029,o,s,a)},viewport:(t,e)=>t.viewport(...e)};function Ea(t,e,n){return void 0!==e[t]?e[t]:n[t]}const Ca={blendEquation:(t,e,n)=>t.blendEquationSeparate(Ea(32777,e,n),Ea(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Ea(32969,e,n),Ea(32968,e,n),Ea(32971,e,n),Ea(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Ea(32824,e,n),Ea(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Ea(32938,e,n),Ea(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Ea(2962,e,n),Ea(2967,e,n),Ea(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Ea(34816,e,n),Ea(36003,e,n),Ea(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Ea(2964,e,n),Ea(2965,e,n),Ea(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Ea(34817,e,n),Ea(34818,e,n),Ea(34819,e,n))},Ta={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,i,r)=>t({32773:new Float32Array([e,n,i,r])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,i,r)=>t({32969:e,32968:n,32971:i,32970:r}),clearColor:(t,e,n,i,r)=>t({3106:new Float32Array([e,n,i,r])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,i,r)=>t({3107:[e,n,i,r]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,i,r)=>t({3088:new Int32Array([e,n,i,r])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[1028===e?2968:36005]:n}),stencilFunc:(t,e,n,i)=>t({2962:e,2967:n,2963:i,34816:e,36003:n,36004:i}),stencilFuncSeparate:(t,e,n,i,r)=>t({[1028===e?2962:34816]:n,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(t,e,n,i)=>t({2964:e,2965:n,2966:i,34817:e,34818:n,34819:i}),stencilOpSeparate:(t,e,n,i,r)=>t({[1028===e?2964:34817]:n,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(t,e,n,i,r)=>t({2978:[e,n,i,r]})},Aa=(t,e)=>t.isEnabled(e),ka={3042:Aa,2884:Aa,2929:Aa,3024:Aa,32823:Aa,32926:Aa,32928:Aa,3089:Aa,2960:Aa,35977:Aa};function Ma(t){for(const e in t)return!1;return!0}function La(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),i=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&i&&t.length===e.length){for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}return!1}function Oa(t,e){const n=t[e].bind(t);t[e]=function(){const e=arguments.length<=0?void 0:arguments[0];return e in t.state.cache&&t.state.enable?t.state.cache[e]:n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function Ra(t,e,n){const i=t[e].bind(t);t[e]=function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];const{valueChanged:s,oldValue:a}=n(t.state._updateCache,...r);return s&&i(...r),a},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}class Ia{constructor(t){let{copyState:e=!1,log:n=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.program=null,this.stateStack=[],this.enable=!0,this.cache=e?function(t,e){if("number"===typeof(e=e||ba)){const n=e,i=ka[n];return i?i(t,n):t.getParameter(n)}const n=Array.isArray(e)?e:Object.keys(e),i={};for(const r of n){const e=ka[r];i[r]=e?e(t,Number(r)):t.getParameter(Number(r))}return i}(t):Object.assign({},ba),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Js(this.stateStack.length>0);const t=this.stateStack[this.stateStack.length-1];za(this.gl,t),this.stateStack.pop()}_updateCache(t){let e,n=!1;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const r in t){Js(void 0!==r);const o=t[r],s=this.cache[r];La(o,s)||(n=!0,e=s,i&&!(r in i)&&(i[r]=s),this.cache[r]=o)}return{valueChanged:n,oldValue:e}}}function ja(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{enable:n=!0,copyState:i}=e;if(Js(void 0!==i),!t.state){const{polyfillContext:e}=globalThis;e&&e(t),t.state=new Ia(t,{copyState:i}),function(t){const e=t.useProgram.bind(t);t.useProgram=function(n){t.state.program!==n&&(e(n),t.state.program=n)}}(t);for(const n in Ta){Ra(t,n,Ta[n])}Oa(t,"getParameter"),Oa(t,"isEnabled")}return t.state.enable=n,t}function Fa(t){Js(t.state),t.state.pop()}function za(t,e){if(Js(na(t),"setParameters requires a WebGL context"),Ma(e))return;const n={};for(const r in e){const i=Number(r),o=Pa[r];o&&("string"===typeof o?n[o]=!0:o(t,e[r],i))}const i=t.state&&t.state.cache;if(i)for(const r in n){(0,Ca[r])(t,e,i)}}function Na(t,e,n){if(Ma(e))return n(t);const{nocatch:i=!0}=e;let r;if(function(t){t.state||ja(t,{copyState:!1}),t.state.push()}(t),za(t,e),i)r=n(t),Fa(t);else try{r=n(t)}finally{Fa(t)}return r}function Da(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,i="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return i?t.drawingBufferWidth/i:1}return 1}function Ba(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(t,e,n,i,r){const o=Ua(t[0],e,n);let s=Va(t[1],e,i,r),a=Ua(t[0]+1,e,n);const l=a===n-1?a:a-1;let c;a=Va(t[1]+1,e,i,r),r?(a=0===a?a:a+1,c=s,s=a):c=a===i-1?a:a-1;return{x:o,y:s,width:Math.max(l-o+1,1),height:Math.max(c-s+1,1)}}(e,Da(t),t.drawingBufferWidth,t.drawingBufferHeight,n)}function Ua(t,e,n){return Math.min(Math.round(t*e),n-1)}function Va(t,e,n,i){return i?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const Wa=Es(),Ha=Wa&&"undefined"!==typeof document,Ga={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function Xa(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Js(Wa,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),t=Object.assign({},Ga,t);const{width:e,height:n}=t;function i(e){if(t.throwOnError)throw new Error(e);return console.error(e),null}let r;t.onError=i;const{canvas:o}=t,s=function(t){let e,{canvas:n,width:i=800,height:r=600,onError:o}=t;if("string"===typeof n){Ha&&"complete"===document.readyState||o("createGLContext called on canvas '".concat(n,"' before page was loaded")),e=document.getElementById(n)}else n?e=n:(e=document.createElement("canvas"),e.id="lumagl-canvas",e.style.width=Number.isFinite(i)?"".concat(i,"px"):"100%",e.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(e,document.body.firstChild));return e}({canvas:o,width:e,height:n,onError:i});return r=function(t,e){const{onError:n}=e;let i=null;const r=t=>i=t.statusMessage||i;t.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:o=!0,webgl2:s=!0}=e;let a=null;s&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e));o&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e));if(t.removeEventListener("webglcontextcreationerror",r,!1),!a)return n("Failed to create ".concat(s&&!o?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"));e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1);e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1);return a}(s,t),r?(r=qa(r,t),function(t){const e=ia(t)?"WebGL2":"WebGL1",n=function(t){const e=t.getParameter(7936),n=t.getParameter(7937),i=t.getExtension("WEBGL_debug_renderer_info"),r=i&&t.getParameter(i.UNMASKED_VENDOR_WEBGL||7936),o=i&&t.getParameter(i.UNMASKED_RENDERER_WEBGL||7937);return{vendor:r||e,renderer:o||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t),i=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",r=t.debug?" debug":"";$s.info(1,"".concat(e).concat(r," context ").concat(i))()}(r),r):null}function qa(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||function(t){if("undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext)return 2;return 1}(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},Ga,e);const{manageState:n,debug:i}=e;return n&&ja(t,{copyState:!1,log:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return $s.log(1,...e)()}}),Wa&&i&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),$s.level=Math.max($s.level,1)):$s.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function Za(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.canvas){return void function(t,e,n){let i="width"in n?n.width:t.canvas.clientWidth,r="height"in n?n.height:t.canvas.clientHeight;i&&r||($s.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=t.canvas.width||1,r=t.canvas.height||1);t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const o=t.luma.canvasSizeInfo;if(o.clientWidth!==i||o.clientHeight!==r||o.devicePixelRatio!==e){let n=e;const o=Math.floor(i*n),s=Math.floor(r*n);t.canvas.width=o,t.canvas.height=s,t.drawingBufferWidth===o&&t.drawingBufferHeight===s||($s.warn("Device pixel ratio clamped")(),n=Math.min(t.drawingBufferWidth/i,t.drawingBufferHeight/r),t.canvas.width=Math.floor(i*n),t.canvas.height=Math.floor(r*n)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}(t,function(t){const e="undefined"===typeof window?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}(e.useDevicePixels),e)}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function Ya(){let t;if("undefined"!==typeof window&&window.performance)t=window.performance.now();else if("undefined"!==typeof process&&process.hrtime){const e=process.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}class Ka{constructor(t,e){Ss(this,"name",void 0),Ss(this,"type",void 0),Ss(this,"sampleSize",1),Ss(this,"time",void 0),Ss(this,"count",void 0),Ss(this,"samples",void 0),Ss(this,"lastTiming",void 0),Ss(this,"lastSampleTime",void 0),Ss(this,"lastSampleCount",void 0),Ss(this,"_count",0),Ss(this,"_time",0),Ss(this,"_samples",0),Ss(this,"_startTime",0),Ss(this,"_timerPending",!1),this.name=t,this.type=e,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Ya(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Ya()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Qa{constructor(t){Ss(this,"id",void 0),Ss(this,"stats",{}),this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach((e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((t=>this._getOrCreate(t)))}_getOrCreate(t){if(!t||!t.name)return null;const{name:e,type:n}=t;return this.stats[e]||(this.stats[e]=t instanceof Ka?t:new Ka(e,n)),this.stats[e]}}const $a="8.5.21";const Ja=new class{constructor(){this.stats=new Map}get(t){return this.stats.has(t)||this.stats.set(t,new Qa({id:t})),this.stats.get(t)}};if(globalThis.luma&&globalThis.luma.VERSION!==$a)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat($a));globalThis.luma||(Es()&&$s.log(1,"luma.gl ".concat($a," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),globalThis.luma=globalThis.luma||{VERSION:$a,version:$a,log:$s,stats:Ja,globals:{modules:{},nodeIO:{}}});globalThis.luma;function tl(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function el(t,e){if("string"!==typeof e)return e;const n=Number(e);if(!isNaN(n))return n;const i=t[e=e.replace(/^.*\./,"")];return tl(void 0!==i,"Accessing undefined constant GL.".concat(e)),i}function nl(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const il={};function rl(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";il[t]=il[t]||1;const e=il[t]++;return"".concat(t,"-").concat(e)}function ol(t){return tl("number"===typeof t,"Input must be a number"),t&&0===(t&t-1)}function sl(t){let e=!0;for(const n in t){e=!1;break}return e}function al(t,e,n,i){const r="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),o=Object.getPrototypeOf(t);i.forEach((t=>{o.methodName||(o[t]=()=>{throw $s.removed("Calling removed method ".concat(e,".").concat(t,": "),r)(),new Error(t)})}))}const ll="Resource subclass must define virtual methods";class cl{get[Symbol.toStringTag](){return"Resource"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ra(t);const{id:n,userData:i={}}=e;this.gl=t,this.gl2=t,this.id=n||rl(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=e.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,e&&t&&e.filter(Boolean).forEach((t=>t.delete())),this}bind(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!==typeof e?(this._bindHandle(e),this):(this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t)}unbind(){this.bind(null)}getParameter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};tl(t=el(this.gl,t));const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=ia(this.gl);if(!((!("webgl2"in n)||t)&&(!("extension"in n)||this.gl.getExtension(n.extension)))){const e=n.webgl1,i="webgl2"in n?n.webgl2:n.webgl1;return t?i:e}}return this._getParameter(t,e)}getParameters(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{parameters:e,keys:n}=t,i=this.constructor.PARAMETERS||{},r=ia(this.gl),o={},s=e||Object.keys(i);for(const a of s){const e=i[a];if(e&&(!("webgl2"in e)||r)&&(!("extension"in e)||this.gl.getExtension(e.extension))){const i=n?nl(this.gl,a):a;o[i]=this.getParameter(a,t),n&&"GLenum"===e.type&&(o[i]=nl(this.gl,o[i]))}}return o}setParameter(t,e){tl(t=el(this.gl,t));const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=ia(this.gl);if(!((!("webgl2"in n)||t)&&(!("extension"in n)||this.gl.getExtension(n.extension))))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(e=el(e))}return this._setParameter(t,e),this}setParameters(t){for(const e in t)this.setParameter(e,t[e]);return this}stubRemovedMethods(t,e,n){return al(this,t,e,n)}initialize(t){}_createHandle(){throw new Error(ll)}_deleteHandle(){throw new Error(ll)}_bindHandle(t){throw new Error(ll)}_getOptsFromHandle(){throw new Error(ll)}_getParameter(t,e){throw new Error(ll)}_setParameter(t,e){throw new Error(ll)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const t=this[Symbol.toStringTag],e=Ja.get("Resource Counts");e.get("Resources Created").incrementCount(),e.get("".concat(t,"s Created")).incrementCount(),e.get("".concat(t,"s Active")).incrementCount()}_removeStats(){const t=this[Symbol.toStringTag];Ja.get("Resource Counts").get("".concat(t,"s Active")).decrementCount()}_trackAllocatedMemory(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(t,e),this._trackAllocatedMemoryForContext(t,e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=t}_trackAllocatedMemoryForContext(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const i=Ja.get("Memory Usage".concat(n));i.get("GPU Memory").addCount(t),i.get("".concat(e," Memory")).addCount(t)}_trackDeallocatedMemory(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(t),this._trackDeallocatedMemoryForContext(t,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=Ja.get("Memory Usage".concat(e));n.get("GPU Memory").subtractCount(this.byteLength),n.get("".concat(t," Memory")).subtractCount(this.byteLength)}}const ul="Failed to deduce GL constant from typed array";function hl(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(ul)}}function dl(t){let{clamped:e=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function fl(t){let{data:e,width:n,height:i}=t;const r=Math.round(n/2),o=Math.round(i/2),s=new Uint8Array(r*o*4);for(let a=0;a<o;a++)for(let t=0;t<r;t++)for(let i=0;i<4;i++)s[4*(a*r+t)+i]=e[4*(2*a*n+2*t)+i];return{data:s,width:r,height:o}}function pl(t,e,n){const{removedProps:i={},deprecatedProps:r={},replacedProps:o={}}=n;for(const a in i)if(a in e){const e=i[a]?"".concat(t,".").concat(i[a]):"N/A";$s.removed("".concat(t,".").concat(a),e)()}for(const a in r)if(a in e){const e=r[a];$s.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(e))()}let s=null;for(const a in o)if(a in e){const n=o[a];$s.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(n))(),s=s||Object.assign({},e),s[n]=e[a],delete s[a]}return s||e}const gl={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},ml={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class vl{static getBytesPerElement(t){return dl(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){tl(t.size);return dl(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new vl(...[gl,...e])}constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach((t=>this._assign(t))),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return vl.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return vl.getBytesPerVertex(this)}_assign(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=pl("Accessor",t,ml),void 0!==t.type&&(this.type=t.type,5124!==t.type&&5125!==t.type||(this.integer=!0)),void 0!==t.size&&(this.size=t.size),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.buffer&&(this.buffer=t.buffer),void 0!==t.index&&("boolean"===typeof t.index?this.index=t.index?1:0:this.index=t.index),void 0!==t.instanced&&(this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(this.divisor=t.isInstanced?1:0),this}}const yl={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},bl={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:yl},_l={removedProps:yl};class wl extends cl{get[Symbol.toStringTag](){return"Buffer"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=e.target||(this.gl.webgl2?36662:34962),this.initialize(e),Object.seal(this)}getElementCount(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/vl.getBytesPerElement(t))}getVertexCount(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/vl.getBytesPerVertex(t))}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t=pl("Buffer",t,bl),this.usage=t.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},t,t.accessor)),t.data?this._setData(t.data,t.offset,t.byteLength):this._setByteLength(t.byteLength||0),this}setProps(t){return"accessor"in(t=pl("Buffer",t,_l))&&this.setAccessor(t.accessor),this}setAccessor(t){return delete(t=Object.assign({},t)).buffer,this.accessor=new vl(t),this}reallocate(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}setData(t){return this.initialize(t)}subData(t){ArrayBuffer.isView(t)&&(t={data:t});const{data:e,offset:n=0,srcOffset:i=0}=t,r=t.byteLength||t.length;tl(e);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==i||void 0!==r?(oa(this.gl),this.gl.bufferSubData(this.target,n,e,i,r)):this.gl.bufferSubData(o,n,e),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(e),this}copyData(t){let{sourceBuffer:e,readOffset:n=0,writeOffset:i=0,size:r}=t;const{gl:o}=this;return oa(o),o.bindBuffer(36662,e.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,n,i,r),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:t=null,srcByteOffset:e=0,dstOffset:n=0,length:i=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};oa(this.gl);const r=dl(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(e),s=n;let a,l;t?(l=t.length,a=l-s):(a=Math.min(o,i||o),l=s+a);const c=Math.min(o,a);return i=i||c,tl(i<=c),t=t||new r(l),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,t,n,i),this.gl.bindBuffer(36662,null),t}bind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index,offset:n=0,size:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===t||35982===t?void 0!==i?this.gl.bindBufferRange(t,e,this.handle,n,i):(tl(0===n),this.gl.bindBufferBase(t,e,this.handle)):this.gl.bindBuffer(t,this.handle),this}unbind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===t||35982===t?this.gl.bindBufferBase(t,e,null):this.gl.bindBuffer(t,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.byteLength+e;tl(ArrayBuffer.isView(t)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.usage),this.gl.bufferSubData(i,e,t),this.gl.bindBuffer(i,null),this.debugData=t.slice(0,10),this.bytesUsed=n,this._trackAllocatedMemory(n);const r=hl(t);return tl(r),this.setAccessor(new vl(this.accessor,{type:r})),this}_setByteLength(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;tl(t>=0),this._trackDeallocatedMemory();let n=t;0===t&&(n=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,e),this.gl.bindBuffer(i,null),this.usage=e,this.debugData=null,this.bytesUsed=t,this._trackAllocatedMemory(t),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(t){const e=t/dl(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-e}_inferType(t){this.accessor.type||this.setAccessor(new vl(this.accessor,{type:hl(t)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(t){this.gl.bindBuffer(this.target,this.handle);const e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}get type(){return $s.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return $s.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(t){return $s.deprecated("setByteLength","reallocate")(),this.reallocate(t)}updateAccessor(t){return $s.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new vl(this.accessor,t),this}}const xl={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},Sl={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},Pl={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};const El=[9729,9728],Cl=globalThis.WebGLBuffer||function(){};class Tl extends cl{get[Symbol.toStringTag](){return"Texture"}static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{format:n,linearFiltering:i}=e;let r=!0;return n&&(r=r&&function(t,e){const n=xl[e];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;const i=ia(t)&&n.gl2||n.gl1;return"string"===typeof i?t.getExtension(i):i}(t,n),r=r&&(!i||function(t,e){const n=xl[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}(t,n))),r}constructor(t,e){const{id:n=rl("texture"),handle:i,target:r}=e;super(t,{id:n,handle:i}),this.target=r,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.data;if(e instanceof Promise)return e.then((e=>this.initialize(Object.assign({},t,{pixels:e,data:e})))),this;const n="undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement;if(n&&e.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,e.addEventListener("loadeddata",(()=>this.initialize(t))),this;const{pixels:i=null,format:r=6408,border:o=0,recreate:s=!1,parameters:a={},pixelStore:l={},textureUnit:c}=t;e||(e=i);let{width:u,height:h,dataFormat:d,type:f,compressed:p=!1,mipmaps:g=!0}=t;const{depth:m=0}=t;return({width:u,height:h,compressed:p,dataFormat:d,type:f}=this._deduceParameters({format:r,type:f,dataFormat:d,compressed:p,data:e,width:u,height:h})),this.width=u,this.height=h,this.depth=m,this.format=r,this.type=f,this.dataFormat=d,this.border=o,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),g&&this._isNPOT()&&($s.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),g=!1,this._updateForNPOT(a)),this.mipmaps=g,this.setImageData({data:e,width:u,height:h,depth:m,format:r,type:f,dataFormat:d,border:o,mipmaps:g,parameters:l,compressed:p}),g&&this.generateMipmap(),this.setParameters(a),s&&(this.data=e),n&&(this._video={video:e,parameters:a,lastTime:e.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?e.currentTime:-1}),this}update(){if(this._video){const{video:t,parameters:e,lastTime:n}=this._video;if(n===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}resize(t){let{height:e,width:n,mipmaps:i=!1}=t;return n!==this.width||e!==this.height?this.initialize({width:n,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isNPOT()?($s.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Na(this.gl,t,(()=>{this.gl.generateMipmap(this.target)})),this.gl.bindTexture(this.target,null),this)}setImageData(t){this._trackDeallocatedMemory("Texture");const{target:e=this.target,pixels:n=null,level:i=0,format:r=this.format,border:o=this.border,offset:s=0,parameters:a={}}=t;let{data:l=null,type:c=this.type,width:u=this.width,height:h=this.height,dataFormat:d=this.dataFormat,compressed:f=!1}=t;l||(l=n),({type:c,dataFormat:d,compressed:f,width:u,height:h}=this._deduceParameters({format:r,type:c,dataFormat:d,compressed:f,data:l,width:u,height:h}));const{gl:p}=this;p.bindTexture(this.target,this.handle);let g,m=null;({data:l,dataType:m}=this._getDataType({data:l,compressed:f}));let v=0;if(Na(this.gl,a,(()=>{switch(m){case"null":p.texImage2D(e,i,r,u,h,o,d,c,l);break;case"typed-array":p.texImage2D(e,i,r,u,h,o,d,c,l,s);break;case"buffer":g=oa(p),g.bindBuffer(35052,l.handle||l),g.texImage2D(e,i,r,u,h,o,d,c,s),g.bindBuffer(35052,null);break;case"browser-object":ia(p)?p.texImage2D(e,i,r,u,h,o,d,c,l):p.texImage2D(e,i,r,d,c,l);break;case"compressed":for(const[t,n]of l.entries())p.compressedTexImage2D(e,t,n.format,n.width,n.height,o,n.data),v+=n.levelSize;break;default:tl(!1,"Unknown image data type")}})),"compressed"===m)this._trackAllocatedMemory(v,"Texture");else if(l&&l.byteLength)this._trackAllocatedMemory(l.byteLength,"Texture");else{const t=Sl[this.dataFormat]||4,e=Pl[this.type]||1;this._trackAllocatedMemory(this.width*this.height*t*e,"Texture")}return this.loaded=!0,this}setSubImageData(t){let{target:e=this.target,pixels:n=null,data:i=null,x:r=0,y:o=0,width:s=this.width,height:a=this.height,level:l=0,format:c=this.format,type:u=this.type,dataFormat:h=this.dataFormat,compressed:d=!1,offset:f=0,border:p=this.border,parameters:g={}}=t;if(({type:u,dataFormat:h,compressed:d,width:s,height:a}=this._deduceParameters({format:c,type:u,dataFormat:h,compressed:d,data:i,width:s,height:a})),tl(0===this.depth,"texSubImage not supported for 3D textures"),i||(i=n),i&&i.data){const t=i;i=t.data,s=t.shape[0],a=t.shape[1]}i instanceof wl&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Na(this.gl,g,(()=>{if(d)this.gl.compressedTexSubImage2D(e,l,r,o,s,a,c,i);else if(null===i)this.gl.texSubImage2D(e,l,r,o,s,a,h,u,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(e,l,r,o,s,a,h,u,i,f);else if(i instanceof Cl){const t=oa(this.gl);t.bindBuffer(35052,i),t.texSubImage2D(e,l,r,o,s,a,h,u,f),t.bindBuffer(35052,null)}else if(ia(this.gl)){oa(this.gl).texSubImage2D(e,l,r,o,s,a,h,u,i)}else this.gl.texSubImage2D(e,l,r,o,h,u,i)})),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return $s.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType(t){let{data:e,compressed:n=!1}=t;return n?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof wl?{data:e.handle,dataType:"buffer"}:e instanceof Cl?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:n}=t;let{width:i,height:r,dataFormat:o,type:s,compressed:a}=t;const l=xl[e];return o=o||l&&l.dataFormat,s=s||l&&l.types[0],a=a||l&&l.compressed,({width:i,height:r}=this._deduceImageSize(n,i,r)),{dataFormat:o,type:s,compressed:a,width:i,height:r,format:e,data:n}}_deduceImageSize(t,e,n){let i;return i="undefined"!==typeof ImageData&&t instanceof ImageData?{width:t.width,height:t.height}:"undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?{width:t.width,height:t.height}:"undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:n}:{width:e>=0?e:1,height:n>=0?n:1},tl(i,"Could not deduced texture size"),tl(void 0===e||i.width===e,"Deduced texture width does not match supplied width"),tl(void 0===n||i.height===n,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}_setParameter(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:tl(!1);break;default:this.gl.texParameteri(this.target,t,e)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!ia(this.gl)&&(!(!this.width||!this.height)&&(!ol(this.width)||!ol(this.height)))}_updateForNPOT(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(t,e){if(this._isNPOT())switch(t){case 10241:-1===El.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071)}return e}}let Al="";class kl extends Tl{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(t,e){return Tl.isSupported(t,e)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,i;ra(t),(e instanceof Promise||"string"===typeof e)&&(e={data:e}),"string"===typeof e.data&&(e=Object.assign({},e,{data:(n=e.data,tl("string"===typeof n),n=Al+n,new Promise(((t,e)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>e(new Error("Could not load image ".concat(n,"."))),r.crossOrigin=i&&i.crossOrigin||"anonymous",r.src=n}catch(r){e(r)}})))})),super(t,Object.assign({},e,{target:3553})),this.initialize(e),Object.seal(this)}}const Ml="EXT_color_buffer_float",Ll={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Ml,bpp:2},33327:{gl2:Ml,bpp:4},34842:{gl2:Ml,bpp:8},33326:{gl2:Ml,bpp:4},33328:{gl2:Ml,bpp:8},34836:{gl2:Ml,bpp:16},35898:{gl2:Ml,bpp:4}};class Ol extends cl{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(t){let{format:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:null};return!e||function(t,e,n){const i=n[e];if(!i)return!1;const r=ia(t)&&i.gl2||i.gl1;return"string"===typeof r?t.getExtension(r):r}(t,e,Ll)}static getSamplesForFormat(t,e){let{format:n}=e;return t.getInternalformatParameter(36161,n,32937)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.initialize(e),Object.seal(this)}initialize(t){let{format:e,width:n=1,height:i=1,samples:r=0}=t;return tl(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&ia(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,e,n,i):this.gl.renderbufferStorage(36161,e,n,i),this.format=e,this.width=n,this.height=i,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*Ll[this.format].bpp),this}resize(t){let{width:e,height:n}=t;return e!==this.width||n!==this.height?this.initialize({width:e,height:n,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(t){this.gl.bindRenderbuffer(36161,t)}_syncHandle(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(t){this.gl.bindRenderbuffer(36161,this.handle);return this.gl.getRenderbufferParameter(36161,t)}}const Rl=256,Il=1024,jl=16384,Fl=6144,zl=6145,Nl=6146,Dl=34041,Bl="clear: bad arguments";function Ul(t){let{framebuffer:e=null,color:n=null,depth:i=null,stencil:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o={};e&&(o.framebuffer=e);let s=0;n&&(s|=jl,!0!==n&&(o.clearColor=n)),i&&(s|=Rl,!0!==i&&(o.clearDepth=i)),r&&(s|=Il,!0!==i&&(o.clearStencil=i)),tl(0!==s,Bl),Na(t,o,(()=>{t.clear(s)}))}const Vl=[34069,34070,34071,34072,34073,34074];class Wl extends Tl{get[Symbol.toStringTag](){return"TextureCube"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ra(t),super(t,Object.assign({},e,{target:34067})),this.initialize(e),Object.seal(this)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mipmaps:e=!0,parameters:n={}}=t;return this.opts=t,this.setCubeMapImageData(t).then((()=>{this.loaded=!0,e&&this.generateMipmap(t),this.setParameters(n)})),this}subImage(t){let{face:e,data:n,x:i=0,y:r=0,mipmapLevel:o=0}=t;return this._subImage({target:e,data:n,x:i,y:r,mipmapLevel:o})}async setCubeMapImageData(t){let{width:e,height:n,pixels:i,data:r,border:o=0,format:s=6408,type:a=5121}=t;const{gl:l}=this,c=i||r,u=await Promise.all(Vl.map((t=>{const e=c[t];return Promise.all(Array.isArray(e)?e:[e])})));this.bind(),Vl.forEach(((t,i)=>{u[i].length>1&&!1!==this.opts.mipmaps&&$s.warn("".concat(this.id," has mipmap and multiple LODs."))(),u[i].forEach(((i,r)=>{e&&n?l.texImage2D(t,r,s,e,n,o,s,a,i):l.texImage2D(t,r,s,s,a,i)}))})),this.unbind()}setImageDataForFace(t){const{face:e,width:n,height:i,pixels:r,data:o,border:s=0,format:a=6408,type:l=5121}=t,{gl:c}=this,u=r||o;return this.bind(),u instanceof Promise?u.then((n=>this.setImageDataForFace(Object.assign({},t,{face:e,data:n,pixels:n})))):this.width||this.height?c.texImage2D(e,0,a,n,i,s,a,l,u):c.texImage2D(e,0,a,a,l,u),this}}Wl.FACES=Vl;class Hl extends Tl{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(t){return ia(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};oa(t),e=Object.assign({depth:1},e,{target:32879,unpackFlipY:!1}),super(t,e),this.initialize(e),Object.seal(this)}setImageData(t){let{level:e=0,dataFormat:n=6408,width:i,height:r,depth:o=1,border:s=0,format:a,type:l=5121,offset:c=0,data:u,parameters:h={}}=t;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Na(this.gl,h,(()=>{ArrayBuffer.isView(u)&&this.gl.texImage3D(this.target,e,n,i,r,o,s,a,l,u),u instanceof wl&&(this.gl.bindBuffer(35052,u.handle),this.gl.texImage3D(this.target,e,n,i,r,o,s,a,l,c))})),u&&u.byteLength)this._trackAllocatedMemory(u.byteLength,"Texture");else{const t=Sl[this.dataFormat]||4,e=Pl[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*t*e,"Texture")}return this.loaded=!0,this}}function Gl(t,e){tl(t instanceof kl||t instanceof Wl||t instanceof Hl);const n=t.constructor,{gl:i,width:r,height:o,format:s,type:a,dataFormat:l,border:c,mipmaps:u}=t;return new n(i,Object.assign({width:r,height:o,format:s,type:a,dataFormat:l,border:c,mipmaps:u},e))}function Xl(t,e){const{gl:n,width:i,height:r,id:o}=t;return new Ql(n,Object.assign({},e,{id:"framebuffer-for-".concat(o),width:i,height:r,attachments:{36064:t}}))}function ql(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{sourceX:n=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:o=36064,target:s=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e;const{framebuffer:u,deleteFramebuffer:h}=Yl(t);tl(u);const{gl:d,handle:f,attachments:p}=u;a=a||u.width,l=l||u.height,36064===o&&null===f&&(o=1028),tl(p[o]),c=c||p[o].type,s=function(t,e,n,i,r){if(t)return t;e=e||5121;const o=dl(e,{clamped:!1}),s=function(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return tl(!1),0}}(n);return new o(i*r*s)}(s,c,r,a,l),c=c||hl(s);const g=d.bindFramebuffer(36160,f);return d.readPixels(n,i,a,l,r,c,s),d.bindFramebuffer(36160,g||null),h&&u.delete(),s}function Zl(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=ql(t,{sourceAttachment:e}),{width:r,height:o}=t;for(;o>n;)({data:i,width:r,height:o}=fl({data:i,width:r,height:o}));!function(t){let{data:e,width:n,height:i,bytesPerPixel:r=4,temp:o}=t;const s=n*r;o=o||new Uint8Array(s);for(let a=0;a<i/2;++a){const t=a*s,n=(i-a-1)*s;o.set(e.subarray(t,t+s)),e.copyWithin(t,n,n+s),e.set(o,n)}}({data:i,width:r,height:o});const s=document.createElement("canvas");s.width=r,s.height=o;const a=s.getContext("2d"),l=a.createImageData(r,o);return l.data.set(i),a.putImageData(l,0,0),s.toDataURL()}function Yl(t){return t instanceof Ql?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:Xl(t),deleteFramebuffer:!0}}const Kl="Multiple render targets not supported";class Ql extends cl{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{colorBufferFloat:n,colorBufferHalfFloat:i}=e;let r=!0;return n&&(r=Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")||t.getExtension("OES_texture_float"))),i&&(r=r&&Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("EXT_color_buffer_half_float"))),r}static getDefaultFramebuffer(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new Ql(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const t=oa(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const t=oa(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(e),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(t){let{width:e=1,height:n=1,attachments:i=null,color:r=!0,depth:o=!0,stencil:s=!1,check:a=!0,readBuffer:l,drawBuffers:c}=t;if(tl(e>=0&&n>=0,"Width and height need to be integers"),this.width=e,this.height=n,i)for(const u in i){const t=i[u];(Array.isArray(t)?t[0]:t).resize({width:e,height:n})}else i=this._createDefaultAttachments(r,o,s,e,n);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:c}),i&&a&&this.checkStatus()}delete(){for(const t of this.ownResources)t.delete();return super.delete(),this}update(t){let{attachments:e={},readBuffer:n,drawBuffers:i,clearAttachments:r=!1,resizeAttachments:o=!0}=t;this.attach(e,{clearAttachments:r,resizeAttachments:o});const{gl:s}=this,a=s.bindFramebuffer(36160,this.handle);return n&&this._setReadBuffer(n),i&&this._setDrawBuffers(i),s.bindFramebuffer(36160,a||null),this}resize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{width:e,height:n}=t;if(null===this.handle)return tl(void 0===e&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===e&&(e=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&$s.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(e,"x").concat(n))();for(const i in this.attachments)this.attachments[i].resize({width:e,height:n});return this.width=e,this.height=n,this}attach(t){let{clearAttachments:e=!1,resizeAttachments:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i={};e&&Object.keys(this.attachments).forEach((t=>{i[t]=null})),Object.assign(i,t);const r=this.gl.bindFramebuffer(36160,this.handle);for(const o in i){tl(void 0!==o,"Misspelled framebuffer binding point?");const t=Number(o),e=i[t];let r=e;if(r)if(r instanceof Ol)this._attachRenderbuffer({attachment:t,renderbuffer:r});else if(Array.isArray(e)){const[n,i=0,o=0]=e;r=n,this._attachTexture({attachment:t,texture:n,layer:i,level:o})}else this._attachTexture({attachment:t,texture:r,layer:0,level:0});else this._unattach(t);n&&r&&r.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,r||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter((t=>!this.attachments[t])).forEach((t=>{delete this.attachments[t]}))}checkStatus(){const{gl:t}=this,e=this.getStatus();if(36053!==e)throw new Error(function(t){return(Ql.STATUS||{})[t]||"Framebuffer error ".concat(t)}(e));return this}getStatus(){const{gl:t}=this,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);return t.bindFramebuffer(36160,e||null),n}clear(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:e,depth:n,stencil:i,drawBuffers:r=[]}=t,o=this.gl.bindFramebuffer(36160,this.handle);return(e||n||i)&&Ul(this.gl,{color:e,depth:n,stencil:i}),r.forEach(((t,e)=>{!function(t){let{framebuffer:e=null,buffer:n=Fl,drawBuffer:i=0,value:r=[0,0,0,0]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};oa(t),Na(t,{framebuffer:e},(()=>{switch(n){case Fl:switch(r.constructor){case Int32Array:t.clearBufferiv(n,i,r);break;case Uint32Array:t.clearBufferuiv(n,i,r);break;case Float32Array:default:t.clearBufferfv(n,i,r)}break;case zl:t.clearBufferfv(zl,0,[r]);break;case Nl:t.clearBufferiv(Nl,0,[r]);break;case Dl:const[e,o]=r;t.clearBufferfi(Dl,0,e,o);break;default:tl(!1,Bl)}}))}(this.gl,{drawBuffer:e,value:t})})),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return $s.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return $s.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return $s.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return $s.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return $s.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return $s.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(t){let{attachments:e=[],x:n=0,y:i=0,width:r,height:o}=t;const s=oa(this.gl),a=s.bindFramebuffer(36008,this.handle);return 0===n&&0===i&&void 0===r&&void 0===o?s.invalidateFramebuffer(36008,e):s.invalidateFramebuffer(36008,e,n,i,r,o),s.bindFramebuffer(36008,a),this}getAttachmentParameter(t,e,n){let i=this._getAttachmentParameterFallback(e);return null===i&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&i>1e3&&(i=nl(this.gl,i)),i}getAttachmentParameters(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const r of n){i[e?nl(this.gl,r):r]=this.getAttachmentParameter(t,r,e)}return i}getParameters(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=Object.keys(this.attachments),n={};for(const i of e){const e=Number(i);n[t?nl(this.gl,e):e]=this.getAttachmentParameters(e,t)}return n}show(){return"undefined"!==typeof window&&window.open(Zl(this),"luma-debug-texture"),this}log(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t>$s.level||"undefined"===typeof window)return this;e=e||"Framebuffer ".concat(this.id);const n=Zl(this,{targetMaxHeight:100});return $s.image({logLevel:t,message:e,image:n},e)(),this}bind(){let{target:t=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(t,this.handle),this}unbind(){let{target:t=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(t,null),this}_createDefaultAttachments(t,e,n,i,r){let o=null;return t&&(o=o||{},o[36064]=new kl(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:r,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),e&&n?(o=o||{},o[33306]=new Ol(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(o[33306])):e?(o=o||{},o[36096]=new Ol(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:r}),this.ownResources.push(o[36096])):n&&tl(!1),o}_unattach(t){const e=this.attachments[t];e&&(e instanceof Ol?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}_attachRenderbuffer(t){let{attachment:e=36064,renderbuffer:n}=t;const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,n.handle),this.attachments[e]=n}_attachTexture(t){let{attachment:e=36064,texture:n,layer:i,level:r}=t;const{gl:o}=this;switch(o.bindTexture(n.target,n.handle),n.target){case 35866:case 32879:oa(o).framebufferTextureLayer(36160,e,n.target,r,i);break;case 34067:const t=function(t){return t<34069?t+34069:t}(i);o.framebufferTexture2D(36160,e,t,n.handle,r);break;case 3553:o.framebufferTexture2D(36160,e,3553,n.handle,r);break;default:tl(!1,"Illegal texture type")}o.bindTexture(n.target,null),this.attachments[e]=n}_setReadBuffer(t){const e=ia(n=this.gl)?n:null;var n;e?e.readBuffer(t):tl(36064===t||1029===t,Kl),this.readBuffer=t}_setDrawBuffers(t){const{gl:e}=this,n=oa(e);if(n)n.drawBuffers(t);else{const n=e.getExtension("WEBGL_draw_buffers");n?n.drawBuffersWEBGL(t):tl(1===t.length&&(36064===t[0]||1029===t[0]),Kl)}this.drawBuffers=t}_getAttachmentParameterFallback(t){const e=function(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in tc)void 0===t.luma.caps[e]&&(t.luma.caps[e]=ic(t,e));return t.luma.caps}(this.gl);switch(t){case 36052:return e.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.WEBGL2?null:8;case 33297:return e.WEBGL2?null:5125;case 33296:return e.WEBGL2||e.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(t){return this.gl.bindFramebuffer(36160,t)}}Ql.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const $l="TIMER_QUERY",Jl="ELEMENT_INDEX_UINT32";const tc={["WEBGL2"]:[!1,!0],["VERTEX_ARRAY_OBJECT"]:["OES_vertex_array_object",!0],[$l]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],["INSTANCED_RENDERING"]:["ANGLE_instanced_arrays",!0],["MULTIPLE_RENDER_TARGETS"]:["WEBGL_draw_buffers",!0],[Jl]:["OES_element_index_uint",!0],["BLEND_EQUATION_MINMAX"]:["EXT_blend_minmax",!0],["FLOAT_BLEND"]:["EXT_float_blend"],["COLOR_ENCODING_SRGB"]:["EXT_sRGB",!0],["TEXTURE_DEPTH"]:["WEBGL_depth_texture",!0],["TEXTURE_FLOAT"]:["OES_texture_float",!0],["TEXTURE_HALF_FLOAT"]:["OES_texture_half_float",!0],["TEXTURE_FILTER_LINEAR_FLOAT"]:["OES_texture_float_linear"],["TEXTURE_FILTER_LINEAR_HALF_FLOAT"]:["OES_texture_half_float_linear"],["TEXTURE_FILTER_ANISOTROPIC"]:["EXT_texture_filter_anisotropic"],["COLOR_ATTACHMENT_RGBA32F"]:[function(t){const e=new kl(t,{format:6408,type:5126,dataFormat:6408}),n=new Ql(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=n.getStatus();return e.delete(),n.delete(),36053===i},"EXT_color_buffer_float"],["COLOR_ATTACHMENT_FLOAT"]:[!1,"EXT_color_buffer_float"],["COLOR_ATTACHMENT_HALF_FLOAT"]:["EXT_color_buffer_half_float"],["GLSL_FRAG_DATA"]:["WEBGL_draw_buffers",!0],["GLSL_FRAG_DEPTH"]:["EXT_frag_depth",!0],["GLSL_DERIVATIVES"]:["OES_standard_derivatives",!0],["GLSL_TEXTURE_LOD"]:["EXT_shader_texture_lod",!0]},ec=2;function nc(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>ic(t,e)))}function ic(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},void 0===t.luma.caps[e]&&(t.luma.caps[e]=function(t,e){const n=tc[e];let i;tl(n,e);const r=ia(t)&&n[1]||n[0];if("function"===typeof r)i=r(t);else if(Array.isArray(r)){i=!0;for(const e of r)i=i&&Boolean(t.getExtension(e))}else"string"===typeof r?i=Boolean(t.getExtension(r)):"boolean"===typeof r?i=r:tl(!1);return i}(t,e)),t.luma.caps[e]||$s.log(ec,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}class rc{constructor(t,e){Ss(this,"opts",void 0),Ss(this,"source",void 0),this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:n}=this.source,{size:i}=e;let r=n;if(n&&n.length!==i){r=new Float32Array(i);const t=e.elementOffset||0;for(let e=0;e<i;++e)r[e]=n[t+e]}return r}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}const oc=new class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ss(this,"_pool",[]),Ss(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(t)}setOptions(t){Object.assign(this.opts,t)}allocate(t,e,n){let{size:i=1,type:r,padding:o=0,copy:s=!1,initialize:a=!1,maxCount:l}=n;const c=r||t&&t.constructor||Float32Array,u=e*i+o;if(ArrayBuffer.isView(t)){if(u<=t.length)return t;if(u*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new c(t.buffer,0,u)}let h=1/0;l&&(h=l*i+o);const d=this._allocate(c,u,a,h);return t&&s?d.set(t):a||d.fill(0,0,4),this._release(t),d}release(t){this._release(t)}_allocate(t,e,n,i){let r=Math.max(Math.ceil(e*this.opts.overAlloc),1);r>i&&(r=i);const o=this._pool,s=t.BYTES_PER_ELEMENT*r,a=o.findIndex((t=>t.byteLength>=s));if(a>=0){const e=new t(o.splice(a,1)[0],0,r);return n&&e.fill(0),e}return new t(r)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:i}=n,r=e.findIndex((t=>t.byteLength>=i));r<0?e.push(n):(r>0||e.length<this.opts.poolSize)&&e.splice(r,0,n),e.length>this.opts.poolSize&&e.shift()}},sc=(Math.PI,Math.PI,{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0});function ac(t){let{precision:e=sc.precision}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=function(t){return Math.round(t/sc.EPSILON)*sc.EPSILON}(t),"".concat(parseFloat(t.toPrecision(e)))}function lc(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function cc(t,e,n){return dc(t,(t=>Math.max(e,Math.min(n,t))))}function uc(t,e,n){return lc(t)?t.map(((t,i)=>uc(t,e[i],n))):n*e+(1-n)*t}function hc(t,e,n){const i=sc.EPSILON;n&&(sc.EPSILON=n);try{if(t===e)return!0;if(lc(t)&&lc(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!hc(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):"number"===typeof t&&"number"===typeof e&&Math.abs(t-e)<=sc.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{sc.EPSILON=i}}function dc(t,e,n){if(lc(t)){const i=t;n=n||function(t){return t.clone?t.clone():new Array(t.length)}(i);for(let r=0;r<n.length&&r<i.length;++r)n[r]=e(t[r],r,n);return n}return e(t)}class fc extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){clone(){return(new this.constructor).copy(this)}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:lc(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(sc)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+ac(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!hc(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){if(void 0===n)return this.lerp(this,t,e);for(let i=0;i<this.ELEMENTS;++i){const r=t[i];this[i]=r+n*(e[i]-r)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let t=0;t<this.ELEMENTS;++t)this[t]+=i[t];return this.check()}subtract(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let t=0;t<this.ELEMENTS;++t)this[t]-=i[t];return this.check()}scale(t){if("number"===typeof t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;else for(let e=0;e<this.ELEMENTS&&e<t.length;++e)this[e]*=t[e];return this.check()}multiplyByScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}check(){if(sc.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}get elements(){return this}}function pc(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function gc(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(sc.debug&&!function(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}function mc(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}class vc extends fc{get x(){return this[0]}set x(t){this[0]=pc(t)}get y(){return this[1]}set y(t){this[1]=pc(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-t[n];e+=i*i}return pc(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return pc(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let t=0;t<this.ELEMENTS;++t)this[t]*=i[t];return this.check()}divide(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=i[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return mc(t>=0&&t<this.ELEMENTS,"index is out of range"),pc(this[t])}setComponent(t,e){return mc(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}var yc=1e-6,bc="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function _c(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[3]*i+n[7]*r+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/s,t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/s,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/s,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var wc=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t};!function(){var t=function(){var t=new bc(3);return bc!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}()}();function xc(t,e,n){const i=e[0],r=e[1],o=e[2],s=n[3]*i+n[7]*r+n[11]*o||1;return t[0]=(n[0]*i+n[4]*r+n[8]*o)/s,t[1]=(n[1]*i+n[5]*r+n[9]*o)/s,t[2]=(n[2]*i+n[6]*r+n[10]*o)/s,t}const Sc=[0,0,0];let Pc;class Ec extends vc{static get ZERO(){return Pc||(Pc=new Ec(0,0,0),Object.freeze(Pc)),Pc}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(-0,-0,-0),1===arguments.length&&lc(t)?this.copy(t):(sc.debug&&(pc(t),pc(e),pc(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return sc.debug&&(pc(t.x),pc(t.y),pc(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=pc(t)}angle(t){return function(t,e){var n=t[0],i=t[1],r=t[2],o=e[0],s=e[1],a=e[2],l=Math.sqrt(n*n+i*i+r*r)*Math.sqrt(o*o+s*s+a*a),c=l&&function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}(t,e)/l;return Math.acos(Math.min(Math.max(c,-1),1))}(this,t)}cross(t){return function(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[0],a=n[1],l=n[2];t[0]=r*l-o*a,t[1]=o*s-i*l,t[2]=i*a-r*s}(this,this,t),this.check()}rotateX(t){let{radians:e,origin:n=Sc}=t;return function(t,e,n,i){var r=[],o=[];r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),o[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,n,e),this.check()}rotateY(t){let{radians:e,origin:n=Sc}=t;return function(t,e,n,i){var r=[],o=[];r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),o[1]=r[1],o[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,n,e),this.check()}rotateZ(t){let{radians:e,origin:n=Sc}=t;return function(t,e,n,i){var r=[],o=[];r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),o[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),o[2]=r[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,n,e),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return _c(this,this,t),this.check()}transformAsVector(t){return xc(this,this,t),this.check()}transformByMatrix3(t){return function(t,e,n){var i=e[0],r=e[1],o=e[2];t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8]}(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,n){const i=e[0],r=e[1];t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2]}(this,this,t),this.check()}transformByQuaternion(t){return function(t,e,n){var i=n[0],r=n[1],o=n[2],s=n[3],a=e[0],l=e[1],c=e[2],u=r*c-o*l,h=o*a-i*c,d=i*l-r*a,f=r*d-o*h,p=o*u-i*d,g=i*h-r*u,m=2*s;u*=m,h*=m,d*=m,f*=2,p*=2,g*=2,t[0]=a+u+f,t[1]=l+h+p,t[2]=c+d+g}(this,this,t),this.check()}}const Cc=new Ec;function Tc(t,e,n,i){Cc.set(t,e,n);const r=Cc.len();return{distance:i/r,normal:new Ec(-t/r,-e/r,-n/r)}}let Ac;function kc(t,e){const{size:n=1,startIndex:i=0}=e,r=void 0!==e.endIndex?e.endIndex:t.length,o=(r-i)/n;Ac=oc.allocate(Ac,o,{type:Float32Array,size:2*n});let s=i,a=0;for(;s<r;){for(let e=0;e<n;e++){const i=t[s++];Ac[a+e]=i,Ac[a+e+n]=(l=i)-Math.fround(l)}a+=2*n}var l;return Ac.subarray(0,o*n*2)}function Mc(t){return t.stride||t.size*t.bytesPerElement}function Lc(t,e){e.offset&&Gs.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Mc(t),i=(void 0!==e.vertexOffset?e.vertexOffset:t.vertexOffset||0)*n+(e.elementOffset||0)*t.bytesPerElement+(t.offset||0);return{...e,offset:i,stride:n}}class Oc{constructor(t,e,n){Ss(this,"gl",void 0),Ss(this,"id",void 0),Ss(this,"size",void 0),Ss(this,"settings",void 0),Ss(this,"value",void 0),Ss(this,"doublePrecision",void 0),Ss(this,"_buffer",void 0),Ss(this,"state",void 0),this.gl=t,this.id=e.id||"",this.size=e.size||1;const i=e.logicalType||e.type,r=5130===i;let o,{defaultValue:s}=e;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0),o=r?5126:!i&&e.isIndexed?t&&function(t,e){return nc(t,e)}(t,Jl)?5125:5123:i||5126;let a=function(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(i||o||5126);this.doublePrecision=r,r&&!1===e.fp64&&(a=Float32Array),this.value=null,this.settings={...e,defaultType:a,defaultValue:s,logicalType:i,type:o,size:this.size,bytesPerElement:a.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new wl(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*Mc(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),oc.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const n={},i=this.value instanceof Float64Array,r=function(t,e){const n=Lc(t,e);return{high:n,low:{...n,offset:n.offset+4*t.size}}}(this.getAccessor(),e||{});return n[t]=new rc(this,r.high),n["".concat(t,"64Low")]=i?new rc(this,r.low):new Float32Array(this.size),n}if(e){const n=Lc(this.getAccessor(),e);return{[t]:new rc(this,n)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant&&this.value){const e=Array.from(this.value);t=[e,e]}else{const{value:e,numInstances:n,size:i}=this,r=n*i;if(e&&r&&e.length>=r){const n=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let t=0;t<r;)for(let r=0;r<i;r++){const i=e[t++];i<n[r]&&(n[r]=i),i>o[r]&&(o[r]=i)}t=[n,o]}}return this.state.bounds=t,t}setData(t){const{state:e}=this;let n;n=ArrayBuffer.isView(t)?{value:t}:t instanceof wl?{buffer:t}:t;const i={...this.settings,...n};if(e.bufferAccessor=i,e.bounds=null,n.constant){let t=n.value;t=this._normalizeValue(t,[],0),this.settings.normalized&&(t=this.normalizeConstant(t));if(!(!e.constant||!this._areValuesEqual(t,this.value)))return!1;e.externalBuffer=null,e.constant=!0,this.value=t}else if(n.buffer){const t=n.buffer;e.externalBuffer=t,e.constant=!1,this.value=n.value||null;const r=n.value instanceof Float64Array;i.type=n.type||t.accessor.type,i.bytesPerElement=t.accessor.BYTES_PER_ELEMENT*(r?2:1),i.stride=Mc(i)}else if(n.value){this._checkExternalBuffer(n);let t=n.value;e.externalBuffer=null,e.constant=!1,this.value=t,i.bytesPerElement=t.BYTES_PER_ELEMENT,i.stride=Mc(i);const{buffer:r,byteOffset:o}=this;this.doublePrecision&&t instanceof Float64Array&&(t=kc(t,i));const s=t.byteLength+o+2*i.stride;r.byteLength<s&&r.reallocate(s),r.setAccessor(null),r.subData({data:t,offset:o}),i.type=n.type||r.accessor.type}return!0}updateSubBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state.bounds=null;const e=this.value,{startOffset:n=0,endOffset:i}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?kc(e,{size:this.size,startIndex:n,endIndex:i}):e.subarray(n,i),offset:n*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{state:n}=this,i=n.allocatedValue,r=oc.allocate(i,t+1,{size:this.size,type:this.settings.defaultType,copy:e});this.value=r;const{buffer:o,byteOffset:s}=this;return o.byteLength<r.byteLength+s&&(o.reallocate(r.byteLength+s),e&&i&&o.subData({data:i instanceof Float64Array?kc(i,this):i,offset:s})),n.allocatedValue=r,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!ArrayBuffer.isView(e))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=e.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));e instanceof n||!this.settings.normalized||"normalized"in t||Gs.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map((t=>(t+128)/255*2-1));case 5122:return new Float32Array(t).map((t=>(t+32768)/65535*2-1));case 5121:return new Float32Array(t).map((t=>t/255));case 5123:return new Float32Array(t).map((t=>t/65535));default:return t}}_normalizeValue(t,e,n){const{defaultValue:i,size:r}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t)return e[n]=i[0],e;switch(r){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:i[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:i[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:i[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:i[0];break;default:let o=r;for(;--o>=0;)e[n+o]=Number.isFinite(t[o])?t[o]:i[o]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}}function Rc(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}const Ic=[],jc=[];function Fc(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,i=Ic;const r={index:-1,data:t,target:[]};return t?"function"===typeof t[Symbol.iterator]?i=t:t.length>0&&(jc.length=t.length,i=jc):i=Ic,(e>0||Number.isFinite(n))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,n),r.index=e-1),{iterable:i,objectInfo:r}}function zc(t){return t&&t[Symbol.asyncIterator]}function Nc(t,e){const{size:n,stride:i,offset:r,startIndices:o,nested:s}=e,a=t.BYTES_PER_ELEMENT,l=i?i/a:n,c=r?r/a:0,u=Math.floor((t.length-c)/l);return(e,i)=>{let{index:r,target:a}=i;if(!o){const e=r*l+c;for(let i=0;i<n;i++)a[i]=t[e+i];return a}const h=o[r],d=o[r+1]||u;let f;if(s){f=new Array(d-h);for(let e=h;e<d;e++){const i=e*l+c;a=new Array(n);for(let e=0;e<n;e++)a[e]=t[i+e];f[e-h]=a}}else if(l===n)f=t.subarray(h*n+c,d*n+c);else{f=new t.constructor((d-h)*n);let e=0;for(let i=h;i<d;i++){const r=i*l+c;for(let i=0;i<n;i++)f[e++]=t[r+i]}}return f}}function Dc(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!0;return Array.isArray(t)?Bc(t,e,[]):e(t)?[t]:[]}function Bc(t,e,n){let i=-1;for(;++i<t.length;){const r=t[i];Array.isArray(r)?Bc(r,e,n):e(r)&&n.push(r)}return n}function Uc(t){let{target:e,source:n,start:i=0,count:r=1}=t;const o=n.length,s=r*o;let a=0;for(let l=i;a<o;a++)e[l++]=n[a];for(;a<s;)a<s-a?(e.copyWithin(i+a,i,i+a),a*=2):(e.copyWithin(i+a,i,i+s-a),a=s);return e}const Vc=[],Wc=[[0,1/0]];function Hc(t){const{source:e,target:n,start:i=0,size:r,getData:o}=t,s=t.end||n.length,a=e.length,l=s-i;if(a>l)return void n.set(e.subarray(0,l),i);if(n.set(e,i),!o)return;let c=a;for(;c<l;){const t=o(c,e);for(let e=0;e<r;e++)n[i+c]=t[e]||0,c++}}const Gc={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function Xc(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...Gc[n],...e,...t,type:n}}function qc(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function Zc(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function Yc(t){t.push(t.shift())}function Kc(t,e){const{doublePrecision:n,settings:i,value:r,size:o}=t,s=n&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*o)*s}function Qc(t){let{buffer:e,numInstances:n,attribute:i,fromLength:r,fromStartIndices:o,getData:s=(t=>t)}=t;const a=i.doublePrecision&&i.value instanceof Float64Array?2:1,l=i.size*a,c=i.byteOffset,u=i.startIndices,h=o&&u,d=Kc(i,n),f=i.isConstant;if(!h&&r>=d)return;const p=f?i.value:i.getBuffer().getData({srcByteOffset:c});if(i.settings.normalized&&!f){const t=s;s=(e,n)=>i.normalizeConstant(t(e,n))}const g=f?(t,e)=>s(p,e):(t,e)=>s(p.subarray(t,t+l),e),m=e.getData({length:r}),v=new Float32Array(d);!function(t){let{source:e,target:n,size:i,getData:r,sourceStartIndices:o,targetStartIndices:s}=t;if(!Array.isArray(s))return Hc({source:e,target:n,size:i,getData:r}),n;let a=0,l=0;const c=r&&((t,e)=>r(t+l,e)),u=Math.min(o.length,s.length);for(let h=1;h<u;h++){const t=o[h]*i,r=s[h]*i;Hc({source:e.subarray(a,t),target:n,start:l,end:r,size:i,getData:c}),a=t,l=r}l<n.length&&Hc({source:[],target:n,start:l,size:i,getData:c})}({source:m,target:v,sourceStartIndices:o,targetStartIndices:u,size:l,getData:g}),e.byteLength<v.byteLength+c&&e.reallocate(v.byteLength+c),e.subData({data:v,offset:c})}class $c extends Oc{constructor(t,e){super(t,e,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:Wc}),Ss(this,"constant",!1),this.settings.update=e.update||(e.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw(){let{clearChangedFlags:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!==typeof t&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition;return Xc(Array.isArray(e)?t[e.find((e=>t[e]))]:t[e],n)}setNeedsUpdate(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,e=arguments.length>1?arguments[1]:void 0;if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:t=0,endRow:n=1/0}=e;this.state.updateRanges=function(t,e){if(t===Wc)return t;if(e[0]<0&&(e[0]=0),e[0]>=e[1])return t;const n=[],i=t.length;let r=0;for(let o=0;o<i;o++){const i=t[o];i[1]<e[0]?(n.push(i),r=o+1):i[0]>e[1]?n.push(i):e=[Math.min(i[0],e[0]),Math.max(i[1],e[1])]}return n.splice(r,0,e),n}(this.state.updateRanges,[t,n])}else this.state.updateRanges=Wc}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Vc}setNeedsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){const{state:e,settings:n}=this;return!n.noAlloc&&(!!n.update&&(super.allocate(t,e.updateRanges!==Wc),!0))}updateBuffer(t){let{numInstances:e,data:n,props:i,context:r}=t;if(!this.needsUpdate())return!1;const{state:{updateRanges:o},settings:{update:s,noAlloc:a}}=this;let l=!0;if(s){for(const[t,a]of o)s.call(r,this,{data:n,startRow:t,endRow:a,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[t,n]of o){const i=Number.isFinite(t)?this.getVertexOffset(t):0,r=Number.isFinite(n)?this.getVertexOffset(n):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:i,endOffset:r})}else;this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(t){if(void 0===t||"function"===typeof t)return!1;return this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const{state:n,settings:i}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;n.binaryValue=t,this.setNeedsRedraw();if(i.transform||e!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});const r=t;Rc(ArrayBuffer.isView(r.value),"invalid ".concat(i.accessor));const o=Boolean(r.size)&&r.size!==this.size;return n.binaryAccessor=Nc(r.value,{size:r.size||this.size,stride:r.stride,offset:r.offset,startIndices:e,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?e[t]:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const n in t)Object.assign(e,super.getShaderAttributes(n,t[n]));return e}_autoUpdater(t,e){let{data:n,startRow:i,endRow:r,props:o,numInstances:s}=e;if(t.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:h}=t,{accessor:d,transform:f}=a,p=l.binaryAccessor||("function"===typeof d?d:o[d]);Rc("function"===typeof p,'accessor "'.concat(d,'" is not a function'));let g=t.getVertexOffset(i);const{iterable:m,objectInfo:v}=Fc(n,i,r);for(const y of m){v.index++;let e=p(y,v);if(f&&(e=f.call(this,e)),h){const n=(v.index<h.length-1?h[v.index+1]:s)-h[v.index];if(e&&Array.isArray(e[0])){let n=g;for(const i of e)t._normalizeValue(i,c,n),n+=u}else e&&e.length>u?c.set(e,g):(t._normalizeValue(e,v.target,0),Uc({target:c,source:v.target,start:g,count:n}));g+=n*u}else t._normalizeValue(e,c,g),g+=u}}_validateAttributeUpdaters(){const{settings:t}=this;if(!(t.noAlloc||"function"===typeof t.update))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}let Jc={};function tu(t,e,n,i){Gs.level>0&&Jc[t]&&Jc[t].call(null,e,n,i)}function eu(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const nu="void main() {gl_FragColor = vec4(0);}",iu="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",ru="#version 300 es\n".concat(iu);function ou(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[i,r,o]=n;if(!e.includes(i)||!r||!o)return null;return{qualifier:i,type:r,name:o.split(";")[0]}}function su(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{version:e=100,input:n,inputType:i,output:r}=t;if(!n)return 300===e?ru:e>300?"#version ".concat(e,"\n").concat(iu):nu;const o=function(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return eu(!1),null}}(n,i);return e>=300?"#version ".concat(e," ").concat(300===e?"es":"","\nin ").concat(i," ").concat(n,";\nout vec4 ").concat(r,";\nvoid main() {\n  ").concat(r," = ").concat(o,";\n}"):"varying ".concat(i," ").concat(n,";\nvoid main() {\n  gl_FragColor = ").concat(o,";\n}")}class au extends cl{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(t){return ia(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};oa(t),super(t,e),this.initialize(e),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,sl(this.buffers)||this.bind((()=>this._unbindBuffers())),this.setProps(t),this}setProps(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}setBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind((()=>{for(const e in t)this.setBuffer(e,t[e])})),this}setBuffer(t,e){const n=this._getVaryingIndex(t),{buffer:i,byteSize:r,byteOffset:o}=this._getBufferParams(e);return n<0?(this.unused[t]=i,$s.warn("".concat(this.id," unused varying buffer ").concat(t))(),this):(this.buffers[n]=e,this.bindOnUse||this._bindBuffer(n,i,o,r),this)}begin(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(t){let e,n,i;return t instanceof wl===!1?(i=t.buffer,n=t.byteSize,e=t.byteOffset):i=t,void 0===e&&void 0===n||(e=e||0,n=n||i.byteLength-e),{buffer:i,byteOffset:e,byteSize:n}}_getVaryingInfo(t){return this.configuration&&this.configuration.getVaryingInfo(t)}_getVaryingIndex(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;const e=Number(t);return Number.isFinite(e)?e:-1}_bindBuffers(){if(this.bindOnUse)for(const t in this.buffers){const{buffer:e,byteSize:n,byteOffset:i}=this._getBufferParams(this.buffers[t]);this._bindBuffer(t,e,i,n)}}_unbindBuffers(){if(this.bindOnUse)for(const t in this.buffers)this._bindBuffer(t,null)}_bindBuffer(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const r=e&&e.handle;return r&&void 0!==i?this.gl.bindBufferRange(35982,t,r,n,i):this.gl.bindBufferBase(35982,t,r),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(t){this.gl.bindTransformFeedback(36386,this.handle)}}class lu{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}setupResources(t){for(const e of this.bindings)this._setupTransformFeedback(e,t)}updateModelProps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyings:e}=this;return e.length>0&&(t=Object.assign({},t,{varyings:e})),t}getDrawOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:i}=e;return{attributes:Object.assign({},n,t.attributes),transformFeedback:i}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(t)}getBuffer(t){const{feedbackBuffers:e}=this.bindings[this.currentIndex],n=t?e[t]:null;return n?n instanceof wl?n:n.buffer:null}getData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyingName:e}=t,n=this.getBuffer(e);return n?n.getData():null}delete(){for(const t in this.resources)this.resources[t].delete()}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&tl(ia(this.gl))}_getFeedbackBuffers(t){const{sourceBuffers:e={}}=t,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const t=this.feedbackMap[i];i in e&&(n[t]=i)}Object.assign(n,t.feedbackBuffers);for(const i in n){const t=n[i];if("string"===typeof t){const r=e[t],{byteLength:o,usage:s,accessor:a}=r;n[i]=this._createNewBuffer(i,{byteLength:o,usage:s,accessor:a})}}return n}_setupBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e=null}=t;Object.assign(this.feedbackMap,t.feedbackMap);const n=this._getFeedbackBuffers(t);this._updateBindings({sourceBuffers:e,feedbackBuffers:n})}_setupTransformFeedback(t,e){let{model:n}=e;const{program:i}=n;t.transformFeedback=new au(this.gl,{program:i,buffers:t.feedbackBuffers})}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:e}=this._swapBuffers(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceBuffers:t,feedbackBuffers:e})}}_updateBinding(t,e){return t?(Object.assign(t.sourceBuffers,e.sourceBuffers),Object.assign(t.feedbackBuffers,e.feedbackBuffers),t.transformFeedback&&t.transformFeedback.setBuffers(t.feedbackBuffers),t):{sourceBuffers:Object.assign({},e.sourceBuffers),feedbackBuffers:Object.assign({},e.feedbackBuffers)}}_swapBuffers(t){if(!this.feedbackMap)return null;const e=Object.assign({},t.sourceBuffers),n=Object.assign({},t.feedbackBuffers);for(const i in this.feedbackMap){const r=this.feedbackMap[i];e[i]=t.feedbackBuffers[r],n[r]=t.sourceBuffers[i],tl(n[r]instanceof wl)}return{sourceBuffers:e,feedbackBuffers:n}}_createNewBuffer(t,e){const n=new wl(this.gl,e);return this.resources[t]&&this.resources[t].delete(),this.resources[t]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}function cu(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){const t=parseInt(n[1],10);Number.isFinite(t)&&(e=t)}return e}const uu="vs",hu="fs",du={[uu]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[hu]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},fu="__LUMA_INJECT_DECLARATIONS__",pu=/void\s+main\s*\([^)]*\)\s*\{\n?/,gu=/}\n?[^{}]*$/,mu=[];function vu(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=e===uu;for(const o in n){const e=n[o];e.sort(((t,e)=>t.order-e.order)),mu.length=e.length;for(let t=0,n=e.length;t<n;++t)mu[t]=e[t].injection;const i="".concat(mu.join("\n"),"\n");switch(o){case"vs:#decl":r&&(t=t.replace(fu,i));break;case"vs:#main-start":r&&(t=t.replace(pu,(t=>t+i)));break;case"vs:#main-end":r&&(t=t.replace(gu,(t=>i+t)));break;case"fs:#decl":r||(t=t.replace(fu,i));break;case"fs:#main-start":r||(t=t.replace(pu,(t=>t+i)));break;case"fs:#main-end":r||(t=t.replace(gu,(t=>i+t)));break;default:t=t.replace(o,(t=>t+i))}}return t=t.replace(fu,""),i&&(t=t.replace(/\}\s*$/,(t=>t+du[e]))),t}function yu(t){const e={};return eu(Array.isArray(t)&&t.length>1),t.forEach((t=>{for(const n in t)e[n]=e[n]?"".concat(e[n],"\n").concat(t[n]):t[n]})),e}const bu={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},_u="transform_uSampler_",wu="transform_uSize_",xu="transform_position";function Su(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:i,targetTexture:r}=t;let o=Object.keys(n).length,s=null;const a={};let l=e,c={};if(o>0||i){const t=l.split("\n"),e=t.slice();if(t.forEach(((t,r,l)=>{if(o>0){const i=function(t,e){const n={},i=function(t){return ou(t,["attribute","in"])}(t);if(!i)return null;const{type:r,name:o}=i;if(o&&e[o]){const e="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:i,sizeName:s,uniformDeclerations:a}=function(t){const e="".concat(_u).concat(t),n="".concat(wu).concat(t),i="  uniform sampler2D ".concat(e,";\n  uniform vec2 ").concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:i}}(o),l=function(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return eu(!1),null}}(r),c="  ".concat(r," ").concat(o," = transform_getInput(").concat(i,", ").concat(s,").").concat(l,";\n");n[i]=o;return{updatedLine:e,inject:{"vs:#decl":a,"vs:#main-start":c},samplerTextureMap:n}}return null}(t,n);if(i){const{updatedLine:t,inject:n}=i;e[r]=t,c=yu([c,n]),Object.assign(a,i.samplerTextureMap),o--}}i&&!s&&(s=function(t,e){const n=ou(t,["varying","out"]);if(!n)return null;return n.name===e?n.type:null}(t,i))})),i){tl(r);const t="".concat(wu).concat(i),e="uniform vec2 ".concat(t,";\n"),n="     vec2 ".concat(xu," = transform_getPos(").concat(t,");\n     gl_Position = vec4(").concat(xu,", 0, 1.);\n");c=yu([c,{"vs:#decl":e,"vs:#main-start":n}])}l=e.join("\n")}return{vs:l,targetTextureType:s,inject:c,samplerTextureMap:a}}const Pu={10241:9728,10240:9728,10242:33071,10243:33071};class Eu{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}updateModelProps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this._processVertexShader(t);return Object.assign({},t,e)}getDrawOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e,sourceTextures:n,framebuffer:i,targetTexture:r}=this.bindings[this.currentIndex],o=Object.assign({},e,t.attributes),s=Object.assign({},t.uniforms),a=Object.assign({},t.parameters);let l=t.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const e in this.samplerTextureMap){const t=this.samplerTextureMap[e];s[e]=n[t]}this._setSourceTextureParameters();const t=function(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}=t;const r={};let o,s;n&&(({width:o,height:s}=i),r["".concat(wu).concat(n)]=[o,s]);for(const a in e)({width:o,height:s}=e[a]),r["".concat(wu).concat(a)]=[o,s];return r}({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r});Object.assign(s,t)}return this.hasTargetTexture&&(l=!1,a.viewport=[0,0,i.width,i.height]),{attributes:o,framebuffer:i,uniforms:s,discard:l,parameters:a}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupTextures(t)}getTargetTexture(){const{targetTexture:t}=this.bindings[this.currentIndex];return t}getData(){let{packed:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{framebuffer:e}=this.bindings[this.currentIndex],n=ql(e);if(!t)return n;const i=n.constructor,r=function(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return eu(!1),null}}(this.targetTextureType),o=new i(n.length*r/4);let s=0;for(let a=0;a<n.length;a+=4)for(let t=0;t<r;t++)o[s++]=n[a+t];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{_targetTextureVarying:e,_swapTexture:n}=t;this._swapTexture=n,this.targetTextureVarying=e,this.hasTargetTexture=e,this._setupTextures(t)}_createTargetTexture(t){const{sourceTextures:e,textureOrReference:n}=t;if(n instanceof kl)return n;const i=e[n];return i?(this._targetRefTexName=n,this._createNewTexture(i)):null}_setupTextures(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e,_sourceTextures:n={},_targetTexture:i}=t,r=this._createTargetTexture({sourceTextures:n,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:e,sourceTextures:n,targetTexture:r}),"elementCount"in t&&this._updateElementIDBuffer(t.elementCount)}_updateElementIDBuffer(t){if("number"!==typeof t||this.elementCount>=t)return;const e=new Float32Array(t);e.forEach(((t,e,n)=>{n[e]=e})),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new wl(this.gl,{data:e,accessor:{size:1}}),this.elementCount=t}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this._swapTexture){const{sourceTextures:t,targetTexture:e}=this._swapTextures(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceTextures:t,targetTexture:e})}}_updateBinding(t,e){const{sourceBuffers:n,sourceTextures:i,targetTexture:r}=e;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,i),Object.assign(t.sourceBuffers,n),r){t.targetTexture=r;const{width:e,height:n}=r,{framebuffer:i}=t;i?(i.update({attachments:{36064:r},resizeAttachments:!1}),i.resize({width:e,height:n})):t.framebuffer=new Ql(this.gl,{id:"transform-framebuffer",width:e,height:n,attachments:{36064:r}})}return t}_setSourceTextureParameters(){const t=this.currentIndex,{sourceTextures:e}=this.bindings[t];for(const n in e)e[n].setParameters(Pu)}_swapTextures(t){if(!this._swapTexture)return null;const e=Object.assign({},t.sourceTextures);e[this._swapTexture]=t.targetTexture;return{sourceTextures:e,targetTexture:t.sourceTextures[this._swapTexture]}}_createNewTexture(t){const e=Gl(t,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=e,e}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceTextures:e,targetTexture:n}=this.bindings[this.currentIndex],{vs:i,uniforms:r,targetTextureType:o,inject:s,samplerTextureMap:a}=Su({vs:t.vs,sourceTextureMap:e,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),l=yu([t.inject||{},s]);this.targetTextureType=o,this.samplerTextureMap=a;return{vs:i,fs:t._fs||su({version:cu(i),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[bu].concat(t.modules||[]):t.modules,uniforms:r,inject:l}}}const Cu={number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},array:{validate:(t,e)=>Array.isArray(t)||ArrayBuffer.isView(t)}};function Tu(t){let e=Au(t);return"object"===e?t?"type"in t?Object.assign({},t,Cu[t.type]):"value"in t?(e=Au(t.value),Object.assign({type:e},t,Cu[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},Cu[e])}function Au(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}class ku{constructor(t){let{name:e,vs:n,fs:i,dependencies:r=[],uniforms:o,getUniforms:s,deprecations:a=[],defines:l={},inject:c={},vertexShader:u,fragmentShader:h}=t;eu("string"===typeof e),this.name=e,this.vs=n||u,this.fs=i||h,this.getModuleUniforms=s,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(a),this.defines=l,this.injections=function(t){const e={vs:{},fs:{}};for(const n in t){let i=t[n];"string"===typeof i&&(i={order:0,injection:i}),e[n.slice(0,2)][n]=i}return e}(c),o&&(this.uniforms=function(t){const e={};for(const n in t){const i=Tu(t[n]);e[n]=i}return e}(o))}getModuleSource(t){let e;switch(t){case"vs":e=this.vs||"";break;case"fs":e=this.fs||"";break;default:eu(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(e,"// END MODULE_").concat(this.name,"\n\n")}getUniforms(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):this.uniforms?this._defaultGetUniforms(t):{}}getDefines(){return this.defines}checkDeprecations(t,e){this.deprecations.forEach((n=>{n.regex.test(t)&&(n.deprecated?e.deprecated(n.old,n.new)():e.removed(n.old,n.new)())}))}_parseDeprecationDefinitions(t){return t.forEach((t=>{if("function"===t.type)t.regex=new RegExp("\\b".concat(t.old,"\\("));else t.regex=new RegExp("".concat(t.type," ").concat(t.old,";"))})),t}_defaultGetUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e={},n=this.uniforms;for(const i in n){const r=n[i];i in t&&!r.private?(r.validate&&eu(r.validate(t[i],r),"".concat(this.name,": invalid ").concat(i)),e[i]=t[i]):e[i]=r.value}return e}}function Mu(t){return Lu(Ru(t))}function Lu(t){const e={},n={};return Ou({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort(((t,e)=>n[e]-n[t])).map((t=>e[t]))}function Ou(t){let{modules:e,level:n,moduleMap:i,moduleDepth:r}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const o of e)i[o.name]=o,(void 0===r[o.name]||r[o.name]<n)&&(r[o.name]=n);for(const o of e)o.dependencies&&Ou({modules:o.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}function Ru(t,e){return t.map((t=>(t instanceof ku||(eu("string"!==typeof t,"Shader module use by name is deprecated. Import shader module '".concat(t,"' and use it directly.")),eu(t.name,"shader module has no name"),(t=new ku(t)).dependencies=Ru(t.dependencies)),t)))}const Iu=7936,ju=7937,Fu=7938,zu=35724,Nu={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Du={};Object.keys(Nu).forEach((t=>{Du[t]=t}));const Bu={};function Uu(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=Nu[e];if(eu(i,e),!function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e="undefined"!==typeof window&&window.navigator||{},n=t.userAgent||e.userAgent||"",i=-1!==n.indexOf("MSIE "),r=-1!==n.indexOf("Trident/");return i||r}(n))return!0;if(e in Bu)return Bu[e];const r=i[0],o=n.behavior||"enable",s="#extension GL_".concat(r," : ").concat(o,"\nvoid main(void) {}"),a=t.createShader(35633);t.shaderSource(a,s),t.compileShader(a);const l=t.getShaderParameter(a,35713);return t.deleteShader(a),Bu[e]=l,l}function Vu(t,e){const n=Nu[e];eu(n,e);const i=function(t){return"undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}(t)&&n[1]||n[0],r="string"===typeof i?Boolean(t.getExtension(i)):i;return eu(!1===r||!0===r),r}function Wu(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>Vu(t,e)))}function Hu(t){const e=function(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||Iu),i=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||ju);return{gpuVendor:function(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}(n,i),vendor:n,renderer:i,version:t.getParameter(Fu),shadingLanguageVersion:t.getParameter(zu)}}(t);switch(e.gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}function Gu(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const Xu=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],qu=[...Xu,[Gu("attribute"),"in $1"],[Gu("varying"),"out $1"]],Zu=[...Xu,[Gu("varying"),"in $1"]],Yu=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],Ku=[...Yu,[Gu("in"),"attribute $1"],[Gu("out"),"varying $1"]],Qu=[...Yu,[Gu("in"),"varying $1"]],$u="gl_FragColor",Ju=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,th=/void\s+main\s*\([^)]*\)\s*\{\n?/;function eh(t,e,n){switch(e){case 300:return n?nh(t,qu):function(t){t=nh(t,Zu);const e=t.match(Ju);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat($u,"\\b"),"g"),n)}else{const e="fragmentColor";t=t.replace(th,(t=>"out vec4 ".concat(e,";\n").concat(t))).replace(new RegExp("\\b".concat($u,"\\b"),"g"),e)}return t}(t);case 100:return n?nh(t,Ku):function(t){t=nh(t,Qu);const e=t.match(Ju);if(e){const n=e[1];t=t.replace(Ju,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),$u)}return t}(t);default:throw new Error("unknown GLSL version ".concat(e))}}function nh(t,e){for(const[n,i]of e)t=t.replace(n,i);return t}const ih="\n\n".concat(fu,"\n\n"),rh={[uu]:"vertex",[hu]:"fragment"},oh="precision highp float;\n\n";function sh(t,e){let{id:n,source:i,type:r,modules:o,defines:s={},hookFunctions:a=[],inject:l={},transpileToGLSL100:c=!1,prologue:u=!0,log:h}=e;eu("string"===typeof i,"shader source must be a string");const d=r===uu,f=i.split("\n");let p=100,g="",m=i;0===f[0].indexOf("#version ")?(p=300,g=f[0],m=f.slice(1).join("\n")):g="#version ".concat(p);const v={};o.forEach((t=>{Object.assign(v,t.getDefines())})),Object.assign(v,s);let y=u?"".concat(g,"\n").concat(function(t){let{id:e,source:n,type:i}=t;const r=e&&"string"===typeof e&&-1===n.indexOf("SHADER_NAME");return r?"\n#define SHADER_NAME ".concat(e,"_").concat(rh[i],"\n\n"):""}({id:n,source:i,type:r}),"\n").concat(function(t){let{type:e}=t;return"\n#define SHADER_TYPE_".concat(rh[e].toUpperCase(),"\n")}({type:r}),"\n").concat(Hu(t),"\n").concat(function(t,e,n){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return Wu(t,Du.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),Wu(t,Du.GLSL_DERIVATIVES)&&Uu(t,Du.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),Wu(t,Du.GLSL_FRAG_DATA)&&Uu(t,Du.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),Wu(t,Du.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(t),"\n").concat(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=0,n="";for(const i in t){0===e&&(n+="\n// APPLICATION DEFINES\n"),e++;const r=t[i];(r||Number.isFinite(r))&&(n+="#define ".concat(i.toUpperCase()," ").concat(t[i],"\n"))}0===e&&(n+="\n");return n}(v),"\n").concat(d?"":oh,"\n"):"".concat(g,"\n");const b=function(t){const e={vs:{},fs:{}};return t.forEach((t=>{let n;"string"!==typeof t?(n=t,t=n.hook):n={},t=t.trim();const[i,r]=t.split(":"),o=t.replace(/\(.+/,"");e[i][o]=Object.assign(n,{signature:r})})),e}(a),_={},w={},x={};for(const S in l){const t="string"===typeof l[S]?{injection:l[S],order:0}:l[S],e=S.match(/^(v|f)s:(#)?([\w-]+)$/);if(e){const n=e[2],i=e[3];n?"decl"===i?w[S]=[t]:x[S]=[t]:_[S]=[t]}else x[S]=[t]}for(const S of o){h&&S.checkDeprecations(m,h);y+=S.getModuleSource(r,p);const t=S.injections[r];for(const e in t){const n=e.match(/^(v|f)s:#([\w-]+)$/);if(n){const i="decl"===n[2]?w:x;i[e]=i[e]||[],i[e].push(t[e])}else _[e]=_[e]||[],_[e].push(t[e])}}return y+=ih,y=vu(y,r,w),y+=function(t,e){let n="";for(const i in t){const r=t[i];if(n+="void ".concat(r.signature," {\n"),r.header&&(n+="  ".concat(r.header)),e[i]){const t=e[i];t.sort(((t,e)=>t.order-e.order));for(const e of t)n+="  ".concat(e.injection,"\n")}r.footer&&(n+="  ".concat(r.footer)),n+="}\n"}return n}(b[r],_),y+=m,y=vu(y,r,x),y=eh(y,c?100:p,d),y}function ah(t){return function(e){const n={};for(const i of t){const t=i.getUniforms(e,n);Object.assign(n,t)}return n}}const lh={5126:xh.bind(null,"uniform1fv",ph,1,Sh),35664:xh.bind(null,"uniform2fv",ph,2,Sh),35665:xh.bind(null,"uniform3fv",ph,3,Sh),35666:xh.bind(null,"uniform4fv",ph,4,Sh),5124:xh.bind(null,"uniform1iv",gh,1,Sh),35667:xh.bind(null,"uniform2iv",gh,2,Sh),35668:xh.bind(null,"uniform3iv",gh,3,Sh),35669:xh.bind(null,"uniform4iv",gh,4,Sh),35670:xh.bind(null,"uniform1iv",gh,1,Sh),35671:xh.bind(null,"uniform2iv",gh,2,Sh),35672:xh.bind(null,"uniform3iv",gh,3,Sh),35673:xh.bind(null,"uniform4iv",gh,4,Sh),35674:xh.bind(null,"uniformMatrix2fv",ph,4,Ph),35675:xh.bind(null,"uniformMatrix3fv",ph,9,Ph),35676:xh.bind(null,"uniformMatrix4fv",ph,16,Ph),35678:wh,35680:wh,5125:xh.bind(null,"uniform1uiv",mh,1,Sh),36294:xh.bind(null,"uniform2uiv",mh,2,Sh),36295:xh.bind(null,"uniform3uiv",mh,3,Sh),36296:xh.bind(null,"uniform4uiv",mh,4,Sh),35685:xh.bind(null,"uniformMatrix2x3fv",ph,6,Ph),35686:xh.bind(null,"uniformMatrix2x4fv",ph,8,Ph),35687:xh.bind(null,"uniformMatrix3x2fv",ph,6,Ph),35688:xh.bind(null,"uniformMatrix3x4fv",ph,12,Ph),35689:xh.bind(null,"uniformMatrix4x2fv",ph,8,Ph),35690:xh.bind(null,"uniformMatrix4x3fv",ph,12,Ph),35678:wh,35680:wh,35679:wh,35682:wh,36289:wh,36292:wh,36293:wh,36298:wh,36299:wh,36300:wh,36303:wh,36306:wh,36307:wh,36308:wh,36311:wh},ch={},uh={},hh={},dh=[0];function fh(t,e,n,i){1===e&&"boolean"===typeof t&&(t=t?1:0),Number.isFinite(t)&&(dh[0]=t,t=dh);const r=t.length;if(r%e&&$s.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let o=i[r];o||(o=new n(r),i[r]=o);for(let s=0;s<r;s++)o[s]=t[s];return o}function ph(t,e){return fh(t,e,Float32Array,ch)}function gh(t,e){return fh(t,e,Int32Array,uh)}function mh(t,e){return fh(t,e,Uint32Array,hh)}function vh(t,e,n){const i=lh[n.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(n.type));return i().bind(null,t,e)}function yh(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};const e=t.match(/([^[]*)(\[[0-9]+\])?/);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:e[1],length:e[2]||1,isArray:Boolean(e[2])}}function bh(t){return Array.isArray(t)||ArrayBuffer.isView(t)?function(t){if(0===t.length)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t):!!isFinite(t)||(!0===t||!1===t||(t instanceof Tl||(t instanceof Ol||t instanceof Ql&&Boolean(t.texture))))}function _h(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const i=t[e];for(let t=0,e=n.length;t<e;++t)i[t]=n[t]}else t[e]=n.slice();else t[e]=n}function wh(){let t=null;return(e,n,i)=>{const r=t!==i;return r&&(e.uniform1i(n,i),t=i),r}}function xh(t,e,n,i){let r=null,o=null;return(s,a,l)=>{const c=e(l,n),u=c.length;let h=!1;if(null===r)r=new Float32Array(u),o=u,h=!0;else{tl(o===u,"Uniform length cannot change.");for(let t=0;t<u;++t)if(c[t]!==r[t]){h=!0;break}}return h&&(i(s,t,a,c),r.set(c)),h}}function Sh(t,e,n,i){t[e](n,i)}function Ph(t,e,n,i){t[e](n,!1,i)}function Eh(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const n=t.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return n?n[1]:e}const Ch=35632,Th=35633;function Ah(t,e,n,i){const r=t.split(/\r?\n/),o={},s={},a=i||Eh(e)||"(unnamed)",l="".concat(function(t){switch(t){case Ch:return"fragment";case Th:return"vertex";default:return"unknown type"}}(n)," shader ").concat(a);for(let u=0;u<r.length;u++){const e=r[u];if(e.length<=1)continue;const n=e.split(":"),i=n[0],a=parseInt(n[2],10);if(isNaN(a))throw new Error("GLSL compilation error in ".concat(l,": ").concat(t));"WARNING"!==i?o[a]=e:s[a]=e}const c=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ";const i=t.split(/\r?\n/),r=String(i.length+e-1).length;return i.map(((t,i)=>{const o=String(i+e),s=o.length;return Mh(o,r-s)+n+t}))}(e);return{shaderName:l,errors:kh(o,c),warnings:kh(s,c)}}function kh(t,e){let n="";for(let i=0;i<e.length;i++){const r=e[i];if((t[i+3]||t[i+2]||t[i+1])&&(n+="".concat(r,"\n"),t[i+1])){const e=t[i+1],r=e.split(":",3),o=r[0],s=parseInt(r[1],10)||0,a=e.substring(r.join(":").length+1).trim();n+=Mh("^^^ ".concat(o,": ").concat(a,"\n\n"),s)}}return n}function Mh(t,e){let n="";for(let i=0;i<e;++i)n+=" ";return"".concat(n).concat(t)}class Lh extends cl{get[Symbol.toStringTag](){return"Shader"}static getTypeName(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return tl(!1),"unknown"}}constructor(t,e){ra(t),tl("string"===typeof e.source,"Shader: GLSL source code must be a JavaScript string");super(t,{id:Eh(e.source,null)||e.id||rl("unnamed ".concat(Lh.getTypeName(e.shaderType)))}),this.shaderType=e.shaderType,this.source=e.source,this.initialize(e)}initialize(t){let{source:e}=t;const n=Eh(e,null);n&&(this.id=rl(n)),this._compile(e)}getParameter(t){return this.gl.getShaderParameter(this.handle,t)}toString(){return"".concat(Lh.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Eh(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.source;t.startsWith("#version ")||(t="#version 100\n".concat(t)),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle);if(!this.getParameter(35713)){const t=this.gl.getShaderInfoLog(this.handle),{shaderName:e,errors:n,warnings:i}=Ah(t,this.source,this.shaderType,this.id);throw $s.error("GLSL compilation errors in ".concat(e,"\n").concat(n))(),$s.warn("GLSL compilation warnings in ".concat(e,"\n").concat(i))(),new Error("GLSL compilation errors in ".concat(e))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class Oh extends Lh{get[Symbol.toStringTag](){return"VertexShader"}constructor(t,e){"string"===typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class Rh extends Lh{get[Symbol.toStringTag](){return"FragmentShader"}constructor(t,e){"string"===typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Ih=5120,jh=5121,Fh=5122,zh=5123,Nh=0,Dh=1,Bh=2,Uh=3,Vh=4,Wh=5,Hh=6,Gh=5126,Xh=5124,qh=5125,Zh={[Gh]:[Gh,1,"float"],35664:[Gh,2,"vec2"],35665:[Gh,3,"vec3"],35666:[Gh,4,"vec4"],[Xh]:[Xh,1,"int"],35667:[Xh,2,"ivec2"],35668:[Xh,3,"ivec3"],35669:[Xh,4,"ivec4"],[qh]:[qh,1,"uint"],36294:[qh,2,"uvec2"],36295:[qh,3,"uvec3"],36296:[qh,4,"uvec4"],35670:[Gh,1,"bool"],35671:[Gh,2,"bvec2"],35672:[Gh,3,"bvec3"],35673:[Gh,4,"bvec4"],35674:[Gh,8,"mat2"],35685:[Gh,8,"mat2x3"],35686:[Gh,8,"mat2x4"],35675:[Gh,12,"mat3"],35687:[Gh,12,"mat3x2"],35688:[Gh,12,"mat3x4"],35676:[Gh,16,"mat4"],35689:[Gh,16,"mat4x2"],35690:[Gh,16,"mat4x3"]};function Yh(t){switch(t){case Nh:return Nh;case Dh:case Uh:case Bh:return Dh;case Vh:case Wh:case Hh:return Vh;default:return tl(!1),0}}function Kh(t){const e=Zh[t];if(!e)return null;const[n,i]=e;return{type:n,components:i}}function Qh(t,e){switch(t){case Ih:case jh:case Fh:case zh:t=Gh}for(const n in Zh){const[i,r,o]=Zh[n];if(i===t&&r===e)return{glType:n,name:o}}return null}class $h{constructor(t){this.id=t.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(t),this._readVaryingsFromProgram(t)}getAttributeInfo(t){const e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}getAttributeLocation(t){const e=this.getAttributeInfo(t);return e?e.location:-1}getAttributeAccessor(t){const e=this.getAttributeInfo(t);return e?e.accessor:null}getVaryingInfo(t){const e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}getVaryingIndex(t){const e=this.getVaryingInfo();return e?e.location:-1}getVaryingAccessor(t){const e=this.getVaryingInfo();return e?e.accessor:null}_readAttributesFromProgram(t){const{gl:e}=t,n=e.getProgramParameter(t.handle,35721);for(let i=0;i<n;i++){const{name:n,type:r,size:o}=e.getActiveAttrib(t.handle,i),s=e.getAttribLocation(t.handle,n);s>=0&&this._addAttribute(s,n,r,o)}this.attributeInfos.sort(((t,e)=>t.location-e.location))}_readVaryingsFromProgram(t){const{gl:e}=t;if(!ia(e))return;const n=e.getProgramParameter(t.handle,35971);for(let i=0;i<n;i++){const{name:n,type:r,size:o}=e.getTransformFeedbackVarying(t.handle,i);this._addVarying(i,n,r,o)}this.varyingInfos.sort(((t,e)=>t.location-e.location))}_addAttribute(t,e,n,i){const{type:r,components:o}=Kh(n),s={type:r,size:i*o};this._inferProperties(t,e,s);const a={location:t,name:e,accessor:new vl(s)};this.attributeInfos.push(a),this.attributeInfosByLocation[t]=a,this.attributeInfosByName[a.name]=a}_inferProperties(t,e,n){/instance/i.test(e)&&(n.divisor=1)}_addVarying(t,e,n,i){const{type:r,components:o}=Kh(n),s={location:t,name:e,accessor:new vl({type:r,size:i*o})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}const Jh=35981,td=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class ed extends cl{get[Symbol.toStringTag](){return"Program"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.stubRemovedMethods("Program","v6.0",td),this._isCached=!1,this.initialize(e),Object.seal(this),this._setId(e.id)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hash:e,vs:n,fs:i,varyings:r,bufferMode:o=Jh}=t;return this.hash=e||"",this.vs="string"===typeof n?new Oh(this.gl,{id:"".concat(t.id,"-vs"),source:n}):n,this.fs="string"===typeof i?new Rh(this.gl,{id:"".concat(t.id,"-fs"),source:i}):i,tl(this.vs instanceof Oh),tl(this.fs instanceof Rh),this.uniforms={},this._textureUniforms={},r&&r.length>0&&(oa(this.gl),this.varyings=r,this.gl2.transformFeedbackVaryings(this.handle,r,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new $h(this),this.setProps(t)}delete(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isCached?this:super.delete(t)}setProps(t){return"uniforms"in t&&this.setUniforms(t.uniforms),this}draw(t){let{logPriority:e,drawMode:n=4,vertexCount:i,offset:r=0,start:o,end:s,isIndexed:a=!1,indexType:l=5123,instanceCount:c=0,isInstanced:u=c>0,vertexArray:h=null,transformFeedback:d,framebuffer:f,parameters:p={},uniforms:g,samplers:m}=t;if((g||m)&&($s.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(g||{})),$s.priority>=e){const t=f?f.id:"default",r="mode=".concat(nl(this.gl,n)," verts=").concat(i," ")+"instances=".concat(c," indexType=").concat(nl(this.gl,l)," ")+"isInstanced=".concat(u," isIndexed=").concat(a," ")+"Framebuffer=".concat(t);$s.log(e,r)()}return tl(h),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||u&&0===c)&&(h.bindForDraw(i,c,(()=>{if(void 0!==f&&(p=Object.assign({},p,{framebuffer:f})),d){const t=Yh(n);d.begin(t)}this._bindTextures(),Na(this.gl,p,(()=>{a&&u?this.gl2.drawElementsInstanced(n,i,l,r,c):a&&ia(this.gl)&&!isNaN(o)&&!isNaN(s)?this.gl2.drawRangeElements(n,o,s,i,l,r):a?this.gl.drawElements(n,i,l,r):u?this.gl2.drawArraysInstanced(n,r,i,c):this.gl.drawArrays(n,r,i)})),d&&d.end()})),!0)}setUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};$s.priority>=2&&function(t,e,n){for(const i in t){const r=t[i];if((!n||Boolean(n[i]))&&!bh(r))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(i),r),new Error("".concat(e," Bad uniform ").concat(i))}}(t,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const e in t){const n=t[e],i=this._uniformSetters[e];if(i){let t=n,r=!1;if(t instanceof Ql&&(t=t.texture),t instanceof Tl)if(r=this.uniforms[e]!==n,r){void 0===i.textureIndex&&(i.textureIndex=this._textureIndexCounter++);const n=t,{textureIndex:r}=i;n.bind(r),t=r,this._textureUniforms[e]=n}else t=i.textureIndex;else this._textureUniforms[e]&&delete this._textureUniforms[e];(i(t)||r)&&_h(this.uniforms,e,n)}}return this}_areTexturesRenderable(){let t=!0;for(const e in this._textureUniforms){const n=this._textureUniforms[e];n.update(),t=t&&n.loaded}return t}_bindTextures(){for(const t in this._textureUniforms){const e=this._uniformSetters[t].textureIndex;this._textureUniforms[t].bind(e)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(t){const e=this.gl.getAttachedShaders(t),n={};for(const i of e){switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new Oh({handle:i});break;case 35632:n.fs=new Rh({handle:i})}}return n}_getParameter(t){return this.gl.getProgramParameter(this.handle,t)}_setId(t){if(!t){const t=this._getName();this.id=rl(t)}}_getName(){let t=this.vs.getName()||this.fs.getName();return t=t.replace(/shader/i,""),t=t?"".concat(t,"-program"):"program",t}_compileAndLink(){const{gl:t}=this;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),$s.time(4,"linkProgram for ".concat(this._getName()))(),t.linkProgram(this.handle),$s.timeEnd(4,"linkProgram for ".concat(this._getName()))(),t.debug||$s.level>0){if(!t.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(t.getProgramInfoLog(this.handle)));t.validateProgram(this.handle);if(!t.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(t.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:t}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let e=0;e<this._uniformCount;e++){const n=this.gl.getActiveUniform(this.handle,e),{name:i}=yh(n.name);let r=t.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=vh(t,r,n),n.size>1)for(let e=0;e<n.size;e++)r=t.getUniformLocation(this.handle,"".concat(i,"[").concat(e,"]")),this._uniformSetters["".concat(i,"[").concat(e,"]")]=vh(t,r,n)}this._textureIndexCounter=0}getActiveUniforms(t,e){return this.gl2.getActiveUniforms(this.handle,t,e)}getUniformBlockIndex(t){return this.gl2.getUniformBlockIndex(this.handle,t)}getActiveUniformBlockParameter(t,e){return this.gl2.getActiveUniformBlockParameter(this.handle,t,e)}uniformBlockBinding(t,e){this.gl2.uniformBlockBinding(this.handle,t,e)}}class nd{static getDefaultProgramManager(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new nd(t),t.luma.defaultProgramManager}constructor(t){this.gl=t,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(t){this._defaultModules.find((e=>e.name===t.name))||this._defaultModules.push(t),this.stateHash++}removeDefaultModule(t){const e="string"===typeof t?t:t.name;this._defaultModules=this._defaultModules.filter((t=>t.name!==e)),this.stateHash++}addShaderHook(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t),this.stateHash++}get(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{vs:e="",fs:n="",defines:i={},inject:r={},varyings:o=[],bufferMode:s=35981,transpileToGLSL100:a=!1}=t,l=this._getModuleList(t.modules),c=this._getHash(e),u=this._getHash(n),h=l.map((t=>this._getHash(t.name))).sort(),d=o.map((t=>this._getHash(t))),f=Object.keys(i).sort(),p=Object.keys(r).sort(),g=[],m=[];for(const y of f)g.push(this._getHash(y)),g.push(this._getHash(i[y]));for(const y of p)m.push(this._getHash(y)),m.push(this._getHash(r[y]));const v="".concat(c,"/").concat(u,"D").concat(g.join("/"),"M").concat(h.join("/"),"I").concat(m.join("/"),"V").concat(d.join("/"),"H").concat(this.stateHash,"B").concat(s).concat(a?"T":"");if(!this._programCache[v]){const t=function(t,e){const{vs:n,fs:i}=e,r=Mu(e.modules||[]);return{gl:t,vs:sh(t,Object.assign({},e,{source:n,type:uu,modules:r})),fs:sh(t,Object.assign({},e,{source:i,type:hu,modules:r})),getUniforms:ah(r)}}(this.gl,{vs:e,fs:n,modules:l,inject:r,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:a});this._programCache[v]=new ed(this.gl,{hash:v,vs:t.vs,fs:t.fs,varyings:o,bufferMode:s}),this._getUniforms[v]=t.getUniforms||(t=>{}),this._useCounts[v]=0}return this._useCounts[v]++,this._programCache[v]}getUniforms(t){return this._getUniforms[t.hash]||null}release(t){const e=t.hash;this._useCounts[e]--,0===this._useCounts[e]&&(this._programCache[e].delete(),delete this._programCache[e],delete this._getUniforms[e],delete this._useCounts[e])}_getHash(t){return void 0===this._hashes[t]&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}_getModuleList(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=new Array(this._defaultModules.length+t.length),n={};let i=0;for(let r=0,o=this._defaultModules.length;r<o;++r){const t=this._defaultModules[r],o=t.name;e[i++]=t,n[o]=!0}for(let r=0,o=t.length;r<o;++r){const o=t[r],s=o.name;n[s]||(e[i++]=o,n[s]=!0)}return e.length=i,e}}let id=null;function rd(t,e){var n;return new t((n=t.BYTES_PER_ELEMENT*e,(!id||id.byteLength<n)&&(id=new ArrayBuffer(n)),id),0,e)}const od=globalThis;function sd(t){if(!t&&!Es())return"Node";if(Ps(t))return"Electron";const e="undefined"!==typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const i=-1!==n.indexOf("MSIE "),r=-1!==n.indexOf("Trident/");return i||r?"IE":od.chrome?"Chrome":od.safari?"Safari":od.mozInnerScreenX?"Firefox":"Unknown"}class ad extends cl{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(t){return!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).constantAttributeZero||(ia(t)||"Chrome"===sd())}static getDefaultArray(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new ad(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}static getMaxAttributes(t){return ad.MAX_ATTRIBUTES=ad.MAX_ATTRIBUTES||t.getParameter(34921),ad.MAX_ATTRIBUTES}static setConstant(t,e,n){switch(n.constructor){case Float32Array:ad._setConstantFloatArray(t,e,n);break;case Int32Array:ad._setConstantIntArray(t,e,n);break;case Uint32Array:ad._setConstantUintArray(t,e,n);break;default:tl(!1)}}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.id||e.program&&e.program.id;super(t,Object.assign({},e,{id:n})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=e.isDefaultArray||!1,this.gl2=t,this.initialize(e),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return ad.getMaxAttributes(this.gl)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.setProps(t)}setProps(t){return this}setElementBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return tl(!t||34963===t.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind((()=>{this.gl.bindBuffer(34963,t?t.handle:null)})),this}setBuffer(t,e,n){if(34963===e.target)return this.setElementBuffer(e,n);const{size:i,type:r,stride:o,offset:s,normalized:a,integer:l,divisor:c}=n,{gl:u,gl2:h}=this;return t=Number(t),this.bind((()=>{u.bindBuffer(34962,e.handle),l?(tl(ia(u)),h.vertexAttribIPointer(t,i,r,o,s)):u.vertexAttribPointer(t,i,r,a,o,s),u.enableVertexAttribArray(t),h.vertexAttribDivisor(t,c||0)})),this}enable(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!e&&0===t&&!ad.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind((()=>e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t)))),this}getConstantBuffer(t,e){const n=this._normalizeConstantArrayValue(e),i=n.byteLength*t,r=n.length*t;let o=!this.buffer;if(this.buffer=this.buffer||new wl(this.gl,i),o=o||this.buffer.reallocate(i),o=o||!this._compareConstantArrayValues(n,this.bufferValue),o){const t=rd(e.constructor,r);!function(t){let{target:e,source:n,start:i=0,count:r=1}=t;const o=n.length,s=r*o;let a=0;for(let l=i;a<o;a++)e[l++]=n[a];for(;a<s;)a<s-a?(e.copyWithin(i+a,i,i+a),a*=2):(e.copyWithin(i+a,i,i+s-a),a=s)}({target:t,source:n,start:0,count:r}),this.buffer.subData(t),this.bufferValue=e}return this.buffer}_normalizeConstantArrayValue(t){return Array.isArray(t)?new Float32Array(t):t}_compareConstantArrayValues(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}static _setConstantFloatArray(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:tl(!1)}}static _setConstantIntArray(t,e,n){switch(tl(ia(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:tl(!1)}}static _setConstantUintArray(t,e,n){switch(tl(ia(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:tl(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(t){return this.gl2.deleteVertexArray(t),[this.elements]}_bindHandle(t){this.gl2.bindVertexArray(t)}_getParameter(t,e){let{location:n}=e;return tl(Number.isFinite(n)),this.bind((()=>34373===t?this.gl.getVertexAttribOffset(n,t):this.gl.getVertexAttrib(n,t)))}}const ld=/^(.+)__LOCATION_([0-9]+)$/,cd=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class ud{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.id||e.program&&e.program.id;this.id=n,this.gl=t,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new ad(t),al(this,"VertexArray","v6.0",cd),this.initialize(e),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:t}=this.vertexArrayObject;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}setProps(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(t){return Object.assign(this.attributes,t),this.vertexArrayObject.bind((()=>{for(const e in t){const n=t[e];this._setAttribute(e,n)}this.gl.bindBuffer(34962,null)})),this}setElementBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}setBuffer(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===e.target)return this.setElementBuffer(e,n);const{location:i,accessor:r}=this._resolveLocationAndAccessor(t,e,e.accessor,n);return i>=0&&(this.values[i]=e,this.accessors[i]=r,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,e,r)),this}setConstant(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{location:i,accessor:r}=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},n));return i>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[i]=e,this.accessors[i]=r,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new wl(this.gl,{accessor:{size:4}});for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this.values[t]instanceof wl&&(this.gl.disableVertexAttribArray(t),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(t,1,5126,!1,0,0))})),this}bindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.setElementBuffer(this.elements);for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++){const e=this.values[t];e instanceof wl&&this.setBuffer(t,e)}})),this}bindForDraw(t,e,n){let i;return this.vertexArrayObject.bind((()=>{this._setConstantAttributes(t,e),i=n()})),i}_resolveLocationAndAccessor(t,e,n,i){const r={location:-1,accessor:null},{location:o,name:s}=this._getAttributeIndex(t);if(!Number.isFinite(o)||o<0)return this.unused[t]=e,$s.once(3,(()=>"unused value ".concat(t," in ").concat(this.id)))(),r;const a=this._getAttributeInfo(s||o);if(!a)return r;const l=this.accessors[o]||{},c=vl.resolve(a.accessor,l,n,i),{size:u,type:h}=c;return tl(Number.isFinite(u)&&Number.isFinite(h)),{location:o,accessor:c}}_getAttributeInfo(t){return this.configuration&&this.configuration.getAttributeInfo(t)}_getAttributeIndex(t){const e=Number(t);if(Number.isFinite(e))return{location:e};const n=ld.exec(t),i=n?n[1]:t,r=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+r,name:i}:{location:-1}}_setAttribute(t,e){if(e instanceof wl)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof wl){const n=e[0],i=e[1];this.setBuffer(t,n,i)}else if(ArrayBuffer.isView(e)||Array.isArray(e)){const n=e;this.setConstant(t,n)}else{if(!(e.buffer instanceof wl))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");{const n=e;this.setBuffer(t,n.buffer,n)}}}_setConstantAttributes(t,e){const n=Math.max(0|t,0|e);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,n);for(let r=1;r<this.vertexArrayObject.MAX_ATTRIBUTES;r++)i=this.values[r],ArrayBuffer.isView(i)&&this._setConstantAttribute(r,i)}_setConstantAttributeZero(t,e){if(ad.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,t);const n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(t,e){ad.setConstant(this.gl,t,e)}_updateDrawParams(){const t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}_updateDrawParamsForLocation(t,e){const n=this.values[e],i=this.accessors[e];if(!n)return;const{divisor:r}=i,o=r>0;if(t.isInstanced=t.isInstanced||o,n instanceof wl){const e=n;if(o){const n=e.getVertexCount(i);t.instanceCount=Math.min(t.instanceCount,n)}else{const n=e.getVertexCount(i);t.vertexCount=Math.min(t.vertexCount,n)}}}setElements(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return $s.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(t,e)}}function hd(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{isInteger:n=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return function(t,e){const{maxElts:n=16,size:i=1}=e;let r="[";for(let s=0;s<t.length&&s<n;++s)s>0&&(r+=",".concat(s%i===0?" ":"")),r+=hd(t[s],e);const o=t.length>n?"...":"]";return"".concat(r).concat(o)}(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<1e-16)return n?"0":"0.";if(n)return t.toFixed(0);if(Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function dd(t,e,n,i){const{gl:r}=t;if(!e)return{[i]:"null","Format ":"N/A"};let o,s,a,l="NOT PROVIDED",c=1,u=0,h=0;if(n&&(l=n.type,c=n.size,l=String(l).replace("Array",""),o=-1!==l.indexOf("nt")),e instanceof wl){const t=e,{data:d,changed:f}=t.getDebugData();let p;if(s=f?"*":"",a=d,h=t.byteLength,u=h/d.BYTES_PER_ELEMENT/c,n){const t=n.divisor>0;p="".concat(t?"I ":"P "," ").concat(u," (x").concat(c,"=").concat(h," bytes ").concat(nl(r,l),")")}else o=!0,p="".concat(h," bytes");return{[i]:"".concat(s).concat(hd(a,{size:c,isInteger:o})),"Format ":p}}return a=e,c=e.length,l=String(e.constructor.name).replace("Array",""),o=-1!==l.indexOf("nt"),{[i]:"".concat(hd(a,{size:c,isInteger:o})," (constant)"),"Format ":"".concat(c,"x").concat(l," (constant)")}}function fd(t,e){const{type:n,size:i}=e,r=Qh(n,i);return r?"".concat(t," (").concat(r.name,")"):t}function pd(t){let{header:e="Uniforms",program:n,uniforms:i,undefinedOnly:r=!1}=t;tl(n);const o=".*Matrix",s=n._uniformSetters,a={},l=Object.keys(s).sort();let c=0;for(const d of l)d.match(".*_.*")||d.match(o)||gd({table:a,header:e,uniforms:i,uniformName:d,undefinedOnly:r})&&c++;for(const d of l)d.match(o)&&gd({table:a,header:e,uniforms:i,uniformName:d,undefinedOnly:r})&&c++;for(const d of l)a[d]||gd({table:a,header:e,uniforms:i,uniformName:d,undefinedOnly:r})&&c++;let u=0;const h={};if(!r)for(const d in i){const t=i[d];a[d]||(u++,h[d]={Type:"NOT USED: ".concat(t),[e]:hd(t)})}return{table:a,count:c,unusedTable:h,unusedCount:u}}function gd(t){let{table:e,header:n,uniforms:i,uniformName:r,undefinedOnly:o}=t;const s=i[r],a=function(t){return void 0!==t&&null!==t}(s);return(!o||!a)&&(e[r]={[n]:a?hd(s):"N/A","Uniform Type":a?s:"NOT PROVIDED"},!0)}function md(t){const{type:e,size:n}=t.accessor,i=Qh(e,n);return i?"".concat(i.name," ").concat(t.name):t.name}const vd={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function yd(t,e){const{attributeMap:n=vd}=e||{};return n&&n[t]||t}function bd(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}tl(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const _d=()=>{},wd={};class xd{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{id:n=rl("model")}=e;tl(na(t)),this.id=n,this.gl=t,this.id=e.id||rl("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(e)}initialize(t){this.props={},this.programManager=t.programManager||nd.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:e=null,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c}=t;this.programProps={program:e,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(t.moduleSettings))),this.drawMode=void 0!==t.drawMode?t.drawMode:4,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced||t.instanceCount>0,this._setModelProps(t),this.geometry={},tl(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(t){this._setModelProps(t)}delete(){for(const t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(t){const{program:e,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c}=t;this.programProps={program:e,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(t){return this.drawMode=t,this}setVertexCount(t){return tl(Number.isFinite(t)),this.vertexCount=t,this}setInstanceCount(t){return tl(Number.isFinite(t)),this.instanceCount=t,this}setGeometry(t){return this.drawMode=t.drawMode,this.vertexCount=t.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(t,e,n){const i={};let r=e.indices;for(const o in e.attributes){const s=e.attributes[o],a=yd(o,n);if("indices"===o)r=s;else if(s.constant)i[a]=s.value;else{const e=s.value,n={...s};delete n.value,i[a]=[new wl(t,e),n],bd(o,n)}}if(r){const e=r.value||r;tl(e instanceof Uint16Array||e instanceof Uint32Array,'attribute array for "indices" must be of integer type');const n={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new wl(t,{data:e,target:34963}),n]}return i}(this.gl,t),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(sl(t))return this;const e={};for(const n in t){const i=t[n];e[n]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(e),this}setUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(this.uniforms,t),this}getModuleUniforms(t){this._checkProgram();const e=this.programManager.getUniforms(this.program);return e?e(t):{}}updateModuleSettings(t){const e=this.getModuleUniforms(t||{});return this.setUniforms(e)}clear(t){return Ul(this.program.gl,t),this}draw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._checkProgram();const{moduleSettings:e=null,framebuffer:n,uniforms:i={},attributes:r={},transformFeedback:o=this.transformFeedback,parameters:s={},vertexArray:a=this.vertexArray}=t;let l;this.setAttributes(r),this.updateModuleSettings(e),this.setUniforms(i),$s.priority>=2&&(l=this._logDrawCallStart(2));const c=this.vertexArray.getDrawParams(),{isIndexed:u=c.isIndexed,indexType:h=c.indexType,indexOffset:d=c.indexOffset,vertexArrayInstanced:f=c.isInstanced}=this.props;f&&!this.isInstanced&&$s.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:p,instanceCount:g}=this,{onBeforeRender:m=_d,onAfterRender:v=_d}=this.props;m(),this.program.setUniforms(this.uniforms);const y=this.program.draw(Object.assign(wd,t,{logPriority:l,uniforms:null,framebuffer:n,parameters:s,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:a,transformFeedback:o,isIndexed:u,indexType:h,isInstanced:p,instanceCount:g,offset:u?d:0}));return v(),$s.priority>=2&&this._logDrawCallEnd(l,a,n),y}transform(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{discard:e=!0,feedbackBuffers:n,unbindModels:i=[]}=t;let{parameters:r}=t;n&&this._setFeedbackBuffers(n),e&&(r=Object.assign({},r,{35977:e})),i.forEach((t=>t.vertexArray.unbindBuffers()));try{this.draw(Object.assign({},t,{parameters:r}))}finally{i.forEach((t=>t.vertexArray.bindBuffers()))}return this}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return $s.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(t).draw()}_setModelProps(t){Object.assign(this.props,t),"uniforms"in t&&this.setUniforms(t.uniforms),"pickable"in t&&(this.pickable=t.pickable),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:e,fs:n,modules:i,inject:r,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:l}=this.programProps;t=this.programManager.get({vs:e,fs:n,modules:i,inject:r,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:l}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}tl(t instanceof ed,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new ud(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const t in this.geometryBuffers){const e=this.geometryBuffers[t][0]||this.geometryBuffers[t];e instanceof wl&&e.delete()}}_setAnimationProps(t){this.animated&&tl(t,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(sl(t))return this;const{gl:e}=this.program;return this.transformFeedback=this.transformFeedback||new au(e,{program:this.program}),this.transformFeedback.setBuffers(t),this}_logDrawCallStart(t){const e=t>3?0:1e4;if(!(Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),$s.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:$s.level<=2})(),t}_logDrawCallEnd(t,e,n,i){if(void 0===t)return;const r=function(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=dd(e,e.elements,null,n));const r=e.values;for(const o in r){const t=e._getAttributeInfo(o);if(t){let s="".concat(o,": ").concat(t.name);const a=e.accessors[t.location];a&&(s="".concat(o,": ").concat(fd(t.name,a))),i[s]=dd(e,r[o],a,n)}}return i}({vertexArray:e,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:s,unusedCount:a}=pd({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:l,count:c}=pd({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});c>0&&$s.log("MISSING UNIFORMS",Object.keys(l))(),a>0&&$s.log("UNUSED UNIFORMS",Object.keys(s))();const u=function(t){const e={},n="Accessors for ".concat(t.id);for(const i of t.attributeInfos)if(i){const t=md(i);e["in ".concat(t)]={[n]:JSON.stringify(i.accessor)}}for(const i of t.varyingInfos)if(i){const t=md(i);e["out ".concat(t)]={[n]:JSON.stringify(i.accessor)}}return e}(this.vertexArray.configuration);$s.table(t,r)(),$s.table(t,o)(),$s.table(t+1,u)(),i&&i.log({logLevel:2,message:"Rendered to ".concat(i.id)}),$s.groupEnd(2)()}}class Sd{static isSupported(t){return ia(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(e),Object.seal(this)}delete(){const{model:t,bufferTransform:e,textureTransform:n}=this;t&&t.delete(),e&&e.delete(),n&&n.delete()}run(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{clearRenderTarget:e=!0}=t,n=this._updateDrawOptions(t);e&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let t=!1;const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)t=t||n.swap();tl(t,"Nothing to swap")}getBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(t)}getData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e){const e=n.getData(t);if(e)return e}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"elementCount"in t&&this.model.setVertexCount(t.elementCount);const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)n.update(t)}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{gl:e}=this;this._buildResourceTransforms(e,t),t=this._updateModelProps(t),this.model=new xd(e,Object.assign({},t,{fs:t.fs||su({version:cu(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=i.updateModelProps(e);return e}_buildResourceTransforms(t,e){(function(t){if(!sl(t.feedbackBuffers)||!sl(t.feedbackMap)||t.varyings&&t.varyings.length>0)return!0;return!1})(e)&&(this.bufferTransform=new lu(t,e)),function(t){if(!sl(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)return!0;return!1}(e)&&(this.textureTransform=new Eu(t,e)),tl(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=Object.assign(e,i.getDrawOptions(e));return e}}class Pd{constructor(t){Ss(this,"_inProgress",void 0),Ss(this,"_handle",void 0),Ss(this,"_timeline",void 0),Ss(this,"time",void 0),Ss(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=t,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(t){var e,n;this.cancel(),this.settings=t,this._inProgress=!0,null===(e=(n=this.settings).onStart)||void 0===e||e.call(n,this)}end(){var t,e;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(t=(e=this.settings).onEnd)||void 0===t||t.call(e,this))}cancel(){var t,e;this._inProgress&&(null===(t=(e=this.settings).onInterrupt)||void 0===t||t.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var t,e;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:t,settings:e}=this;this._handle=t.addChannel({delay:t.getTime(),duration:e.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(t=(e=this.settings).onUpdate)||void 0===t||t.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Ed="\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n";const Cd={interpolation:class{constructor(t){let{gl:e,attribute:n,timeline:i}=t;Ss(this,"gl",void 0),Ss(this,"type","interpolation"),Ss(this,"attributeInTransition",void 0),Ss(this,"settings",void 0),Ss(this,"attribute",void 0),Ss(this,"transition",void 0),Ss(this,"currentStartIndices",void 0),Ss(this,"currentLength",void 0),Ss(this,"transform",void 0),Ss(this,"buffers",void 0),this.gl=e,this.transition=new Pd(i),this.attribute=n,this.attributeInTransition=new $c(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=function(t,e){const n=Zc(e.size);return new Sd(t,{vs:Ed,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(e,n);const r={byteLength:0,usage:35050};this.buffers=[new wl(e,r),new wl(e,r)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0)return void this.transition.cancel();this.settings=t;const{gl:n,buffers:i,attribute:r}=this;Yc(i);const o={numInstances:e,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const s of i)Qc({buffer:s,...o});this.currentStartIndices=r.startIndices,this.currentLength=Kc(r,e),this.attributeInTransition.setData({buffer:i[1],value:r.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aFrom:i[0],aTo:qc(0,r)},feedbackBuffers:{vCurrent:i[1]}})}update(){const t=this.transition.update();if(t){const{duration:t,easing:e}=this.settings,{time:n}=this.transition;let i=n/t;e&&(i=e(i)),this.transform.run({uniforms:{time:i}})}return t}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0}},spring:class{constructor(t){let{gl:e,attribute:n,timeline:i}=t;Ss(this,"gl",void 0),Ss(this,"type","spring"),Ss(this,"attributeInTransition",void 0),Ss(this,"settings",void 0),Ss(this,"attribute",void 0),Ss(this,"transition",void 0),Ss(this,"currentStartIndices",void 0),Ss(this,"currentLength",void 0),Ss(this,"texture",void 0),Ss(this,"framebuffer",void 0),Ss(this,"transform",void 0),Ss(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Pd(i),this.attribute=n,this.attributeInTransition=new $c(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=function(t){return new kl(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function(t,e){return new Ql(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(e,this.texture),this.transform=function(t,e,n){const i=Zc(e.size);return new Sd(t,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(e,n,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new wl(e,r),new wl(e,r),new wl(e,r)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:n,buffers:i,attribute:r}=this,o={numInstances:e,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const s of i)Qc({buffer:s,...o});this.settings=t,this.currentStartIndices=r.startIndices,this.currentLength=Kc(r,e),this.attributeInTransition.setData({buffer:i[1],value:r.value}),this.transition.start({...t,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aTo:qc(0,r)}})}update(){const{buffers:t,transform:e,framebuffer:n,transition:i}=this;if(!i.update())return!1;const r=this.settings;e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.stiffness,damping:r.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),Yc(t),this.attributeInTransition.setData({buffer:t[1],value:this.attribute.value});return ql(n)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}};class Td{constructor(t,e){let{id:n,timeline:i}=e;Ss(this,"id",void 0),Ss(this,"isSupported",void 0),Ss(this,"gl",void 0),Ss(this,"timeline",void 0),Ss(this,"transitions",void 0),Ss(this,"needsRedraw",void 0),Ss(this,"numInstances",void 0),this.id=n,this.gl=t,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=Sd.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update(t){let{attributes:e,transitions:n,numInstances:i}=t;this.numInstances=i||1;for(const r in e){const t=e[r],i=t.getTransitionSetting(n);i&&this._updateAttribute(r,t,i)}for(const r in this.transitions){const t=e[r];t&&t.getTransitionSetting(n)||this._removeTransition(r)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const e in this.transitions){this.transitions[e].update()&&(this.needsRedraw=!0)}const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,n){const i=this.transitions[t];let r=!i||i.type!==n.type;if(r){if(!this.isSupported)return void Gs.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();i&&this._removeTransition(t);const o=Cd[n.type];o?this.transitions[t]=new o({attribute:e,timeline:this.timeline,gl:this.gl}):(Gs.error("unsupported transition type '".concat(n.type,"'"))(),r=!1)}(r||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}const Ad="attributeManager.invalidate";class kd{constructor(t){let{id:e="attribute-manager",stats:n,timeline:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ss(this,"id",void 0),Ss(this,"gl",void 0),Ss(this,"attributes",void 0),Ss(this,"updateTriggers",void 0),Ss(this,"needsRedraw",void 0),Ss(this,"userData",void 0),Ss(this,"stats",void 0),Ss(this,"attributeTransitionManager",void 0),this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new Td(t,{id:"".concat(e,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{instanced:1})}remove(t){for(const e of t)void 0!==this.attributes[e]&&(this.attributes[e].delete(),delete this.attributes[e])}invalidate(t,e){const n=this._invalidateTrigger(t,e);tu(Ad,this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);tu(Ad,this,"all")}update(t){let{data:e,numInstances:n,startIndices:i=null,transitions:r,props:o={},buffers:s={},context:a={}}=t,l=!1;tu("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const t=this.attributes[c],r=t.settings.accessor;t.startIndices=i,t.numInstances=n,o[c]&&Gs.removed("props.".concat(c),"data.attributes.".concat(c))(),t.setExternalBuffer(s[c])||t.setBinaryValue("string"===typeof r?s[r]:void 0,e.startIndices)||"string"===typeof r&&!s[r]&&t.setConstantValue(o[r])||t.needsUpdate()&&(l=!0,this._updateAttribute({attribute:t,numInstances:n,data:e,props:o,context:a})),this.needsRedraw=this.needsRedraw||t.needsRedraw()}l&&tu("attributeManager.updateEnd",this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:r})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getChangedAttributes(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearChangedFlags:!1};const{attributes:e,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const r in e){const o=e[r];o.needsRedraw(t)&&!n.hasAttribute(r)&&(i[r]=o)}return i}getShaderAttributes(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t||(t=this.getAttributes());const n={};for(const i in t)e[i]||Object.assign(n,t[i].getShaderAttributes());return n}_add(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(const n in t){const i=t[n];this.attributes[n]=this._createAttribute(n,i,e)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const i={...e,id:t,size:(e.isIndexed?1:e.size)||1,divisor:n.instanced?1:e.divisor||0};return new $c(this.gl,i)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes){this.attributes[e].getUpdateTriggers().forEach((n=>{t[n]||(t[n]=[]),t[n].push(e)}))}this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:i}=this,r=i[t];return r&&r.forEach((t=>{const i=n[t];i&&i.setNeedsUpdate(i.id,e)})),r}_updateAttribute(t){const{attribute:e,numInstances:n}=t;if(tu("attribute.updateStart",e),e.constant)return void e.setConstantValue(e.value);e.allocate(n)&&tu("attribute.allocate",e,n);e.updateBuffer(t)&&(this.needsRedraw=!0,tu("attribute.updateEnd",e,n))}}const Md=1e-5;function Ld(t,e,n,i,r){const o=e-t;return(n-e)*r+-o*i+o+e}function Od(t,e){if(Array.isArray(t)){let n=0;for(let i=0;i<t.length;i++){const r=t[i]-e[i];n+=r*r}return Math.sqrt(n)}return Math.abs(t-e)}const Rd={interpolation:class extends Pd{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:i,easing:r}}=this,o=r(t/i);this._value=uc(e,n,o)}},spring:class extends Pd{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:i}=this.settings,{_prevValue:r=t,_currValue:o=t}=this;let s=function(t,e,n,i,r){if(Array.isArray(n)){const o=[];for(let s=0;s<n.length;s++)o[s]=Ld(t[s],e[s],n[s],i,r);return o}return Ld(t,e,n,i,r)}(r,o,e,n,i);const a=Od(s,e),l=Od(s,o);a<Md&&l<Md&&(s=e,this.end()),this._prevValue=o,this._currValue=s}}};class Id{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,i){const{transitions:r}=this;if(r.has(t)){const n=r.get(t),{value:i=n.settings.fromValue}=n;e=i,this.remove(t)}if(!(i=Xc(i)))return;const o=Rd[i.type];if(!o)return void Gs.error("unsupported transition type '".concat(i.type,"'"))();const s=new o(this.timeline);s.start({...i,fromValue:e,toValue:n}),r.set(t,s)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}const jd="Awaiting state",Fd="Matched. State transferred from previous layer",zd="Initialized",Nd="Discarded. Awaiting garbage collection",Dd="No longer matched. Awaiting garbage collection",Bd="Finalized! Awaiting garbage collection",Ud=Symbol.for("component"),Vd=Symbol.for("asyncPropDefaults"),Wd=Symbol.for("asyncPropOriginal"),Hd=Symbol.for("asyncPropResolved");function Gd(t,e){const n=qd({newProps:t,oldProps:e,propTypes:Qd(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(t,e){if(null===e)return"oldProps is null, initial diff";let n=!1;const{dataComparator:i,_dataDiff:r}=t;i?i(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied");n&&r&&(n=r(t.data,e.data)||n);return n}(t,e);let r=!1;return i||(r=function(t,e){if(null===e)return{all:!0};if("all"in t.updateTriggers){if(Kd(t,e,"all"))return{all:!0}}const n={};let i=!1;for(const r in t.updateTriggers)if("all"!==r){Kd(t,e,r)&&(n[r]=!0,i=!0)}return!!i&&n}(t,e)),{dataChanged:i,propsChanged:n,updateTriggersChanged:r,extensionsChanged:Yd(t,e),transitionsChanged:Xd(t,e)}}function Xd(t,e){if(!t.transitions)return!1;const n={},i=Qd(t);let r=!1;for(const o in t.transitions){const s=i[o],a=s&&s.type;("number"===a||"color"===a||"array"===a)&&Zd(t[o],e[o],s)&&(n[o]=!0,r=!0)}return!!r&&n}function qd(t){let{newProps:e,oldProps:n,ignoreProps:i={},propTypes:r={},triggerName:o="props"}=t;if(n===e)return!1;if("object"!==typeof e||null===e)return"".concat(o," changed shallowly");if("object"!==typeof n||null===n)return"".concat(o," changed shallowly");for(const s of Object.keys(e))if(!(s in i)){if(!(s in n))return"".concat(o,".").concat(s," added");const t=Zd(e[s],n[s],r[s]);if(t)return"".concat(o,".").concat(s," ").concat(t)}for(const s of Object.keys(n))if(!(s in i)){if(!(s in e))return"".concat(o,".").concat(s," dropped");if(!Object.hasOwnProperty.call(e,s)){const t=Zd(e[s],n[s],r[s]);if(t)return"".concat(o,".").concat(s," ").concat(t)}}return!1}function Zd(t,e,n){let i=n&&n.equal;return i&&!i(t,e,n)?"changed deeply":i||(i=t&&e&&t.equals,!i||i.call(t,e))?i||e===t?null:"changed shallowly":"changed deeply"}function Yd(t,e){if(null===e)return!0;const n=e.extensions,{extensions:i}=t;if(i===n)return!1;if(!n||!i)return!0;if(i.length!==n.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(n[r]))return!0;return!1}function Kd(t,e,n){let i=t.updateTriggers[n];i=void 0===i||null===i?{}:i;let r=e.updateTriggers[n];r=void 0===r||null===r?{}:r;return qd({oldProps:r,newProps:i,triggerName:n})}function Qd(t){const e=t[Ud],n=e&&e.constructor;return n?n._propTypes:{}}const $d="count(): argument not an object",Jd="count(): argument not a container";function tf(t){if(!function(t){return null!==t&&"object"===typeof t}(t))throw new Error($d);if("function"===typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"===typeof t&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error(Jd)}function ef(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}function nf(t){let e,n={};return i=>{for(const r in i)if(!ef(i[r],n[r])){e=t(i),n=i;break}return e}}function rf(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some((t=>"project64"===t.name)))){const t=n.modules.findIndex((t=>"project32"===t.name));t>=0&&n.modules.splice(t,1)}if("inject"in e)if(t.inject){const i={...t.inject};for(const t in e.inject)i[t]=(i[t]||"")+e.inject[t];n.inject=i}else n.inject=e.inject;return n}function of(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],m=e[14],v=e[15],y=n*a-i*s,b=n*l-r*s,_=n*c-o*s,w=i*l-r*a,x=i*c-o*a,S=r*c-o*l,P=u*g-h*p,E=u*m-d*p,C=u*v-f*p,T=h*m-d*g,A=h*v-f*g,k=d*v-f*m,M=y*k-b*A+_*T+w*C-x*E+S*P;return M?(M=1/M,t[0]=(a*k-l*A+c*T)*M,t[1]=(r*A-i*k-o*T)*M,t[2]=(g*S-m*x+v*w)*M,t[3]=(d*x-h*S-f*w)*M,t[4]=(l*C-s*k-c*E)*M,t[5]=(n*k-r*C+o*E)*M,t[6]=(m*_-p*S-v*b)*M,t[7]=(u*S-d*_+f*b)*M,t[8]=(s*A-a*C+c*P)*M,t[9]=(i*C-n*A-o*P)*M,t[10]=(p*x-g*_+v*y)*M,t[11]=(h*_-u*x-f*y)*M,t[12]=(a*E-s*T-l*P)*M,t[13]=(n*T-i*E+r*P)*M,t[14]=(g*b-p*w-m*y)*M,t[15]=(u*w-h*b+d*y)*M,t):null}function sf(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],f=e[10],p=e[11],g=e[12],m=e[13],v=e[14],y=e[15],b=n[0],_=n[1],w=n[2],x=n[3];return t[0]=b*i+_*a+w*h+x*g,t[1]=b*r+_*l+w*d+x*m,t[2]=b*o+_*c+w*f+x*v,t[3]=b*s+_*u+w*p+x*y,b=n[4],_=n[5],w=n[6],x=n[7],t[4]=b*i+_*a+w*h+x*g,t[5]=b*r+_*l+w*d+x*m,t[6]=b*o+_*c+w*f+x*v,t[7]=b*s+_*u+w*p+x*y,b=n[8],_=n[9],w=n[10],x=n[11],t[8]=b*i+_*a+w*h+x*g,t[9]=b*r+_*l+w*d+x*m,t[10]=b*o+_*c+w*f+x*v,t[11]=b*s+_*u+w*p+x*y,b=n[12],_=n[13],w=n[14],x=n[15],t[12]=b*i+_*a+w*h+x*g,t[13]=b*r+_*l+w*d+x*m,t[14]=b*o+_*c+w*f+x*v,t[15]=b*s+_*u+w*p+x*y,t}function af(t,e,n){var i,r,o,s,a,l,c,u,h,d,f,p,g=n[0],m=n[1],v=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*v+e[12],t[13]=e[1]*g+e[5]*m+e[9]*v+e[13],t[14]=e[2]*g+e[6]*m+e[10]*v+e[14],t[15]=e[3]*g+e[7]*m+e[11]*v+e[15]):(i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],f=e[10],p=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=d,t[10]=f,t[11]=p,t[12]=i*g+a*m+h*v+e[12],t[13]=r*g+l*m+d*v+e[13],t[14]=o*g+c*m+f*v+e[14],t[15]=s*g+u*m+p*v+e[15]),t}function lf(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function cf(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+c*i,t[5]=s*r+u*i,t[6]=a*r+h*i,t[7]=l*r+d*i,t[8]=c*r-o*i,t[9]=u*r-s*i,t[10]=h*r-a*i,t[11]=d*r-l*i,t}function uf(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+c*i,t[1]=s*r+u*i,t[2]=a*r+h*i,t[3]=l*r+d*i,t[4]=c*r-o*i,t[5]=u*r-s*i,t[6]=h*r-a*i,t[7]=d*r-l*i,t}var hf=function(t,e,n,i,r){var o,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(o=1/(i-r),t[10]=(r+i)*o,t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i),t};var df=function(t,e,n,i,r,o,s){var a=1/(e-n),l=1/(i-r),c=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*l,t[14]=(s+o)*c,t[15]=1,t};function ff(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*s,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*s,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*s,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*s,t}!function(){var t=function(){var t=new bc(4);return bc!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}();const pf=[0,0,0,0],gf=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],mf=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],vf=[0,0,0],yf=[0,0,0],bf=nf((function(t){let{viewport:e,devicePixelRatio:n,coordinateSystem:i,coordinateOrigin:r}=t;const{projectionCenter:o,viewProjectionMatrix:s,originCommon:a,cameraPosCommon:l,shaderCoordinateOrigin:c,geospatialOrigin:u}=function(t,e,n){const{viewMatrixUncentered:i,projectionMatrix:r}=t;let{viewMatrix:o,viewProjectionMatrix:s}=t,a=pf,l=pf,c=t.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:h,offsetMode:d}=_f(t,e,n);d&&(l=t.projectPosition(u||h),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=ff([],l,s),o=i||o,s=sf([],r,o),s=sf([],s,gf));return{viewMatrix:o,viewProjectionMatrix:s,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:u}}(e,i,r),h=e.getDistanceScales(),d=[e.width*n,e.height*n],f=ff([],[0,0,-e.focalDistance,1],e.projectionMatrix)[3]||1,p={project_uCoordinateSystem:i,project_uProjectionMode:e.projectionMode,project_uCoordinateOrigin:c,project_uCommonOrigin:a.slice(0,3),project_uCenter:o,project_uPseudoMeters:Boolean(e._pseudoMeters),project_uViewportSize:d,project_uDevicePixelRatio:n,project_uFocalDistance:f,project_uCommonUnitsPerMeter:h.unitsPerMeter,project_uCommonUnitsPerWorldUnit:h.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:vf,project_uScale:e.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:mf,project_uCameraPosition:l};if(u){const t=e.getDistanceScales(u);switch(i){case Xs.METER_OFFSETS:p.project_uCommonUnitsPerWorldUnit=t.unitsPerMeter,p.project_uCommonUnitsPerWorldUnit2=t.unitsPerMeter2;break;case Xs.LNGLAT:case Xs.LNGLAT_OFFSETS:e._pseudoMeters||(p.project_uCommonUnitsPerMeter=t.unitsPerMeter),p.project_uCommonUnitsPerWorldUnit=t.unitsPerDegree,p.project_uCommonUnitsPerWorldUnit2=t.unitsPerDegree2;break;case Xs.CARTESIAN:p.project_uCommonUnitsPerWorldUnit=[1,1,t.unitsPerMeter[2]],p.project_uCommonUnitsPerWorldUnit2=[0,0,t.unitsPerMeter2[2]]}}return p}));function _f(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yf;n.length<3&&(n=[n[0],n[1],0]);let i,r=n,o=!0;switch(i=e===Xs.LNGLAT_OFFSETS||e===Xs.METER_OFFSETS?n:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case qs.WEB_MERCATOR:e!==Xs.LNGLAT&&e!==Xs.CARTESIAN||(i=[0,0,0],o=!1);break;case qs.WEB_MERCATOR_AUTO_OFFSET:e===Xs.LNGLAT?r=i:e===Xs.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case qs.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case qs.GLOBE:o=!1,i=null;break;default:o=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:o}}class wf extends fc{toString(){let t="[";if(sc.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=pc(n),this}getColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0);const n=t*this.RANK;for(let i=0;i<this.RANK;++i)e[i]=this[n+i];return e}setColumn(t,e){const n=t*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=e[i];return this}}function xf(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Sf(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Pf(t,e,n,i){var r=e[0],o=e[1];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t}var Ef;!function(){var t=function(){var t=new bc(2);return bc!=Float32Array&&(t[0]=0,t[1]=0),t}()}();!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"}(Ef||(Ef={}));const Cf=45*Math.PI/180,Tf=1,Af=.1,kf=500,Mf=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Lf extends wf{static get IDENTITY(){return function(){Rf||(Rf=new Lf,Object.freeze(Rf));return Rf}()}static get ZERO(){return function(){Of||(Of=new Lf([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Of));return Of}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Ef}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,i,r,o,s,a,l,c,u,h,d,f,p,g){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this[4]=r,this[5]=o,this[6]=s,this[7]=a,this[8]=l,this[9]=c,this[10]=u,this[11]=h,this[12]=d,this[13]=f,this[14]=p,this[15]=g,this.check()}setRowMajor(t,e,n,i,r,o,s,a,l,c,u,h,d,f,p,g){return this[0]=t,this[1]=r,this[2]=l,this[3]=d,this[4]=e,this[5]=o,this[6]=c,this[7]=f,this[8]=n,this[9]=s,this[10]=u,this[11]=p,this[12]=i,this[13]=a,this[14]=h,this[15]=g,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(Mf)}fromObject(t){return this.check()}fromQuaternion(t){return function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n+n,a=i+i,l=r+r,c=n*s,u=i*s,h=i*a,d=r*s,f=r*a,p=r*l,g=o*s,m=o*a,v=o*l;t[0]=1-h-p,t[1]=u+v,t[2]=d-m,t[3]=0,t[4]=u-v,t[5]=1-c-p,t[6]=f+g,t[7]=0,t[8]=d+m,t[9]=f-g,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this.check()}frustum(t){const{left:e,right:n,bottom:i,top:r,near:o=Af,far:s=kf}=t;return s===1/0?function(t,e,n,i,r,o){const s=2*o/(n-e),a=2*o/(r-i),l=(n+e)/(n-e),c=(r+i)/(r-i),u=-1,h=-1,d=-2*o;t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=c,t[10]=u,t[11]=h,t[12]=0,t[13]=0,t[14]=d,t[15]=0}(this,e,n,i,r,o):function(t,e,n,i,r,o,s){var a=1/(n-e),l=1/(r-i),c=1/(o-s);t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*l,t[10]=(s+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*c,t[15]=0}(this,e,n,i,r,o,s),this.check()}lookAt(t){const{eye:e,center:n=[0,0,0],up:i=[0,1,0]}=t;return function(t,e,n,i){var r,o,s,a,l,c,u,h,d,f,p=e[0],g=e[1],m=e[2],v=i[0],y=i[1],b=i[2],_=n[0],w=n[1],x=n[2];Math.abs(p-_)<yc&&Math.abs(g-w)<yc&&Math.abs(m-x)<yc?function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(t):(u=p-_,h=g-w,d=m-x,r=y*(d*=f=1/Math.hypot(u,h,d))-b*(h*=f),o=b*(u*=f)-v*d,s=v*h-y*u,(f=Math.hypot(r,o,s))?(r*=f=1/f,o*=f,s*=f):(r=0,o=0,s=0),a=h*s-d*o,l=d*r-u*s,c=u*o-h*r,(f=Math.hypot(a,l,c))?(a*=f=1/f,l*=f,c*=f):(a=0,l=0,c=0),t[0]=r,t[1]=a,t[2]=u,t[3]=0,t[4]=o,t[5]=l,t[6]=h,t[7]=0,t[8]=s,t[9]=c,t[10]=d,t[11]=0,t[12]=-(r*p+o*g+s*m),t[13]=-(a*p+l*g+c*m),t[14]=-(u*p+h*g+d*m),t[15]=1)}(this,e,n,i),this.check()}ortho(t){const{left:e,right:n,bottom:i,top:r,near:o=Af,far:s=kf}=t;return df(this,e,n,i,r,o,s),this.check()}orthographic(t){const{fovy:e=Cf,aspect:n=Tf,focalDistance:i=1,near:r=Af,far:o=kf}=t;If(e);const s=e/2,a=i*Math.tan(s),l=a*n;return this.ortho({left:-l,right:l,bottom:-a,top:a,near:r,far:o})}perspective(t){const{fovy:e=45*Math.PI/180,aspect:n=1,near:i=.1,far:r=500}=t;return If(e),hf(this,e,n,i,r),this.check()}determinant(){return function(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],f=t[12],p=t[13],g=t[14],m=t[15];return(e*s-n*o)*(h*m-d*g)-(e*a-i*o)*(u*m-d*p)+(e*l-r*o)*(u*g-h*p)+(n*a-i*s)*(c*m-d*f)-(n*l-r*s)*(c*g-h*f)+(i*l-r*a)*(c*p-u*f)}(this)}getScale(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],r=1/n[1],o=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*r,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*r,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],r=1/n[1],o=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*o,t[3]=this[4]*i,t[4]=this[5]*r,t[5]=this[6]*o,t[6]=this[8]*i,t[7]=this[9]*r,t[8]=this[10]*o,t}transpose(){return function(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=r,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(this,this),this.check()}invert(){return of(this,this),this.check()}multiplyLeft(t){return sf(this,t,this),this.check()}multiplyRight(t){return sf(this,this,t),this.check()}rotateX(t){return cf(this,this,t),this.check()}rotateY(t){return function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],d=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-c*i,t[1]=s*r-u*i,t[2]=a*r-h*i,t[3]=l*r-d*i,t[8]=o*i+c*r,t[9]=s*i+u*r,t[10]=a*i+h*r,t[11]=l*i+d*r}(this,this,t),this.check()}rotateZ(t){return uf(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,e){return function(t,e,n,i){var r,o,s,a,l,c,u,h,d,f,p,g,m,v,y,b,_,w,x,S,P,E,C,T,A=i[0],k=i[1],M=i[2],L=Math.hypot(A,k,M);L<yc||(A*=L=1/L,k*=L,M*=L,r=Math.sin(n),s=1-(o=Math.cos(n)),a=e[0],l=e[1],c=e[2],u=e[3],h=e[4],d=e[5],f=e[6],p=e[7],g=e[8],m=e[9],v=e[10],y=e[11],b=A*A*s+o,_=k*A*s+M*r,w=M*A*s-k*r,x=A*k*s-M*r,S=k*k*s+o,P=M*k*s+A*r,E=A*M*s+k*r,C=k*M*s-A*r,T=M*M*s+o,t[0]=a*b+h*_+g*w,t[1]=l*b+d*_+m*w,t[2]=c*b+f*_+v*w,t[3]=u*b+p*_+y*w,t[4]=a*x+h*S+g*P,t[5]=l*x+d*S+m*P,t[6]=c*x+f*S+v*P,t[7]=u*x+p*S+y*P,t[8]=a*E+h*C+g*T,t[9]=l*E+d*C+m*T,t[10]=c*E+f*C+v*T,t[11]=u*E+p*C+y*T,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,this,t,e),this.check()}scale(t){return lf(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return af(this,this,t),this.check()}transform(t,e){return 4===t.length?(gc(e=ff(e||[-0,-0,-0,-0],t,this),4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;let i;switch(n){case 2:i=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}(e||[-0,-0],t,this);break;case 3:i=_c(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return gc(i,t.length),i}transformAsVector(t,e){let n;switch(t.length){case 2:n=function(t,e,n){const i=e[0],r=e[1],o=n[3]*i+n[7]*r||1;return t[0]=(n[0]*i+n[4]*r)/o,t[1]=(n[1]*i+n[5]*r)/o,t}(e||[-0,-0],t,this);break;case 3:n=xc(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return gc(n,t.length),n}transformPoint(t,e){return this.transformAsPoint(t,e)}transformVector(t,e){return this.transformAsPoint(t,e)}transformDirection(t,e){return this.transformAsVector(t,e)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}}let Of,Rf;function If(t){if(t>2*Math.PI)throw Error("expected radians")}function jf(t,e){const n=ff([],e,t);var i,r,o;return i=n,r=n,o=1/n[3],i[0]=r[0]*o,i[1]=r[1]*o,i[2]=r[2]*o,i[3]=r[3]*o,n}function Ff(t,e){const n=t%e;return n<0?e+n:n}function zf(t,e,n){return t<e?e:t>n?n:t}const Nf=Math.log2||function(t){return Math.log(t)*Math.LOG2E};function Df(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Bf=Math.PI,Uf=Bf/4,Vf=Bf/180,Wf=180/Bf,Hf=512,Gf=4003e4,Xf=85.051129,qf=1.5;function Zf(t){const[e,n]=t;Df(Number.isFinite(e)),Df(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const i=n*Vf;return[Hf*(e*Vf+Bf)/(2*Bf),Hf*(Bf+Math.log(Math.tan(Uf+.5*i)))/(2*Bf)]}function Yf(t){const[e,n]=t,i=e/Hf*(2*Bf)-Bf,r=2*(Math.atan(Math.exp(n/Hf*(2*Bf)-Bf))-Uf);return[i*Wf,r*Wf]}function Kf(t){const{latitude:e}=t;Df(Number.isFinite(e));const n=Math.cos(e*Vf);return function(t){return Nf(t)}(Gf*n)-9}function Qf(t){const{latitude:e,longitude:n,highPrecision:i=!1}=t;Df(Number.isFinite(e)&&Number.isFinite(n));const r=Hf,o=Math.cos(e*Vf),s=r/360,a=s/o,l=r/Gf/o,c={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[s,a,l],degreesPerUnit:[1/s,1/a,1/l]};if(i){const t=Vf*Math.tan(e*Vf)/o,n=s*t/2,i=r/Gf*t,u=i/a*l;c.unitsPerDegree2=[0,n,i],c.unitsPerMeter2=[u,0,u]}return c}function $f(t,e){const[n,i,r]=t,[o,s,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=Qf({longitude:n,latitude:i,highPrecision:!0}),u=Zf(t);u[0]+=o*(l[0]+c[0]*s),u[1]+=s*(l[1]+c[1]*s);const h=Yf(u),d=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[h[0],h[1],d]:h}function Jf(t){const{width:e,height:n,altitude:i,pitch:r=0,offset:o,center:s,scale:a,nearZMultiplier:l=1,farZMultiplier:c=1}=t;let{fovy:u=tp(qf)}=t;void 0!==i&&(u=tp(i));const h=u*Vf,d=r*Vf,f=ep(u);let p=f;s&&(p+=s[2]*a/Math.cos(d)/n);const g=h*(.5+(o?o[1]:0)/n),m=Math.sin(g)*p/Math.sin(zf(Math.PI/2-d-g,.01,Math.PI-.01)),v=Math.sin(d)*m+p,y=10*p;return{fov:h,aspect:e/n,focalDistance:f,near:l,far:Math.min(v*c,y)}}function tp(t){return 2*Math.atan(.5/t)*Wf}function ep(t){return.5/Math.tan(.5*t*Vf)}function np(t,e){const[n,i,r=0]=t;return Df(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(r)),jf(e,[n,i,r,1])}function ip(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const[i,r,o]=t;if(Df(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(o)){return jf(e,[i,r,o,1])}const s=jf(e,[i,r,0,1]),a=jf(e,[i,r,1,1]),l=s[2],c=a[2];return Pf([],s,a,l===c?0:((n||0)-l)/(c-l))}function rp(t){const{width:e,height:n,bounds:i,minExtent:r=0,maxZoom:o=24,offset:s=[0,0]}=t,[[a,l],[c,u]]=i,h=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if("number"===typeof t)return{top:t,bottom:t,left:t,right:t};return Df(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t}(t.padding),d=Zf([a,zf(u,-Xf,Xf)]),f=Zf([c,zf(l,-Xf,Xf)]),p=[Math.max(Math.abs(f[0]-d[0]),r),Math.max(Math.abs(f[1]-d[1]),r)],g=[e-h.left-h.right-2*Math.abs(s[0]),n-h.top-h.bottom-2*Math.abs(s[1])];Df(g[0]>0&&g[1]>0);const m=g[0]/p[0],v=g[1]/p[1],y=(h.right-h.left)/2/m,b=(h.top-h.bottom)/2/v,_=Yf([(f[0]+d[0])/2+y,(f[1]+d[1])/2+b]),w=Math.min(o,Nf(Math.abs(Math.min(m,v))));return Df(Number.isFinite(w)),{longitude:_[0],latitude:_[1],zoom:w}}const op=Math.PI/180;function sp(t,e,n){const{pixelUnprojectionMatrix:i}=t,r=jf(i,[e,0,1,1]),o=jf(i,[e,t.height,1,1]),s=Yf(Pf([],r,o,(n*t.distanceScales.unitsPerMeter[2]-r[2])/(o[2]-r[2])));return s.push(n),s}const ap=512;const lp=Math.PI/180,cp=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],up=[0,0,0],hp={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class dp{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ss(this,"id",void 0),Ss(this,"x",void 0),Ss(this,"y",void 0),Ss(this,"width",void 0),Ss(this,"height",void 0),Ss(this,"isGeospatial",void 0),Ss(this,"zoom",void 0),Ss(this,"focalDistance",void 0),Ss(this,"position",void 0),Ss(this,"modelMatrix",void 0),Ss(this,"distanceScales",void 0),Ss(this,"scale",void 0),Ss(this,"center",void 0),Ss(this,"cameraPosition",void 0),Ss(this,"projectionMatrix",void 0),Ss(this,"viewMatrix",void 0),Ss(this,"viewMatrixUncentered",void 0),Ss(this,"viewMatrixInverse",void 0),Ss(this,"viewProjectionMatrix",void 0),Ss(this,"pixelProjectionMatrix",void 0),Ss(this,"pixelUnprojectionMatrix",void 0),Ss(this,"resolution",void 0),Ss(this,"_frustumPlanes",{}),this.id=t.id||this.constructor.displayName||"viewport",this.x=t.x||0,this.y=t.y||0,this.width=t.width||1,this.height=t.height||1,this.zoom=t.zoom||0,this.distanceScales=t.distanceScales||hp,this.focalDistance=t.focalDistance||1,this.position=t.position||up,this.modelMatrix=t.modelMatrix||null;const{longitude:e,latitude:n}=t;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(e),this._initProps(t),this._initMatrices(t),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?qs.WEB_MERCATOR:qs.WEB_MERCATOR_AUTO_OFFSET:qs.IDENTITY}equals(t){return t instanceof dp&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&hc(t.projectionMatrix,this.projectionMatrix)&&hc(t.viewMatrix,this.viewMatrix))}project(t){let{topLeft:e=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=np(this.projectPosition(t),this.pixelProjectionMatrix),[i,r]=n,o=e?r:this.height-r;return 2===t.length?[i,o]:[i,o,n[2]]}unproject(t){let{topLeft:e=!0,targetZ:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[i,r,o]=t,s=e?r:this.height-r,a=n&&n*this.distanceScales.unitsPerMeter[2],l=ip([i,s,o],this.pixelUnprojectionMatrix,a),[c,u,h]=this.unprojectPosition(l);return Number.isFinite(o)?[c,u,h]:Number.isFinite(n)?[c,u,n]:[c,u]}projectPosition(t){const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){if(this.isGeospatial){const e=Zf(t);return e[1]=cc(e[1],-318,830),e}return t}unprojectFlat(t){return this.isGeospatial?Yf(t):t}getBounds(){const t={targetZ:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0},e=this.unproject([0,0],t),n=this.unproject([this.width,0],t),i=this.unproject([0,this.height],t),r=this.unproject([this.width,this.height],t);return[Math.min(e[0],n[0],i[0],r[0]),Math.min(e[1],n[1],i[1],r[1]),Math.max(e[0],n[0],i[0],r[0]),Math.max(e[1],n[1],i[1],r[1])]}getDistanceScales(t){return t?Qf({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel(t){let{x:e,y:n,width:i=1,height:r=1}=t;return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+r}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,{left:Tc((t=this.viewProjectionMatrix)[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Tc(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Tc(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Tc(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Tc(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Tc(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}),this._frustumPlanes;var t}panByPosition(t,e){return null}_initProps(t){const e=t.longitude,n=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=Kf({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||Qf({latitude:n,longitude:e}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:r,modelMatrix:o}=t;let s=up;if(r&&(s=o?new Lf(o).transformAsVector(r,[]):r),this.isGeospatial){const t=this.projectPosition([e,n,0]);this.center=new Ec(s).scale(this.distanceScales.unitsPerMeter).add(t)}else this.center=this.projectPosition(s)}_initMatrices(t){const{viewMatrix:e=cp,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:r,fovy:o=75,near:s=.1,far:a=1e3,padding:l=null,focalDistance:c=1}=t;this.viewMatrixUncentered=e,this.viewMatrix=(new Lf).multiplyRight(e).translate(new Ec(this.center).negate()),this.projectionMatrix=n||function(t){let{width:e,height:n,orthographic:i,fovyRadians:r,focalDistance:o,padding:s,near:a,far:l}=t;const c=e/n,u=i?(new Lf).orthographic({fovy:r,aspect:c,focalDistance:o,near:a,far:l}):(new Lf).perspective({fovy:r,aspect:c,near:a,far:l});if(s){const{left:t=0,right:i=0,top:r=0,bottom:o=0}=s,a=cc((t+e-i)/2,0,e)-e/2,l=cc((r+n-o)/2,0,n)-n/2;u[8]-=2*a/e,u[9]+=2*l/n}return u}({width:this.width,height:this.height,orthographic:i,fovyRadians:r||o*lp,focalDistance:c,padding:l,near:s,far:a});const u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var h;sf(u,u,this.projectionMatrix),sf(u,u,this.viewMatrix),this.viewProjectionMatrix=u,this.viewMatrixInverse=of([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=[(h=this.viewMatrixInverse)[12],h[13],h[14]];const d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];lf(d,d,[this.width/2,-this.height/2,1]),af(d,d,[1,-1,0]),sf(f,d,this.viewProjectionMatrix),this.pixelProjectionMatrix=f,this.pixelUnprojectionMatrix=of([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Gs.warn("Pixel project matrix not invertible")()}}Ss(dp,"displayName","Viewport");const fp=512,pp=4003e4,gp=Math.PI/180;function mp(t){const e=Math.cos(t*gp);return fp/pp/e}class vp extends dp{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{latitude:e=0,longitude:n=0,zoom:i=0,pitch:r=0,bearing:o=0,nearZMultiplier:s=.1,farZMultiplier:a=1.01,orthographic:l=!1,projectionMatrix:c,repeat:u=!1,worldOffset:h=0,legacyMeterSizes:d=!1}=t;let{width:f,height:p,altitude:g=1.5}=t;const m=Math.pow(2,i);let v;f=f||1,p=p||1;let y=null;c?(g=c[5]/2,v=tp(g)):(t.fovy?(v=t.fovy,g=ep(v)):v=tp(g),y=Jf({width:f,height:p,pitch:r,fovy:v,nearZMultiplier:s,farZMultiplier:a}));let b=function(t){const{height:e,pitch:n,bearing:i,altitude:r,scale:o,center:s}=t,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];af(a,a,[0,0,-r]),cf(a,a,-n*Vf),uf(a,a,i*Vf);const l=o/e;var c,u;return lf(a,a,[l,l,l]),s&&af(a,a,((c=[])[0]=-(u=s)[0],c[1]=-u[1],c[2]=-u[2],c)),a}({height:p,pitch:r,bearing:o,scale:m,altitude:g});if(h){b=(new Lf).translate([512*h,0,0]).multiplyLeft(b)}super({...t,width:f,height:p,viewMatrix:b,longitude:n,latitude:e,zoom:i,...y,fovy:v,focalDistance:g}),Ss(this,"longitude",void 0),Ss(this,"latitude",void 0),Ss(this,"pitch",void 0),Ss(this,"bearing",void 0),Ss(this,"altitude",void 0),Ss(this,"fovy",void 0),Ss(this,"orthographic",void 0),Ss(this,"_subViewports",void 0),Ss(this,"_pseudoMeters",void 0),this.latitude=e,this.longitude=n,this.zoom=i,this.pitch=r,this.bearing=o,this.altitude=g,this.fovy=v,this.orthographic=l,this._subViewports=u?[]:null,this._pseudoMeters=d,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let i=e;i<=n;i++){const t=i?new vp({...this,worldOffset:i}):this;this._subViewports.push(t)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*mp(t[1])]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)/mp(n)]}addMetersToLngLat(t,e){return $f(t,e)}panByPosition(t,e){const n=ip(e,this.pixelUnprojectionMatrix),i=xf([],this.projectFlat(t),Sf([],n)),r=xf([],this.center,i),[o,s]=this.unprojectFlat(r);return{longitude:o,latitude:s}}getBounds(){const t=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{width:n,height:i,unproject:r}=t,o={targetZ:e},s=r([0,i],o),a=r([n,i],o);let l,c;return(t.fovy?.5*t.fovy*op:Math.atan(.5/t.altitude))>(90-t.pitch)*op-.01?(l=sp(t,0,e),c=sp(t,n,e)):(l=r([0,0],o),c=r([n,0],o)),[s,a,c,l]}(this,(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0);return[Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),Math.min(t[0][1],t[1][1],t[2][1],t[3][1]),Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),Math.max(t[0][1],t[1][1],t[2][1],t[3][1])]}fitBounds(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{width:n,height:i}=this,{longitude:r,latitude:o,zoom:s}=rp({width:n,height:i,bounds:t,...e});return new vp({width:n,height:i,longitude:r,latitude:o,zoom:s})}}function yp(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=e.projectPosition(t);if(n&&e instanceof vp){const[n,r,o=0]=t,s=e.getDistanceScales([n,r]);i[2]=o*s.unitsPerMeter[2]}return i}function bp(t,e){let{viewport:n,modelMatrix:i,coordinateSystem:r,coordinateOrigin:o,offsetMode:s}=e,[a,l,c=0]=t;switch(i&&([a,l,c]=ff([],[a,l,c,1],i)),r){case Xs.LNGLAT:return yp([a,l,c],n,s);case Xs.LNGLAT_OFFSETS:return yp([a+o[0],l+o[1],c+(o[2]||0)],n,s);case Xs.METER_OFFSETS:return yp($f(o,[a,l,c]),n,s);case Xs.CARTESIAN:default:return n.isGeospatial?[a+o[0],l+o[1],c+o[2]]:n.projectPosition([a,l,c])}}function _p(t,e){const{viewport:n,coordinateSystem:i,coordinateOrigin:r,modelMatrix:o,fromCoordinateSystem:s,fromCoordinateOrigin:a}=function(t){const{viewport:e,modelMatrix:n,coordinateOrigin:i}=t;let{coordinateSystem:r,fromCoordinateSystem:o,fromCoordinateOrigin:s}=t;return r===Xs.DEFAULT&&(r=e.isGeospatial?Xs.LNGLAT:Xs.CARTESIAN),void 0===o&&(o=r),void 0===s&&(s=i),{viewport:e,coordinateSystem:r,coordinateOrigin:i,modelMatrix:n,fromCoordinateSystem:o,fromCoordinateOrigin:s}}(e),{geospatialOrigin:l,shaderCoordinateOrigin:c,offsetMode:u}=_f(n,i,r),h=bp(t,{viewport:n,modelMatrix:o,coordinateSystem:s,coordinateOrigin:a,offsetMode:u});if(u){const t=n.projectPosition(l||c);wc(h,h,t)}return h}Ss(vp,"displayName","WebMercatorViewport");const wp={10241:9987,10240:9729,10242:33071,10243:33071},xp={};function Sp(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const n in t){const i=t[n],r=e[n];if(!(i===r||Array.isArray(i)&&Array.isArray(r)&&Sp(i,r)))return!1}return!0}const Pp={boolean:{validate:(t,e)=>!0,equal:(t,e,n)=>Boolean(t)===Boolean(e)},number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},color:{validate:(t,e)=>e.optional&&!t||Ap(t)&&(3===t.length||4===t.length),equal:(t,e,n)=>Ep(t,e)},accessor:{validate(t,e){const n=kp(t);return"function"===n||n===kp(e.value)},equal:(t,e,n)=>"function"===typeof e||Ep(t,e)},array:{validate:(t,e)=>e.optional&&!t||Ap(t),equal:(t,e,n)=>n.compare?Ep(t,e):t===e},object:{equal:(t,e,n)=>n.compare?Sp(t,e):t===e},function:{validate:(t,e)=>e.optional&&!t||"function"===typeof t,equal:(t,e,n)=>!n.compare||t===e},data:{transform:(t,e,n)=>{const{dataTransform:i}=n.props;return i&&t?i(t):t}},image:{transform:(t,e,n)=>function(t,e){const n=t.context&&t.context.gl;if(!n||!e)return null;if(e instanceof kl)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const r=new kl(n,{...e,parameters:{...wp,...i,...t.props.textureParameters}});return xp[r.id]=!0,r}(n,t),release:t=>{var e;(e=t)&&e instanceof kl&&xp[e.id]&&(e.delete(),delete xp[e.id])}}};function Ep(t,e){if(t===e)return!0;if(!Ap(t)||!Ap(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function Cp(t,e){switch(kp(e)){case"object":return Tp(t,e);case"array":return Tp(t,{type:"array",value:e,compare:!1});case"boolean":return Tp(t,{type:"boolean",value:e});case"number":return Tp(t,{type:"number",value:e});case"function":return Tp(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Tp(t,e){return"type"in e?{name:t,...Pp[e.type],...e}:"value"in e?{name:t,type:kp(e.value),...e}:{name:t,type:"object",value:e}}function Ap(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function kp(t){return Ap(t)?"array":null===t?"null":typeof t}function Mp(t){const e=Rp(t,"_mergedDefaultProps");return e||(function(t){const e=t.prototype;if(!e)return;const n=Object.getPrototypeOf(t),i=Mp(n),r=Rp(t,"defaultProps")||{},o=function(t){const e={},n={},i={};for(const[r,o]of Object.entries(t)){const t=null===o||void 0===o?void 0:o.deprecatedFor;if(t)i[r]=Array.isArray(t)?t:[t];else{const t=Cp(r,o);e[r]=t,n[r]=t.value}}return{propTypes:e,defaultProps:n,deprecatedProps:i}}(r),s=function(t,e,n){const i=Object.create(null);Object.assign(i,e,t);const r=function(t){const e=Rp(t,"layerName")||Rp(t,"componentName");e||Gs.once(0,"".concat(t.name,".componentName not specified"))();return e||t.name}(n);return delete t.id,Object.defineProperties(i,{id:{writable:!0,value:r}}),i}(o.defaultProps,i,t),a={...n._propTypes,...o.propTypes};!function(t,e){const n={},i={};for(const r in e){const t=e[r],{name:o,value:s}=t;t.async&&(n[o]=s,i[o]=Lp(o))}t[Vd]=n,t[Wd]={},Object.defineProperties(t,i)}(s,a);const l={...n._deprecatedProps,...o.deprecatedProps};(function(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(t){const i="".concat(this.id,": ").concat(n);for(const r of e[n])Op(this,r)||(this[r]=t);Gs.deprecated(i,e[n].join("/"))()}})})(s,l),t._mergedDefaultProps=s,t._propTypes=a,t._deprecatedProps=l}(t),t._mergedDefaultProps)}function Lp(t){return{enumerable:!0,set(e){"string"===typeof e||e instanceof Promise||zc(e)?this[Wd][t]=e:this[Hd][t]=e},get(){if(this[Hd]){if(t in this[Hd]){return this[Hd][t]||this[Vd][t]}if(t in this[Wd]){const e=this[Ud]&&this[Ud].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Vd][t]}}return this[Vd][t]}}}function Op(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Rp(t,e){return Op(t,e)&&t[e]}let Ip=0;class jp{constructor(){Ss(this,"id",void 0),Ss(this,"props",void 0),Ss(this,"count",void 0);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.props=function(t,e){const n=Mp(t.constructor),i=Object.create(n);i[Ud]=t,i[Wd]={},i[Hd]={};for(let r=0;r<e.length;++r){const t=e[r];for(const e in t)i[e]=t[e]}return Object.freeze(i),i}(this,e),this.id=this.props.id,this.count=Ip++}clone(t){const{props:e}=this,n={};for(const i in e[Vd])i in e[Hd]?n[i]=e[Hd][i]:i in e[Wd]&&(n[i]=e[Wd][i]);return new this.constructor({...e,...n,...t})}}Ss(jp,"componentName","Component"),Ss(jp,"defaultProps",{});const Fp=Object.freeze({});class zp{constructor(t){Ss(this,"component",void 0),Ss(this,"onAsyncPropUpdated",void 0),Ss(this,"asyncProps",void 0),Ss(this,"oldProps",void 0),Ss(this,"oldAsyncProps",void 0),this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e&&e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps||Fp}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const e in this.asyncProps)if(this.isAsyncPropLoading(e))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){const e=t[Hd]||{},n=t[Wd]||t,i=t[Vd]||{};for(const r in e){const t=e[r];this._createAsyncPropData(r,i[r]),this._updateAsyncProp(r,t),e[r]=this.getAsyncProp(r)}for(const r in n){const t=n[r];this._createAsyncPropData(r,i[r]),this._updateAsyncProp(r,t)}}_fetch(t,e){return null}_onResolve(t,e){}_onError(t,e){}_updateAsyncProp(t,e){this._didAsyncInputValueChange(t,e)&&("string"===typeof e&&(e=this._fetch(t,e)),e instanceof Promise?this._watchPromise(t,e):zc(e)?this._resolveAsyncIterable(t,e):this._setPropValue(t,e))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e!==n.resolvedValue&&e!==n.lastValue&&(n.lastValue=e,!0)}_setPropValue(t,e){this._freezeAsyncOldProps();const n=this.asyncProps[t];n&&(e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(t,e,n){const i=this.asyncProps[t];i&&n>=i.resolvedLoadCount&&void 0!==e&&(this._freezeAsyncOldProps(),i.resolvedValue=e,i.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;e.then((e=>{e=this._postProcessValue(n,e),this._setAsyncPropValue(t,e,i),this._onResolve(t,e)})).catch((e=>{this._onError(t,e)}))}}async _resolveAsyncIterable(t,e){if("data"!==t)return void this._setPropValue(t,e);const n=this.asyncProps[t];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let r=[],o=0;for await(const s of e){const{dataTransform:e}=this.component.props;r=e?e(s,r):r.concat(s),Object.defineProperty(r,"__diff",{enumerable:!1,value:[{startRow:o,endRow:r.length}]}),o=r.length,this._setAsyncPropValue(t,r,i)}this._onResolve(t,r)}_postProcessValue(t,e){const n=t.type;return n&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const n=this.component&&this.component.constructor._propTypes;this.asyncProps[t]={type:n&&n[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}class Np extends zp{constructor(t){let{attributeManager:e,layer:n}=t;super(n),Ss(this,"attributeManager",void 0),Ss(this,"needsRedraw",void 0),Ss(this,"needsUpdate",void 0),Ss(this,"subLayers",void 0),Ss(this,"usesPickingColorCache",void 0),Ss(this,"changeFlags",void 0),Ss(this,"viewport",void 0),Ss(this,"uniformTransitions",void 0),Ss(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(t){this.component=t}_fetch(t,e){const n=this.component.props.fetch;return n?n(e,{propName:t,layer:this.layer}):super._fetch(t,e)}_onResolve(t,e){const n=this.component.props.onDataLoad;"data"===t&&n&&n(e,{propName:t,layer:this.layer})}_onError(t,e){this.layer.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}}const Dp=t=>"boolean"===typeof t,Bp=t=>"function"===typeof t,Up=t=>null!==t&&"object"===typeof t,Vp=t=>Up(t)&&t.constructor==={}.constructor,Wp=t=>t&&"function"===typeof t[Symbol.iterator],Hp=t=>t&&"function"===typeof t[Symbol.asyncIterator],Gp=t=>"undefined"!==typeof Response&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Xp=t=>"undefined"!==typeof Blob&&t instanceof Blob,qp=t=>t&&"object"===typeof t&&t.isBuffer,Zp=t=>(t=>"undefined"!==typeof ReadableStream&&t instanceof ReadableStream||Up(t)&&Bp(t.tee)&&Bp(t.cancel)&&Bp(t.getReader))(t)||(t=>Up(t)&&Bp(t.read)&&Bp(t.pipe)&&Dp(t.readable))(t);function Yp(t,e){if(!t)throw new Error(e||"loader assertion failed.")}function Kp(t){var e;if(!t)return!1;Array.isArray(t)&&(t=t[0]);return Array.isArray(null===(e=t)||void 0===e?void 0:e.extensions)}function Qp(t){var e,n;let i;return Yp(t,"null loader"),Yp(Kp(t),"invalid loader"),Array.isArray(t)&&(i=t[1],t=t[0],t={...t,options:{...t.options,...i}}),(null!==(e=t)&&void 0!==e&&e.parseTextSync||null!==(n=t)&&void 0!==n&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}let $p="";const Jp={};const tg=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,eg=/^([-\w.]+\/[-\w.+]+)/;function ng(t){const e=tg.exec(t);return e?e[1]:""}const ig=/\?.*/;function rg(t){return t.replace(ig,"")}function og(t){if(Gp(t)){return t.url}if(Xp(t)){return t.name||""}return"string"===typeof t?t:""}function sg(t){if(Gp(t)){const e=t,n=e.headers.get("content-type")||"",i=rg(e.url);return function(t){const e=eg.exec(t);return e?e[1]:t}(n)||ng(i)}if(Xp(t)){return t.type||""}return"string"===typeof t?ng(t):""}async function ag(t){if(Gp(t))return t;const e={},n=function(t){if(Gp(t))return t.headers["content-length"]||-1;if(Xp(t))return t.size;return"string"===typeof t?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}(t);n>=0&&(e["content-length"]=String(n));const i=og(t),r=sg(t);r&&(e["content-type"]=r);const o=await async function(t){const e=5;if("string"===typeof t)return"data:,".concat(t.slice(0,e));if(t instanceof Blob){const e=t.slice(0,5);return await new Promise((t=>{const n=new FileReader;n.onload=e=>{var n;return t(null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.result)},n.readAsDataURL(e)}))}if(t instanceof ArrayBuffer){const n=function(t){let e="";const n=new Uint8Array(t);for(let i=0;i<n.byteLength;i++)e+=String.fromCharCode(n[i]);return btoa(e)}(t.slice(0,e));return"data:base64,".concat(n)}return null}(t);o&&(e["x-first-bytes"]=o),"string"===typeof t&&(t=(new TextEncoder).encode(t));const s=new Response(t,{headers:e});return Object.defineProperty(s,"url",{value:i}),s}async function lg(t,e){if("string"===typeof t){t=function(t){for(const e in Jp)if(t.startsWith(e)){const n=Jp[e];t=t.replace(e,n)}return t.startsWith("http://")||t.startsWith("https://")||(t="".concat($p).concat(t)),t}(t);let n=e;return null!==e&&void 0!==e&&e.fetch&&"function"!==typeof(null===e||void 0===e?void 0:e.fetch)&&(n=e.fetch),await fetch(t,n)}return await ag(t)}const cg=new Us({id:"loaders.gl"});class ug{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof n.g&&n.g,"undefined"!==typeof document&&document;const hg=Boolean("object"!==typeof process||"[object process]"!==String(process)||process.browser),dg="undefined"!==typeof process&&process.version&&/v([0-9]*)/.exec(process.version),fg=(dg&&parseFloat(dg[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){Ss(this,"console",void 0),this.console=console}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.log.bind(this.console,...e)}info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.info.bind(this.console,...e)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.warn.bind(this.console,...e)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:hg,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),pg={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function gg(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const mg=()=>{const t=gg();return t.globalOptions=t.globalOptions||{...fg},t.globalOptions};function vg(t,e,n,i){return n=n||[],function(t,e){yg(t,null,fg,pg,e);for(const n of e){const i=t&&t[n.id]||{},r=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};yg(i,n.id,r,o,e)}}(t,n=Array.isArray(n)?n:[n]),_g(e,t,i)}function yg(t,e,n,i,r){const o=e||"Top level",s=e?"".concat(e,"."):"";for(const a in t){const l=!e&&Up(t[a]);if(!(a in n)&&!("baseUri"===a&&!e)&&!("workerUrl"===a&&e))if(a in i)cg.warn("".concat(o," loader option '").concat(s).concat(a,"' no longer supported, use '").concat(i[a],"'"))();else if(!l){const t=bg(a,r);cg.warn("".concat(o," loader option '").concat(s).concat(a,"' not recognized. ").concat(t))()}}}function bg(t,e){const n=t.toLowerCase();let i="";for(const r of e)for(const e in r.options){if(t===e)return"Did you mean '".concat(r.id,".").concat(e,"'?");const o=e.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(i=i||"Did you mean '".concat(r.id,".").concat(e,"'?"))}return i}function _g(t,e,n){const i={...t.options||{}};return function(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}(i,n),null===i.log&&(i.log=new ug),wg(i,mg()),wg(i,e),i}function wg(t,e){for(const n in e)if(n in e){const i=e[n];Vp(i)&&Vp(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function xg(t,e){const n=mg(),i=t||n;return"function"===typeof i.fetch?i.fetch:Up(i.fetch)?t=>lg(t,i):null!==e&&void 0!==e&&e.fetch?null===e||void 0===e?void 0:e.fetch:lg}function Sg(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Pg="3.4.15";"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof n.g&&n.g,"undefined"!==typeof document&&document;const Eg="object"!==typeof process||"[object process]"!==String(process)||process.browser,Cg="undefined"!==typeof window&&"undefined"!==typeof window.orientation,Tg="undefined"!==typeof process&&process.version&&/v([0-9]*)/.exec(process.version);Tg&&parseFloat(Tg[1]);class Ag{terminate(){}}const kg=new Map;function Mg(t){Sg(t.source&&!t.url||!t.source&&t.url);let e=kg.get(t.source||t.url);return e||(t.url&&(e=function(t){if(!t.startsWith("http"))return t;return Lg((e=t,"try {\n  importScripts('".concat(e,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")));var e}(t.url),kg.set(t.url,e)),t.source&&(e=Lg(t.source),kg.set(t.source,e))),Sg(e),e}function Lg(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Og(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;const i=n||new Set;if(t){if(Rg(t))i.add(t);else if(Rg(t.buffer))i.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"===typeof t)for(const r in t)Og(t[r],e,i)}else;return void 0===n?Array.from(i):[]}function Rg(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!==typeof MessagePort&&t instanceof MessagePort||("undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!==typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}const Ig=()=>{};class jg{static isSupported(){return"undefined"!==typeof Worker&&Eg||"undefined"!==typeof Ag&&!Eg}constructor(t){Ss(this,"name",void 0),Ss(this,"source",void 0),Ss(this,"url",void 0),Ss(this,"terminated",!1),Ss(this,"worker",void 0),Ss(this,"onMessage",void 0),Ss(this,"onError",void 0),Ss(this,"_loadableURL","");const{name:e,source:n,url:i}=t;Sg(n||i),this.name=e,this.source=n,this.url=i,this.onMessage=Ig,this.onError=t=>console.log(t),this.worker=Eg?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Ig,this.onError=Ig,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(t,e){e=e||Og(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+="worker ".concat(this.name," from ").concat(this.url,". "),t.message&&(e+="".concat(t.message," in ")),t.lineno&&(e+=":".concat(t.lineno,":").concat(t.colno)),new Error(e)}_createBrowserWorker(){this._loadableURL=Mg({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},t.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},t.onmessageerror=t=>console.error(t),t}_createNodeWorker(){let t;if(this.url){const e=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);t=new Ag(e,{eval:!1})}else{if(!this.source)throw new Error("no worker");t=new Ag(this.source,{eval:!0})}return t.on("message",(t=>{this.onMessage(t)})),t.on("error",(t=>{this.onError(t)})),t.on("exit",(t=>{})),t}}class Fg{constructor(t,e){Ss(this,"name",void 0),Ss(this,"workerThread",void 0),Ss(this,"isRunning",!0),Ss(this,"result",void 0),Ss(this,"_resolve",(()=>{})),Ss(this,"_reject",(()=>{})),this.name=t,this.workerThread=e,this.result=new Promise(((t,e)=>{this._resolve=t,this._reject=e}))}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){Sg(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){Sg(this.isRunning),this.isRunning=!1,this._reject(t)}}class zg{static isSupported(){return jg.isSupported()}constructor(t){Ss(this,"name","unnamed"),Ss(this,"source",void 0),Ss(this,"url",void 0),Ss(this,"maxConcurrency",1),Ss(this,"maxMobileConcurrency",1),Ss(this,"onDebug",(()=>{})),Ss(this,"reuseWorkers",!0),Ss(this,"props",{}),Ss(this,"jobQueue",[]),Ss(this,"idleQueue",[]),Ss(this,"count",0),Ss(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach((t=>t.destroy())),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)}async startJob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t,e,n)=>t.done(n),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(t,e)=>t.error(e);const i=new Promise((i=>(this.jobQueue.push({name:t,onMessage:e,onError:n,onStart:i}),this)));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const n=new Fg(e.name,t);t.onMessage=t=>e.onMessage(n,t.type,t.payload),t.onError=t=>e.onError(n,t),e.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new jg({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Cg?this.maxMobileConcurrency:this.maxConcurrency}}const Ng={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Dg{static isSupported(){return jg.isSupported()}static getWorkerFarm(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Dg._workerFarm=Dg._workerFarm||new Dg({}),Dg._workerFarm.setProps(t),Dg._workerFarm}constructor(t){Ss(this,"props",void 0),Ss(this,"workerPools",new Map),this.props={...Ng},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:i}=t;let r=this.workerPools.get(e);return r||(r=new zg({name:e,source:n,url:i}),r.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,r)),r}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}Ss(Dg,"_workerFarm",void 0);const Bg="latest";async function Ug(t,e,n,i,r){const o=t.id,s=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e[t.id]||{},i="".concat(t.id,"-worker.js");let r=n.workerUrl;if(r||"compression"!==t.id||(r=e.workerUrl),"test"===e._workerType&&(r="modules/".concat(t.module,"/dist/").concat(i)),!r){let e=t.version;"latest"===e&&(e=Bg);const n=e?"@".concat(e):"";r="https://unpkg.com/@loaders.gl/".concat(t.module).concat(n,"/dist/").concat(i)}return Sg(r),r}(t,n),a=Dg.getWorkerFarm(n).getWorkerPool({name:o,url:s});n=JSON.parse(JSON.stringify(n)),i=JSON.parse(JSON.stringify(i||{}));const l=await a.startJob("process-on-worker",Vg.bind(null,r));l.postMessage("process",{input:e,options:n,context:i});const c=await l.result;return await c.result}async function Vg(t,e,n,i){switch(n){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:o,input:s,options:a}=i;try{const n=await t(s,a);e.postMessage("done",{id:o,result:n})}catch(r){const t=r instanceof Error?r.message:"unknown error";e.postMessage("error",{id:o,error:t})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}async function Wg(t){const e=[];for await(const n of t)e.push(n);return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.map((t=>t instanceof ArrayBuffer?new Uint8Array(t):t)),r=i.reduce(((t,e)=>t+e.byteLength),0),o=new Uint8Array(r);let s=0;for(const a of i)o.set(a,s),s+=a.byteLength;return o.buffer}(...e)}const Hg=262144;const Gg=262144;const Xg=1048576;function qg(t){if(function(t){return t&&"object"===typeof t&&t.isBuffer}(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return 0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if("string"===typeof t){const e=t;return(new TextEncoder).encode(e).buffer}if(t&&"object"===typeof t&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function Zg(t,e){return hg?async function*(t,e){const n=t.getReader();let i;try{for(;;){const t=i||n.read();null!==e&&void 0!==e&&e._streamReadAhead&&(i=n.read());const{done:r,value:o}=await t;if(r)return;yield qg(o)}}catch(r){n.releaseLock()}}(t,e):async function*(t,e){for await(const n of t)yield qg(n)}(t)}function Yg(t,e){if("string"===typeof t)return function*(t,e){const n=(null===e||void 0===e?void 0:e.chunkSize)||Hg;let i=0;const r=new TextEncoder;for(;i<t.length;){const e=Math.min(t.length-i,n),o=t.slice(i,i+e);i+=e,yield r.encode(o)}}(t,e);if(t instanceof ArrayBuffer)return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const{chunkSize:n=Gg}=e;let i=0;for(;i<t.byteLength;){const e=Math.min(t.byteLength-i,n),r=new ArrayBuffer(e),o=new Uint8Array(t,i,e);new Uint8Array(r).set(o),i+=e,yield r}}()}(t,e);if(Xp(t))return async function*(t,e){const n=(null===e||void 0===e?void 0:e.chunkSize)||Xg;let i=0;for(;i<t.size;){const e=i+n,r=await t.slice(i,e).arrayBuffer();i=e,yield r}}(t,e);if(Zp(t))return Zg(t,e);if(Gp(t)){return Zg(t.body,e)}throw new Error("makeIterator")}const Kg="Cannot convert supplied data type";async function Qg(t,e,n){const i=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if("string"===typeof t||i)return function(t,e,n){if(e.text&&"string"===typeof t)return t;if(qp(t)&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let n=t.buffer;const i=t.byteLength||t.length;return 0===t.byteOffset&&i===n.byteLength||(n=n.slice(t.byteOffset,t.byteOffset+i)),n}throw new Error(Kg)}(t,e);if(Xp(t)&&(t=await ag(t)),Gp(t)){const n=t;return await async function(t){if(!t.ok){const e=await async function(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let i=t.statusText;n.includes("application/json")&&(i+=" ".concat(await t.text())),e+=i,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch(n){}return e}(t);throw new Error(e)}}(n),e.binary?await n.arrayBuffer():await n.text()}if(Zp(t)&&(t=Yg(t,n)),Wp(t)||Hp(t))return Wg(t);throw new Error(Kg)}function $g(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function Jg(t,e,n){if(n)return n;const i={fetch:xg(e,t),...t};if(i.url){const t=rg(i.url);i.baseUrl=t,i.queryString=function(t){const e=t.match(ig);return e&&e[0]}(i.url),i.filename=$g(t),i.baseUrl=function(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}(t)}return Array.isArray(i.loaders)||(i.loaders=null),i}const tm=new Us({id:"loaders.gl"}),em=()=>{const t=gg();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};const nm=/\.([^.]+)$/;function im(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!rm(t))return null;if(e&&!Array.isArray(e))return Qp(e);let r=[];e&&(r=r.concat(e)),null!==n&&void 0!==n&&n.ignoreRegisteredLoaders||r.push(...em()),function(t){for(const e of t)Qp(e)}(r);const o=function(t,e,n,i){const r=og(t),o=sg(t),s=rg(r)||(null===i||void 0===i?void 0:i.url);let a=null,l="";null!==n&&void 0!==n&&n.mimeType&&(a=sm(e,null===n||void 0===n?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(null===n||void 0===n?void 0:n.mimeType));var c;a=a||function(t,e){const n=e&&nm.exec(e),i=n&&n[1];return i?function(t,e){e=e.toLowerCase();for(const n of t)for(const t of n.extensions)if(t.toLowerCase()===e)return n;return null}(t,i):null}(e,s),l=l||(a?"matched url ".concat(s):""),a=a||sm(e,o),l=l||(a?"matched MIME type ".concat(o):""),a=a||function(t,e){if(!e)return null;for(const n of t)if("string"===typeof e){if(am(e,n))return n}else if(ArrayBuffer.isView(e)){if(lm(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer){if(lm(e,0,n))return n}return null}(e,t),l=l||(a?"matched initial data ".concat(cm(t)):""),a=a||sm(e,null===n||void 0===n?void 0:n.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(o):""),l&&tm.log(1,"selectLoader selected ".concat(null===(c=a)||void 0===c?void 0:c.name,": ").concat(l,"."));return a}(t,r,n,i);if(!o&&(null===n||void 0===n||!n.nothrow))throw new Error(om(t));return o}function rm(t){return!(t instanceof Response&&204===t.status)}function om(t){const e=og(t),n=sg(t);let i="No valid loader found (";i+=e?"".concat($g(e),", "):"no url provided, ",i+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const r=t?cm(t):"";return i+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",i+=")",i}function sm(t,e){for(const n of t){if(n.mimeTypes&&n.mimeTypes.includes(e))return n;if(e==="application/x.".concat(n.id))return n}return null}function am(t,e){if(e.testText)return e.testText(t);return(Array.isArray(e.tests)?e.tests:[e.tests]).some((e=>t.startsWith(e)))}function lm(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((i=>function(t,e,n,i){if(i instanceof ArrayBuffer)return function(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const i=new Uint8Array(t),r=new Uint8Array(e);for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0}(i,t,i.byteLength);switch(typeof i){case"function":return i(t,n);case"string":return i===um(t,e,i.length);default:return!1}}(t,e,n,i)))}function cm(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"===typeof t)return t.slice(0,e);if(ArrayBuffer.isView(t))return um(t.buffer,t.byteOffset,e);if(t instanceof ArrayBuffer){return um(t,0,e)}return""}function um(t,e,n){if(t.byteLength<e+n)return"";const i=new DataView(t);let r="";for(let o=0;o<n;o++)r+=String.fromCharCode(i.getUint8(e+o));return r}async function hm(t,e,n,i){Sg(!i||"object"===typeof i),!e||Array.isArray(e)||Kp(e)||(i=void 0,n=e,e=void 0),n=n||{};const r=og(t=await t),o=function(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const t=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...t]:t}return n&&n.length?n:null}(e,i),s=await async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!rm(t))return null;let r=im(t,e,{...n,nothrow:!0},i);if(r)return r;if(Xp(t)&&(r=im(t=await t.slice(0,10).arrayBuffer(),e,n,i)),!r&&(null===n||void 0===n||!n.nothrow))throw new Error(om(t));return r}(t,o,n);return s?(i=Jg({url:r,parse:hm,loaders:o},n=vg(n,s,o,r),i||null),await async function(t,e,n,i){if(function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pg;Sg(t,"no worker provided");const n=t.version}(t),Gp(e)){const t=e,{ok:n,redirected:r,status:o,statusText:s,type:a,url:l}=t,c=Object.fromEntries(t.headers.entries());i.response={headers:c,ok:n,redirected:r,status:o,statusText:s,type:a,url:l}}if(e=await Qg(e,t,n),t.parseTextSync&&"string"===typeof e)return n.dataType="text",t.parseTextSync(e,n,i,t);if(function(t,e){return!!Dg.isSupported()&&!!(Eg||null!==e&&void 0!==e&&e._nodeWorkers)&&t.worker&&(null===e||void 0===e?void 0:e.worker)}(t,n))return await Ug(t,e,n,i,hm);if(t.parseText&&"string"===typeof e)return await t.parseText(e,n,i,t);if(t.parse)return await t.parse(e,n,i,t);throw Sg(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}(s,t,n,i)):null}async function dm(t,e,n,i){Array.isArray(e)||Kp(e)||(void 0,n=e,e=void 0);const r=xg(n);let o=t;return"string"===typeof t&&(o=await r(t)),Xp(t)&&(o=await r(t)),await hm(o,e,n)}const fm=2**24-1,pm=Object.freeze([]),gm=nf((t=>{let{oldViewport:e,viewport:n}=t;return e.equals(n)}));let mm=new Uint8ClampedArray(0);const vm={data:{type:"data",value:pm,async:!0},dataComparator:{type:"function",value:null,compare:!1,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,e)=>{let{propName:n,layer:i,loaders:r,loadOptions:o,signal:s}=e;const{resourceManager:a}=i.context;var l;(o=o||i.getLoadOptions(),r=r||i.props.loaders,s)&&(o={...o,fetch:{...null===(l=o)||void 0===l?void 0:l.fetch,signal:s}});let c=a.contains(t);return c||o||(a.add({resourceId:t,data:dm(t,r),persistent:!1}),c=!0),c?a.subscribe({resourceId:t,onChange:t=>{var e;return null===(e=i.internalState)||void 0===e?void 0:e.reloadAsyncProp(n,t)},consumerId:i.id,requestId:n}):dm(t,r,o)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:Ks,onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Xs.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:t=>{let{layerIndex:e}=t;return[0,100*-e]},compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class ym extends jp{constructor(){super(...arguments),Ss(this,"internalState",null),Ss(this,"lifecycle",jd),Ss(this,"context",void 0),Ss(this,"state",void 0),Ss(this,"parent",null)}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}project(t){Rc(this.internalState);const e=this.internalState.viewport||this.context.viewport,n=bp(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,r,o]=np(n,e.pixelProjectionMatrix);return 2===t.length?[i,r]:[i,r,o]}unproject(t){Rc(this.internalState);return(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,e){Rc(this.internalState);return _p(t,{viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...e})}get isComposite(){return!1}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===Xs.DEFAULT||t===Xs.LNGLAT||t===Xs.CARTESIAN}onHover(t,e){return this.props.onHover&&this.props.onHover(t,e)||!1}onClick(t,e){return this.props.onClick&&this.props.onClick(t,e)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){Rc(t instanceof Uint8Array);const[e,n,i]=t;return e+256*n+65536*i-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:tf(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var t;const e=this.getAttributeManager();if(!e)return null;const{positions:n,instancePositions:i}=e.attributes;return null===(t=n||i)||void 0===t?void 0:t.getBounds()}getShaders(t){for(const e of this.props.extensions)t=rf(t,e.getShaders.call(this,e));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){const e=this.getAttributeManager(),{dataChanged:n}=t.changeFlags;if(n&&e)if(Array.isArray(n))for(const a of n)e.invalidateAll(a);else e.invalidateAll();const{props:i,oldProps:r}=t,o=Number.isInteger(r.highlightedObjectIndex)||r.pickable,s=Number.isInteger(i.highlightedObjectIndex)||i.pickable;if(o!==s&&e){const{pickingColors:t,instancePickingColors:n}=e.attributes,i=t||n;i&&(s&&i.constant&&(i.constant=!1,e.invalidate(i.id)),i.value||s||(i.constant=!0,i.value=[0,0,0]))}}finalizeState(t){for(const n of this.getModels())n.delete();const e=this.getAttributeManager();e&&e.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo(t){let{info:e,mode:n,sourceLayer:i}=t;const{index:r}=e;return r>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[r]),e}raiseError(t,e){var n,i,r,o;(e&&(t.message="".concat(e,": ").concat(t.message)),null!==(n=(i=this.props).onError)&&void 0!==n&&n.call(i,t))||(null===(r=this.context)||void 0===r||null===(o=r.onError)||void 0===o||o.call(r,t,this))}getNeedsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};return this._getNeedsRedraw(t)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var t;return(null===(t=this.internalState)||void 0===t?void 0:t.uniformTransitions.active)||!1}activateViewport(t){if(!this.internalState)return;const e=this.internalState.viewport;this.internalState.viewport=t,e&&gm({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";const e=this.getAttributeManager();e&&("all"===t?e.invalidateAll():e.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(){const t=this.getAttributeManager();if(!t)return;const e=this.props,n=this.getNumInstances(),i=this.getStartIndices();t.update({data:e.data,numInstances:n,startIndices:i,props:e,transitions:e.transitions,buffers:e.data.attributes,context:this});const r=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(r)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const t in e)Object.defineProperty(n,t,{value:e[t]});return n}return this.props}calculateInstancePickingColors(t,e){let{numInstances:n}=e;if(t.constant)return;const i=Math.floor(mm.length/3);if(this.internalState.usesPickingColorCache=!0,i<n){n>fm&&Gs.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),mm=oc.allocate(mm,n,{size:3,copy:!0,maxCount:Math.max(n,fm)});const t=Math.floor(mm.length/3),e=[];for(let n=i;n<t;n++)this.encodePickingColor(n,e),mm[3*n+0]=e[0],mm[3*n+1]=e[1],mm[3*n+2]=e[2]}t.value=mm.subarray(0,3*n)}_setModelAttributes(t,e){const n=this.getAttributeManager(),i=t.userData.excludeAttributes||{},r=n.getShaderAttributes(e,i);t.setAttributes(r)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;if(!i)return;const r=i.getVertexOffset(t),o=i.getVertexOffset(t+1);i.buffer.subData({data:new Uint8Array(o-r),offset:r})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==mm.buffer&&(n.value=mm.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){Rc(!this.internalState),Rc(Number.isFinite(this.props.coordinateSystem)),tu("layer.initialize",this);const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Np({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Gs.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new Id(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const e of this.props.extensions)e.initializeState.call(this,this.context,e);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){tu("layer.matched",this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.internalState.layer=this,this.state=e,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const t=this.needsUpdate();if(tu("layer.update",this,t),!t)return;const e=this.props,n=this.context,i=this.internalState,r=n.viewport,o=this._updateUniformTransition();i.propsInTransition=o,n.viewport=i.viewport||r,this.props=o;try{const t=this._getUpdateParams(),e=this.getModels();if(n.gl)this.updateState(t);else try{this.updateState(t)}catch(s){}for(const n of this.props.extensions)n.updateState.call(this,t,n);const i=this.getModels()[0]!==e[0];this._postUpdate(t,i)}finally{n.viewport=r,this.props=e,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){tu("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}_drawLayer(t){let{moduleParameters:e=null,uniforms:n={},parameters:i={}}=t;this._updateAttributeTransition();const r=this.props,o=this.context;this.props=this.internalState.propsInTransition||r;const s=this.props.opacity;n.opacity=Math.pow(s,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:t}=this.props,r=t&&t(n)||[0,0];za(o.gl,{polygonOffset:r}),Na(o.gl,i,(()=>{const t={moduleParameters:e,uniforms:n,parameters:i,context:o};for(const e of this.props.extensions)e.draw.call(this,t,e);this.draw(t)}))}finally{this.props=r}}getChangeFlags(){var t;return null===(t=this.internalState)||void 0===t?void 0:t.changeFlags}setChangeFlags(t){if(!this.internalState)return;const{changeFlags:e}=this.internalState;for(const i in t)if(t[i]){let n=!1;if("dataChanged"===i){const r=t[i],o=e[i];r&&Array.isArray(o)&&(e.dataChanged=Array.isArray(r)?o.concat(r):r,n=!0)}e[i]||(e[i]=t[i],n=!0),n&&tu("layer.changeFlag",this,i,t)}const n=Boolean(e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged);e.propsOrDataChanged=n,e.somethingChanged=n||e.viewportChanged||e.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,e){const n=Gd(t,e);if(n.updateTriggersChanged)for(const r in n.updateTriggersChanged)n.updateTriggersChanged[r]&&this.invalidateAttribute(r);if(n.transitionsChanged)for(const r in n.transitionsChanged){var i;this.internalState.uniformTransitions.add(r,e[r],t[r],null===(i=t.transitions)||void 0===i?void 0:i[r])}return this.setChangeFlags(n)}validateProps(){!function(t){const e=Qd(t);for(const n in e){const i=e[n],{validate:r}=i;if(r&&!r(t[n],i))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&"function"===typeof n&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_getAttributeManager(){const t=this.context;return new kd(t.gl,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,e){const{props:n,oldProps:i}=t;this.setNeedsRedraw(),this._updateAttributes();const{model:r}=this.state;null===r||void 0===r||r.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:s,highlightColor:a}=n;if(e||i.autoHighlight!==o||i.highlightedObjectIndex!==s||i.highlightColor!==a){const t={};o||(t.pickingSelectedColor=null),Array.isArray(a)&&(t.pickingHighlightColor=a),Number.isInteger(s)&&(t.pickingSelectedColor=Number.isFinite(s)&&s>=0?this.encodePickingColor(s):null),this.setModuleParameters(t)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const n=this.getAttributeManager(),i=!!n&&n.getNeedsRedraw(t);return e=e||i,e}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}Ss(ym,"defaultProps",vm),Ss(ym,"layerName","Layer");class bm extends ym{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every((t=>t.isLoaded))}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(t){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo(t){let{info:e}=t;const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id?(e.object=n.__source.object,e.index=n.__source.index,e):e}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){return e&&e.length}getSubLayerClass(t,e){const{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||e}getSubLayerRow(t,e,n){return t.__source={parent:this,object:e,index:n},t}getSubLayerAccessor(t){if("function"===typeof t){const e={index:-1,data:this.props.data,target:[]};return(n,i)=>n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,i)}return t}getSubLayerProps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var e;const{opacity:n,pickable:i,visible:r,parameters:o,getPolygonOffset:s,highlightedObjectIndex:a,autoHighlight:l,highlightColor:c,coordinateSystem:u,coordinateOrigin:h,wrapLongitude:d,positionFormat:f,modelMatrix:p,extensions:g,fetch:m,operation:v,_subLayerProps:y}=this.props,b={id:"",updateTriggers:{},opacity:n,pickable:i,visible:r,parameters:o,getPolygonOffset:s,highlightedObjectIndex:a,autoHighlight:l,highlightColor:c,coordinateSystem:u,coordinateOrigin:h,wrapLongitude:d,positionFormat:f,modelMatrix:p,extensions:g,fetch:m,operation:v},_=y&&t.id&&y[t.id],w=_&&_.updateTriggers,x=t.id||"sublayer";if(_){const e=this.constructor._propTypes,n=t.type?t.type._propTypes:{};for(const t in _){const i=n[t]||e[t];i&&"accessor"===i.type&&(_[t]=this.getSubLayerAccessor(_[t]))}}Object.assign(b,t,_),b.id="".concat(this.props.id,"-").concat(x),b.updateTriggers={all:null===(e=this.props.updateTriggers)||void 0===e?void 0:e.all,...t.updateTriggers,...w};for(const S of g){const t=S.getSubLayerProps.call(this,S);t&&Object.assign(b,t,{updateTriggers:Object.assign(b.updateTriggers,t.updateTriggers)})}return b}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_postUpdate(t,e){let n=this.internalState.subLayers;const i=!n||this.needsUpdate();if(i){n=Dc(this.renderLayers(),Boolean),this.internalState.subLayers=n}tu("compositeLayer.renderLayers",this,i,n);for(const r of n)r.parent=this}}Ss(bm,"layerName","CompositeLayer");const _m={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null},wm="#define SMOOTH_EDGE_RADIUS 0.5",xm={name:"geometry",vs:"\n".concat(wm,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(wm,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")},Sm=Object.keys(Xs).map((t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Xs[t],";"))).join(""),Pm=Object.keys(qs).map((t=>"const int PROJECTION_MODE_".concat(t," = ").concat(qs[t],";"))).join(""),Em=Object.keys(Zs).map((t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Zs[t],";"))).join(""),Cm="".concat(Sm,"\n").concat(Pm,"\n").concat(Em,'\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0; // meters\nconst float GLOBE_RADIUS = 256.0;\n\n// returns an adjustment factor for uCommonUnitsPerMeter\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n\n    // uCommonUnitsPerMeter in low-zoom Web Mercator is non-linear\n    // Adjust by 1 / cos(latitude)\n    // If geometry.position (vertex in common space) is populated, use it\n    // Otherwise use geometry.worldPosition (anchor in world space)\n    \n    if (geometry.position.w == 0.0) {\n      float y = clamp(geometry.worldPosition.y, -89.9, 89.9);\n      return 1.0 / cos(radians(y));\n    }\n\n    // latitude from common y: 2.0 * (atan(exp(y / TILE_SIZE * 2.0 * PI - PI)) - PI / 4.0)\n    // Taylor series of 1 / cos(latitude)\n    // Max error < 0.003\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n//\n// Scaling offsets - scales meters to "world distance"\n// Note the scalar version of project_size is for scaling the z component only\n//\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\n\n// Get rotation matrix that aligns the z axis with the given up vector\n// Find 3 unit vectors ux, uy, uz that are perpendicular to each other and uz == up\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  // Tangent on XY plane\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n\n//\n// Projecting normal - transform deltas from current coordinate system to\n// normals in the worldspace\n//\nvec3 project_normal(vec3 vector) {\n  // Apply model matrix\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\n\n//\n// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]\n//\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\n\n//\n// Projects positions (defined by project_uCoordinateSystem) to common space (defined by project_uProjectionMode)\n//\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n\n  // Work around for a Mac+NVIDIA bug https://github.com/visgl/deck.gl/issues/4145\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        // Too far from the projection center for offset mode to be accurate\n        // Only use high parts\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n\n  // Translation is already added to the high parts\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\n\n//\n// Projects from common space coordinates to clip space.\n// Uses project_uViewProjectionMatrix\n//\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\n\n// Returns a clip space offset that corresponds to a given number of screen pixels\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  // UNIT_PIXELS\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n'),Tm={};const Am={name:"project",dependencies:[_m,xm],vs:Cm,getUniforms:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tm;return"viewport"in t?function(t){let{viewport:e,devicePixelRatio:n=1,modelMatrix:i=null,coordinateSystem:r=Xs.DEFAULT,coordinateOrigin:o=yf,autoWrapLongitude:s=!1}=t;r===Xs.DEFAULT&&(r=e.isGeospatial?Xs.LNGLAT:Xs.CARTESIAN);const a=bf({viewport:e,devicePixelRatio:n,coordinateSystem:r,coordinateOrigin:o});return a.project_uWrapLongitude=s,a.project_uModelMatrix=i||mf,a}(t):{}}},km={name:"project32",dependencies:[Am],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},Mm="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",Lm={lightSources:{}};function Om(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.map((t=>t*e/255))}const Rm={name:"lights",vs:Mm,fs:Mm,getUniforms:function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lm;if("lightSources"in e){const{ambientLight:t,pointLights:n,directionalLights:i}=e.lightSources||{};return t||n&&n.length>0||i&&i.length>0?Object.assign({},function(t){let{ambientLight:e,pointLights:n=[],directionalLights:i=[]}=t;const r={};return r["lighting_uAmbientLight.color"]=e?Om(e):[0,0,0],n.forEach(((t,e)=>{r["lighting_uPointLight[".concat(e,"].color")]=Om(t),r["lighting_uPointLight[".concat(e,"].position")]=t.position,r["lighting_uPointLight[".concat(e,"].attenuation")]=t.attenuation||[1,0,0]})),r.lighting_uPointLightCount=n.length,i.forEach(((t,e)=>{r["lighting_uDirectionalLight[".concat(e,"].color")]=Om(t),r["lighting_uDirectionalLight[".concat(e,"].direction")]=t.direction})),r.lighting_uDirectionalLightCount=i.length,r}({ambientLight:t,pointLights:n,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){const n={pointLights:[],directionalLights:[]};for(const t of e.lights||[])switch(t.type){case"ambient":n.ambientLight=t;break;case"directional":n.directionalLights.push(t);break;case"point":n.pointLights.push(t)}return t({lightSources:n})}return{}},defines:{MAX_LIGHTS:3}},Im="\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",jm={};function Fm(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jm;if(!("material"in t))return{};const{material:e}=t;return e?function(t){const{ambient:e=.35,diffuse:n=.6,shininess:i=32,specularColor:r=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:i,lighting_uSpecularColor:r.map((t=>t/255))}}(e):{lighting_uEnabled:!1}}const zm={name:"gouraud-lighting",dependencies:[Rm],vs:Im,defines:{LIGHTING_VERTEX:1},getUniforms:Fm},Nm={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1};const Dm={name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nm;const e={};if(void 0!==t.pickingSelectedColor)if(t.pickingSelectedColor){const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}else e.picking_uSelectedColorValid=0;if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,(t=>t/255));Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return void 0!==t.pickingActive&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}},Bm={inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},...Dm},Um={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Vm{static get DRAW_MODE(){return Um}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:e=rl("geometry"),drawMode:n=Um.TRIANGLES,attributes:i={},indices:r=null,vertexCount:o=null}=t;this.id=e,this.drawMode=0|n,this.attributes={},this.userData={},this._setAttributes(i,r),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return"Geometry ".concat(this.id," attribute ").concat(t)}_setAttributes(t,e){e&&(this.indices=ArrayBuffer.isView(e)?{value:e,size:1}:e);for(const n in t){let e=t[n];e=ArrayBuffer.isView(e)?{value:e}:e,tl(ArrayBuffer.isView(e.value),"".concat(this._print(n),": must be typed array or object with value as typed array")),"POSITION"!==n&&"positions"!==n||e.size||(e.size=3),"indices"===n?(tl(!this.indices),this.indices=e):this.attributes[n]=e}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(t,e){if(e)return e.value.length;let n=1/0;for(const i in t){const e=t[i],{value:r,size:o,constant:s}=e;!s&&r&&o>=1&&(n=Math.min(n,r.length/o))}return tl(Number.isFinite(n)),n}}var Wm=n(89),Hm=n.n(Wm);const Gm=1,Xm=-1;function qm(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Math.sign(function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{start:n=0,end:i=t.length}=e,r=e.size||2;let o=0;for(let s=n,a=i-r;s<i;s+=r)o+=(t[s]-t[a])*(t[s+1]+t[a+1]),a=s;return o/2}(t,e))}(t,n);return i!==e&&(function(t,e){const{start:n=0,end:i=t.length,size:r=2}=e,o=(i-n)/r,s=Math.floor(o/2);for(let a=0;a<s;++a){const e=n+a*r,i=n+(o-1-a)*r;for(let n=0;n<r;++n){const r=t[e+n];t[e+n]=t[i+n],t[i+n]=r}}}(t,n),!0)}function Zm(t,e,n,i){let r,o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(8&n)r=(i[3]-t[1])/(e[1]-t[1]),o=3;else if(4&n)r=(i[1]-t[1])/(e[1]-t[1]),o=1;else if(2&n)r=(i[2]-t[0])/(e[0]-t[0]),o=2;else{if(!(1&n))return null;r=(i[0]-t[0])/(e[0]-t[0]),o=0}for(let a=0;a<t.length;a++)s[a]=(1&o)===a?i[o]:r*(e[a]-t[a])+t[a];return s}function Ym(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function Km(t,e){const n=e.length,i=t.length;if(i>0){let r=!0;for(let o=0;o<n;o++)if(t[i-n+o]!==e[o]){r=!1;break}if(r)return!1}for(let r=0;r<n;r++)t[i+r]=e[r];return!0}function Qm(t,e){const n=e.length;for(let i=0;i<n;i++)t[i]=e[i]}function $m(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];const o=i+e*n;for(let s=0;s<n;s++)r[s]=t[o+s];return r}function Jm(t,e){const{size:n=2,broken:i=!1,gridResolution:r=10,gridOffset:o=[0,0],startIndex:s=0,endIndex:a=t.length}=e||{},l=(a-s)/n;let c=[];const u=[c],h=$m(t,0,n,s);let d,f;const p=ov(h,r,o,[]),g=[];Km(c,h);for(let m=1;m<l;m++){for(d=$m(t,m,n,s,d),f=Ym(d,p);f;){Zm(h,d,f,p,g);const t=Ym(g,p);t&&(Zm(h,g,t,p,g),f=t),Km(c,g),Qm(h,g),sv(p,r,f),i&&c.length>n&&(c=[],u.push(c),Km(c,h)),f=Ym(d,p)}Km(c,d),Qm(h,d)}return i?u:u[0]}const tv=0,ev=1;function nv(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function iv(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;if(!t.length)return[];const{size:i=2,gridResolution:r=10,gridOffset:o=[0,0],edgeTypes:s=!1}=n||{},a=[],l=[{pos:t,types:s?new Array(t.length/i).fill(ev):null,holes:e||[]}],c=[[],[]];let u=[];for(;l.length;){const{pos:t,types:e,holes:n}=l.shift();av(t,i,n[0]||t.length,c),u=ov(c[0],r,o,u);const h=Ym(c[1],u);if(h){let r=rv(t,e,i,0,n[0]||t.length,u,h);const o={pos:r[0].pos,types:r[0].types,holes:[]},a={pos:r[1].pos,types:r[1].types,holes:[]};l.push(o,a);for(let l=0;l<n.length;l++)r=rv(t,e,i,n[l],n[l+1]||t.length,u,h),r[0]&&(o.holes.push(o.pos.length),o.pos=nv(o.pos,r[0].pos),s&&(o.types=nv(o.types,r[0].types))),r[1]&&(a.holes.push(a.pos.length),a.pos=nv(a.pos,r[1].pos),s&&(a.types=nv(a.types,r[1].types)))}else{const i={positions:t};s&&(i.edgeTypes=e),n.length&&(i.holeIndices=n),a.push(i)}}return a}function rv(t,e,n,i,r,o,s){const a=(r-i)/n,l=[],c=[],u=[],h=[],d=[];let f,p,g;const m=$m(t,a-1,n,i);let v=Math.sign(8&s?m[1]-o[3]:m[0]-o[2]),y=e&&e[a-1],b=0,_=0;for(let w=0;w<a;w++)f=$m(t,w,n,i,f),p=Math.sign(8&s?f[1]-o[3]:f[0]-o[2]),g=e&&e[i/n+w],p&&v&&v!==p&&(Zm(m,f,s,o,d),Km(l,d)&&u.push(y),Km(c,d)&&h.push(y)),p<=0?(Km(l,f)&&u.push(g),b-=p):u.length&&(u[u.length-1]=tv),p>=0?(Km(c,f)&&h.push(g),_+=p):h.length&&(h[h.length-1]=tv),Qm(m,f),v=p,y=g;return[b?{pos:l,types:e&&u}:null,_?{pos:c,types:e&&h}:null]}function ov(t,e,n,i){const r=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return i[0]=r,i[1]=o,i[2]=r+e,i[3]=o+e,i}function sv(t,e,n){8&n?(t[1]+=e,t[3]+=e):4&n?(t[1]-=e,t[3]-=e):2&n?(t[0]+=e,t[2]+=e):1&n&&(t[0]-=e,t[2]-=e)}function av(t,e,n,i){let r=1/0,o=-1/0,s=1/0,a=-1/0;for(let l=0;l<n;l+=e){const e=t[l],n=t[l+1];r=e<r?e:r,o=e>o?e:o,s=n<s?n:s,a=n>a?n:a}return i[0][0]=r,i[0][1]=s,i[1][0]=o,i[1][1]=a,i}const lv=85.051129;function cv(t,e,n,i){let r=-1,o=-1;for(let s=n+1;s<i;s+=e){const e=Math.abs(t[s]);e>r&&(r=e,o=s-1)}return o}function uv(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:lv;const o=t[n],s=t[i-e];if(Math.abs(o-s)>180){const i=$m(t,0,e,n);i[0]+=360*Math.round((s-o)/360),Km(t,i),i[1]=Math.sign(i[1])*r,Km(t,i),i[0]=o,Km(t,i)}}function hv(t,e,n,i){let r,o=t[0];for(let s=n;s<i;s+=e){r=t[s];const e=r-o;(e>180||e<-180)&&(r-=360*Math.round(e/360)),t[s]=o=r}}function dv(t,e){let n;const i=t.length/e;for(let o=0;o<i&&(n=t[o*e],(n+180)%360===0);o++);const r=360*-Math.round(n/360);if(0!==r)for(let o=0;o<i;o++)t[o*e]+=r}const fv=Gm,pv=Xm,gv={isClosed:!0};function mv(t){return"positions"in t?t.positions:t}function vv(t){return"holeIndices"in t?t.holeIndices:null}function yv(t,e,n,i,r){let o=e;const s=n.length;for(let a=0;a<s;a++)for(let e=0;e<i;e++)t[o++]=n[a][e]||0;if(!function(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}(n))for(let a=0;a<i;a++)t[o++]=n[0][a]||0;return gv.start=e,gv.end=o,gv.size=i,qm(t,r,gv),o}function bv(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0;o=o||n.length;const a=o-r;if(a<=0)return e;let l=e;for(let c=0;c<a;c++)t[l++]=n[r+c];if(!function(t,e,n,i){for(let r=0;r<e;r++)if(t[n+r]!==t[i-e+r])return!1;return!0}(n,i,r,o))for(let c=0;c<i;c++)t[l++]=n[r+c];return gv.start=e,gv.end=l,gv.size=i,qm(t,s,gv),l}function _v(t,e){!function(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}(t);const n=[],i=[];if("positions"in t){const{positions:r,holeIndices:o}=t;if(o){let t=0;for(let s=0;s<=o.length;s++)t=bv(n,t,r,e,o[s-1],o[s],0===s?fv:pv),i.push(t);return i.pop(),{positions:n,holeIndices:i}}t=r}if(!function(t){return Array.isArray(t[0])}(t))return bv(n,0,t,e,0,n.length,fv),n;if(!function(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}(t)){let r=0;for(const[o,s]of t.entries())r=yv(n,r,s,e,0===o?fv:pv),i.push(r);return i.pop(),{positions:n,holeIndices:i}}return yv(n,0,t,e,fv),n}class wv{constructor(t){Ss(this,"opts",void 0),Ss(this,"typedArrayManager",void 0),Ss(this,"indexStarts",[0]),Ss(this,"vertexStarts",[0]),Ss(this,"vertexCount",0),Ss(this,"instanceCount",0),Ss(this,"attributes",void 0),Ss(this,"_attributeDefs",void 0),Ss(this,"data",void 0),Ss(this,"getGeometry",void 0),Ss(this,"geometryBuffer",void 0),Ss(this,"buffers",void 0),Ss(this,"positionSize",void 0),Ss(this,"normalize",void 0);const{attributes:e={}}=t;this.typedArrayManager=oc,this.attributes={},this._attributeDefs=e,this.opts=t,this.updateGeometry(t)}updateGeometry(t){Object.assign(this.opts,t);const{data:e,buffers:n={},getGeometry:i,geometryBuffer:r,positionFormat:o,dataChanged:s,normalize:a=!0}=this.opts;if(this.data=e,this.getGeometry=i,this.positionSize=r&&r.size||("XY"===o?2:3),this.buffers=n,this.normalize=a,r&&(Rc(e.startIndices),this.getGeometry=this.getGeometryFromBuffer(r),a||(n.positions=r)),this.geometryBuffer=n.positions,Array.isArray(s))for(const l of s)this._rebuildGeometry(l);else this._rebuildGeometry()}updatePartialGeometry(t){let{startRow:e,endRow:n}=t;this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(t){const e=t.value||t;return ArrayBuffer.isView(e)?Nc(e,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices}):null}_allocate(t,e){const{attributes:n,buffers:i,_attributeDefs:r,typedArrayManager:o}=this;for(const s in r)if(s in i)o.release(n[s]),n[s]=null;else{const i=r[s];i.copy=e,n[s]=o.allocate(n[s],t,i)}}_forEachGeometry(t,e,n){const{data:i,getGeometry:r}=this,{iterable:o,objectInfo:s}=Fc(i,e,n);for(const a of o){s.index++;t(r?r(a,s):null,s.index)}}_rebuildGeometry(t){if(!this.data)return;let{indexStarts:e,vertexStarts:n,instanceCount:i}=this;const{data:r,geometryBuffer:o}=this,{startRow:s=0,endRow:a=1/0}=t||{},l={};if(t||(e=[0],n=[0]),this.normalize||!o)this._forEachGeometry(((t,e)=>{const i=t&&this.normalizeGeometry(t);l[e]=i,n[e+1]=n[e]+(i?this.getGeometrySize(i):0)}),s,a),i=n[n.length-1];else if(n=r.startIndices,i=n[r.length]||0,ArrayBuffer.isView(o))i=i||o.length/this.positionSize;else if(o instanceof wl){const t=o.accessor.stride||4*this.positionSize;i=i||o.byteLength/t}else if(o.buffer){const t=o.stride||4*this.positionSize;i=i||o.buffer.byteLength/t}else if(o.value){const t=o.value,e=o.stride/t.BYTES_PER_ELEMENT||this.positionSize;i=i||t.length/e}this._allocate(i,Boolean(t)),this.indexStarts=e,this.vertexStarts=n,this.instanceCount=i;const c={};this._forEachGeometry(((t,r)=>{const o=l[r]||t;c.vertexStart=n[r],c.indexStart=e[r];const s=r<n.length-1?n[r+1]:i;c.geometrySize=s-n[r],c.geometryIndex=r,this.updateGeometryAttributes(o,c)}),s,a),this.vertexCount=e[e.length-1]}}class xv extends wv{constructor(t){const{fp64:e,IndexType:n=Uint32Array}=t;super({...t,attributes:{positions:{size:3,type:e?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:n,size:1}}})}get(t){const{attributes:e}=this;return"indices"===t?e.indices&&e.indices.subarray(0,this.vertexCount):e[t]}updateGeometry(t){super.updateGeometry(t);const e=this.buffers.indices;if(e)this.vertexCount=(e.value||e).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(t){if(this.normalize){const e=_v(t,this.positionSize);return this.opts.resolution?iv(mv(e),vv(e),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;const{size:i=2,normalize:r=!0,edgeTypes:o=!1}=n||{};e=e||[];const s=[],a=[];let l=0,c=0;for(let h=0;h<=e.length;h++){const r=e[h]||t.length,o=c,u=cv(t,i,l,r);for(let e=u;e<r;e++)s[c++]=t[e];for(let e=l;e<u;e++)s[c++]=t[e];hv(s,i,o,c),uv(s,i,o,c,null===n||void 0===n?void 0:n.maxLatitude),l=r,a[h]=c}a.pop();const u=iv(s,a,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(r)for(const h of u)dv(h.positions,i);return u}(mv(e),vv(e),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):e}return t}getGeometrySize(t){if(Sv(t)){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}return mv(t).length/this.positionSize}getGeometryFromBuffer(t){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(t):null}updateGeometryAttributes(t,e){if(t&&Sv(t))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t,e.indexStart=this.indexStarts[e.geometryIndex+1]}else this._updateIndices(t,e),this._updatePositions(t,e),this._updateVertexValid(t,e)}_updateIndices(t,e){let{geometryIndex:n,vertexStart:i,indexStart:r}=e;const{attributes:o,indexStarts:s,typedArrayManager:a}=this;let l=o.indices;if(!l||!t)return;let c=r;const u=function(t,e,n){let i=vv(t);i&&(i=i.map((t=>t/e)));let r=mv(t);if(n){const t=r.length;r=r.slice();const i=[];for(let o=0;o<t;o+=e){i[0]=r[o],i[1]=r[o+1];const t=n(i);r[o]=t[0],r[o+1]=t[1]}}return Hm()(r,i,e)}(t,this.positionSize,this.opts.preproject);l=a.allocate(l,r+u.length,{copy:!0});for(let h=0;h<u.length;h++)l[c++]=u[h]+i;s[n+1]=r+u.length,o.indices=l}_updatePositions(t,e){let{vertexStart:n,geometrySize:i}=e;const{attributes:{positions:r},positionSize:o}=this;if(!r||!t)return;const s=mv(t);for(let a=n,l=0;l<i;a++,l++){const t=s[l*o],e=s[l*o+1],n=o>2?s[l*o+2]:0;r[3*a]=t,r[3*a+1]=e,r[3*a+2]=n}}_updateVertexValid(t,e){let{vertexStart:n,geometrySize:i}=e;const{positionSize:r}=this,o=this.attributes.vertexValid,s=t&&vv(t);if(t&&t.edgeTypes?o.set(t.edgeTypes,n):o.fill(1,n,n+i),s)for(let a=0;a<s.length;a++)o[n+s[a]/r-1]=0;o[n+i-1]=0}}function Sv(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const Pv="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    // normals generated by the polygon tesselator are in lnglat offsets instead of meters\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n  }\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n  #ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n  #else\n    normal = project_normal(vec3(0.0, 0.0, 1.0));\n  #endif\n    geometry.normal = normal;\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",Ev="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(Pv,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),Cv="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(Pv,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n"),Tv=[0,0,0,255],Av={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:Tv},getLineColor:{type:"accessor",value:Tv},material:!0},kv={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class Mv extends ym{constructor(){super(...arguments),Ss(this,"state",void 0)}getShaders(t){return super.getShaders({vs:"top"===t?Ev:Cv,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[km,zm,Bm]})}get wrapLongitude(){return!1}initializeState(){const{gl:t,viewport:e}=this.context;let{coordinateSystem:n}=this.props;e.isGeospatial&&n===Xs.DEFAULT&&(n=Xs.LNGLAT),this.setState({numInstances:0,polygonTesselator:new xv({preproject:n===Xs.LNGLAT&&e.projectFlat.bind(e),fp64:this.use64bitPositions(),IndexType:!t||nc(t,Jl)?Uint32Array:Uint16Array})});const i=this.getAttributeManager(),r=!0;i.remove(["instancePickingColors"]),i.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:r},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:kv,accessor:"getPolygon",update:this.calculatePositions,noAlloc:r,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:r},elevations:{size:1,transition:kv,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:kv,accessor:"getFillColor",defaultValue:Tv,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:kv,accessor:"getLineColor",defaultValue:Tv,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(t,e)=>{let{index:n,target:i}=e;return this.encodePickingColor(t&&t.__source?t.__source.index:n,i)},shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:i}=this.props;return i[0]&&i[0].__source&&(e.object=i.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}draw(t){let{uniforms:e}=t;const{extruded:n,filled:i,wireframe:r,elevationScale:o}=this.props,{topModel:s,sideModel:a,polygonTesselator:l}=this.state,c={...e,extruded:Boolean(n),elevationScale:o};a&&(a.setInstanceCount(l.instanceCount-1),a.setUniforms(c),r&&(a.setDrawMode(3),a.setUniforms({isWireframe:!0}).draw()),i&&(a.setDrawMode(6),a.setUniforms({isWireframe:!1}).draw())),s&&(s.setVertexCount(l.vertexCount),s.setUniforms(c).draw())}updateState(t){super.updateState(t),this.updateGeometry(t);const{props:e,oldProps:n,changeFlags:i}=t,r=this.getAttributeManager();var o;(i.extensionsChanged||e.filled!==n.filled||e.extruded!==n.extruded)&&(null===(o=this.state.models)||void 0===o||o.forEach((t=>t.delete())),this.setState(this._getModels(this.context.gl)),r.invalidateAll())}updateGeometry(t){let{props:e,oldProps:n,changeFlags:i}=t;if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon)){const{polygonTesselator:t}=this.state,n=e.data.attributes||{};t.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:n.getPolygon,buffers:n,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:i.dataChanged}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),i.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(t){const{id:e,filled:n,extruded:i}=this.props;let r,o;if(n){const n=this.getShaders("top");n.defines.NON_INSTANCED_MODEL=1,r=new xd(t,{...n,id:"".concat(e,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(o=new xd(t,{...this.getShaders("side"),id:"".concat(e,"-side"),geometry:new Vm({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,r].filter(Boolean),topModel:r,sideModel:o}}calculateIndices(t){const{polygonTesselator:e}=this.state;t.startIndices=e.indexStarts,t.value=e.get("indices")}calculatePositions(t){const{polygonTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateVertexValid(t){t.value=this.state.polygonTesselator.get("vertexValid")}}function Lv(t,e,n,i){let r;if(Array.isArray(t[0])){const n=t.length*e;r=new Array(n);for(let i=0;i<t.length;i++)for(let n=0;n<e;n++)r[i*e+n]=t[i][n]||0}else r=t;return n?Jm(r,{size:e,gridResolution:n}):i?function(t,e){const{size:n=2,startIndex:i=0,endIndex:r=t.length,normalize:o=!0}=e||{},s=t.slice(i,r);hv(s,n,0,r-i);const a=Jm(s,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const l of a)dv(l,n);return a}(r,{size:e}):r}Ss(Mv,"defaultProps",Av),Ss(Mv,"layerName","SolidPolygonLayer");class Ov extends wv{constructor(t){super({...t,attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(t){return this.attributes[t]}getGeometryFromBuffer(t){return this.normalize?super.getGeometryFromBuffer(t):null}normalizeGeometry(t){return this.normalize?Lv(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}getGeometrySize(t){if(Rv(t)){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}const e=this.getPathLength(t);return e<2?0:this.isClosed(t)?e<3?0:e+2:e}updateGeometryAttributes(t,e){if(0!==e.geometrySize)if(t&&Rv(t))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t}else this._updateSegmentTypes(t,e),this._updatePositions(t,e)}_updateSegmentTypes(t,e){const n=this.attributes.segmentTypes,i=!!t&&this.isClosed(t),{vertexStart:r,geometrySize:o}=e;n.fill(0,r,r+o),i?(n[r]=4,n[r+o-2]=4):(n[r]+=1,n[r+o-2]+=2),n[r+o-1]=4}_updatePositions(t,e){const{positions:n}=this.attributes;if(!n||!t)return;const{vertexStart:i,geometrySize:r}=e,o=new Array(3);for(let s=i,a=0;a<r;s++,a++)this.getPointOnPath(t,a,o),n[3*s]=o[0],n[3*s+1]=o[1],n[3*s+2]=o[2]}getPathLength(t){return t.length/this.positionSize}getPointOnPath(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const{positionSize:i}=this;e*i>=t.length&&(e+=1-t.length/i);const r=e*i;return n[0]=t[r],n[1]=t[r+1],n[2]=3===i&&t[r+2]||0,n}isClosed(t){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:e}=this,n=t.length-e;return t[0]===t[n]&&t[1]===t[n+1]&&(2===e||t[2]===t[n+2])}}function Rv(t){return Array.isArray(t[0])}const Iv=[0,0,0,255],jv={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:Iv},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Fv={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class zv extends ym{constructor(){super(...arguments),Ss(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\n\n// calculate line join positions\nvec3 lineJoin(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  // side of the segment - -1: left, 0: center, 1: right\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n\n  // tangent of the corner\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  // direction of the corner\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  // direction of the segment\n  vec2 dir = isEnd ? dirA : dirB;\n  // direction of the extrusion\n  vec2 perp = isEnd ? perpA : perpB;\n  // length of the segment\n  float L = isEnd ? lenA : lenB;\n\n  // A = angle of the corner\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n\n  // -1: right, 1: left\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n\n  // relative position to the corner:\n  // -1: inside (smaller side of the angle)\n  // 0: center\n  // 1: outside (bigger side of the angle)\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  // trim if inside corner extends further than the line segment\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n\n  // special treatment for start cap and end cap\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n\n  // extend out a triangle to envelope the round cap\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n\n  // Generate variables for fragment shader\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return currPoint + offset;\n}\n\n// In clipspace extrusion, if a line extends behind the camera, clip it to avoid visual artifacts\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    // Extrude in clipspace\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 pos = lineJoin(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    // Extrude in commonspace\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec4 pos = vec4(\n      lineJoin(prevPosition, currPosition, nextPosition, width.xy),\n      1.0);\n    geometry.position = pos;\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\n/*\n * vPathPosition represents the relative coordinates of the current fragment on the path segment.\n * vPathPosition.x - position along the width of the path, between [-1, 1]. 0 is the center line.\n * vPathPosition.y - position along the length of the path, between [0, L / width].\n */\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    // if joint is rounded, test distance from the corner\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    // trim miter\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[km,Bm]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:Fv,accessor:"getPath",update:this.calculatePositions,noAlloc:true,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:true},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Fv,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:Fv,defaultValue:Iv},instancePickingColors:{size:3,type:5121,accessor:(t,e)=>{let{index:n,target:i}=e;return this.encodePickingColor(t&&t.__source?t.__source.index:n,i)}}}),this.setState({pathTesselator:new Ov({fp64:this.use64bitPositions()})})}updateState(t){super.updateState(t);const{props:e,changeFlags:n}=t,i=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:t}=this.state,r=e.data.attributes||{};t.updateGeometry({data:e.data,geometryBuffer:r.getPath,buffers:r,normalize:!e._pathType,loop:"loop"===e._pathType,getGeometry:e.getPath,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),n.dataChanged||i.invalidateAll()}if(n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),i.invalidateAll()}}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:i}=this.props;return i[0]&&i[0].__source&&(e.object=i.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}draw(t){let{uniforms:e}=t;const{jointRounded:n,capRounded:i,billboard:r,miterLimit:o,widthUnits:s,widthScale:a,widthMinPixels:l,widthMaxPixels:c}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(i),billboard:r,widthUnits:Zs[s],widthScale:a,miterLimit:o,widthMinPixels:l,widthMaxPixels:c}).draw()}_getModel(t){return new xd(t,{...this.getShaders(),id:this.props.id,geometry:new Vm({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateSegmentTypes(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("segmentTypes")}}function Nv(t){let{data:e,getIndex:n,dataRange:i,replace:r}=t;const{startRow:o=0,endRow:s=1/0}=i,a=e.length;let l=a,c=a;for(let d=0;d<a;d++){const t=n(e[d]);if(l>d&&t>=o&&(l=d),t>=s){c=d;break}}let u=l;const h=c-l!==r.length?e.slice(c):void 0;for(let d=0;d<r.length;d++)e[u++]=r[d];if(h){for(let t=0;t<h.length;t++)e[u++]=h[t];e.length=u}return{startRow:l,endRow:l+r.length}}Ss(zv,"defaultProps",jv),Ss(zv,"layerName","PathLayer");const Dv=[0,0,0,255],Bv={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:Dv},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class Uv extends bm{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&Gs.removed("getLineDashArray","PathStyleExtension")()}updateState(t){let{changeFlags:e}=t;const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const t=this.state.paths.slice(),n=e.dataChanged.map((e=>Nv({data:t,getIndex:t=>t.__source.index,dataRange:e,replace:this._getPaths(e)})));this.setState({paths:t,pathsDiff:n})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{data:e,getPolygon:n,positionFormat:i,_normalize:r}=this.props,o=[],s="XY"===i?2:3,{startRow:a,endRow:l}=t,{iterable:c,objectInfo:u}=Fc(e,a,l);for(const h of c){u.index++;let t=n(h,u);r&&(t=_v(t,s));const{holeIndices:e}=t,i=t.positions||t;if(e)for(let n=0;n<=e.length;n++){const t=i.slice(e[n-1]||0,e[n]||i.length);o.push(this.getSubLayerRow({path:t},h,u.index))}else o.push(this.getSubLayerRow({path:i},h,u.index))}return o}renderLayers(){const{data:t,_dataDiff:e,stroked:n,filled:i,extruded:r,wireframe:o,_normalize:s,_windingOrder:a,elevationScale:l,transitions:c,positionFormat:u}=this.props,{lineWidthUnits:h,lineWidthScale:d,lineWidthMinPixels:f,lineWidthMaxPixels:p,lineJointRounded:g,lineMiterLimit:m,lineDashJustified:v}=this.props,{getFillColor:y,getLineColor:b,getLineWidth:_,getLineDashArray:w,getElevation:x,getPolygon:S,updateTriggers:P,material:E}=this.props,{paths:C,pathsDiff:T}=this.state,A=this.getSubLayerClass("fill",Mv),k=this.getSubLayerClass("stroke",zv),M=this.shouldRenderSubLayer("fill",C)&&new A({_dataDiff:e,extruded:r,elevationScale:l,filled:i,wireframe:o,_normalize:s,_windingOrder:a,getElevation:x,getFillColor:y,getLineColor:r&&o?b:Dv,material:E,transitions:c},this.getSubLayerProps({id:"fill",updateTriggers:P&&{getPolygon:P.getPolygon,getElevation:P.getElevation,getFillColor:P.getFillColor,lineColors:r&&o,getLineColor:P.getLineColor}}),{data:t,positionFormat:u,getPolygon:S});return[!r&&M,!r&&n&&this.shouldRenderSubLayer("stroke",C)&&new k({_dataDiff:T&&(()=>T),widthUnits:h,widthScale:d,widthMinPixels:f,widthMaxPixels:p,jointRounded:g,miterLimit:m,dashJustified:v,_pathType:"loop",transitions:c&&{getWidth:c.getLineWidth,getColor:c.getLineColor,getPath:c.getPolygon},getColor:this.getSubLayerAccessor(b),getWidth:this.getSubLayerAccessor(_),getDashArray:this.getSubLayerAccessor(w)},this.getSubLayerProps({id:"stroke",updateTriggers:P&&{getWidth:P.getLineWidth,getColor:P.getLineColor,getDashArray:P.getLineDashArray}}),{data:C,positionFormat:u,getPath:t=>t.path}),r&&M]}}Ss(Uv,"layerName","PolygonLayer"),Ss(Uv,"defaultProps",Bv);const Vv=(0,t.createContext)(null),Wv=e=>{let{children:n}=e;const{parcelsData:r}=_(),{parcelId:o,setParcelId:s}=h(),{parcelAreaFrom:a,parcelAreaTo:l}=rr(),{builtAreaFrom:c,builtAreaTo:u}=Wr(),{parcelsProperties:d,setParcelLongitude:f,setParcelLatitude:p}=$o(),{activeLots:g}=bs();(0,t.useEffect)((()=>{r&&(()=>{const t=r.filter((t=>t.id===o)),e=t.length>0?t[0].centroid:null;e&&f(e.coordinates[0]),e&&p(e.coordinates[1])})()}),[o,r]);const m=r&&r.filter((t=>t.area>a&&t.area<l&&t.constructed_area>=c&&t.constructed_area<=u)),v=r&&new Uv({id:"parcels-layer",data:m,pickable:!0,getLineWidth:1,getLineColor:t=>[126,126,132,180],highlightColor:[172,208,56,50],autoHighlight:!0,getPolygon:t=>t.geometry.coordinates[0],getFillColor:t=>t.id===o?[126,126,132,255]:t.id in d?[172,208,56,50]:(t.constructed_area,[126,126,132,155]),updateTriggers:{getFillColor:[a,l,c,u,o],getLineColor:[a,l,c,u,o]},onClick:t=>{const e=t.object.id;s(e)},parameters:{depthTest:!1},visible:g});return(0,i.jsx)(Vv.Provider,{value:{parcelsLayer:v},children:n})};Vv.displayName="ParcelsContext";const{_parseImageNode:Hv}=globalThis,Gv="undefined"!==typeof Image,Xv="undefined"!==typeof ImageBitmap,qv=Boolean(Hv),Zv=!!hg||qv;function Yv(t){const e=Qv(t);if(!e)throw new Error("Not an image");return e}function Kv(t){switch(Yv(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function Qv(t){return"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!==typeof Image&&t instanceof Image?"image":t&&"object"===typeof t&&t.data&&t.width&&t.height?"data":null}const $v=/^data:image\/svg\+xml/,Jv=/\.svg((\?|#).*)?$/;function ty(t){return t&&($v.test(t)||Jv.test(t))}function ey(t,e){if(ty(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function ny(t,e,n){const i=function(t,e){if(ty(e)){let e=(new TextDecoder).decode(t);try{"function"===typeof unescape&&"function"===typeof encodeURIComponent&&(e=unescape(encodeURIComponent(e)))}catch(n){throw new Error(n.message)}return"data:image/svg+xml;base64,".concat(btoa(e))}return ey(t,e)}(t,n),r=self.URL||self.webkitURL,o="string"!==typeof i&&r.createObjectURL(i);try{return await async function(t,e){const n=new Image;if(n.src=t,e.image&&e.image.decode&&n.decode)return await n.decode(),n;return await new Promise(((e,i)=>{try{n.onload=()=>e(n),n.onerror=e=>i(new Error("Could not load image ".concat(t,": ").concat(e)))}catch(r){i(r)}}))}(o||i,e)}finally{o&&r.revokeObjectURL(o)}}const iy={};let ry=!0;async function oy(t,e,n){let i;if(ty(n)){i=await ny(t,e,n)}else i=ey(t,n);const r=e&&e.imagebitmap;return await async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(t){for(const e in t||iy)return!1;return!0}(e)&&ry||(e=null);if(e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),ry=!1}return await createImageBitmap(t)}(i,r)}function sy(t){return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=function(t){return[...t].map((t=>t.charCodeAt(0)))}(e);for(let r=0;r<i.length;++r)if(i[r]!==t[r+n])return!1;return!0}(t,"ftyp",4)?0===(96&t[8])?null:function(t){switch(function(t,e,n){return String.fromCharCode(...t.slice(e,n))}(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}(t):null}const ay=!1,ly=!0;function cy(t){const e=uy(t);return function(t){const e=uy(t),n=e.byteLength>=24&&2303741511===e.getUint32(0,ay);if(!n)return null;return{mimeType:"image/png",width:e.getUint32(16,ay),height:e.getUint32(20,ay)}}(e)||function(t){const e=uy(t),n=e.byteLength>=3&&65496===e.getUint16(0,ay)&&255===e.getUint8(2);if(!n)return null;const{tableMarkers:i,sofMarkers:r}=function(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);const e=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:t,sofMarkers:e}}();let o=2;for(;o+9<e.byteLength;){const t=e.getUint16(o,ay);if(r.has(t))return{mimeType:"image/jpeg",height:e.getUint16(o+5,ay),width:e.getUint16(o+7,ay)};if(!i.has(t))return null;o+=2,o+=e.getUint16(o,ay)}return null}(e)||function(t){const e=uy(t),n=e.byteLength>=10&&1195984440===e.getUint32(0,ay);if(!n)return null;return{mimeType:"image/gif",width:e.getUint16(6,ly),height:e.getUint16(8,ly)}}(e)||function(t){const e=uy(t),n=e.byteLength>=14&&16973===e.getUint16(0,ay)&&e.getUint32(2,ly)===e.byteLength;if(!n)return null;return{mimeType:"image/bmp",width:e.getUint32(18,ly),height:e.getUint32(22,ly)}}(e)||function(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=sy(e);if(!n)return null;return{mimeType:n.mimeType,width:0,height:0}}(e)}function uy(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}const hy={id:"image",module:"images",name:"Images",version:"3.4.15",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:async function(t,e,n){const i=((e=e||{}).image||{}).type||"auto",{url:r}=n||{},o=function(t){switch(t){case"auto":case"data":return function(){if(Xv)return"imagebitmap";if(Gv)return"image";if(Zv)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return Xv||Gv||Zv;case"imagebitmap":return Xv;case"image":return Gv;case"data":return Zv;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}(t),t}}(i);let s;switch(o){case"imagebitmap":s=await oy(t,e,r);break;case"image":s=await ny(t,e,r);break;case"data":s=await async function(t,e){const{mimeType:n}=cy(t)||{},i=globalThis._parseImageNode;return Yp(i),await i(t,n)}(t);break;default:Yp(!1)}return"data"===i&&(s=Kv(s)),s},tests:[t=>Boolean(cy(new DataView(t)))],options:{image:{type:"auto",decode:!0}}},dy=()=>{},fy={10241:9987,10240:9729,10242:33071,10243:33071};function py(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function gy(t,e,n,i){return n===e.width&&i===e.height?e:(t.canvas.height=i,t.canvas.width=n,t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(e,0,0,e.width,e.height,0,0,n,i),t.canvas)}function my(t){return t&&(t.id||t.url)}function vy(t,e,n){const i=t.width,r=t.height,o=Gl(t,{width:e,height:n});return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:o=0,targetInternalFormat:s=6408}=n;let{targetX:a,targetY:l,targetZ:c,width:u,height:h}=n;const{framebuffer:d,deleteFramebuffer:f}=Yl(t);tl(d);const{gl:p,handle:g}=d,m="undefined"!==typeof a||"undefined"!==typeof l||"undefined"!==typeof c;a=a||0,l=l||0,c=c||0;const v=p.bindFramebuffer(36160,g);tl(e);let y=null;if(e instanceof Tl&&(y=e,u=Number.isFinite(u)?u:y.width,h=Number.isFinite(h)?h:y.height,y.bind(0),e=y.target),m)switch(e){case 3553:case 34067:p.copyTexSubImage2D(e,o,a,l,i,r,u,h);break;case 35866:case 32879:oa(p).copyTexSubImage3D(e,o,a,l,c,i,r,u,h)}else p.copyTexImage2D(e,o,s,i,r,u,h,0);y&&y.unbind(),p.bindFramebuffer(36160,v||null),f&&d.delete()}(t,o,{targetY:0,width:i,height:r}),t.delete(),o}function yy(t,e,n){for(let i=0;i<e.length;i++){const{icon:r,xOffset:o}=e[i];t[my(r)]={...r,x:o,y:n}}}class by{constructor(t,e){let{onUpdate:n=dy,onError:i=dy}=e;Ss(this,"gl",void 0),Ss(this,"onUpdate",void 0),Ss(this,"onError",void 0),Ss(this,"_loadOptions",null),Ss(this,"_texture",null),Ss(this,"_externalTexture",null),Ss(this,"_mapping",{}),Ss(this,"_pendingCount",0),Ss(this,"_autoPacking",!1),Ss(this,"_xOffset",0),Ss(this,"_yOffset",0),Ss(this,"_rowHeight",0),Ss(this,"_buffer",4),Ss(this,"_canvasWidth",1024),Ss(this,"_canvasHeight",0),Ss(this,"_canvas",null),this.gl=t,this.onUpdate=n,this.onError=i}finalize(){var t;null===(t=this._texture)||void 0===t||t.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(t){const e=this._autoPacking?my(t):t;return this._mapping[e]||{}}setProps(t){let{loadOptions:e,autoPacking:n,iconAtlas:i,iconMapping:r}=t;var o;(e&&(this._loadOptions=e),void 0!==n&&(this._autoPacking=n),r&&(this._mapping=r),i)&&(null===(o=this._texture)||void 0===o||o.delete(),this._texture=null,this._externalTexture=i)}get isLoaded(){return 0===this._pendingCount}packIcons(t,e){if(!this._autoPacking||"undefined"===typeof document)return;const n=Object.values(function(t,e,n){if(!t||!e)return null;n=n||{};const i={},{iterable:r,objectInfo:o}=Fc(t);for(const s of r){o.index++;const t=e(s,o),r=my(t);if(!t)throw new Error("Icon is missing.");if(!t.url)throw new Error("Icon url is missing.");i[r]||n[r]&&t.url===n[r].url||(i[r]={...t,source:s,sourceIndex:o.index})}return i}(t,e,this._mapping)||{});if(n.length>0){const{mapping:t,xOffset:e,yOffset:i,rowHeight:r,canvasHeight:o}=function(t){let{icons:e,buffer:n,mapping:i={},xOffset:r=0,yOffset:o=0,rowHeight:s=0,canvasWidth:a}=t,l=[];for(let c=0;c<e.length;c++){const t=e[c];if(!i[my(t)]){const{height:e,width:c}=t;r+c+n>a&&(yy(i,l,o),r=0,o=s+o+n,s=0,l=[]),l.push({icon:t,xOffset:r}),r=r+c+n,s=Math.max(s,e)}}return l.length>0&&yy(i,l,o),{mapping:i,rowHeight:s,xOffset:r,yOffset:o,canvasWidth:a,canvasHeight:py(s+o+n)}}({icons:n,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=r,this._mapping=t,this._xOffset=e,this._yOffset=i,this._canvasHeight=o,this._texture||(this._texture=new kl(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:fy})),this._texture.height!==this._canvasHeight&&(this._texture=vy(this._texture,this._canvasWidth,this._canvasHeight)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(n)}}_loadIcons(t){const e=this._canvas.getContext("2d");for(const n of t)this._pendingCount++,dm(n.url,hy,this._loadOptions).then((t=>{const i=my(n),{x:r,y:o,width:s,height:a}=this._mapping[i],l=gy(e,t,s,a);this._texture.setSubImageData({data:l,x:r,y:o,width:s,height:a}),this._texture.generateMipmap(),this.onUpdate()})).catch((t=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:t})})).finally((()=>{this._pendingCount--}))}}const _y=[0,0,0,255],wy={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:_y},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};class xy extends ym{constructor(){super(...arguments),Ss(this,"state",void 0)}getShaders(){return super.getShaders({vs:'#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  // convert size in meters to pixels, then scaled and clamp\n \n  // project meters to pixels and clamp to limits \n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n\n  // scale icon height to match instanceSize\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n\n  // scale and rotate vertex in "pixel" value and convert back to fraction in clipspace\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n',fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n\n  // if colorMode == 0, use pixel color from the texture\n  // if colorMode == 1 or rendering picking buffer, use texture as transparency mask\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  // Take the global opacity and the alpha from vColor into account for the alpha component\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[km,Bm]})}initializeState(){this.state={iconManager:new by(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})};this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:_y},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:i}=t,r=this.getAttributeManager(),{iconAtlas:o,iconMapping:s,data:a,getIcon:l}=e,{iconManager:c}=this.state,u=o||this.internalState.isAsyncPropLoading("iconAtlas");if(c.setProps({loadOptions:e.loadOptions,autoPacking:!u,iconAtlas:o,iconMapping:u?s:null}),u?n.iconMapping!==e.iconMapping&&r.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&c.packIcons(a,l),i.extensionsChanged){var h;const{gl:t}=this.context;null===(h=this.state.model)||void 0===h||h.delete(),this.state.model=this._getModel(t),r.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(t){super.finalizeState(t),this.state.iconManager.finalize()}draw(t){let{uniforms:e}=t;const{sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,sizeUnits:o,billboard:s,alphaCutoff:a}=this.props,{iconManager:l}=this.state,c=l.getTexture();c&&this.state.model.setUniforms(e).setUniforms({iconsTexture:c,iconsTextureDim:[c.width,c.height],sizeUnits:Zs[o],sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,billboard:s,alphaCutoff:a}).draw()}_getModel(t){return new xd(t,{...this.getShaders(),id:this.props.id,geometry:new Vm({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(t){var e;const n=null===(e=this.getCurrentLayer())||void 0===e?void 0:e.props.onIconError;n?n(t):Gs.error(t.error.message)()}getInstanceOffset(t){const{width:e,height:n,anchorX:i=e/2,anchorY:r=n/2}=this.state.iconManager.getIconMapping(t);return[e/2-i,n/2-r]}getInstanceColorMode(t){return this.state.iconManager.getIconMapping(t).mask?1:0}getInstanceIconFrame(t){const{x:e,y:n,width:i,height:r}=this.state.iconManager.getIconMapping(t);return[e,n,i,r]}}Ss(xy,"defaultProps",wy),Ss(xy,"layerName","IconLayer");const Sy=[0,0,0,255],Py={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:Sy},getLineColor:{type:"accessor",value:Sy},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class Ey extends ym{getShaders(){return super.getShaders({vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool antialiasing;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  // Multiply out radius and clamp to limits\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  \n  // Multiply out line width and clamp to limits\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n\n  // outer radius needs to offset by half stroke width\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n\n  // Expand geometry to accomodate edge smoothing\n  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\n\n  // position on the containing square in [-1, 1] space\n  unitPosition = edgePadding * positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = edgePadding * positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n  }\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Apply opacity to instance color, or return instance picking color\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[km,Bm]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){if(super.updateState(t),t.changeFlags.extensionsChanged){var e;const{gl:t}=this.context;null===(e=this.state.model)||void 0===e||e.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw(t){let{uniforms:e}=t;const{radiusUnits:n,radiusScale:i,radiusMinPixels:r,radiusMaxPixels:o,stroked:s,filled:a,billboard:l,antialiasing:c,lineWidthUnits:u,lineWidthScale:h,lineWidthMinPixels:d,lineWidthMaxPixels:f}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:s?1:0,filled:a,billboard:l,antialiasing:c,radiusUnits:Zs[n],radiusScale:i,radiusMinPixels:r,radiusMaxPixels:o,lineWidthUnits:Zs[u],lineWidthScale:h,lineWidthMinPixels:d,lineWidthMaxPixels:f}).draw()}_getModel(t){return new xd(t,{...this.getShaders(),id:this.props.id,geometry:new Vm({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0})}}Ss(Ey,"defaultProps",Py),Ss(Ey,"layerName","ScatterplotLayer");const Cy=[];class Ty extends xy{constructor(){super(...arguments),Ss(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n\n    // if enable sdf (signed distance fields)\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n\n    // Take the global opacity and the alpha from color into account for the alpha component\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"}}initializeState(){super.initializeState();this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(t,e)=>{let{index:n,target:i}=e;return this.encodePickingColor(n,i)}}})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;let{outlineColor:i}=e;i!==n.outlineColor&&(i=i.map((t=>t/255)),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!e.sdf&&e.outlineWidth&&Gs.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(t){const{sdf:e,smoothing:n,outlineWidth:i}=this.props,{outlineColor:r}=this.state;t.uniforms={...t.uniforms,buffer:.75,outlineBuffer:i?Math.max(n,.75*(1-i)):-1,gamma:n,sdf:Boolean(e),outlineColor:r},super.draw(t)}getInstanceOffset(t){return t?Array.from(t).flatMap((t=>super.getInstanceOffset(t))):Cy}getInstanceColorMode(t){return 1}getInstanceIconFrame(t){return t?Array.from(t).flatMap((t=>super.getInstanceIconFrame(t))):Cy}}Ss(Ty,"defaultProps",{getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}}),Ss(Ty,"layerName","MultiIconLayer");var Ay=n(331),ky=n.n(Ay);const My=32,Ly=[];function Oy(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function Ry(t,e,n,i){let r=0;for(let s=e;s<n;s++){var o;r+=(null===(o=i[t[s]])||void 0===o?void 0:o.width)||0}return r}function Iy(t,e,n,i,r,o){let s=e,a=0;for(let l=e;l<n;l++){const e=Ry(t,l,l+1,r);a+e>i&&(s<l&&o.push(l),s=l,a=0),a+=e}return a}function jy(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0;void 0===o&&(o=t.length);const s=[];return"break-all"===e?Iy(t,r,o,n,i,s):function(t,e,n,i,r,o){let s=e,a=e,l=e,c=0;for(let u=e;u<n;u++)if(" "===t[u]?l=u+1:" "!==t[u+1]&&u+1!==n||(l=u+1),l>a){let e=Ry(t,a,l,r);c+e>i&&(s<a&&(o.push(a),s=a,c=0),e>i&&(e=Iy(t,a,l,i,r,o),s=o[o.length-1])),a=l,c+=e}}(t,r,o,n,i,s),s}function Fy(t,e,n,i,r,o){let s=0,a=0;for(let l=e;l<n;l++){const e=t[l],n=i[e];n?(a||(a=n.height),r[l]=s+n.width/2,s+=n.width):(Gs.warn("Missing character: ".concat(e," (").concat(e.codePointAt(0),")"))(),r[l]=s,s+=My)}o[0]=s,o[1]=a}function zy(t,e,n,i,r){const o=Array.from(t),s=o.length,a=new Array(s),l=new Array(s),c=new Array(s),u=("break-word"===n||"break-all"===n)&&isFinite(i)&&i>0,h=[0,0],d=[0,0];let f=0,p=0,g=0;for(let m=0;m<=s;m++){const t=o[m];if("\n"!==t&&m!==s||(g=m),g>p){const t=u?jy(o,n,i,r,p,g):Ly;for(let n=0;n<=t.length;n++){const i=0===n?p:t[n-1],s=n<t.length?t[n]:g;Fy(o,i,s,r,a,d);for(let t=i;t<s;t++)l[t]=f+d[1]/2,c[t]=d[0];f+=d[1]*e,h[0]=Math.max(h[0],d[0])}p=g}"\n"===t&&(a[p]=0,l[p]=0,c[p]=0,p++)}return h[1]=f,{x:a,y:l,rowWidth:c,size:h}}class Ny{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;Ss(this,"limit",void 0),Ss(this,"_cache",{}),Ss(this,"_order",[]),this.limit=t}get(t){const e=this._cache[t];return e&&(this._deleteOrder(t),this._appendOrder(t)),e}set(t,e){this._cache[t]?(this.delete(t),this._cache[t]=e,this._appendOrder(t)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[t]=e,this._appendOrder(t))}delete(t){this._cache[t]&&(delete this._cache[t],this._deleteOrder(t))}_deleteOrder(t){const e=this._order.indexOf(t);e>=0&&this._order.splice(e,1)}_appendOrder(t){this._order.push(t)}}const Dy={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},By=3;let Uy=new Ny(By);function Vy(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function Wy(t,e,n,i){t.font="".concat(i," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}class Hy{constructor(){Ss(this,"props",{...Dy}),Ss(this,"_key",void 0),Ss(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return 1.2}setProps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this.props,t);const e=this._key;this._key=this._getKey();const n=function(t,e){let n;n="string"===typeof e?new Set(Array.from(e)):new Set(e);const i=Uy.get(t);if(!i)return n;for(const r in i.mapping)n.has(r)&&n.delete(r);return n}(this._key,this.props.characterSet),i=Uy.get(this._key);if(i&&0===n.size)return void(this._key!==e&&(this._atlas=i));const r=this._generateFontAtlas(this._key,n,i);this._atlas=r,Uy.set(this._key,r)}_generateFontAtlas(t,e,n){const{fontFamily:i,fontWeight:r,fontSize:o,buffer:s,sdf:a,radius:l,cutoff:c}=this.props;let u=n&&n.data;u||(u=document.createElement("canvas"),u.width=1024);const h=u.getContext("2d");Wy(h,i,o,r);const{mapping:d,canvasHeight:f,xOffset:p,yOffset:g}=function(t){let{characterSet:e,getFontWidth:n,fontHeight:i,buffer:r,maxCanvasWidth:o,mapping:s={},xOffset:a=0,yOffset:l=0}=t,c=0,u=a;for(const d of e)if(!s[d]){const t=n(d);u+t+2*r>o&&(u=0,c++),s[d]={x:u+r,y:l+c*(i+2*r)+r,width:t,height:i},u+=t+2*r}const h=i+2*r;return{mapping:s,xOffset:u,yOffset:l+c*h,canvasHeight:Oy(l+(c+1)*h)}}({getFontWidth:t=>h.measureText(t).width,fontHeight:1.2*o,buffer:s,characterSet:e,maxCanvasWidth:1024,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(u.height!==f){const t=h.getImageData(0,0,u.width,u.height);u.height=f,h.putImageData(t,0,0)}if(Wy(h,i,o,r),a){const t=new(ky())(o,s,l,c,i,r),n=h.getImageData(0,0,t.size,t.size);for(const i of e)Vy(t.draw(i),n),h.putImageData(n,d[i].x-s,d[i].y+s)}else for(const m of e)h.fillText(m,d[m].x,d[m].y+.9*o);return{xOffset:p,yOffset:g,mapping:d,data:u,width:u.width,height:u.height}}_getKey(){const{fontFamily:t,fontWeight:e,fontSize:n,buffer:i,sdf:r,radius:o,cutoff:s}=this.props;return r?"".concat(t," ").concat(e," ").concat(n," ").concat(i," ").concat(o," ").concat(s):"".concat(t," ").concat(e," ").concat(n," ").concat(i)}}const Gy={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class Xy extends ym{constructor(){super(...arguments),Ss(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n\n  // convert size in meters to pixels, then scaled and clamp\n\n  // project meters to pixels and clamp to limits\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Apply opacity to instance color, or return instance picking color\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[km,Bm]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){super.updateState(t);const{changeFlags:e}=t;if(e.extensionsChanged){var n;const{gl:t}=this.context;null===(n=this.state.model)||void 0===n||n.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw(t){let{uniforms:e}=t;const{billboard:n,sizeScale:i,sizeUnits:r,sizeMinPixels:o,sizeMaxPixels:s,getLineWidth:a}=this.props;let{padding:l}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:Boolean(a),padding:l,sizeUnits:Zs[r],sizeScale:i,sizeMinPixels:o,sizeMaxPixels:s}).draw()}_getModel(t){return new xd(t,{...this.getShaders(),id:this.props.id,geometry:new Vm({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0})}}Ss(Xy,"defaultProps",Gy),Ss(Xy,"layerName","TextBackgroundLayer");const qy={start:1,middle:0,end:-1},Zy={top:1,center:0,bottom:-1},Yy=[0,0,0,255],Ky={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Yy},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:Dy.characterSet},fontFamily:Dy.fontFamily,fontWeight:Dy.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Yy},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Yy},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class Qy extends bm{constructor(){super(...arguments),Ss(this,"state",void 0),Ss(this,"getBoundingRect",((t,e)=>{const n=this.state.fontAtlasManager.mapping,i=this.state.getText,{wordBreak:r,maxWidth:o,lineHeight:s,getTextAnchor:a,getAlignmentBaseline:l}=this.props,c=i(t,e)||"",{size:[u,h]}=zy(c,s,r,o,n);return[(qy["function"===typeof a?a(t,e):a]-1)*u/2,(Zy["function"===typeof l?l(t,e):l]-1)*h/2,u,h]})),Ss(this,"getIconOffsets",((t,e)=>{const n=this.state.fontAtlasManager.mapping,i=this.state.getText,{wordBreak:r,maxWidth:o,lineHeight:s,getTextAnchor:a,getAlignmentBaseline:l}=this.props,c=i(t,e)||"",{x:u,y:h,rowWidth:d,size:[f,p]}=zy(c,s,r,o,n),g=qy["function"===typeof a?a(t,e):a],m=Zy["function"===typeof l?l(t,e):l],v=u.length,y=new Array(2*v);let b=0;for(let _=0;_<v;_++){const t=(1-g)*(f-d[_])/2;y[b++]=(g-1)*f/2+t+u[_],y[b++]=(m-1)*p/2+h[_]}return y}))}initializeState(){this.state={styleVersion:0,fontAtlasManager:new Hy}}updateState(t){const{props:e,oldProps:n,changeFlags:i}=t;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText();(this._updateFontAtlas()||e.lineHeight!==n.lineHeight||e.wordBreak!==n.wordBreak||e.maxWidth!==n.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo(t){let{info:e}=t;return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:t,fontFamily:e,fontWeight:n}=this.props,{fontAtlasManager:i,characterSet:r}=this.state,o={...t,characterSet:r,fontFamily:e,fontWeight:n};if(!i.mapping)return i.setProps(o),!0;for(const s in o)if(o[s]!==i.props[s])return i.setProps(o),!0;return!1}_updateText(){var t;const{data:e,characterSet:n}=this.props,i=null===(t=e.attributes)||void 0===t?void 0:t.getText;let r,{getText:o}=this.props,s=e.startIndices;const a="auto"===n&&new Set;if(i&&s){const{texts:t,characterCount:n}=function(t){let{value:e,length:n,stride:i,offset:r,startIndices:o,characterSet:s}=t;const a=e.BYTES_PER_ELEMENT,l=i?i/a:1,c=r?r/a:0,u=o[n]||Math.ceil((e.length-c)/l),h=s&&new Set,d=new Array(n);let f=e;if(l>1||c>0){f=new(0,e.constructor)(u);for(let t=0;t<u;t++)f[t]=e[t*l+c]}for(let p=0;p<n;p++){const t=o[p],e=o[p+1]||u,n=f.subarray(t,e);d[p]=String.fromCodePoint.apply(null,n),h&&n.forEach(h.add,h)}if(h)for(const p of h)s.add(String.fromCodePoint(p));return{texts:d,characterCount:u}}({...ArrayBuffer.isView(i)?{value:i}:i,length:e.length,startIndices:s,characterSet:a});r=n,o=(e,n)=>{let{index:i}=n;return t[i]}}else{const{iterable:t,objectInfo:n}=Fc(e);s=[0],r=0;for(const e of t){n.index++;const t=Array.from(o(e,n)||"");a&&t.forEach(a.add,a),r+=t.length,s.push(r)}}this.setState({getText:o,startIndices:s,numInstances:r,characterSet:a||n})}renderLayers(){const{startIndices:t,numInstances:e,getText:n,fontAtlasManager:{scale:i,texture:r,mapping:o},styleVersion:s}=this.state,{data:a,_dataDiff:l,getPosition:c,getColor:u,getSize:h,getAngle:d,getPixelOffset:f,getBackgroundColor:p,getBorderColor:g,getBorderWidth:m,backgroundPadding:v,background:y,billboard:b,fontSettings:_,outlineWidth:w,outlineColor:x,sizeScale:S,sizeUnits:P,sizeMinPixels:E,sizeMaxPixels:C,transitions:T,updateTriggers:A}=this.props,k=this.getSubLayerClass("characters",Ty),M=this.getSubLayerClass("background",Xy);return[y&&new M({getFillColor:p,getLineColor:g,getLineWidth:m,padding:v,getPosition:c,getSize:h,getAngle:d,getPixelOffset:f,billboard:b,sizeScale:S/this.state.fontAtlasManager.props.fontSize,sizeUnits:P,sizeMinPixels:E,sizeMaxPixels:C,transitions:T&&{getPosition:T.getPosition,getAngle:T.getAngle,getSize:T.getSize,getFillColor:T.getBackgroundColor,getLineColor:T.getBorderColor,getLineWidth:T.getBorderWidth,getPixelOffset:T.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:A.getPosition,getAngle:A.getAngle,getSize:A.getSize,getFillColor:A.getBackgroundColor,getLineColor:A.getBorderColor,getLineWidth:A.getBorderWidth,getPixelOffset:A.getPixelOffset,getBoundingRect:{getText:A.getText,getTextAnchor:A.getTextAnchor,getAlignmentBaseline:A.getAlignmentBaseline,styleVersion:s}}}),{data:a.attributes&&a.attributes.background?{length:a.length,attributes:a.attributes.background}:a,_dataDiff:l,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new k({sdf:_.sdf,smoothing:Number.isFinite(_.smoothing)?_.smoothing:Dy.smoothing,outlineWidth:w,outlineColor:x,iconAtlas:r,iconMapping:o,getPosition:c,getColor:u,getSize:h,getAngle:d,getPixelOffset:f,billboard:b,sizeScale:S*i,sizeUnits:P,sizeMinPixels:E*i,sizeMaxPixels:C*i,transitions:T&&{getPosition:T.getPosition,getAngle:T.getAngle,getColor:T.getColor,getSize:T.getSize,getPixelOffset:T.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:A.getText,getPosition:A.getPosition,getAngle:A.getAngle,getColor:A.getColor,getSize:A.getSize,getPixelOffset:A.getPixelOffset,getIconOffsets:{getText:A.getText,getTextAnchor:A.getTextAnchor,getAlignmentBaseline:A.getAlignmentBaseline,styleVersion:s}}}),{data:a,_dataDiff:l,startIndices:t,numInstances:e,getIconOffsets:this.getIconOffsets,getIcon:n})]}static set fontAtlasCacheLimit(t){!function(t){Gs.assert(Number.isFinite(t)&&t>=By,"Invalid cache limit"),Uy=new Ny(t)}(t)}}Ss(Qy,"defaultProps",Ky),Ss(Qy,"layerName","TextLayer");const $y={circle:{type:Ey,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:xy,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:Qy,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Jy={type:zv,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},tb={type:Mv,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function eb(t){let{type:e,props:n}=t;const i={};for(const r in n)i[r]=e.defaultProps[n[r]];return i}function nb(t,e){const{transitions:n,updateTriggers:i}=t.props,r={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const o in e){const s=e[o];let a=t.props[o];o.startsWith("get")&&(a=t.getSubLayerAccessor(a),r.updateTriggers[s]=i[o],n&&(r.transitions[s]=n[o])),r[s]=a}return r}function ib(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:r=0,endRow:o=t.length}=n;for(let s=r;s<o;s++){const n=t[s];Gs.assert(n&&n.geometry,"GeoJSON does not have geometry");const{geometry:r}=n;if("GeometryCollection"===r.type){Gs.assert(Array.isArray(r.geometries),"GeoJSON does not have geometries array");const{geometries:t}=r;for(let r=0;r<t.length;r++){rb(t[r],i,e,n,s)}}else rb(r,i,e,n,s)}return i}function rb(t,e,n,i,r){const{type:o,coordinates:s}=t,{pointFeatures:a,lineFeatures:l,polygonFeatures:c,polygonOutlineFeatures:u}=e;if(function(t,e){let n=ob[t];Gs.assert(n,"Unknown GeoJSON type ".concat(t));for(;e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}(o,s))switch(o){case"Point":a.push(n({geometry:t},i,r));break;case"MultiPoint":s.forEach((t=>{a.push(n({geometry:{type:"Point",coordinates:t}},i,r))}));break;case"LineString":l.push(n({geometry:t},i,r));break;case"MultiLineString":s.forEach((t=>{l.push(n({geometry:{type:"LineString",coordinates:t}},i,r))}));break;case"Polygon":c.push(n({geometry:t},i,r)),s.forEach((t=>{u.push(n({geometry:{type:"LineString",coordinates:t}},i,r))}));break;case"MultiPolygon":s.forEach((t=>{c.push(n({geometry:{type:"Polygon",coordinates:t}},i,r)),t.forEach((t=>{u.push(n({geometry:{type:"LineString",coordinates:t}},i,r))}))}))}else Gs.warn("".concat(o," coordinates are malformed"))()}const ob={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function sb(t){return t.geometry.coordinates}function ab(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:i,lines:r,polygons:o}=t,s=function(t,e){const n={points:null,lines:null,polygons:null};for(const i in n){const r=t[i].globalFeatureIds.value;n[i]=new Uint8ClampedArray(3*r.length);const o=[];for(let t=0;t<r.length;t++)e(r[t],o),n[i][3*t+0]=o[0],n[i][3*t+1]=o[1],n[i][3*t+2]=o[2]}return n}(t,e);return n.points.data={length:i.positions.value.length/i.positions.size,attributes:{...i.attributes,getPosition:i.positions,instancePickingColors:{size:3,value:s.points}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:{...r.attributes,getPath:r.positions,instancePickingColors:{size:3,value:s.lines}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{...o.attributes,getPolygon:o.positions,pickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{...o.attributes,getPath:o.positions,instancePickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}const lb=["points","linestrings","polygons"],cb={...eb($y.circle),...eb($y.icon),...eb($y.text),...eb(Jy),...eb(tb),stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class ub extends bm{initializeState(){this.state={layerProps:{},features:{}}}updateState(t){let{props:e,changeFlags:n}=t;if(!n.dataChanged)return;const{data:i}=this.props,r=i&&"points"in i&&"polygons"in i&&"lines"in i;this.setState({binary:r}),r?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary(t){let{props:e,changeFlags:n}=t;const i=ab(e.data,this.encodePickingColor);this.setState({layerProps:i})}_updateStateJSON(t){let{props:e,changeFlags:n}=t;const i=function(t){if(Array.isArray(t))return t;switch(Gs.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return Gs.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}(e.data),r=this.getSubLayerRow.bind(this);let o={};const s={};if(Array.isArray(n.dataChanged)){const t=this.state.features;for(const e in t)o[e]=t[e].slice(),s[e]=[];for(const e of n.dataChanged){const n=ib(i,r,e);for(const i in t)s[i].push(Nv({data:o[i],getIndex:t=>t.__source.index,dataRange:e,replace:n[i]}))}}else o=ib(i,r);const a=function(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:i,lineFeatures:r,polygonFeatures:o,polygonOutlineFeatures:s}=t;return n.points.data=i,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=sb,n.lines.data=r,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=sb,n.polygons.data=o,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=sb,n.polygonsOutline.data=s,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=sb,n}(o,s);this.setState({features:o,featuresDiff:s,layerProps:a})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n,sourceLayer:i}=e;return e.featureType=lb.find((t=>i.id.startsWith("".concat(this.id,"-").concat(t,"-")))),n>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(e.index=this.props.data.points.globalFeatureIds.value[n]),e}_updateAutoHighlight(t){const e="".concat(this.id,"-points-"),n="points"===t.featureType;for(const i of this.getSubLayers())i.id.startsWith(e)===n&&i.updateAutoHighlight(t)}_renderPolygonLayer(){const{extruded:t,wireframe:e}=this.props,{layerProps:n}=this.state,i="polygons-fill",r=this.shouldRenderSubLayer(i,n.polygons.data)&&this.getSubLayerClass(i,tb.type);if(r){const o=nb(this,tb.props),s=t&&e;return s||delete o.getLineColor,o.updateTriggers.lineColors=s,new r(o,this.getSubLayerProps({id:i,updateTriggers:o.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:t,stroked:e}=this.props,{layerProps:n}=this.state,i="polygons-stroke",r="linestrings",o=!t&&e&&this.shouldRenderSubLayer(i,n.polygonsOutline.data)&&this.getSubLayerClass(i,Jy.type),s=this.shouldRenderSubLayer(r,n.lines.data)&&this.getSubLayerClass(r,Jy.type);if(o||s){const t=nb(this,Jy.props);return[o&&new o(t,this.getSubLayerProps({id:i,updateTriggers:t.updateTriggers}),n.polygonsOutline),s&&new s(t,this.getSubLayerProps({id:r,updateTriggers:t.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:t}=this.props,{layerProps:e,binary:n}=this.state;let{highlightedObjectIndex:i}=this.props;!n&&Number.isFinite(i)&&(i=e.points.data.findIndex((t=>t.__source.index===i)));const r=new Set(t.split("+")),o=[];for(const s of r){const t="points-".concat(s),r=$y[s],a=r&&this.shouldRenderSubLayer(t,e.points.data)&&this.getSubLayerClass(t,r.type);if(a){const l=nb(this,r.props);let c=e.points;if("text"===s&&n){const{instancePickingColors:t,...e}=c.data.attributes;c={...c,data:{...c.data,attributes:e}}}o.push(new a(l,this.getSubLayerProps({id:t,updateTriggers:l.updateTriggers,highlightedObjectIndex:i}),c))}}return o}renderLayers(){const{extruded:t}=this.props,e=this._renderPolygonLayer();return[!t&&e,this._renderLineLayers(),this._renderPointLayers(),t&&e]}getSubLayerAccessor(t){const{binary:e}=this.state;return e&&"function"===typeof t?(e,n)=>{const{data:i,index:r}=n,o=function(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,i=t.featureIds.value[n];return-1!==n?function(t,e,n){const i={properties:{...t.properties[e]}};for(const r in t.numericProps)i.properties[r]=t.numericProps[r].value[n];return i}(t,i,n):null}(i,r);return t(o,n)}:super.getSubLayerAccessor(t)}}Ss(ub,"layerName","GeoJsonLayer"),Ss(ub,"defaultProps",cb);const hb=(0,t.createContext)(null),db=t=>{let{children:e}=t;const{circleGeometry:n}=p(),{fillColor:r}=Ir(),o=r.replace("rgba(","").replace(")","").split(",");o[3]=20;const s=n&&new ub({id:"circle",data:n,getFillColor:o.map((t=>parseInt(t))),getLineColor:[126,126,132,80],parameters:{depthTest:!1},getLineWidth:1});return(0,i.jsx)(hb.Provider,{value:{circleLayer:s},children:e})};hb.displayName="CircleLayerContext";let fb=1,pb=1;class gb{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(t){const{delay:e=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:r=1}=t,o=fb++,s={time:0,delay:e,duration:n,rate:i,repeat:r};return this._setChannelTime(s,this.time),this.channels.set(o,s),o}removeChannel(t){this.channels.delete(t);for(const[e,n]of this.animations)n.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return void 0!==e&&this.time>=e.delay+e.duration*e.repeat}getTime(t){if(void 0===t)return this.time;const e=this.channels.get(t);return void 0===e?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const i of e)this._setChannelTime(i,this.time);const n=this.animations.values();for(const i of n){const{animation:t,channel:e}=i;t.setTime(this.getTime(e))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,e){const n=pb++;return this.animations.set(n,{animation:t,channel:e}),t.setTime(this.getTime(e)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const n=e-t.delay;n>=t.duration*t.repeat?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}}class mb{constructor(t,e,n){Ss(this,"id",void 0),Ss(this,"context",void 0),Ss(this,"isLoaded",void 0),Ss(this,"persistent",void 0),Ss(this,"_loadCount",0),Ss(this,"_subscribers",new Set),Ss(this,"_data",void 0),Ss(this,"_loader",void 0),Ss(this,"_error",void 0),Ss(this,"_content",void 0),this.id=t,this.context=n,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((()=>this.getData()))}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let i=t;"string"===typeof t&&(i=dm(t)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=t)})).catch((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=t||!0)}))):(this.isLoaded=!0,this._error=void 0,this._content=t);for(const r of this._subscribers)r.onChange(this.getData())}}class vb{constructor(t){let{gl:e,protocol:n}=t;Ss(this,"protocol",void 0),Ss(this,"_context",void 0),Ss(this,"_resources",void 0),Ss(this,"_consumers",void 0),Ss(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return!!t.startsWith(this.protocol)||t in this._resources}add(t){let{resourceId:e,data:n,forceUpdate:i=!1,persistent:r=!0}=t,o=this._resources[e];o?o.setData(n,i):(o=new mb(e,n,this._context),this._resources[e]=o),o.persistent=r}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe(t){let{consumerId:e}=t;const n=this._consumers[e];if(n){for(const t in n){const e=n[t],i=this._resources[e.resourceId];i&&i.unsubscribe(e)}delete this._consumers[e],this.prune()}}subscribe(t){let{resourceId:e,onChange:n,consumerId:i,requestId:r="default"}=t;const{_resources:o,protocol:s}=this;e.startsWith(s)&&(e=e.replace(s,""),o[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=o[e];if(this._track(i,r,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout((()=>this._prune()),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,i){const r=this._consumers,o=r[t]=r[t]||{},s=o[e]||{},a=s.resourceId&&this._resources[s.resourceId];a&&(a.unsubscribe(s),this.prune()),n&&(o[e]=s,s.onChange=i,s.resourceId=n.id,n.subscribe(s))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];e.persistent||e.inUse()||(e.delete(),delete this._resources[t])}}}const yb=[Am],bb=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function _b(t){const e=nd.getDefaultProgramManager(t);for(const n of yb)e.addDefaultModule(n);for(const n of bb)e.addShaderHook(n);return e}class wb{constructor(t){let{deck:e,stats:n,viewport:i,timeline:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ss(this,"layers",void 0),Ss(this,"context",void 0),Ss(this,"resourceManager",void 0),Ss(this,"_lastRenderedLayers",[]),Ss(this,"_needsRedraw",!1),Ss(this,"_needsUpdate",!1),Ss(this,"_nextLayers",null),Ss(this,"_debug",!1),Ss(this,"activateViewport",(t=>{tu("layerManager.activateViewport",this,t),t&&(this.context.viewport=t)})),this.layers=[],this.resourceManager=new vb({gl:t,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:t,deck:e,programManager:t&&_b(t),stats:n||new Qa({id:"deck.gl"}),viewport:i||new dp({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:r||new gb,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(t);e=e||i}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers(){let{layerIds:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t?this.layers.filter((e=>t.find((t=>0===e.id.indexOf(t))))):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){tu("layerManager.setLayers",this,e,t),this._lastRenderedLayers=t;const n=Dc(t,Boolean);for(const i of n)i.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this._lastRenderedLayers,t)),this._nextLayers=null}_handleError(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}_updateLayers(t,e){const n={};for(const o of t)n[o.id]?Gs.warn("Multiple old layers with same id ".concat(o.id))():n[o.id]=o;const i=[];this._updateSublayersRecursively(e,n,i),this._finalizeOldLayers(n);let r=!1;for(const o of i)if(o.hasUniformTransition()){r="Uniform transition in ".concat(o);break}this._needsUpdate=r,this.layers=i}_updateSublayersRecursively(t,e,n){for(const r of t){r.context=this.context;const t=e[r.id];null===t&&Gs.warn("Multiple new layers with same id ".concat(r.id))(),e[r.id]=null;let o=null;try{this._debug&&t!==r&&r.validateProps(),t?(this._transferLayerState(t,r),this._updateLayer(r)):this._initializeLayer(r),n.push(r),o=r.isComposite?r.getSubLayers():null}catch(i){this._handleError("matching",i,r)}o&&this._updateSublayersRecursively(o,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=zd}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle=Fd,e!==t&&(t.lifecycle=Nd)}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle=Dd;try{t._finalize(),t.lifecycle=Bd}catch(e){this._handleError("finalization",e,t)}}}class xb{constructor(t){Ss(this,"width",void 0),Ss(this,"height",void 0),Ss(this,"views",void 0),Ss(this,"viewState",void 0),Ss(this,"controllers",void 0),Ss(this,"timeline",void 0),Ss(this,"_viewports",void 0),Ss(this,"_viewportMap",void 0),Ss(this,"_isUpdating",void 0),Ss(this,"_needsRedraw",void 0),Ss(this,"_needsUpdate",void 0),Ss(this,"_eventManager",void 0),Ss(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers){const e=this.controllers[t];e&&e.finalize()}this.controllers={}}needsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter((e=>e.containsPixel(t))):this._viewports}getViews(){const t={};return this.views.forEach((e=>{t[e.id]=e})),t}getView(t){return this.views.find((e=>e.id===t))}getViewState(t){const e="string"===typeof t?this.getView(t):t,n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),i={x:t[0],y:t[1]};for(let r=n.length-1;r>=0;--r){const o=n[r];if(o.containsPixel(i)){const n=t.slice();return n[0]-=o.x,n[1]-=o.y,o.unproject(n,e)}}return null}setProps(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=Dc(t,Boolean);this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){if(t){!Sp(t,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=t}else Gs.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...e,viewId:t})}_createController(t,e){return new(0,e.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:e=>t.makeViewport({viewState:e,width:this.width,height:this.height})})}_updateController(t,e,n,i){const r=t.controller;if(r){const o={...e,...r,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height};return i||(i=this._createController(t,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:t}=this,e=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=t.length;i--;){const r=t[i],o=this.getViewState(r),s=r.makeViewport({viewState:o,width:this.width,height:this.height});let a=e[r.id];const l=Boolean(r.controller);l&&!a&&(n=!0),!n&&l||!a||(a.finalize(),a=null),this.controllers[r.id]=this._updateController(r,o,s,a),this._viewports.unshift(s)}for(const i in e){const t=e[i];t&&!this.controllers[i]&&t.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach((t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)}))}_diffViews(t,e){return t.length!==e.length||t.some(((n,i)=>!t[i].equals(e[i])))}}const Sb=/([0-9]+\.?[0-9]*)(%|px)/;function Pb(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=Sb.exec(t);if(e&&e.length>=3){const t="%"===e[2],n=parseFloat(e[1]);return{position:t?n/100:n,relative:t}}default:throw new Error("Could not parse position string ".concat(t))}}function Eb(t,e){return t.relative?Math.round(t.position*e):t.position}class Cb{constructor(t){Ss(this,"id",void 0),Ss(this,"viewportInstance",void 0),Ss(this,"_x",void 0),Ss(this,"_y",void 0),Ss(this,"_width",void 0),Ss(this,"_height",void 0),Ss(this,"_padding",void 0),Ss(this,"props",void 0);const{id:e,x:n=0,y:i=0,width:r="100%",height:o="100%",padding:s=null,viewportInstance:a}=t||{};Rc(!a||a instanceof dp),this.viewportInstance=a,this.id=e||this.constructor.displayName||"view",this.props={...t,id:this.id},this._x=Pb(n),this._y=Pb(i),this._width=Pb(r),this._height=Pb(o),this._padding=s&&{left:Pb(s.left||0),right:Pb(s.right||0),top:Pb(s.top||0),bottom:Pb(s.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t||(this.viewportInstance?!!t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance):this.ViewportType===t.ViewportType&&Sp(this.props,t.props))}makeViewport(t){let{width:e,height:n,viewState:i}=t;if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:n});return new this.ViewportType({...i,...this.props,...r})}getViewStateId(){const{viewState:t}=this.props;return"string"===typeof t?t:(null===t||void 0===t?void 0:t.id)||this.id}filterViewState(t){if(this.props.viewState&&"object"===typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const t in this.props.viewState)"id"!==t&&(e[t]=this.props.viewState[t]);return e}return t}getDimensions(t){let{width:e,height:n}=t;const i={x:Eb(this._x,e),y:Eb(this._y,n),width:Eb(this._width,e),height:Eb(this._height,n)};return this._padding&&(i.padding={left:Eb(this._padding.left,e),top:Eb(this._padding.top,n),right:Eb(this._padding.right,e),bottom:Eb(this._padding.bottom,n)}),i}get controller(){const t=this.props.controller;return t?!0===t?{type:this.ControllerType}:"function"===typeof t?{type:t}:{type:this.ControllerType,...t}:null}}const Tb=()=>{},Ab=2,kb=3,Mb=t=>t,Lb=1;class Ob{constructor(t){Ss(this,"getControllerState",void 0),Ss(this,"props",void 0),Ss(this,"propsInTransition",void 0),Ss(this,"transition",void 0),Ss(this,"onViewStateChange",void 0),Ss(this,"onStateChange",void 0),Ss(this,"_onTransitionUpdate",(t=>{const{time:e,settings:{interpolator:n,startProps:i,endProps:r,duration:o,easing:s}}=t,a=s(e/o),l=n.interpolateProps(i,r,a);this.propsInTransition=this.getControllerState({...this.props,...l}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})})),this.getControllerState=t.getControllerState,this.propsInTransition=null,this.transition=new Pd(t.timeline),this.onViewStateChange=t.onViewStateChange||Tb,this.onStateChange=t.onStateChange||Tb}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(this.props=t,!n||this._shouldIgnoreViewportChange(n,t))return!1;if(this._isTransitionEnabled(t)){let i=n;if(this.transition.inProgress){const{interruption:t,endProps:e}=this.transition.settings;i={...n,...t===Ab?e:this.propsInTransition||n}}this._triggerTransition(i,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||"auto"===e)&&Boolean(n)}_isUpdateDueToCurrentTransition(t){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?this.transition.settings.interruption===kb||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}_triggerTransition(t,e){const n=this.getControllerState(t),i=this.getControllerState(e).shortestPathFrom(n),r=e.transitionInterpolator,o=r.getDuration?r.getDuration(t,e):e.transitionDuration;if(0===o)return;const s=r.initializeProps(t,i);this.propsInTransition={};const a={duration:o,easing:e.transitionEasing||Mb,interpolator:r,interruption:e.transitionInterruption||Lb,startProps:s.start,endProps:s.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)};this.transition.start(a),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),null===t||void 0===t||t(e)}}}class Rb{constructor(t){Ss(this,"_propsToCompare",void 0),Ss(this,"_propsToExtract",void 0),Ss(this,"_requiredProps",void 0);const{compare:e,extract:n,required:i}=t;this._propsToCompare=e,this._propsToExtract=n||e,this._requiredProps=i}arePropsEqual(t,e){for(const n of this._propsToCompare)if(!(n in t)||!(n in e)||!hc(t[n],e[n]))return!1;return!0}initializeProps(t,e){const n={},i={};for(const r of this._propsToExtract)(r in t||r in e)&&(n[r]=t[r],i[r]=e[r]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach((e=>{const n=t[e];Rc(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))}))}}const Ib=["longitude","latitude","zoom","bearing","pitch"],jb=["longitude","latitude","zoom"];class Fb extends Rb{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=Array.isArray(t)?t:t.transitionProps,n=Array.isArray(t)?{}:t;n.transitionProps=Array.isArray(e)?{compare:e,required:e}:e||{compare:Ib,required:jb},super(n.transitionProps),Ss(this,"opts",void 0),this.opts=n}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:i,around:r}=this.opts;if(i&&r){const o=i(t),s=i(e),a=o.unproject(r);n.start.around=r,Object.assign(n.end,{around:s.project(a),aroundPosition:a,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const i={};for(const r of this._propsToExtract)i[r]=uc(t[r]||0,e[r]||0,n);if(e.aroundPosition&&this.opts.makeViewport){const r=this.opts.makeViewport({...e,...i});Object.assign(i,r.panByPosition(e.aroundPosition,uc(t.around,e.around,n)))}return i}}const zb={transitionDuration:0},Nb=t=>1-(1-t)*(1-t),Db=["wheel"],Bb=["panstart","panmove","panend"],Ub=["pinchstart","pinchmove","pinchend"],Vb=["tripanstart","tripanmove","tripanend"],Wb=["doubletap"],Hb=["keydown"],Gb={};class Xb{constructor(t){Ss(this,"props",void 0),Ss(this,"state",{}),Ss(this,"transitionManager",void 0),Ss(this,"eventManager",void 0),Ss(this,"onViewStateChange",void 0),Ss(this,"onStateChange",void 0),Ss(this,"makeViewport",void 0),Ss(this,"_controllerState",void 0),Ss(this,"_events",{}),Ss(this,"_interactionState",{isDragging:!1}),Ss(this,"_customEvents",[]),Ss(this,"_eventStartBlocked",null),Ss(this,"_panMove",!1),Ss(this,"invertPan",!1),Ss(this,"dragMode","rotate"),Ss(this,"inertia",0),Ss(this,"scrollZoom",!0),Ss(this,"dragPan",!0),Ss(this,"dragRotate",!0),Ss(this,"doubleClickZoom",!0),Ss(this,"touchZoom",!0),Ss(this,"touchRotate",!1),Ss(this,"keyboard",!0),this.transitionManager=new Ob({...t,getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=t.eventManager,this.onViewStateChange=t.onViewStateChange||(()=>{}),this.onStateChange=t.onStateChange||(()=>{}),this.makeViewport=t.makeViewport}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events){var t;if(this._events[e])null===(t=this.eventManager)||void 0===t||t.off(e,this.handleEvent)}this.transitionManager.finalize()}handleEvent(t){this._controllerState=void 0;const e=this._eventStartBlocked;switch(t.type){case"panstart":return!e&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!e&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!e&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(t){const{x:e,y:n}=this.props,{offsetCenter:i}=t;return[i.x-e,i.y-n]}isPointInBounds(t,e){const{width:n,height:i}=this.props;if(e&&e.handled)return!1;const r=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=i;return r&&e&&e.stopPropagation(),r}isFunctionKeyPressed(t){const{srcEvent:e}=t;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(t){const e=setTimeout((()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)}),t);this._eventStartBlocked=e}setProps(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);const{inertia:e}=t;this.inertia=Number.isFinite(e)?e:!0===e?300:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:r=!0,doubleClickZoom:o=!0,touchZoom:s=!0,touchRotate:a=!1,keyboard:l=!0}=t,c=Boolean(this.onViewStateChange);this.toggleEvents(Db,c&&n),this.toggleEvents(Bb,c&&(i||r)),this.toggleEvents(Ub,c&&(s||a)),this.toggleEvents(Vb,c&&a),this.toggleEvents(Wb,c&&o),this.toggleEvents(Hb,c&&l),this.scrollZoom=n,this.dragPan=i,this.dragRotate=r,this.doubleClickZoom=o,this.touchZoom=s,this.touchRotate=a,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach((t=>{this._events[t]!==e&&(this._events[t]=e,e?this.eventManager.on(t,this.handleEvent):this.eventManager.off(t,this.handleEvent))}))}updateViewport(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i={...t.getViewportProps(),...e},r=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(n),r){const t=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:t})}}_onTransition(t){this.onViewStateChange({...t,interactionState:this._interactionState})}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(i,zb,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,zb,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],r=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:Nb},{isDragging:!1,isPanning:!0})}else{const t=this.controllerState.panEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,zb,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],r=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:Nb},{isDragging:!1,isRotating:!0})}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;t.srcEvent.preventDefault();const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const{speed:n=.01,smooth:i=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:r}=t;let o=2/(1+Math.exp(-Math.abs(r*n)));r<0&&0!==o&&(o=1/o);const s=this.controllerState.zoom({pos:e,scale:o});return this.updateViewport(s,{...this._getTransitionProps({around:e}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,zb,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,zb,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),i=[n[0],n[1]+=t.velocityY*e/2],r=this.controllerState.rotate({pos:i});this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:Nb},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return Gb._startPinchRotation=t.rotation,Gb._lastPinchEvent=t,this.updateViewport(n,zb,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,i=this.getCenter(t);e=e.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:Gb._startPinchRotation-n})}return this.updateViewport(e,zb,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Gb._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this,{_lastPinchEvent:n}=Gb;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const i=this.getCenter(t);let r=this.controllerState.rotateEnd();const o=Math.log2(t.scale),s=(o-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),a=Math.pow(2,o+s*e/2);r=r.zoom({pos:i,scale:a}).zoomEnd(),this.updateViewport(r,{...this._getTransitionProps({around:i}),transitionDuration:e,transitionEasing:Nb},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const t=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Gb._startPinchRotation=null,Gb._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),i=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:r,rotateSpeedY:o}=!0===this.keyboard?{}:this.keyboard,{controllerState:s}=this;let a;const l={};switch(t.srcEvent.code){case"Minus":a=e?s.zoomOut(n).zoomOut(n):s.zoomOut(n),l.isZooming=!0;break;case"Equal":a=e?s.zoomIn(n).zoomIn(n):s.zoomIn(n),l.isZooming=!0;break;case"ArrowLeft":e?(a=s.rotateLeft(r),l.isRotating=!0):(a=s.moveLeft(i),l.isPanning=!0);break;case"ArrowRight":e?(a=s.rotateRight(r),l.isRotating=!0):(a=s.moveRight(i),l.isPanning=!0);break;case"ArrowUp":e?(a=s.rotateUp(o),l.isRotating=!0):(a=s.moveUp(i),l.isPanning=!0);break;case"ArrowDown":e?(a=s.rotateDown(o),l.isRotating=!0):(a=s.moveDown(i),l.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),l),!0}_getTransitionProps(t){const{transition:e}=this;return e&&e.transitionInterpolator?t?{...e,transitionInterpolator:new Fb({...t,...e.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:e:zb}}class qb{constructor(t,e){Ss(this,"_viewportProps",void 0),Ss(this,"_state",void 0),this._viewportProps=this.applyConstraints(t),this._state=e}getViewportProps(){return this._viewportProps}getState(){return this._state}}class Zb extends qb{constructor(t){const{width:e,height:n,latitude:i,longitude:r,zoom:o,bearing:s=0,pitch:a=0,altitude:l=1.5,position:c=[0,0,0],maxZoom:u=20,minZoom:h=0,maxPitch:d=60,minPitch:f=0,startPanLngLat:p,startZoomLngLat:g,startRotatePos:m,startBearing:v,startPitch:y,startZoom:b,normalize:_=!0}=t;Rc(Number.isFinite(r)),Rc(Number.isFinite(i)),Rc(Number.isFinite(o)),super({width:e,height:n,latitude:i,longitude:r,zoom:o,bearing:s,pitch:a,altitude:l,maxZoom:u,minZoom:h,maxPitch:d,minPitch:f,normalize:_,position:c},{startPanLngLat:p,startZoomLngLat:g,startRotatePos:m,startBearing:v,startPitch:y,startZoom:b}),Ss(this,"makeViewport",void 0),this.makeViewport=t.makeViewport}panStart(t){let{pos:e}=t;return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan(t){let{pos:e,startPos:n}=t;const i=this.getState().startPanLngLat||this._unproject(n);if(!i)return this;const r=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart(t){let{pos:e}=t;return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate(t){let{pos:e,deltaAngleX:n=0,deltaAngleY:i=0}=t;const{startRotatePos:r,startBearing:o,startPitch:s}=this.getState();if(!r||void 0===o||void 0===s)return this;let a;return a=e?this._getNewRotation(e,r,s,o):{bearing:o+n,pitch:s+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart(t){let{pos:e}=t;return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom(t){let{pos:e,startPos:n,scale:i}=t,{startZoom:r,startZoomLngLat:o}=this.getState();if(o||(r=this.getViewportProps().zoom,o=this._unproject(n)||this._unproject(e)),!o)return this;const{maxZoom:s,minZoom:a}=this.getViewportProps();let l=r+Math.log2(i);l=cc(l,a,s);const c=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...c.panByPosition(o,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(t)}zoomOut(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(1/t)}moveLeft(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([t,0])}moveRight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([-t,0])}moveUp(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,t])}moveDown(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,-t])}rotateLeft(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:r}=n;return Math.abs(i-e.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(r-e.longitude)>180&&(n.longitude=r<0?r+360:r-360),n}applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i}=t;t.zoom=cc(i,n,e);const{maxPitch:r,minPitch:o,pitch:s}=t;t.pitch=cc(s,o,r);const{normalize:a=!0}=t;return a&&Object.assign(t,function(t){const{width:e,height:n,pitch:i=0}=t;let{longitude:r,latitude:o,zoom:s,bearing:a=0}=t;(r<-180||r>180)&&(r=Ff(r+180,360)-180),(a<-180||a>180)&&(a=Ff(a+180,360)-180);const l=Nf(n/ap);if(s<=l)s=l,o=0;else{const t=n/2/Math.pow(2,s),e=Yf([0,t])[1];if(o<e)o=e;else{const e=Yf([0,ap-t])[1];o>e&&(o=e)}}return{width:e,height:n,longitude:r,latitude:o,zoom:s,pitch:i,bearing:a}}(t)),t}_zoomFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}_unproject(t){const e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}_getNewRotation(t,e,n,i){const r=t[0]-e[0],o=t[1]-e[1],s=t[1],a=e[1],{width:l,height:c}=this.getViewportProps(),u=r/l;let h=0;o>0?Math.abs(c-a)>5&&(h=o/(a-c)*1.2):o<0&&a>5&&(h=1-s/a),h=cc(h,-1,1);const{minPitch:d,maxPitch:f}=this.getViewportProps();let p=n;return h>0?p=n+h*(f-n):h<0&&(p=n-h*(d-n)),{pitch:p,bearing:i+180*u}}}class Yb extends Xb{constructor(){super(...arguments),Ss(this,"ControllerState",Zb),Ss(this,"transition",{transitionDuration:300,transitionInterpolator:new Fb({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),Ss(this,"dragMode","pan")}setProps(t){t.position=t.position||[0,0,0];const e=this.props;super.setProps(t);(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...t,...this.state}))}}class Kb extends Cb{get ViewportType(){return vp}get ControllerType(){return Yb}}Ss(Kb,"displayName","MapView");const Qb=[255,255,255],$b=1;let Jb=0;class t_{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ss(this,"id",void 0),Ss(this,"color",void 0),Ss(this,"intensity",void 0),Ss(this,"type","ambient");const{color:e=Qb}=t,{intensity:n=$b}=t;this.id=t.id||"ambient-".concat(Jb++),this.color=e,this.intensity=n}}const e_=[255,255,255],n_=1,i_=[0,0,-1];let r_=0;class o_{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ss(this,"id",void 0),Ss(this,"color",void 0),Ss(this,"intensity",void 0),Ss(this,"type","directional"),Ss(this,"direction",void 0),Ss(this,"shadow",void 0);const{color:e=e_}=t,{intensity:n=n_}=t,{direction:i=i_}=t,{_shadow:r=!1}=t;this.id=t.id||"directional-".concat(r_++),this.color=e,this.intensity=n,this.type="directional",this.direction=new Ec(i).normalize().toArray(),this.shadow=r}getProjectedLight(t){return this}}class s_{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:"pass"};Ss(this,"id",void 0),Ss(this,"gl",void 0),Ss(this,"props",void 0);const{id:n}=e;this.id=n,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(t){}cleanup(){}}class a_ extends s_{render(t){return za(this.gl,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{target:e,moduleParameters:n,viewports:i,views:r,onViewportActive:o,clearCanvas:s=!0}=t;t.pass=t.pass||"unknown";const a=this.gl;s&&function(t){const e=t.drawingBufferWidth,n=t.drawingBufferHeight;za(t,{viewport:[0,0,e,n]}),t.clear(16640)}(a);const l=[];for(const c of i){const i=r&&r[c.id];o(c);const s=this._getDrawLayerParams(c,t),u=c.subViewports||[c];for(const r of u){const o=this._drawLayersInViewport(a,{target:e,moduleParameters:n,viewport:r,view:i,pass:t.pass,layers:t.layers},s);l.push(o)}}return l}_getDrawLayerParams(t,e){let{layers:n,pass:i,layerFilter:r,cullRect:o,effects:s,moduleParameters:a}=e;const l=[],c=l_(),u={layer:n[0],viewport:t,isPicking:i.startsWith("picking"),renderPass:i,cullRect:o},h={};for(let d=0;d<n.length;d++){const e=n[d],o=this._shouldDrawLayer(e,u,r,h),f={shouldDrawLayer:o};o&&(f.layerRenderIndex=c(e,o),f.moduleParameters=this._getModuleParameters(e,s,i,a),f.layerParameters=this.getLayerParameters(e,d,t)),l[d]=f}return l}_drawLayersInViewport(t,e,n){let{layers:i,moduleParameters:r,pass:o,target:s,viewport:a,view:l}=e;const c=function(t,e){let{moduleParameters:n,target:i,viewport:r}=e;const o=i&&"default-framebuffer"!==i.id,s=n&&n.devicePixelRatio||Da(t),a=o?i.height:t.drawingBufferHeight,l=r;return[l.x*s,a-(l.y+l.height)*s,l.width*s,l.height*s]}(t,{moduleParameters:r,target:s,viewport:a});if(l&&l.props.clear){const e=!0===l.props.clear?{color:!0,depth:!0}:l.props.clear;Na(t,{scissorTest:!0,scissor:c},(()=>Ul(t,e)))}const u={totalCount:i.length,visibleCount:0,compositeCount:0,pickableCount:0};za(t,{viewport:c});for(let d=0;d<i.length;d++){const t=i[d],{shouldDrawLayer:e,layerRenderIndex:r,moduleParameters:s,layerParameters:l}=n[d];if(e&&t.props.pickable&&u.pickableCount++,t.isComposite)u.compositeCount++;else if(e){u.visibleCount++,s.viewport=a;try{t._drawLayer({moduleParameters:s,uniforms:{layerIndex:r},parameters:l})}catch(h){t.raiseError(h,"drawing ".concat(t," to ").concat(o))}}}return u}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e,n){return t.props.parameters}_shouldDrawLayer(t,e,n,i){if(!(t.props.visible&&this.shouldDrawLayer(t)))return!1;e.layer=t;let r=t.parent;for(;r;){if(!r.props.visible||!r.filterSubLayer(e))return!1;e.layer=r,r=r.parent}if(n){const t=e.layer.id;if(t in i||(i[t]=n(e)),!i[t])return!1}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,i){var r;const o=Object.assign(Object.create((null===(r=t.internalState)||void 0===r?void 0:r.propsInTransition)||t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:Da(this.gl)});if(e)for(const a of e){var s;Object.assign(o,null===(s=a.getModuleParameters)||void 0===s?void 0:s.call(a,t))}return Object.assign(o,this.getModuleParameters(t,e),i)}}function l_(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={},i=(r,o)=>{const s=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in e)&&i(r.parent,!1),l in n){const t=n[l]=n[l]||l_(e[l],e);c=t(r,o),n[a]=t}else Number.isFinite(s)?(c=s+(e[l]||0),n[a]=null):c=t;return o&&c>=t&&(t=c+1),e[a]=c,c};return i}class c_ extends a_{constructor(t,e){super(t,e),Ss(this,"shadowMap",void 0),Ss(this,"depthBuffer",void 0),Ss(this,"fbo",void 0),this.shadowMap=new kl(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Ol(t,{format:33189,width:1,height:1}),this.fbo=new Ql(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(t){const e=this.fbo;Na(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},(()=>{const n=t.viewports[0],i=Da(this.gl),r=n.width*i,o=n.height*i;r===e.width&&o===e.height||e.resize({width:r,height:o}),super.render({...t,target:e,pass:"shadow"})}))}shouldDrawLayer(t){return!1!==t.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const u_=nf((function(t){let{viewport:e,center:n}=t;return new Lf(e.viewProjectionMatrix).invert().transform(n)})),h_=nf((function(t){let{viewport:e,shadowMatrices:n}=t;const i=[],r=e.pixelUnprojectionMatrix,o=e.isGeospatial?void 0:1,s=[[0,0,o],[e.width,0,o],[0,e.height,o],[e.width,e.height,o],[0,0,-1],[e.width,0,-1],[0,e.height,-1],[e.width,e.height,-1]].map((t=>function(t,e){const[n,i,r]=t,o=ip([n,i,r],e);if(Number.isFinite(r))return o;return[o[0],o[1],0]}(t,r)));for(const a of n){const t=a.clone().translate(new Ec(e.center).negate()),n=s.map((e=>t.transform(e))),r=(new Lf).ortho({left:Math.min(...n.map((t=>t[0]))),right:Math.max(...n.map((t=>t[0]))),bottom:Math.min(...n.map((t=>t[1]))),top:Math.max(...n.map((t=>t[1]))),near:Math.min(...n.map((t=>-t[2]))),far:Math.max(...n.map((t=>-t[2])))});i.push(r.multiplyRight(a))}return i})),d_=[0,0,0,1],f_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];const p_={name:"shadow",dependencies:[Am],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?function(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:!!t.shadowMaps&&t.shadowMaps.length>0,shadow_uColor:t.shadowColor||d_,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},r=u_({viewport:t.viewport,center:e.project_uCenter}),o=[],s=h_({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const n=s[a],i=n.clone().translate(new Ec(t.viewport.center).negate());e.project_uCoordinateSystem===Xs.LNGLAT&&e.project_uProjectionMode===qs.WEB_MERCATOR?(s[a]=i,o[a]=r):(s[a]=n.clone().multiplyRight(f_),o[a]=i.transform(r))}for(let a=0;a<s.length;a++)i["shadow_uViewProjectionMatrices[".concat(a,"]")]=s[a],i["shadow_uProjectCenters[".concat(a,"]")]=o[a],t.shadowMaps&&t.shadowMaps.length>0?i["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:i["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return i}(t,e):{}}},g_={color:[255,255,255],intensity:1},m_=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],v_=[0,0,0,200/255];class y_{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ss(this,"id","lighting-effect"),Ss(this,"props",null),Ss(this,"shadowColor",v_),Ss(this,"shadow",void 0),Ss(this,"ambientLight",null),Ss(this,"directionalLights",[]),Ss(this,"pointLights",[]),Ss(this,"shadowPasses",[]),Ss(this,"shadowMaps",[]),Ss(this,"dummyShadowMap",null),Ss(this,"programManager",void 0),Ss(this,"shadowMatrices",void 0);for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((t=>t.shadow))}preRender(t,e){let{layers:n,layerFilter:i,viewports:r,onViewportActive:o,views:s}=e;if(this.shadow){this.shadowMatrices=this._calculateMatrices(),0===this.shadowPasses.length&&this._createShadowPasses(t),this.programManager||(this.programManager=nd.getDefaultProgramManager(t),p_&&this.programManager.addDefaultModule(p_)),this.dummyShadowMap||(this.dummyShadowMap=new kl(t,{width:1,height:1}));for(let t=0;t<this.shadowPasses.length;t++){this.shadowPasses[t].render({layers:n,layerFilter:i,viewports:r,onViewportActive:o,views:s,moduleParameters:{shadowLightId:t,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((e=>e.getProjectedLight({layer:t}))),pointLights:this.pointLights.map((e=>e.getProjectedLight({layer:t})))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(p_),this.programManager=null)}_calculateMatrices(){const t=[];for(const e of this.directionalLights){const n=(new Lf).lookAt({eye:new Ec(e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new c_(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;t||0!==e.length||0!==n.length||(this.ambientLight=new t_(g_),this.directionalLights.push(new o_(m_[0]),new o_(m_[1])))}}class b_ extends a_{constructor(t,e){super(t,e),Ss(this,"maskMap",void 0),Ss(this,"fbo",void 0);const{mapSize:n=2048}=e;this.maskMap=new kl(t,{width:n,height:n,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.fbo=new Ql(t,{id:"maskmap",width:n,height:n,attachments:{36064:this.maskMap}})}render(t){const e=this.gl,n=[!1,!1,!1,!1];return n[t.channel]=!0,Na(e,{clearColor:[255,255,255,255],blend:!0,blendFunc:[0,1],blendEquation:32778,colorMask:n,depthTest:!1},(()=>super.render({...t,target:this.fbo,pass:"mask"})))}shouldDrawLayer(t){return t.props.operation===Qs}delete(){this.fbo.delete(),this.maskMap.delete()}}const __=(new Lf).lookAt({eye:[0,0,1]});function w_(t){let{width:e,height:n,near:i,far:r,padding:o}=t,s=-e/2,a=e/2,l=-n/2,c=n/2;if(o){const{left:t=0,right:i=0,top:r=0,bottom:u=0}=o,h=cc((t+e-i)/2,0,e)-e/2,d=cc((r+n-u)/2,0,n)-n/2;s-=h,a-=h,l+=d,c+=d}return(new Lf).ortho({left:s,right:a,bottom:l,top:c,near:i,far:r})}class x_ extends dp{constructor(t){const{width:e,height:n,near:i=.1,far:r=1e3,zoom:o=0,target:s=[0,0,0],padding:a=null,flipY:l=!0}=t,c=Array.isArray(o)?o[0]:o,u=Array.isArray(o)?o[1]:o,h=Math.min(c,u),d=Math.pow(2,h);let f;if(c!==u){const t=Math.pow(2,c),e=Math.pow(2,u);f={unitsPerMeter:[t/d,e/d,1],metersPerUnit:[d/t,d/e,1]}}super({...t,longitude:void 0,position:s,viewMatrix:__.clone().scale([d,d*(l?-1:1),d]),projectionMatrix:w_({width:e||1,height:n||1,padding:a,near:i,far:r}),zoom:h,distanceScales:f})}projectFlat(t){let[e,n]=t;const{unitsPerMeter:i}=this.distanceScales;return[e*i[0],n*i[1]]}unprojectFlat(t){let[e,n]=t;const{metersPerUnit:i}=this.distanceScales;return[e*i[0],n*i[1]]}panByPosition(t,e){const n=ip(e,this.pixelUnprojectionMatrix),i=xf([],this.projectFlat(t),Sf([],n)),r=xf([],this.center,i);return{target:this.unprojectFlat(r)}}}class S_ extends qb{constructor(t){const{width:e,height:n,rotationX:i=0,rotationOrbit:r=0,target:o=[0,0,0],zoom:s=0,minRotationX:a=-90,maxRotationX:l=90,minZoom:c=-1/0,maxZoom:u=1/0,startPanPosition:h,startRotatePos:d,startRotationX:f,startRotationOrbit:p,startZoomPosition:g,startZoom:m}=t;super({width:e,height:n,rotationX:i,rotationOrbit:r,target:o,zoom:s,minRotationX:a,maxRotationX:l,minZoom:c,maxZoom:u},{startPanPosition:h,startRotatePos:d,startRotationX:f,startRotationOrbit:p,startZoomPosition:g,startZoom:m}),Ss(this,"makeViewport",void 0),this.makeViewport=t.makeViewport}panStart(t){let{pos:e}=t;return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan(t){let{pos:e,startPosition:n}=t;const i=this.getState().startPanPosition||n;if(!i)return this;const r=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart(t){let{pos:e}=t;return this._getUpdatedState({startRotatePos:e,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate(t){let{pos:e,deltaAngleX:n=0,deltaAngleY:i=0}=t;const{startRotatePos:r,startRotationX:o,startRotationOrbit:s}=this.getState(),{width:a,height:l}=this.getViewportProps();if(!r||void 0===o||void 0===s)return this;let c;if(e){let t=(e[0]-r[0])/a;(o<-90||o>90)&&(t*=-1),c={rotationX:o+180*((e[1]-r[1])/l),rotationOrbit:s+180*t}}else c={rotationX:o+i,rotationOrbit:s+n};return this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{rotationOrbit:i}=n;return Math.abs(i-e.rotationOrbit)>180&&(n.rotationOrbit=i<0?i+360:i-360),n}zoomStart(t){let{pos:e}=t;return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom(t){let{pos:e,startPos:n,scale:i}=t,{startZoom:r,startZoomPosition:o}=this.getState();if(o||(r=this.getViewportProps().zoom,o=this._unproject(n)||this._unproject(e)),!o)return this;const s=this._calculateNewZoom({scale:i,startZoom:r}),a=this.makeViewport({...this.getViewportProps(),zoom:s});return this._getUpdatedState({zoom:s,...a.panByPosition(o,e)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._getUpdatedState({zoom:this._calculateNewZoom({scale:t})})}zoomOut(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/t})})}moveLeft(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this._panFromCenter([-t,0])}moveRight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this._panFromCenter([t,0])}moveUp(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this._panFromCenter([0,-t])}moveDown(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this._panFromCenter([0,t])}rotateLeft(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-t})}rotateRight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+t})}rotateUp(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-t})}rotateDown(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+t})}_unproject(t){const e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}_calculateNewZoom(t){let{scale:e,startZoom:n}=t;const{maxZoom:i,minZoom:r}=this.getViewportProps();void 0===n&&(n=this.getViewportProps().zoom);return cc(n+Math.log2(e),r,i)}_panFromCenter(t){const{width:e,height:n,target:i}=this.getViewportProps();return this.pan({startPosition:i,pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i,maxRotationX:r,minRotationX:o,rotationOrbit:s}=t;return t.zoom=Array.isArray(i)?[cc(i[0],n,e),cc(i[1],n,e)]:cc(i,n,e),t.rotationX=cc(t.rotationX,o,r),(s<-180||s>180)&&(t.rotationOrbit=function(t,e){const n=t%e;return n<0?e+n:n}(s+180,360)-180),t}}class P_ extends S_{constructor(t){super(t),Ss(this,"zoomAxis",void 0),this.zoomAxis=t.zoomAxis||"all"}_calculateNewZoom(t){let{scale:e,startZoom:n}=t;const{maxZoom:i,minZoom:r}=this.getViewportProps();void 0===n&&(n=this.getViewportProps().zoom);let o=Math.log2(e);if(Array.isArray(n)){let[t,e]=n;switch(this.zoomAxis){case"X":t=cc(t+o,r,i);break;case"Y":e=cc(e+o,r,i);break;default:let n=Math.min(t+o,e+o);n<r&&(o+=r-n),n=Math.max(t+o,e+o),n>i&&(o+=i-n),t+=o,e+=o}return[t,e]}return cc(n+o,r,i)}}class E_ extends Xb{constructor(){super(...arguments),Ss(this,"ControllerState",P_),Ss(this,"transition",{transitionDuration:300,transitionInterpolator:new Fb(["target","zoom"])}),Ss(this,"dragMode","pan")}_onPanRotate(){return!1}}class C_ extends Cb{get ViewportType(){return x_}get ControllerType(){return E_}}Ss(C_,"displayName","OrthographicView");class T_{constructor(){Ss(this,"id","mask-effect"),Ss(this,"props",null),Ss(this,"useInPicking",!0),Ss(this,"dummyMaskMap",void 0),Ss(this,"channels",[]),Ss(this,"masks",null),Ss(this,"maskPass",void 0),Ss(this,"maskMap",void 0),Ss(this,"lastViewport",void 0)}preRender(t,e){let{layers:n,layerFilter:i,viewports:r,onViewportActive:o,views:s}=e;this.dummyMaskMap||(this.dummyMaskMap=new kl(t,{width:1,height:1}));const a=n.filter((t=>t.props.visible&&t.props.operation===Qs));if(0===a.length)return this.masks=null,void(this.channels.length=0);this.masks={},this.maskPass||(this.maskPass=new b_(t,{id:"default-mask"}),this.maskMap=this.maskPass.maskMap);const l=this._sortMaskChannels(a),c=r[0],u=!this.lastViewport||!this.lastViewport.equals(c);for(const h in l)this._renderChannel(l[h],{layerFilter:i,onViewportActive:o,views:s,viewport:c,viewportChanged:u})}_renderChannel(t,e){let{layerFilter:n,onViewportActive:i,views:r,viewport:o,viewportChanged:s}=e;const a=this.channels[t.index];if(!a)return;const l=t===a||a.layers.length!==t.layers.length||t.layerBounds.some(((t,e)=>t!==a.layerBounds[e]));if(t.bounds=a.bounds,t.maskBounds=a.maskBounds,this.channels[t.index]=t,(l||s)&&(this.lastViewport=o,t.bounds=function(t){let{layers:e,viewport:n}=t,i=null;for(const s of e){const t=s.getBounds();t&&(i?(i[0]=Math.min(i[0],t[0][0]),i[1]=Math.min(i[1],t[0][1]),i[2]=Math.max(i[2],t[1][0]),i[3]=Math.max(i[3],t[1][1])):i=[t[0][0],t[0][1],t[1][0],t[1][1]])}const r=n.getBounds();if(!i)return r;const o=function(t){const e={x:t[2]-t[0],y:t[3]-t[1]},n={x:t[0]+.5*e.x,y:t[1]+.5*e.y};return[n.x-e.x,n.y-e.y,n.x+e.x,n.y+e.y]}(r);return i[2]-i[0]<o[2]-o[0]||i[3]-i[1]<o[3]-o[1]||(i[0]=Math.max(i[0],o[0]),i[1]=Math.max(i[1],o[1]),i[2]=Math.min(i[2],o[2]),i[3]=Math.min(i[3],o[3])),i}({layers:t.layers,viewport:o}),l||!hc(t.bounds,a.bounds))){const{maskPass:e,maskMap:s}=this,a=function(t){let{bounds:e,viewport:n,width:i,height:r}=t;if(e[2]<=e[0]||e[3]<=e[1])return null;if(i-=2,r-=2,n instanceof vp){const{longitude:t,latitude:n,zoom:o}=rp({width:i,height:r,bounds:[[e[0],e[1]],[e[2],e[3]]],maxZoom:20});return new vp({longitude:t,latitude:n,zoom:o,x:1,y:1,width:i,height:r})}const o=[(e[0]+e[2])/2,(e[1]+e[3])/2,0],s=Math.min(20,i/(e[2]-e[0]),r/(e[3]-e[1]));return new C_({x:1,y:1}).makeViewport({width:i,height:r,viewState:{target:o,zoom:Math.log2(s)}})}({bounds:t.bounds,viewport:o,width:s.width,height:s.height});t.maskBounds=a?a.getBounds():[0,0,1,1],e.render({pass:"mask",channel:t.index,layers:t.layers,layerFilter:n,viewports:a?[a]:[],onViewportActive:i,views:r,moduleParameters:{devicePixelRatio:1}})}this.masks[t.id]={index:t.index,bounds:t.maskBounds,coordinateOrigin:t.coordinateOrigin,coordinateSystem:t.coordinateSystem}}_sortMaskChannels(t){const e={};let n=0;for(const i of t){const{id:t}=i.root;let r=e[t];if(!r){if(++n>4){Gs.warn("Too many mask layers. The max supported is 4")();continue}r={id:t,index:this.channels.findIndex((e=>(null===e||void 0===e?void 0:e.id)===t)),layers:[],layerBounds:[],coordinateOrigin:i.root.props.coordinateOrigin,coordinateSystem:i.root.props.coordinateSystem},e[t]=r}r.layers.push(i),r.layerBounds.push(i.getBounds())}for(let i=0;i<4;i++){const t=this.channels[i];t&&t.id in e||(this.channels[i]=null)}for(const i in e){const t=e[i];t.index<0&&(t.index=this.channels.findIndex((t=>!t)),this.channels[t.index]=t)}return e}getModuleParameters(){return{maskMap:this.masks?this.maskMap:this.dummyMaskMap,maskChannels:this.masks}}cleanup(){this.dummyMaskMap&&(this.dummyMaskMap.delete(),this.dummyMaskMap=void 0),this.maskPass&&(this.maskPass.delete(),this.maskPass=void 0,this.maskMap=void 0),this.lastViewport=void 0,this.masks=null,this.channels.length=0}}const A_=new y_;class k_{constructor(){Ss(this,"effects",void 0),Ss(this,"_internalEffects",void 0),Ss(this,"_needsRedraw",void 0),this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(t){"effects"in t&&(t.effects.length===this.effects.length&&Sp(t.effects,this.effects)||(this.setEffects(t.effects),this._needsRedraw="effects changed"))}needsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.cleanup(),this.effects=t,this._internalEffects=t.slice(),this._internalEffects.push(new T_),t.some((t=>t instanceof y_))||this._internalEffects.push(A_)}cleanup(){for(const t of this.effects)t.cleanup();for(const t of this._internalEffects)t.cleanup();this.effects.length=0,this._internalEffects.length=0}}class M_ extends a_{shouldDrawLayer(t){return t.props.operation===Ks}}const L_={blendFunc:[1,0,32771,0],blendEquation:32774};class O_ extends a_{constructor(){super(...arguments),Ss(this,"pickZ",void 0),Ss(this,"_colors",null)}render(t){return t.pickingFBO?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer(t){let{layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:o,pickingFBO:s,deviceRect:{x:a,y:l,width:c,height:u},cullRect:h,effects:d,pass:f="picking",pickZ:p}=t;const g=this.gl;this.pickZ=p;const m=p?null:{byLayer:new Map,byAlpha:[]};this._colors=m;const v=Na(g,{scissorTest:!0,scissor:[a,l,c,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...L_,blend:!p},(()=>super.render({target:s,layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:o,cullRect:h,effects:null===d||void 0===d?void 0:d.filter((t=>t.useInPicking)),pass:f})));this._colors=null;return{decodePickingColor:m&&R_.bind(null,m),stats:v}}shouldDrawLayer(t){return t.props.pickable&&t.props.operation===Ks}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e,n){const i={...t.props.parameters};return this._colors?(Object.assign(i,L_),i.blend=!0,i.blendColor=function(t,e,n){const{byLayer:i,byAlpha:r}=t;let o,s=i.get(e);s?(s.viewports.push(n),o=s.a):(o=i.size+1,o<=255?(s={a:o,layer:e,viewports:[n]},i.set(e,s),r[o]=s):(Gs.warn("Too many pickable layers, only picking the first 255")(),o=0));return[0,0,0,o/255]}(this._colors,t,n)):i.blend=!1,i}}function R_(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}class I_{constructor(t){this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new M_(t),this.pickLayersPass=new O_(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){"layerFilter"in t&&this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in t&&this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;t.layerFilter=t.layerFilter||this.layerFilter,t.effects=t.effects||[],t.target=t.target||Ql.getDefaultFramebuffer(this.gl),this._preRender(t.effects,t);const n=this.lastPostProcessEffect?this.renderBuffers[0]:t.target,i=e.render({...t,target:n});this._postRender(t.effects,t),this.renderCount++,tu("deckRenderer.renderLayers",this,i,t)}needsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){let n=null;for(const i of t)i.preRender(this.gl,e),i.postRender&&(n=i);n&&this._resizeRenderBuffers(),this.lastPostProcessEffect=n}_resizeRenderBuffers(){const{renderBuffers:t}=this;0===t.length&&t.push(new Ql(this.gl),new Ql(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:n}=this,i={inputBuffer:n[0],swapBuffer:n[1],target:null};for(const r of t)if(r.postRender){if(r===this.lastPostProcessEffect){i.target=e.target,r.postRender(this.gl,i);break}const t=r.postRender(this.gl,i);i.inputBuffer=t,i.swapBuffer=t===n[0]?n[1]:n[0]}}}const j_={pickedColor:null,pickedObjectIndex:-1};function F_(t){let{pickedColors:e,decodePickingColor:n,deviceX:i,deviceY:r,deviceRadius:o,deviceRect:s}=t;const{x:a,y:l,width:c,height:u}=s;let h=o*o,d=-1,f=0;for(let p=0;p<u;p++){const t=p+l-r,n=t*t;if(n>h)f+=4*c;else for(let r=0;r<c;r++){if(e[f+3]-1>=0){const t=r+a-i,e=t*t+n;e<=h&&(h=e,d=f)}f+=4}}if(d>=0){const t=e.slice(d,d+4),i=n(t);if(i){const e=Math.floor(d/4/c),n=d/4-e*c;return{...i,pickedColor:t,pickedX:a+n,pickedY:l+e}}Gs.error("Picked non-existent layer. Is picking buffer corrupt?")()}return j_}function z_(t){let e,{pickInfo:n,viewports:i,pixelRatio:r,x:o,y:s,z:a}=t,l=i[0];if(i.length>1&&(l=function(t,e){for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.containsPixel(e))return i}return t[0]}((null===n||void 0===n?void 0:n.pickedViewports)||i,{x:o,y:s})),l){const t=[o-l.x,s-l.y];void 0!==a&&(t[2]=a),e=l.unproject(t)}return{color:null,layer:null,viewport:l,index:-1,picked:!1,x:o,y:s,pixel:[o,s],coordinate:e,devicePixel:n&&"pickedX"in n?[n.pickedX,n.pickedY]:void 0,pixelRatio:r}}function N_(t){const{pickInfo:e,lastPickedInfo:n,mode:i,layers:r}=t,{pickedColor:o,pickedLayer:s,pickedObjectIndex:a}=e,l=s?[s]:[];if("hover"===i){const t=n.index,e=n.layerId,i=s?s.props.id:null;if(i!==e||a!==t){if(i!==e){const t=r.find((t=>t.props.id===e));t&&l.unshift(t)}n.layerId=i,n.index=a,n.info=null}}const c=z_(t),u=new Map;return u.set(null,c),l.forEach((t=>{let e={...c};t===s&&(e.color=o,e.index=a,e.picked=!0),e=D_({layer:t,info:e,mode:i});const r=e.layer;t===s&&"hover"===i&&(n.info=e),u.set(r.id,e),"hover"===i&&r.updateAutoHighlight(e)})),u}function D_(t){let{layer:e,info:n,mode:i}=t;for(;e&&n;){const t=n.layer||null;n.sourceLayer=t,n.layer=e,n=e.getPickingInfo({info:n,mode:i,sourceLayer:t}),e=e.parent}return n}class B_{constructor(t){Ss(this,"gl",void 0),Ss(this,"pickingFBO",void 0),Ss(this,"depthFBO",void 0),Ss(this,"pickLayersPass",void 0),Ss(this,"layerFilter",void 0),Ss(this,"lastPickedInfo",void 0),Ss(this,"_pickable",!0),this.gl=t,this.pickLayersPass=new O_(t),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject(t){let{x:e,y:n,layers:i,viewports:r}=t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.lastPickedInfo.info;const s=o&&o.layer&&o.layer.id,a=o&&o.viewport&&o.viewport.id,l=s?i.find((t=>t.id===s)):null,c=a&&r.find((t=>t.id===a))||r[0],u=c&&c.unproject([e-c.x,n-c.y]),h={x:e,y:n,viewport:c,coordinate:u,layer:l};return{...o,...h}}_resizeBuffer(){var t,e;const{gl:n}=this;if(!this.pickingFBO&&(this.pickingFBO=new Ql(n),Ql.isSupported(n,{colorBufferFloat:!0}))){const t=new Ql(n);t.attach({36064:new kl(n,{format:ia(n)?34836:6408,type:5126})}),this.depthFBO=t}null===(t=this.pickingFBO)||void 0===t||t.resize({width:n.canvas.width,height:n.canvas.height}),null===(e=this.depthFBO)||void 0===e||e.resize({width:n.canvas.width,height:n.canvas.height})}_getPickable(t){if(!1===this._pickable)return null;const e=t.filter((t=>t.isPickable()&&!t.isComposite));return e.length?e:null}_pickClosestObject(t){let{layers:e,views:n,viewports:i,x:r,y:o,radius:s=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u,effects:h}=t;const d=this._getPickable(e),f=Da(this.gl);if(!d)return{result:[],emptyInfo:z_({viewports:i,x:r,y:o,pixelRatio:f})};this._resizeBuffer();const p=Ba(this.gl,[r,o],!0),g=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],m=Math.round(s*f),{width:v,height:y}=this.pickingFBO,b=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceWidth:v,deviceHeight:y}),_={x:r-s,y:o-s,width:2*s+1,height:2*s+1};let w;const x=[],S=new Set;for(let P=0;P<a;P++){let t,e;if(b){t=F_({...this._drawAndSample({layers:d,views:n,viewports:i,onViewportActive:u,deviceRect:b,cullRect:_,effects:h,pass:"picking:".concat(l)}),deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceRect:b})}else t={pickedColor:null,pickedObjectIndex:-1};if(t.pickedLayer&&c&&this.depthFBO){e=this._drawAndSample({layers:[t.pickedLayer],views:n,viewports:i,onViewportActive:u,deviceRect:{x:t.pickedX,y:t.pickedY,width:1,height:1},cullRect:_,effects:h,pass:"picking:".concat(l,":z")},!0).pickedColors[0]}t.pickedLayer&&P+1<a&&(S.add(t.pickedLayer),t.pickedLayer.disablePickingIndex(t.pickedObjectIndex)),w=N_({pickInfo:t,lastPickedInfo:this.lastPickedInfo,mode:l,layers:d,viewports:i,x:r,y:o,z:e,pixelRatio:f});for(const n of w.values())n.layer&&x.push(n);if(!t.pickedColor)break}for(const P of S)P.restorePickingColors();return{result:x,emptyInfo:w.get(null)}}_pickVisibleObjects(t){let{layers:e,views:n,viewports:i,x:r,y:o,width:s=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u,effects:h}=t;const d=this._getPickable(e);if(!d)return[];this._resizeBuffer();const f=Da(this.gl),p=Ba(this.gl,[r,o],!0),g=p.x,m=p.y+p.height,v=Ba(this.gl,[r+s,o+a],!0),y=v.x+v.width,b=v.y,_={x:g,y:b,width:y-g,height:m-b},w=function(t){let{pickedColors:e,decodePickingColor:n}=t;const i=new Map;if(e)for(let r=0;r<e.length;r+=4)if(e[r+3]-1>=0){const t=e.slice(r,r+4),o=t.join(",");if(!i.has(o)){const e=n(t);e?i.set(o,{...e,color:t}):Gs.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(i.values())}(this._drawAndSample({layers:d,views:n,viewports:i,onViewportActive:u,deviceRect:_,cullRect:{x:r,y:o,width:s,height:a},effects:h,pass:"picking:".concat(l)})),x=new Map,S=Number.isFinite(c);for(let P=0;P<w.length&&!(S&&c&&x.size>=c);P++){const t=w[P];let e={color:t.pickedColor,layer:null,index:t.pickedObjectIndex,picked:!0,x:r,y:o,pixelRatio:f};e=D_({layer:t.pickedLayer,info:e,mode:l}),x.has(e.object)||x.set(e.object,e)}return Array.from(x.values())}_drawAndSample(t){let{layers:e,views:n,viewports:i,onViewportActive:r,deviceRect:o,cullRect:s,effects:a,pass:l}=t,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const u=c?this.depthFBO:this.pickingFBO,{decodePickingColor:h}=this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:n,viewports:i,onViewportActive:r,pickingFBO:u,deviceRect:o,cullRect:s,effects:a,pass:l,pickZ:c}),{x:d,y:f,width:p,height:g}=o,m=new(c?Float32Array:Uint8Array)(p*g*4);return ql(u,{sourceX:d,sourceY:f,sourceWidth:p,sourceHeight:g,target:m}),{pickedColors:m,decodePickingColor:h}}_getPickingRect(t){let{deviceX:e,deviceY:n,deviceRadius:i,deviceWidth:r,deviceHeight:o}=t;const s=Math.max(0,e-i),a=Math.max(0,n-i),l=Math.min(r,e+i+1)-s,c=Math.min(o,n+i+1)-a;return l<=0||c<=0?null:{x:s,y:a,width:l,height:c}}}const U_={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class V_{constructor(t){Ss(this,"el",null),Ss(this,"isVisible",!1);const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,U_),e.appendChild(this.el))}setTooltip(t,e,n){const i=this.el;if(i){if("string"===typeof t)i.innerText=t;else{if(!t)return this.isVisible=!1,void(i.style.display="none");t.text&&(i.innerText=t.text),t.html&&(i.innerHTML=t.html),t.className&&(i.className=t.className),Object.assign(i.style,t.style)}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(e,"px, ").concat(n,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}const W_={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(t){const e=t[0],n=t[t.length-1];return"{"===e&&"}"===n||"["===e&&"]"===n},parseTextSync:JSON.parse},H_="8.8.4",G_=globalThis.deck&&globalThis.deck.VERSION;if(G_&&G_!==H_)throw new Error("deck.gl - multiple versions detected: ".concat(G_," vs ").concat(H_));G_||(Gs.log(1,"deck.gl ".concat(H_))(),globalThis.deck={...globalThis.deck,VERSION:H_,version:H_,log:Gs,_registerLoggers:function(t){Jc=t}},function(t){const e=em();t=Array.isArray(t)?t:[t];for(const n of t){const t=Qp(n);e.find((e=>t===e))||e.unshift(t)}}([W_,[hy,{imagebitmap:{premultiplyAlpha:"none"}}]]));const X_=globalThis.deck;class q_ extends cl{get[Symbol.toStringTag](){return"Query"}static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=ia(t),i=nc(t,$l);let r=n||i;for(const o of e)switch(o){case"queries":r=r&&n;break;case"timers":r=r&&i;break;default:tl(!1)}return r}constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery(){let{conservative:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.begin(t?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(t){return this._queryPending||(this.target=t,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const t=this.gl2.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let e=0;return this._pollingPromise=new Promise(((n,i)=>{const r=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):e++>t?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(r)};requestAnimationFrame(r)})),this._pollingPromise}_createHandle(){return q_.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const Z_=Es()&&"undefined"!==typeof document;let Y_=0;class K_{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{onCreateContext:e=(t=>Xa(t)),onAddHTML:n=null,onInitialize:i=(()=>{}),onRender:r=(()=>{}),onFinalize:o=(()=>{}),onError:s,gl:a=null,glOptions:l={},debug:c=!1,createFramebuffer:u=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:d=!0,stats:f=Ja.get("animation-loop-".concat(Y_++))}=t;let{useDevicePixels:p=!0}=t;"useDevicePixelRatio"in t&&($s.deprecated("useDevicePixelRatio","useDevicePixels")(),p=t.useDevicePixelRatio),this.props={onCreateContext:e,onAddHTML:n,onInitialize:i,onRender:r,onFinalize:o,onError:s,gl:a,glOptions:l,debug:c,createFramebuffer:u},this.gl=a,this.needsRedraw=null,this.timeline=null,this.stats=f,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:d,useDevicePixels:p}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(t){return tl("string"===typeof t),this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._running)return this;this._running=!0;const e=this._getPageLoadPromise().then((()=>!this._running||this._initialized?null:(this._createWebGLContext(t),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=q_.isSupported(this.gl,["timers"])?new q_(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps)))).then((t=>{this._running&&(this._addCallbackData(t||{}),!1!==t&&this._startLoop())}));return this.props.onError&&e.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((t=>{this._resolveNextFrame=t}))),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=document.getElementById(t);return n?Number(n.value):e}setViewParameters(){return $s.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const t=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(t))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(t)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Z_?new Promise(((t,e)=>{Z_&&"complete"===document.readyState?t(document):window.addEventListener("load",(()=>{t(document)}))})):Promise.resolve({})),this._pageLoadPromise}_setDisplay(t){this.display&&(this.display.delete(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_cancelAnimationFrame(t){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(t):(e=t,"undefined"!==typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e));var e}_requestAnimationFrame(t){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(t):(e=t,"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60));var e}_renderFrame(){this.display?this.display._renderFrame(...arguments):this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:t,height:e,aspect:n}=this._getSizeAndAspect();t===this.animationProps.width&&e===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=e,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(t){"object"===typeof t&&null!==t&&(this.animationProps=Object.assign({},this.animationProps,t))}_createWebGLContext(t){if(this.offScreen=t.canvas&&"undefined"!==typeof OffscreenCanvas&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,this.props.glOptions),this.gl=this.props.gl?qa(this.props.gl,t):this.onCreateContext(t),!na(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");za(this.gl,ba),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);const n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}_getSizeAndAspect(){const t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight;let n=1;const{canvas:i}=this.gl;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&Za(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Ql(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:t}=this.gl;t&&(t.addEventListener("mousemove",this._onMousemove),t.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}_onMouseleave(t){this.animationProps._mousePosition=null}}var Q_=n(97);const $_=1,J_=2,tw=4,ew={mousedown:$_,mousemove:J_,mouseup:tw};!function(t){const e=t.prototype.handler;t.prototype.handler=function(t){const n=this.store;t.button>0&&"pointerdown"===t.type&&(function(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}(n,(e=>e.pointerId===t.pointerId))||n.push(t)),e.call(this,t)}}(Q_.PointerEventInput),Q_.MouseInput.prototype.handler=function(t){let e=ew[t.type];e&$_&&t.button>=0&&(this.pressed=!0),e&J_&&0===t.buttons&&(e=tw),this.pressed&&(e&tw&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))};const nw=Q_.Manager,iw=Q_;class rw{constructor(t,e,n){this.element=t,this.callback=e,this.options={enable:!0,...n}}}const ow=iw?[[iw.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[iw.Rotate,{enable:!1}],[iw.Pinch,{enable:!1}],[iw.Swipe,{enable:!1}],[iw.Pan,{threshold:0,enable:!1}],[iw.Press,{enable:!1}],[iw.Tap,{event:"doubletap",taps:2,enable:!1}],[iw.Tap,{event:"anytap",enable:!1}],[iw.Tap,{enable:!1}]]:null,sw={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},aw={doubletap:["tap"]},lw={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},cw={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},uw={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},hw={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},dw="undefined"!==typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",fw="undefined"!==typeof window?window:n.g;"undefined"!==typeof n.g?n.g:window,"undefined"!==typeof document&&document;let pw=!1;try{const t={get passive(){return pw=!0,!0}};fw.addEventListener("test",null,t),fw.removeEventListener("test",null)}catch(SS){pw=!1}const gw=-1!==dw.indexOf("firefox"),{WHEEL_EVENTS:mw}=cw,vw="wheel",yw=4.000244140625;class bw extends rw{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{if(!this.options.enable)return;let e=t.deltaY;fw.WheelEvent&&(gw&&t.deltaMode===fw.WheelEvent.DOM_DELTA_PIXEL&&(e/=fw.devicePixelRatio),t.deltaMode===fw.WheelEvent.DOM_DELTA_LINE&&(e*=40)),0!==e&&e%yw===0&&(e=Math.floor(e/yw)),t.shiftKey&&e&&(e*=.25),this.callback({type:vw,center:{x:t.clientX,y:t.clientY},delta:-e,srcEvent:t,pointerType:"mouse",target:t.target})},this.events=(this.options.events||[]).concat(mw),this.events.forEach((e=>t.addEventListener(e,this.handleEvent,!!pw&&{passive:!1})))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===vw&&(this.options.enable=e)}}const{MOUSE_EVENTS:_w}=cw,ww="pointermove",xw="pointerover",Sw="pointerout",Pw="pointerenter",Ew="pointerleave";class Cw extends rw{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{this.handleOverEvent(t),this.handleOutEvent(t),this.handleEnterEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(_w),this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===ww&&(this.enableMoveEvent=e),t===xw&&(this.enableOverEvent=e),t===Sw&&(this.enableOutEvent=e),t===Pw&&(this.enableEnterEvent=e),t===Ew&&(this.enableLeaveEvent=e)}handleOverEvent(t){this.enableOverEvent&&"mouseover"===t.type&&this._emit(xw,t)}handleOutEvent(t){this.enableOutEvent&&"mouseout"===t.type&&this._emit(Sw,t)}handleEnterEvent(t){this.enableEnterEvent&&"mouseenter"===t.type&&this._emit(Pw,t)}handleLeaveEvent(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this._emit(Ew,t)}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.buttons&&(this.pressed=!1),this.pressed||this._emit(ww,t);break;case"mouseup":this.pressed=!1}}_emit(t,e){this.callback({type:t,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const{KEY_EVENTS:Tw}=cw,Aw="keydown",kw="keyup";class Mw extends rw{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{const e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:Aw,srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:kw,srcEvent:t,key:t.key,target:t.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Tw),t.tabIndex=this.options.tabIndex||0,t.style.outline="none",this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===Aw&&(this.enableDownEvent=e),t===kw&&(this.enableUpEvent=e)}}const Lw="contextmenu";class Ow extends rw{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{this.options.enable&&this.callback({type:Lw,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})},t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===Lw&&(this.options.enable=e)}}const Rw=2,Iw={pointerdown:1,pointermove:Rw,pointerup:4,mousedown:1,mousemove:Rw,mouseup:4},jw=0,Fw=1,zw=2,Nw=1,Dw=2,Bw=4;function Uw(t){const e=Iw[t.srcEvent.type];if(!e)return null;const{buttons:n,button:i}=t.srcEvent;let r=!1,o=!1,s=!1;return e===Rw?(r=Boolean(n&Nw),o=Boolean(n&Bw),s=Boolean(n&Dw)):(r=i===jw,o=i===Fw,s=i===zw),{leftButton:r,middleButton:o,rightButton:s}}function Vw(t,e){const n=t.center;if(!n)return null;const i=e.getBoundingClientRect(),r=i.width/e.offsetWidth||1,o=i.height/e.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-i.left-e.clientLeft)/r,y:(n.y-i.top-e.clientTop)/o}}}const Ww={srcElement:"root",priority:0};class Hw{constructor(t){this.handleEvent=t=>{if(this.isEmpty())return;const e=this._normalizeEvent(t);let n=t.srcEvent.target;for(;n&&n!==e.rootElement;){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")},this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{handlers:o,handlersByElement:s}=this;let a=Ww;"string"===typeof n||n&&n.addEventListener?a={...Ww,srcElement:n}:n&&(a={...Ww,...n});let l=s.get(a.srcElement);l||(l=[],s.set(a.srcElement,l));const c={type:t,handler:e,srcElement:a.srcElement,priority:a.priority};i&&(c.once=!0),r&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let u=l.length-1;for(;u>=0&&!(l[u].priority>=c.priority);)u--;l.splice(u+1,0,c)}remove(t,e){const{handlers:n,handlersByElement:i}=this;for(let r=n.length-1;r>=0;r--){const o=n[r];if(o.type===t&&o.handler===e){n.splice(r,1);const t=i.get(o.srcElement);t.splice(t.indexOf(o),1),0===t.length&&i.delete(o.srcElement)}}this._active=n.some((t=>!t.passive))}_emit(t,e){const n=this.handlersByElement.get(e);if(n){let e=!1;const i=()=>{t.handled=!0},r=()=>{t.handled=!0,e=!0},o=[];for(let s=0;s<n.length;s++){const{type:a,handler:l,once:c}=n[s];if(l({...t,type:a,stopPropagation:i,stopImmediatePropagation:r}),c&&o.push(n[s]),e)break}for(let t=0;t<o.length;t++){const{type:e,handler:n}=o[t];this.remove(e,n)}}}_normalizeEvent(t){const e=this.eventManager.getElement();return{...t,...Uw(t),...Vw(t,e),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:e}}}const Gw={events:null,recognizers:null,recognizerOptions:{},Manager:nw,touchAction:"none",tabIndex:0};class Xw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0;this._onBasicInput=t=>{const{srcEvent:e}=t,n=lw[e.type];n&&this.manager.emit(n,t)},this._onOtherEvent=t=>{this.manager.emit(t.type,t)},this.options={...Gw,...e},this.events=new Map,this.setElement(t);const{events:n}=this.options;n&&this.on(n)}getElement(){return this.element}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this,n=e.Manager;this.manager=new n(t,{touchAction:e.touchAction,recognizers:e.recognizers||ow}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys(sw).forEach((t=>{const e=this.manager.get(t);e&&sw[t].forEach((t=>{e.recognizeWith(t)}))}));for(const i in e.recognizerOptions){const t=this.manager.get(i);if(t){const n=e.recognizerOptions[i];delete n.enable,t.set(n)}}this.wheelInput=new bw(t,this._onOtherEvent,{enable:!1}),this.moveInput=new Cw(t,this._onOtherEvent,{enable:!1}),this.keyInput=new Mw(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new Ow(t,this._onOtherEvent,{enable:!1});for(const[i,r]of this.events)r.isEmpty()||(this._toggleRecognizer(r.recognizerName,!0),this.manager.on(i,r.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,n){this._addEventHandler(t,e,n,!1)}once(t,e,n){this._addEventHandler(t,e,n,!0)}watch(t,e,n){this._addEventHandler(t,e,n,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:n}=this;if(!n)return;const i=n.get(t);if(i&&i.options.enable!==e){i.set({enable:e});const r=aw[t];r&&!this.options.recognizers&&r.forEach((r=>{const o=n.get(r);e?(o.requireFailure(t),i.dropRequireFailure(r)):o.dropRequireFailure(t)}))}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,n,i,r){if("string"!==typeof t){n=e;for(const e in t)this._addEventHandler(e,t[e],n,i,r);return}const{manager:o,events:s}=this,a=hw[t]||t;let l=s.get(a);l||(l=new Hw(this),s.set(a,l),l.recognizerName=uw[a]||a,o&&o.on(a,l.handleEvent)),l.add(t,e,n,i,r),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(t,e){if("string"!==typeof t){for(const e in t)this._removeEventHandler(e,t[e]);return}const{events:n}=this,i=hw[t]||t,r=n.get(i);if(r&&(r.remove(t,e),r.isEmpty())){const{recognizerName:t}=r;let e=!1;for(const i of n.values())if(i.recognizerName===t&&!i.isEmpty()){e=!0;break}e||this._toggleRecognizer(t,!1)}}}function qw(){}const Zw={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:qw,onResize:qw,onViewStateChange:qw,onInteractionStateChange:qw,onBeforeRender:qw,onAfterRender:qw,onLoad:qw,onError:t=>Gs.error(t.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:t=>{let{isDragging:e}=t;return e?"grabbing":"grab"},getTooltip:null,debug:!1,drawPickingColors:!1};class Yw{constructor(t){Ss(this,"props",void 0),Ss(this,"width",0),Ss(this,"height",0),Ss(this,"userData",{}),Ss(this,"canvas",null),Ss(this,"viewManager",null),Ss(this,"layerManager",null),Ss(this,"effectManager",null),Ss(this,"deckRenderer",null),Ss(this,"deckPicker",null),Ss(this,"eventManager",null),Ss(this,"tooltip",null),Ss(this,"metrics",void 0),Ss(this,"animationLoop",void 0),Ss(this,"stats",void 0),Ss(this,"viewState",void 0),Ss(this,"cursorState",void 0),Ss(this,"_needsRedraw",void 0),Ss(this,"_pickRequest",void 0),Ss(this,"_lastPointerDownInfo",null),Ss(this,"_metricsCounter",void 0),Ss(this,"_onPointerMove",(t=>{const{_pickRequest:e}=this;if("pointerleave"===t.type)e.x=-1,e.y=-1,e.radius=0;else{if(t.leftButton||t.rightButton)return;{const n=t.offsetCenter;if(!n)return;e.x=n.x,e.y=n.y,e.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:e.x,y:e.y}),e.event=t})),Ss(this,"_onEvent",(t=>{const e=Ys[t.type],n=t.offsetCenter;if(!e||!n||!this.layerManager)return;const i=this.layerManager.getLayers(),r=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:i,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:o}=r,s=o&&(o[e.handler]||o.props[e.handler]),a=this.props[e.handler];let l=!1;s&&(l=s.call(o,r,t)),!l&&a&&a(r,t)})),Ss(this,"_onPointerDown",(t=>{const e=t.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:e.x,y:e.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo})),this.props={...Zw,...t},t=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},t.viewState&&t.initialViewState&&Gs.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===sd()&&Gs.warn("IE 11 is not supported")(),this.viewState=t.initialViewState,t.gl||"undefined"!==typeof document&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new Qa({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&oc.setOptions(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){var t,e,n,i,r,o,s,a;(this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(t=this.layerManager)||void 0===t||t.finalize(),this.layerManager=null,null===(e=this.viewManager)||void 0===e||e.finalize(),this.viewManager=null,null===(n=this.effectManager)||void 0===n||n.finalize(),this.effectManager=null,null===(i=this.deckRenderer)||void 0===i||i.finalize(),this.deckRenderer=null,null===(r=this.deckPicker)||void 0===r||r.finalize(),this.deckPicker=null,null===(o=this.eventManager)||void 0===o||o.destroy(),this.eventManager=null,null===(s=this.tooltip)||void 0===s||s.remove(),this.tooltip=null,this.props.canvas||this.props.gl||!this.canvas)||(null===(a=this.canvas.parentElement)||void 0===a||a.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&Gs.removed("onLayerHover","onHover")(),"onLayerClick"in t&&Gs.removed("onLayerClick","onClick")(),t.initialViewState&&!Sp(this.props.initialViewState,t.initialViewState)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),i=this.layerManager.needsRedraw(t),r=this.effectManager.needsRedraw(t),o=this.deckRenderer.needsRedraw(t);return e=e||n||i||r||o,e}redraw(t){if(!this.layerManager)return;let e=this.needsRedraw({clearRedrawFlags:!0});e=t||e,e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}get isInitialized(){return null!==this.viewManager}getViews(){return Rc(this.viewManager),this.viewManager.views}getViewports(t){return Rc(this.viewManager),this.viewManager.getViewports(t)}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_pick(t,e,n){Rc(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(e).timeStart();const r=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(e).timeEnd(),r}_createCanvas(t){let e=t.canvas;if("string"===typeof e&&(e=document.getElementById(e),Rc(e)),!e){e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay";(t.parent||document.body).appendChild(e)}return Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;const{width:e,height:n}=t;if(e||0===e){const t=Number.isFinite(e)?"".concat(e,"px"):e;this.canvas.style.width=t}if(n||0===n){var i;const e=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.position=(null===(i=t.style)||void 0===i?void 0:i.position)||"absolute",this.canvas.style.height=e}}_updateCanvasSize(){const{canvas:t}=this;if(!t)return;const e=t.clientWidth||t.width,n=t.clientHeight||t.height;var i;e===this.width&&n===this.height||(this.width=e,this.height=n,null===(i=this.viewManager)||void 0===i||i.setProps({width:e,height:n}),this.props.onResize({width:e,height:n}))}_createAnimationLoop(t){const{width:e,height:n,gl:i,glOptions:r,debug:o,onError:s,onBeforeRender:a,onAfterRender:l,useDevicePixels:c}=t;return new K_({width:e,height:n,useDevicePixels:c,autoResizeViewport:!1,gl:i,onCreateContext:t=>Xa({...r,...t,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:t=>this._setGLContext(t.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:a,onAfterRender:l,onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new Kb({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:n,emptyInfo:i}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=n.length>0;let r=i,o=!1;for(const s of n){var e;r=s,o=(null===(e=s.layer)||void 0===e?void 0:e.onHover(s,t.event))||o}if(!o&&this.props.onHover&&this.props.onHover(r,t.event),this.props.getTooltip&&this.tooltip){const t=this.props.getTooltip(r);this.tooltip.setTooltip(t,r.x,r.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,qa(t,{enable:!0,copyState:!0})),this.tooltip=new V_(this.canvas),za(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new gb;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new Xw(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in Ys)this.eventManager.on(i,this._onEvent);this.viewManager=new xb({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new wb(t,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new k_,this.deckRenderer=new I_(t),this.deckPicker=new B_(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:n}=this.layerManager.context;za(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:t,effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:n})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Gs.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.cursorState.isDragging=t.isDragging||!1,this.props.onInteractionStateChange(t)}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=Ja.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}function Kw(t){let{map:e,gl:n,deck:i}=t;if(e.__deck)return e.__deck;const r=null===i||void 0===i?void 0:i.props._customRender,o={useDevicePixels:!0,_customRender:t=>{e.triggerRepaint(),null===r||void 0===r||r(t)},parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774},views:i&&i.props.views||[new Kb({id:"mapbox"})]};let s;return i&&i.props.gl!==n||(Object.assign(o,{gl:n,width:null,height:null,touchAction:"unset",viewState:Qw(e)}),e.on("move",(()=>function(t,e){t.setProps({viewState:Qw(e)}),t.needsRedraw({clearRedrawFlags:!0})}(s,e)))),i?(s=i,i.setProps(o),i.userData.isExternal=!0):(s=new Yw(o),e.on("remove",(()=>{s.finalize(),e.__deck=null}))),s.userData.mapboxLayers=new Set,s.userData.mapboxVersion=function(t){let e=0,n=0;const i=t.version;i&&([e,n]=i.split(".").slice(0,2).map(Number));return{major:e,minor:n}}(e),e.__deck=s,e.on("render",(()=>{s.isInitialized&&function(t,e){const{mapboxLayers:n,isExternal:i}=t.userData;if(i){const i=Array.from(n,(t=>t.id)),r=Dc(t.props.layers,Boolean).some((t=>t&&!i.includes(t.id)));let o=t.getViewports();const s=o.findIndex((t=>"mapbox"===t.id)),a=o.length>1||s<0;(r||a)&&(s>=0&&(o=o.slice(),o[s]=$w(t,e,!1)),t._drawLayers("mapbox-repaint",{viewports:o,layerFilter:e=>(!t.props.layerFilter||t.props.layerFilter(e))&&("mapbox"!==e.viewport.id||!i.includes(e.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}(s,e)})),s}function Qw(t){const{lng:e,lat:n}=t.getCenter();return{longitude:(e+540)%360-180,latitude:n,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()}}function $w(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const{mapboxVersion:i}=t.userData;return new vp(Object.assign({id:"mapbox",x:0,y:0,width:t.width,height:t.height},Qw(e),n?{nearZMultiplier:1===i.major&&i.minor>=3||i.major>=2?.02:1/(t.height||1)}:{nearZMultiplier:.1}))}function Jw(t){if(t.userData.isExternal)return;const e=[];let n=0;t.userData.mapboxLayers.forEach((t=>{const i=new(0,t.props.type)(t.props,{_offset:n++});e.push(i)})),t.setProps({layers:e})}Ss(Yw,"defaultProps",Zw),Ss(Yw,"VERSION",X_.VERSION);class tx{constructor(t){if(Ss(this,"id",void 0),Ss(this,"type",void 0),Ss(this,"renderingMode",void 0),Ss(this,"map",void 0),Ss(this,"deck",void 0),Ss(this,"props",void 0),!t.id)throw new Error("Layer must have an unique id");this.id=t.id,this.type="custom",this.renderingMode=t.renderingMode||"3d",this.map=null,this.deck=null,this.props=t}onAdd(t,e){var n,i;this.map=t,this.deck=Kw({map:t,gl:e,deck:this.props.deck}),n=this.deck,i=this,n.userData.mapboxLayers.add(i),Jw(n)}onRemove(){var t,e;this.deck&&(t=this.deck,e=this,t.userData.mapboxLayers.delete(e),Jw(t))}setProps(t){Object.assign(this.props,t,{id:this.id}),this.deck&&Jw(this.deck)}render(){!function(t,e,n){let{currentViewport:i}=t.userData;i||(i=$w(t,e,!0),t.userData.currentViewport=i),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[i],layerFilter:t=>{let{layer:e}=t;return n.id===e.id},clearCanvas:!1})}(this.deck,this.map,this)}}const ex="__UNDEFINED__";function nx(t,e,n,i){if(!t||!e||!t.style||!t.style._loaded)return;const r=Dc(i,Boolean);if(n!==i){const e=Dc(n,Boolean),i=new Set(e.map((t=>t.id)));for(const t of r)i.delete(t.id);for(const n of i)t.getLayer(n)&&t.removeLayer(n)}for(const a of r)t.getLayer(a.id)||t.addLayer(new tx({id:a.id,deck:e}),a.props.beforeId);const o=t.style._order,s={};for(const a of r){let{beforeId:t}=a.props;t&&o.includes(t)||(t=ex),s[t]=s[t]||[],s[t].push(a.id)}for(const a in s){const e=s[a];let n=a===ex?o.length:o.indexOf(a),i=a===ex?void 0:a;for(let r=e.length-1;r>=0;r--){const s=e[r],a=o.indexOf(s);a!==n-1&&(t.moveLayer(s,i),a>n&&n++),n--,i=s}}}class ix{constructor(t){Ss(this,"_props",void 0),Ss(this,"_deck",void 0),Ss(this,"_map",void 0),Ss(this,"_container",void 0),Ss(this,"_interleaved",void 0),Ss(this,"_handleStyleChange",(()=>{nx(this._map,this._deck,this._props.layers,this._props.layers)})),Ss(this,"_updateContainerSize",(()=>{if(this._map&&this._container){const{clientWidth:t,clientHeight:e}=this._map.getContainer();Object.assign(this._container.style,{width:"".concat(t,"px"),height:"".concat(e,"px")})}})),Ss(this,"_updateViewState",(()=>{const t=this._deck;t&&(t.setProps({viewState:Qw(this._map)}),t.redraw())})),Ss(this,"_handleMouseEvent",(t=>{const e=this._deck;if(!e)return;const n={type:t.type,offsetCenter:t.point,srcEvent:t};switch(t.type){case"click":n.tapCount=1,e._onPointerDown(n),e._onEvent(n);break;case"dblclick":n.type="click",n.tapCount=2,e._onEvent(n);break;case"mousemove":n.type="pointermove",e._onPointerMove(n);break;case"mouseout":n.type="pointerleave",e._onPointerMove(n);break;default:return}}));const{interleaved:e=!1,...n}=t;this._interleaved=e,this._props=n}setProps(t){this._interleaved&&t.layers&&nx(this._map,this._deck,this._props.layers,t.layers),Object.assign(this._props,t),this._deck&&this._deck.setProps(this._props)}onAdd(t){return this._map=t,this._interleaved?this._onAddInterleaved(t):this._onAddOverlaid(t)}_onAddOverlaid(t){const e=document.createElement("div");return Object.assign(e.style,{position:"absolute",left:0,top:0,pointerEvents:"none"}),this._container=e,this._deck=new Yw({...this._props,parent:e,viewState:Qw(t)}),t.on("resize",this._updateContainerSize),t.on("render",this._updateViewState),t.on("mousemove",this._handleMouseEvent),t.on("mouseout",this._handleMouseEvent),t.on("click",this._handleMouseEvent),t.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),e}_onAddInterleaved(t){return this._deck=new Yw({...this._props,gl:t.painter.context.gl}),t.on("styledata",this._handleStyleChange),nx(t,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){var t;const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),null===(t=this._deck)||void 0===t||t.finalize(),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(t){t.off("resize",this._updateContainerSize),t.off("render",this._updateViewState),t.off("mousemove",this._handleMouseEvent),t.off("mouseout",this._handleMouseEvent),t.off("click",this._handleMouseEvent),t.off("dblclick",this._handleMouseEvent)}_onRemoveInterleaved(t){t.off("styledata",this._handleStyleChange),nx(t,this._deck,this._props.layers,[])}getDefaultPosition(){return"top-left"}pickObject(t){return Rc(this._deck),this._deck.pickObject(t)}pickMultipleObjects(t){return Rc(this._deck),this._deck.pickMultipleObjects(t)}pickObjects(t){return Rc(this._deck),this._deck.pickObjects(t)}finalize(){this._map&&this._map.removeControl(this)}}const rx=t=>(jo((()=>new ix(t))).setProps(t),null),ox=()=>{const{parcelsLayer:e}=(0,t.useContext)(Vv),{circleLayer:n}=(0,t.useContext)(hb),r=[n,e];return(0,i.jsx)(rx,{layers:r})};ox.displayName="Layers";const sx=(0,t.createContext)(null),ax=e=>{let{children:n}=e;const{mapRef:r,marker:o,setMarker:s}=h(),[a,l]=(0,t.useState)(!1),[c,u]=(0,t.useState)({x:0,y:0}),d=(0,t.useCallback)((t=>{var e;const n=null===(e=r.current)||void 0===e?void 0:e.queryRenderedFeatures(t,{layers:["layer-mask"]});return n&&n.length>0}),[r]),f=(0,t.useCallback)((t=>{if(d(t.point)){l(!0);const{x:e,y:n}=t.point,i=r.current.project([o.longitude,o.latitude]);u({x:e-i.x,y:n-i.y})}}),[d,o,r]),p=(0,t.useCallback)((t=>{if(a){const e=r.current.unproject({x:t.point.x-c.x,y:t.point.y-c.y});s({longitude:e.lng,latitude:e.lat})}}),[a,c,r,s]),g=(0,t.useCallback)((()=>{l(!1)}),[]);return(0,i.jsx)(sx.Provider,{value:{isDragging:a,onDragStart:f,onMouseMove:p,onDragEnd:g},children:n})};sx.displayName="MouseEventsContext";const lx=()=>{const{mapRef:e,basemap:n,viewport:r,setViewport:o}=h(),{isDragging:s,onDragStart:a,onMouseMove:l,onDragEnd:c}=(0,t.useContext)(sx),u=(0,t.useCallback)((t=>{const e=t.lngLat.lng,n=t.lngLat.lat;o((t=>({...t,longitude:e,latitude:n})))}),[]);return(0,i.jsx)(ns,{children:(0,i.jsxs)(Wo,{ref:e,mapStyle:n,initialViewState:r,mapboxAccessToken:"pk.eyJ1IjoiaHZva2luZyIsImEiOiJja3F4YWMyNHMwODkxMm5vNzcxNWJrZXUzIn0.QCH37vNtXL1p2CfPYiVdgg",doubleClickZoom:!1,onDblClick:u,onMouseDown:a,onMouseMove:l,onMouseUp:c,onTouchStart:a,onTouchMove:l,onTouchEnd:c,dragPan:!s,children:[(0,i.jsx)(ox,{}),(0,i.jsx)(Ko,{}),(0,i.jsx)(Zo,{}),(0,i.jsx)(os,{}),(0,i.jsx)(ss,{}),(0,i.jsx)(vs,{})]})})};lx.displayName="Maps";const cx=()=>(0,i.jsx)("div",{className:"logo-wrapper",children:(0,i.jsx)("img",{src:"/parcels/static/logos/logo.svg",alt:"logo",height:"50px"})});cx.displayName="Logo";const ux=t=>{let{suggestions:e,suggestionIndex:n,handleClick:r}=t;return(0,i.jsx)("ul",{className:"search-suggestions",children:e.slice(0,5).map(((t,e)=>(0,i.jsx)("li",{onClick:r,style:{backgroundColor:e===n?"rgba(126, 126, 132, 1)":e%2===0?"rgba(126, 126, 132, 0.8)":"rgba(126, 126, 132, 0.6)"},children:t},e)))})};ux.displayName="Suggestions";const hx=(0,t.createContext)(null),dx=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(""),[s,a]=(0,t.useState)(null);return(0,t.useEffect)((()=>{r&&(async()=>{const t=r.replace(" ","__"),e="\n\t    \t".concat("http://localhost:8000","/\n\t    \tsearch_api\n\t    \t?query=").concat(t,"\n\t    \t&language=pt_BR\n\t    ").replace(/\s/g,""),n=await fetch(e),i=await n.json();a(i)})()}),[r]),(0,i.jsx)(hx.Provider,{value:{googleSearchData:s,searchText:r,setSearchText:o},children:n})};hx.displayName="GoogleSearchApiContext";const fx=e=>{let{activeSearch:n,setActiveSearch:r}=e;const{setPlaceId:o}=h(),{googleSearchData:s,searchText:a,setSearchText:l}=(0,t.useContext)(hx),[c,u]=(0,t.useState)(0),[d,f]=(0,t.useState)(!1),p=(0,t.useRef)(null),g=s&&s.predictions.reduce(((t,e)=>{const n=e.description.toLowerCase();return t.push(n),t}),[]),m=t=>{s&&s.predictions.filter((e=>{e.description.toLowerCase().trim()===t&&o(e.place_id)}))};return(0,i.jsxs)("div",{style:{display:"flex"},children:[(0,i.jsx)("img",{className:"search-icon",src:"/parcels/static/components/search/search_icon.svg",alt:"search-icon",onClick:()=>r((t=>!t))}),(0,i.jsx)("div",{className:"search-wrapper",children:n&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{className:"search-input",type:"text",placeholder:"Search...",value:a,onChange:t=>{const e=t.target.value;l(e),e.length>0?f(!0):f(!1)},onKeyDown:t=>{if(38===t.keyCode){if(0===c)return;u(c-1)}else if(40===t.keyCode){if(c-1===g.length)return;u(c+1)}else if(13===t.keyCode){const t=g&&g[c];m(t),t&&l(t),u(0),f(!1)}else 27===t.keyCode&&(l(""),u(0),f(!1))},spellCheck:!1,ref:p}),(0,i.jsx)("div",{className:"cancel-cross-wrapper",children:(0,i.jsx)("img",{className:"cancel-cross",src:"/parcels/static/components/search/cancel_search.svg",alt:"search-icon",onClick:()=>{l(""),u(0),f(!1)}})}),d&&g&&(0,i.jsx)(ux,{suggestions:g,suggestionIndex:c,handleClick:t=>{const e=t.target.innerText.trim();m(e),l(e),f(!1)}})]})})]})};fx.displayName="Search";const px=t=>{let{setActiveSearch:e}=t;return(0,i.jsx)("svg",{fill:"rgba(255, 255, 255, 1)",viewBox:"0 0 20 24",width:"24",onClick:()=>e(!1),children:(0,i.jsx)("path",{d:"\r M21,\r 11v1\r H5.64 l6.72,\r 6.72 l-0.71,\r 0.71 L3.72,\r 11.5 l7.92-7.92 l0.71,\r 0.71 L5.64,\r 11H\r 21z"})})};px.displayName="BackArrow";const gx=()=>{const[e,n]=(0,t.useState)(!1);return(0,i.jsxs)("div",{className:"wrapper-header",children:[(0,i.jsx)("div",{className:"normal-header",children:(0,i.jsx)(cx,{})}),(0,i.jsx)("div",{className:"small-header",children:e?(0,i.jsx)(px,{setActiveSearch:n}):(0,i.jsx)(cx,{})}),(0,i.jsx)(fx,{activeSearch:e,setActiveSearch:n})]})};gx.displayName="Header";const mx=t=>{let{children:e}=t,n=.01*window.innerHeight;return document.documentElement.style.setProperty("--vh","".concat(n,"px")),window.addEventListener("resize",(()=>{let t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(t,"px"))})),(0,i.jsxs)("div",{className:"wrapper",children:[(0,i.jsx)(gx,{}),e]})};mx.displayName="Wrapper";const vx=t=>{let{children:e}=t;return(0,i.jsx)(Wv,{children:(0,i.jsx)(db,{children:e})})};vx.displayName="LayersProvider";const yx=t=>{let{children:e}=t;return(0,i.jsx)(vx,{children:(0,i.jsx)(ax,{children:e})})};yx.displayName="MapsProvider";const bx=(0,t.createContext)(null),_x=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(8),[s,a]=(0,t.useState)(8),[l,c]=(0,t.useState)(3),[u,h]=(0,t.useState)(8),[d,f]=(0,t.useState)(8),[p,g]=(0,t.useState)(3);return(0,i.jsx)(bx.Provider,{value:{apartmentFront:r,setApartmentFront:o,apartmentSide:s,setApartmentSide:a,apartmentHeight:l,setApartmentHeight:c,apartmentFrontPosition:u,setApartmentFrontPosition:h,apartmentSidePosition:d,setApartmentSidePosition:f,apartmentHeightPosition:p,setApartmentHeightPosition:g},children:n})};bx.displayName="ModuleDimensionsContext";const wx=t=>{let{children:e}=t;return(0,i.jsx)(or,{children:(0,i.jsx)(Hr,{children:(0,i.jsx)(_x,{children:e})})})};wx.displayName="DimensionsProvider";const xx=(0,t.createContext)(null),Sx=t=>{let{children:e}=t;const n=106.94,r=-61.77,o=(t,e)=>Math.sqrt(e**2+t**2),s=o(n,r),a=o(-65.2,-37.6),l=n/s,c=r/s,u=-65.2/a,h=-37.6/a;return(0,i.jsx)(xx.Provider,{value:{iRight:l,jRight:c,iLeft:u,jLeft:h},children:e})};xx.displayName="VectorsContext";const Px=(0,t.createContext)(null),Ex=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(6),[s,a]=(0,t.useState)(3),[l,c]=(0,t.useState)(6),[u,h]=(0,t.useState)(3),[d,f]=(0,t.useState)(2);return(0,i.jsx)(Px.Provider,{value:{undergroundHeight:r,setUndergroundHeight:o,floors:s,setFloors:a,maxFloors:l,setMaxFloors:c,floorHeight:u,setFloorHeight:h,garages:d,setGarages:f},children:n})};Px.displayName="BuildingContext";const Cx=t=>{let{children:e}=t;return(0,i.jsx)(_s,{children:(0,i.jsx)(Sx,{children:(0,i.jsx)(d,{children:(0,i.jsx)(wx,{children:(0,i.jsx)(Ex,{children:(0,i.jsx)(jr,{children:e})})})})})})};Cx.displayName="FiltersProvider";const Tx=t=>{let{children:e}=t;return(0,i.jsx)(cr,{children:(0,i.jsx)(Zr,{children:e})})};Tx.displayName="SliderSizesProvider";const Ax=t=>{let{children:e}=t;return(0,i.jsx)(_r,{children:(0,i.jsx)(Tx,{children:(0,i.jsx)(a,{children:(0,i.jsx)(Er,{children:e})})})})};Ax.displayName="LeftSizesProvider";const kx=(0,t.createContext)(null),Mx=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(null),[s,a]=(0,t.useState)(null),l={top:0,bottom:0,left:0,right:0},c=r-l.right-l.left,u=s-l.top-l.bottom;return(0,i.jsx)(kx.Provider,{value:{margin:l,width:r,height:s,setWidth:o,setHeight:a,innerWidth:c,innerHeight:u},children:n})};kx.displayName="FrontSliderSizesContext";const Lx=(0,t.createContext)(null),Ox=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(null),[s,a]=(0,t.useState)(null),l={top:0,bottom:0,left:0,right:0},c=r-l.right-l.left,u=s-l.top-l.bottom;return(0,i.jsx)(Lx.Provider,{value:{margin:l,width:r,height:s,setWidth:o,setHeight:a,innerWidth:c,innerHeight:u},children:n})};Lx.displayName="SideSliderSizesContext";const Rx=(0,t.createContext)(null),Ix=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(null),[s,a]=(0,t.useState)(null),l={top:0,bottom:0,left:0,right:0},c=r-l.right-l.left,u=s-l.top-l.bottom;return(0,i.jsx)(Rx.Provider,{value:{margin:l,width:r,height:s,setWidth:o,setHeight:a,innerWidth:c,innerHeight:u},children:n})};Rx.displayName="HeightSliderSizesContext";const jx=t=>{let{children:e}=t;return(0,i.jsx)(Mx,{children:(0,i.jsx)(Ix,{children:(0,i.jsx)(Ox,{children:e})})})};jx.displayName="ApartmentSlidersSizesProvider";const Fx=(0,t.createContext)(null),zx=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(null),[s,a]=(0,t.useState)(null),l={top:10,bottom:10,left:10,right:10},c=r-l.right-l.left,u=s-l.top-l.bottom;return(0,i.jsx)(Fx.Provider,{value:{margin:l,width:r,height:s,setWidth:o,setHeight:a,innerWidth:c,innerHeight:u},children:n})};Fx.displayName="ApartmentBlockSizesContext";const Nx=t=>{let{children:e}=t;return(0,i.jsx)(jx,{children:(0,i.jsx)(zx,{children:e})})};Nx.displayName="ApartmentSizesProvider";const Dx=(0,t.createContext)(null),Bx=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(null),[s,a]=(0,t.useState)(null),l={top:20,bottom:10,left:30,right:0},c=r-l.right-l.left,u=s-l.top-l.bottom;return(0,i.jsx)(Dx.Provider,{value:{margin:l,width:r,height:s,setWidth:o,setHeight:a,innerWidth:c,innerHeight:u},children:n})};Dx.displayName="FrontElevationSizesContext";const Ux=(0,t.createContext)(null),Vx=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(null),[s,a]=(0,t.useState)(null),l={top:10,bottom:20,left:30,right:0},c=r-l.right-l.left,u=s-l.top-l.bottom;return(0,i.jsx)(Ux.Provider,{value:{margin:l,width:r,height:s,setWidth:o,setHeight:a,innerWidth:c,innerHeight:u},children:n})};Ux.displayName="SideElevationSizesContext";const Wx=t=>{let{children:e}=t;return(0,i.jsx)(Bx,{children:(0,i.jsx)(Vx,{children:e})})};Wx.displayName="ElevationSizesProvider";const Hx=(0,t.createContext)(null),Gx=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(null),[s,a]=(0,t.useState)(null),l={top:0,bottom:0,left:20,right:20},c=r-l.right-l.left,u=s-l.top-l.bottom;return(0,i.jsx)(Hx.Provider,{value:{margin:l,width:r,height:s,setWidth:o,setHeight:a,innerWidth:c,innerHeight:u},children:n})};Hx.displayName="LayoutSizesContext";const Xx=(0,t.createContext)(null),qx=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(null),[s,a]=(0,t.useState)(null),l={top:0,bottom:0,left:20,right:20},c=r-l.right-l.left,u=s-l.top-l.bottom;return(0,i.jsx)(Xx.Provider,{value:{margin:l,width:r,height:s,setWidth:o,setHeight:a,innerWidth:c,innerHeight:u},children:n})};Xx.displayName="ParcelSizesContext";const Zx=(0,t.createContext)(null),Yx=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(null),[s,a]=(0,t.useState)(null),l={top:0,bottom:10,left:20,right:20},c=r-l.right-l.left,u=s-l.top-l.bottom;return(0,i.jsx)(Zx.Provider,{value:{margin:l,width:r,height:s,setWidth:o,setHeight:a,innerWidth:c,innerHeight:u},children:n})};Zx.displayName="PerspectiveSizesContext";const Kx=t=>{let{children:e}=t;return(0,i.jsx)(Nx,{children:(0,i.jsx)(Wx,{children:(0,i.jsx)(Gx,{children:(0,i.jsx)(qx,{children:(0,i.jsx)(Yx,{children:e})})})})})};Kx.displayName="RightSizesProvider";const Qx=(0,t.createContext)(null),$x=e=>{let{children:n}=e;const[r,o]=(0,t.useState)(null),[s,a]=(0,t.useState)(null),l={top:0,bottom:0,left:0,right:0},c=r-l.right-l.left,u=s-l.top-l.bottom;return(0,i.jsx)(Qx.Provider,{value:{margin:l,width:r,height:s,setWidth:o,setHeight:a,innerWidth:c,innerHeight:u},children:n})};Qx.displayName="SVGMapSizesContext";const Jx=t=>{let{children:e}=t;return(0,i.jsx)($x,{children:e})};Jx.displayName="MapSizesProvider";const tS=t=>{let{children:e}=t;return(0,i.jsx)(Ax,{children:(0,i.jsx)(Kx,{children:(0,i.jsx)(Jx,{children:e})})})};tS.displayName="SizesProvider";const eS=(0,t.createContext)(null),nS=e=>{let{children:n}=e;const{parcelId:r}=h(),[o,s]=(0,t.useState)(null);return(0,t.useEffect)((()=>{(async()=>{const t="\n        ".concat("http://localhost:8000","/\n        site_api\n        ?parcel_id=").concat(r,"\n      ").replace(/\s/g,""),e=await fetch(t),n=await e.json();s(n)})()}),[r]),(0,i.jsx)(eS.Provider,{value:{siteData:o},children:n})};eS.displayName="SiteApiContext";const iS=(0,t.createContext)(null),rS=e=>{let{children:n}=e;const{apartmentSide:r,apartmentFront:o,apartmentHeight:s}=(0,t.useContext)(bx),{garages:a}=(0,t.useContext)(Px),{zoneData:l}=ro(),{siteData:c}=(0,t.useContext)(eS),[u,h]=(0,t.useState)(null),d=c&&c.front,f=l&&c&&l.occupancy_rate*c.area,p=l&&l.height;return(0,t.useEffect)((()=>{l&&c&&(async()=>{const t="\n        ".concat("http://localhost:8000","/\n        building_api\n        ?apartment_side=").concat(Math.round(10*r)/10,"\n        &apartment_front=").concat(Math.round(10*o)/10,"\n        &apartment_height=").concat(Math.round(10*s)/10,"\n        &parcel_front=").concat(d,"\n        &occupancy_rate=").concat(f,"\n        &zone_height=").concat(p,"\n        &garages=").concat(a,"\n      ").replace(/\s/g,""),e=await fetch(t),n=await e.json();h(n)})()}),[l,c,r,o,s]),(0,i.jsx)(iS.Provider,{value:{buildingData:u},children:n})};iS.displayName="BuildingApiContext";const oS=(0,t.createContext)(null),sS=e=>{let{children:n}=e;const{parcelId:r}=h(),[o,s]=(0,t.useState)(null);return(0,t.useEffect)((()=>{(async()=>{const t="\n        ".concat("http://localhost:8000","/\n        envelop_api\n        ?parcel_id=").concat(r,"\n      ").replace(/\s/g,""),e=await fetch(t),n=await e.json();s(n)})()}),[r]),(0,i.jsx)(oS.Provider,{value:{envelopData:o},children:n})};oS.displayName="EnvelopApiContext";const aS=t=>{let{children:e}=t;return(0,i.jsx)(nS,{children:(0,i.jsx)(sS,{children:(0,i.jsx)(oo,{children:(0,i.jsx)(rS,{children:e})})})})};aS.displayName="ParcelApiProvider";const lS=(0,t.createContext)(null),cS=e=>{let{children:n}=e;const{placeId:r,setPlaceCoordinates:o}=h(),[s,a]=(0,t.useState)(null);return(0,t.useEffect)((()=>{r&&(async()=>{const t="\n\t    \t".concat("http://localhost:8000","/\n\t    \tdetails_api\n\t    \t?place_id=").concat(r,"\n\t    ").replace(/\s/g,""),e=await fetch(t),n=await e.json();a(n)})()}),[r]),(0,t.useEffect)((()=>{if(s&&s.result){const t=s.result.geometry.location.lng,e=s.result.geometry.location.lat;o({longitude:t,latitude:e})}}),[s]),(0,i.jsx)(lS.Provider,{value:{googleDetailsData:s},children:n})};lS.displayName="GoogleDetailsApiContext";const uS=t=>{let{children:e}=t;return(0,i.jsx)(Jo,{children:(0,i.jsx)(dx,{children:(0,i.jsx)(cS,{children:e})})})};uS.displayName="GoogleApiProvider";const hS=(0,t.createContext)(null),dS=e=>{let{children:n}=e;const{polygonData:r}=v(),[o,s]=(0,t.useState)(null),{activeDrain:a}=bs();return(0,t.useEffect)((()=>{a&&(async()=>{const t="\n\t\t\t\t".concat("http://localhost:8000","/\n\t\t\t\tdrain_api\n\t\t\t").replace(/\s/g,""),e=await fetch(t),n=await e.json();s(n)})()}),[r,a]),(0,i.jsx)(hS.Provider,{value:{drainData:o},children:n})};hS.displayName="DrainApiContext";const fS=(0,t.createContext)(null),pS=e=>{let{children:n}=e;const{polygonData:r}=v(),[o,s]=(0,t.useState)(null),{activeCurves:a}=bs();return(0,t.useEffect)((()=>{a&&(async()=>{const t="\n\t\t\t\t".concat("http://localhost:8000","/\n\t\t\t\tparcels_curves_api\n\t\t\t").replace(/\s/g,""),e=await fetch(t),n=await e.json();s(n)})()}),[r,a]),(0,i.jsx)(fS.Provider,{value:{parcelsCurvesData:o},children:n})};fS.displayName="ParcelsCurvesApiContext";const gS=(0,t.createContext)(null),mS=e=>{let{children:n}=e;const{parcelId:r}=h(),[o,s]=(0,t.useState)(null);return(0,t.useEffect)((()=>{(async()=>{const t="\n\t\t\t\t".concat("http://localhost:8000","/\n\t\t\t\tparcel_curves_api\n\t\t\t\t?parcel_id=").concat(r,"\n\t\t\t").replace(/\s/g,""),e=await fetch(t),n=await e.json();s(n)})()}),[r]),(0,i.jsx)(gS.Provider,{value:{parcelCurvesData:o},children:n})};gS.displayName="ParcelCurvesApiContext";const vS=t=>{let{children:e}=t;return(0,i.jsx)(w,{children:(0,i.jsx)(dS,{children:(0,i.jsx)(pS,{children:(0,i.jsx)(mS,{children:e})})})})};vS.displayName="GeomApiProvider";const yS=t=>{let{children:e}=t;return(0,i.jsx)(y,{children:(0,i.jsx)(vS,{children:(0,i.jsx)(aS,{children:(0,i.jsx)(uS,{children:e})})})})};yS.displayName="ApiProvider";const bS=t=>{let{children:e}=t;return(0,i.jsx)(Cx,{children:(0,i.jsx)(g,{children:(0,i.jsx)(yS,{children:(0,i.jsx)(tS,{children:(0,i.jsx)(yx,{children:(0,i.jsx)(rs,{children:(0,i.jsx)(ms,{children:e})})})})})})})};bS.displayName="MainProvider";const _S=()=>(0,i.jsx)(bS,{children:(0,i.jsx)(mx,{children:(0,i.jsxs)("div",{className:"main",children:[(0,i.jsx)(ao,{}),(0,i.jsx)(lx,{})]})})});_S.displayName="Main";const wS=()=>(0,i.jsx)("div",{className:"App",children:(0,i.jsx)(_S,{})});wS.displayName="App";const xS=document.getElementById("root");(0,e.s)(xS).render((0,i.jsx)(t.StrictMode,{children:(0,i.jsx)(wS,{})}))})()})();
//# sourceMappingURL=main.928d70a3.js.map